(this["webpackJsonpsolitaire-react"]=this["webpackJsonpsolitaire-react"]||[]).push([[0],{10:function(t,e,n){},17:function(t,e,n){"use strict";n.r(e);var a=n(0),s=(n(10),n(1)),c=n(2),r=n(8),i=n(4),o=n(3),u=n(7),l=n(5),d=n.n(l),h=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).state={timeElapsed:null},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var t=this;setInterval((function(){t.setState((function(e){var n=(t.props.end||Date.now())-t.props.started,a=Math.floor(n/1e3/60/60);n-=1e3*a*60*60;var s=Math.floor(n/1e3/60);n-=1e3*s*60;var c=Math.floor(n/1e3);return n-=1e3*c,e.timeElapsed=a?a+":"+s+":"+c:s+":"+c,Object(u.a)({},e)}))}),1e3)}},{key:"render",value:function(){return Object(a.jsxs)("span",{className:this.props.className,children:["Time Elapsed: ",this.state.timeElapsed]})}}]),n}(l.Component),p=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var t=this;document.addEventListener("keydown",(function(e){var n=window.event?event:e;90==n.keyCode&&n.ctrlKey&&t.props.undo()}))}},{key:"render",value:function(){return Object(a.jsx)("div",{children:Object(a.jsxs)("button",{onClick:this.props.undo,children:["undo (penalty:-",this.props.undoLabel(),")"]})})}}]),n}(l.Component),f=function(t){return Object(a.jsx)("div",{className:"footer",children:Object(a.jsxs)("div",{className:"footer-grid-container",children:[Object(a.jsxs)("span",{children:["Points: ",t.model.points]}),Object(a.jsx)(h,{className:"clock",started:t.model.started,end:t.model.end}),Object(a.jsxs)("span",{children:["Is Ended: ",t.model.isEnded?"Y":"N"]}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:t.reset,children:"reset"})}),Object(a.jsx)(p,{undo:t.undo,undoLabel:t.undoLabel}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:t.beat,children:"beat on table"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:t.trip,children:"trip"})}),Object(a.jsxs)("span",{className:"report",children:["Report Issues ",Object(a.jsx)("a",{href:"https://github.com/ckonig/solitaire/issues",children:"here"}),"."]})]})})},k=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"componentDidUpdate",value:function(){this.props.model.blinkFor&&this.props.model.unblink()}}]),n}(l.Component),b=function(t){var e=t.model,n=t.className+" card card-base suit-"+e.type.icon;n+=t.isSelected?" card-selected":"",n+=t.blink?" blink":"";var s=Object(u.a)({zIndex:t.zIndex?t.zIndex:!!t.offsetTop+2,top:t.offsetTop?t.offsetTop/10+"vw":0},t.model.entropyStyle);if(t.model.offsetTop&&(console.log("found it",t.model.offsetTop),s.top+=t.model.offsetTop),t.shadowOffsetX||!t.shadowOffsetX&&0===t.shadowOffsetX){var c=t.shadowOffsetY||"-1";s.boxShadow=t.shadowOffsetX+"px "+c+"px 4px 4px rgba(0, 0, 0, 0.75)"}return Object(a.jsx)("div",{className:"stack-base",children:Object(a.jsx)("div",{style:s,className:n,onClick:function(){return t.onClick(Object(u.a)({},e))},children:e.isHidden?Object(a.jsx)("div",{className:"card-back quarot",children:"\xa0"}):Object(a.jsxs)("div",{className:"card-grid-container",children:[Object(a.jsx)("div",{children:Object(a.jsx)("div",{className:"align-center",children:e.type.icon})}),Object(a.jsx)("div",{children:Object(a.jsx)("div",{className:"align-left",children:e.face})}),Object(a.jsx)("div",{children:"\xa0"}),Object(a.jsx)("div",{children:Object(a.jsx)("div",{className:"align-center",children:e.type.icon})}),Object(a.jsx)("div",{className:"mainface",children:Object(a.jsx)("div",{className:"align-center",children:e.face})}),Object(a.jsx)("div",{children:Object(a.jsx)("div",{className:"align-center",children:e.type.icon})}),Object(a.jsx)("div",{children:"\xa0"}),Object(a.jsx)("div",{children:Object(a.jsx)("div",{className:"align-right",children:e.face})}),Object(a.jsx)("div",{children:Object(a.jsx)("div",{className:"align-center",children:e.type.icon})})]})})})},j=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).isTouch=a.is_touch_device(),a}return Object(c.a)(n,[{key:"is_touch_device",value:function(){try{var t=" -webkit- -moz- -o- -ms- ".split(" ");return"ontouchstart"in window||"undefined"!==typeof window.DocumentTouch&&document instanceof window.DocumentTouch||(e=["(",t.join("touch-enabled),("),"heartz",")"].join(""),window.matchMedia(e).matches)}catch(n){return console.error("(Touch detect failed)",n),!1}var e}},{key:"shouldShowHand",value:function(t){return this.isTouch&&this.props.hand.isHoldingCard()&&this.props.hand.source===t}}]),n}(l.Component),m=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).myRef=d.a.createRef(),a.onMouseMove=a.onMouseMove.bind(Object(r.a)(a)),a.onKeyDown=a.onKeyDown.bind(Object(r.a)(a)),a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.isTouch||(document.addEventListener("mousemove",this.onMouseMove,!1),this.props.putBack&&document.addEventListener("keydown",this.onKeyDown,!1))}},{key:"componentWillUnmount",value:function(){this.isTouch||(document.removeEventListener("mousemove",this.onMouseMove,!1),document.addEventListener("keydown",this.onKeyDown,!1))}},{key:"onMouseMove",value:function(t){if(!this.isTouch&&this.props.hand&&this.props.parent==this.props.hand.source){var e=this.myRef.current,n=t.clientX,a=t.clientY;e.style.top=a+25+"px",e.style.left=n+25+"px",e.style.position="absolute"}}},{key:"onKeyDown",value:function(t){27==(window.event?event:t).keyCode&&!this.isTouch&&this.props.hand&&this.props.parent==this.props.hand.source&&this.props.putBack()}},{key:"render",value:function(){return Object(a.jsx)("div",{ref:this.myRef,children:!this.isTouch&&this.props.hand&&this.props.parent==this.props.hand.source&&this.props.stack&&this.props.stack.map((function(t,e){return Object(a.jsx)(b,{model:t,onClick:function(){console.error("clicked card in mouse hand")},offsetTop:20*e,zIndex:1e3+20*e,isSelected:!0},e)}))})}}]),n}(j),v=function(t){var e="card-base socket-empty";return t.blink&&(e+=" blink"),Object(a.jsx)("div",{className:e,onClick:function(){return t.onClick()},children:t.children})},O=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var t=this;return this.isTouch&&this.props.hand&&this.props.parent===this.props.hand.source?Object(a.jsx)("div",{children:this.props.hand&&this.props.hand.stack&&this.props.hand.stack.map((function(e,n){return Object(a.jsx)(b,{model:e,offsetTop:t.props.offset+20*n,zIndex:1e3+20*n,isSelected:!0,onClick:function(e){return t.props.onClick(e)}},n)}))}):null}}]),n}(j),g=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var t=this.props;return Object(a.jsxs)("div",{children:[Object(a.jsx)(v,{blink:t.model.blinkFor,onClick:function(){return t.onClick()},children:Object(a.jsx)("div",{className:"align-center foundation-base suit-"+t.model.icon,children:t.model.icon})}),t.model.stack.map((function(e,n){return Object(a.jsx)(b,{model:e,shadowOffsetX:2*t.index,shadowOffsetY:-3,blink:t.model.blinkFor,entropy:6,onClick:t.onClick},n)})),Object(a.jsx)(O,{parent:"foundation-"+t.index,hand:t.hand,onClick:function(){return t.onClick(t.model.stack[t.model.stack.length-1])}}),Object(a.jsx)(m,{parent:"foundation-"+t.index,hand:t.hand,stack:t.hand.stack,putBack:function(){return t.onClick(t.model.stack[t.model.stack.length-1],t.model.stack.length-1)}})]})}}]),n}(k),y=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var t=this.props;return Object(a.jsxs)("div",{children:[Object(a.jsx)(v,{blink:t.model.blinkFor,onClick:t.onClick}),t.model.stack.map((function(e,n){return Object(a.jsx)(b,{model:e,offsetTop:n/2*-1,blink:t.model.blinkFor,shadowOffsetX:-6,shadowOffsetY:-3,source:"main",entropy:6,onClick:t.onClick},n)}))]})}}]),n}(k),w=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var t=this.props,e=function(e){for(var n=0;n<=e;n++)if(t.model.stack[n]&&!t.model.stack[n].isHidden)return 12*n+24*(e-n);return 12*e};return Object(a.jsxs)("div",{children:[Object(a.jsx)(v,{blink:t.model.blinkFor,onClick:function(){return t.onClick(null,"tableau-"+t.index)}}),t.model.stack.map((function(n,s){return Object(a.jsx)(b,{model:n,blink:t.model.blinkFor,entropy:4,shadowOffsetX:2*(-3+t.index),offsetTop:e(s),onClick:t.onClick},s)})),Object(a.jsx)(O,{parent:"tableau-"+t.index,hand:t.hand,offset:e(t.model.stack.length),onClick:function(){return t.onClick(t.model.stack[t.model.stack.length-1])}}),Object(a.jsx)(m,{parent:"tableau-"+t.index,hand:t.hand,stack:t.hand.stack,putBack:function(){return t.onClick(t.model.stack[t.model.stack.length-1],t.model.stack.length-1)}})]})}}]),n}(k),x=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){return Object(s.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var t=this.props;return Object(a.jsxs)("div",{children:[Object(a.jsx)(v,{blink:t.model.blinkFor,onClick:t.onClick}),t.model.stack.map((function(e,n){return Object(a.jsx)(b,{model:e,shadowOffsetX:-4,shadowOffsetY:-3,offsetTop:n/2*-1,blink:t.model.blinkFor,onClick:function(e){return t.onClick(e)},entropy:6},n)})),Object(a.jsx)(O,{parent:"waste",hand:t.hand,onClick:function(e){return t.onClick(e,"waste")}}),Object(a.jsx)(m,{parent:"waste",hand:t.hand,stack:t.hand.stack,putBack:function(){return t.onClick(t.model.stack[t.model.stack.length-1],t.model.stack.length-1)}})]})}}]),n}(k),C=function(t){return Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"layout-grid-container",children:[Object(a.jsx)("div",{className:"game-view",children:Object(a.jsxs)("div",{className:"board-grid-container",children:[Object(a.jsx)(y,{model:t.model.stock,onClick:t.handlers.clickStock}),Object(a.jsx)(x,{model:t.model.waste,hand:t.model.hand,onClick:t.handlers.clickWaste}),Object(a.jsx)("div",{className:"spacer",children:"\xa0"}),t.model.foundation.stacks.map((function(e,n){return Object(a.jsx)(g,{index:n,model:e,hand:t.model.hand,onClick:function(e){return t.handlers.clickFoundation(e,n)}},n)})),t.model.tableau.stacks.map((function(e,n){return Object(a.jsx)(w,{index:n,model:e,hand:t.model.hand,onClick:function(e){return t.handlers.clickTableau(e,n)}},n)}))]})}),Object(a.jsx)(f,{reset:t.handlers.reset,undoLabel:t.handlers.undoLabel,undo:t.handlers.undo,beat:t.handlers.beat,trip:t.handlers.trip,model:t.model.game})]})})},T=n(6),S=function(){function t(e,n,a){var c=this;Object(s.a)(this,t),this.causeEntropy=function(t){var e=2*t,n=function(){return Math.random()<.5},a=function(t,e){return Math.random()*(e-t)+t};n()&&(n()?c.entropyStyle.left=a(0,e/2):c.entropyStyle.right=a(0,e/2),n()),c.entropyStyle.transform="rotate("+a(-1*e,e)+"deg)"},this.equals=function(e){return t.equals(c,e)},this.face=e,this.type=n,this.isHidden=a,this.entropyStyle={},this.offsetTop=0,this.causeEntropy(1)}return Object(c.a)(t,null,[{key:"equals",value:function(t,e){return!t&&!e||t&&e&&e.face==t.face&&e.type.icon==t.type.icon}}]),t}();S.copy=function(t){var e=new S(t.face,t.type,t.isHidden);return e.source=t.source,e.entropyStyle=t.entropyStyle,e},S.copyAll=function(t){return t.map((function(t){return S.copy(t)}))};var M=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],E={heart:{icon:"\u2665",color:"red"},club:{icon:"\u2663",color:"black"},diamond:{icon:"\u2666",color:"red"},spade:{icon:"\u2660",color:"black"}},N=function(){function t(){Object(s.a)(this,t);var e=Object.keys(E);this.cards=M.map((function(t){return Object(T.a)(e.map((function(e){return new S(t,E[e],!0)})))})).flat()}return Object(c.a)(t,[{key:"shuffle",value:function(){return this.shuffleArray(this.cards),this}},{key:"shuffleArray",value:function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),a=[t[n],t[e]];t[e]=a[0],t[n]=a[1]}}}]),t}(),P=function(){function t(){var e=this;Object(s.a)(this,t),this.getCurrentAccepted=function(t){var n=e.stacks[t].acceptedCards;return n[n.length-1]},this.accepts=function(t,n){var a=e.getCurrentAccepted(t);return e.stacks[t].icon==n.type.icon&&a==n.face},this.add=function(t,n){var a=n[0];return a.causeEntropy(3),a.source="foundation-"+t,e.stacks[t].stack.push(a),e.stacks[t].usedCards.push(e.stacks[t].acceptedCards.pop())},this.remove=function(t,n){return e.stacks[t].acceptedCards.push(e.stacks[t].usedCards.pop()),n&&n.equals(e.getTop(t))&&e.stacks[t].stack.pop()},this.getPreviousUsed=function(t){return Object(T.a)(e.stacks[t].usedCards).pop()},this.countCards=function(){e.stacks.map((function(t){return parseInt(t.stack.length)})).reduce((function(t,e){return t+e}),0)},this.trip=function(){var t=e.stacks[Math.floor(Math.random()*e.stacks.length)],n=t.stack[Math.floor(Math.random()*t.stack.length)];return n&&n.causeEntropy(4),e};var n=Object.keys(E).map((function(t){return E[t]})).map((function(t){return Object(u.a)(Object(u.a)({},{stack:[],acceptedCards:Object(T.a)(["A"].concat(Object(T.a)(M.slice(0,M.length-1))).reverse()),usedCards:[],icon:null,color:null}),t)}));this.stacks=Object(T.a)(n)}return Object(c.a)(t,[{key:"getTop",value:function(t){return this.stacks[t].stack[this.stacks[t].stack.length-1]}}]),t}();P.copy=function(t){var e=new P;return e.stacks=t.stacks.map((function(t){return{stack:S.copyAll(t.stack),acceptedCards:Object(T.a)(t.acceptedCards),usedCards:Object(T.a)(t.usedCards),icon:t.icon,color:t.color}})),e};var D=function(){function t(){var e=this;Object(s.a)(this,t),this.popPreviousState=function(t,n){for(var a=e.previousStates.length-1==t,s=function(){return a&&e.previousStates&&e.previousStates.pop()},c=s();c&&(!c.game.memorable||e.modelEquals(c,n))&&e.previousStates.length;)c=s();return c&&c.game&&(c.game.points=Math.min(c.game.points,e.points)-Math.pow(2,e.multiplicator),c.game.multiplicator=e.multiplicator+1),c},this.points=0,this.started=Date.now(),this.previousStates=[],this.memorable=!0,this.modified=!1,this.multiplicator=1,this.trippy=!1}return Object(c.a)(t,[{key:"registerMove",value:function(t,e){this.memorable=!0,this.modified=!0;var n={source:e,target:t};return e==t&&(this.memorable=!1),this.points+=this.rateMove(n),!0}},{key:"stackEquals",value:function(t,e){return t.stack.every((function(t,n){return S.equals(t,e.stack[n])&&t.isHidden==e.stack[n].isHidden}))}},{key:"stacksEqual",value:function(t,e){var n=this;return t.stacks.every((function(t,a){return n.stackEquals(t,e.stacks[a])}))}},{key:"modelEquals",value:function(t,e){return this.stackEquals(t.stock,e.stock)&&this.stackEquals(t.waste,e.waste)&&this.stacksEqual(t.tableau,e.tableau)&&this.stacksEqual(t.foundation,e.foundation)}},{key:"pushPreviousState",value:function(t){var e=this.previousStates[this.previousStates.length-1];e&&this.modelEquals(t,e)||this.previousStates.push(t)}},{key:"registerPickup",value:function(){return this.modified=!0,this.memorable=!1,!0}},{key:"registerRecycle",value:function(){this.memorable=!0,this.modified=!0,this.points>0&&(this.points<100?this.points=0:this.points-=100),console.debug("RATING: subtract (max) 100 points for RECYCLE")}},{key:"registerUncover",value:function(){return this.memorable=!0,this.modified=!0,this.points+=5,console.debug("RATING: add 5 points for UNCOVER"),!0}},{key:"registerBlink",value:function(){return this.modified=!0,this.memorable=!1,!0}},{key:"rateMove",value:function(t){var e="tableau"==t.source.substr(0,7),n="tableau"==t.target.substr(0,7),a="foundation"==t.source.substr(0,10),s="foundation"==t.target.substr(0,10);if(e){if(s)return console.debug("RATING: add 10 points for MOVE tableau -> foundation"),10}else if("waste"==t.source){if(s)return console.debug("RATING: add 10 points for MOVE waste -> foundation"),10;if(n)return console.debug("RATING: add 5 points for MOVE waste -> tableau"),5}else if(a&&n)return console.debug("RATING: subtract 15 points for MOVE foundation -> tableau"),-15;return 0}}]),t}();D.copy=function(t){var e=new D;return e.points=t.points,e.started=t.started,e.modified=t.modified,e.multiplicator=t.multiplicator,e.memorable=t.memorable,e.previousStates=Object(T.a)(t.previousStates),e};var H=function(){function t(){var e=this;Object(s.a)(this,t),this.isHoldingCard=function(){return!!e.stack.length},this.currentCard=function(){return e.isHoldingCard()&&e.stack[0]},this.hasMoreThanOneCard=function(){return e.stack.length>1},this.isFromCurrentSource=function(t){return e.source&&t.source==e.source},this.stack=[],this.source=null}return Object(c.a)(t,[{key:"pickUp",value:function(t,e){return t&&t[0]&&(this.stack=t,this.source=e,console.log("picked up",this.stack)),t}},{key:"putDown",value:function(){return this.source=null,this.stack.splice(0,this.stack.length)}}]),t}();H.copy=function(t){var e=new H;return e.stack=S.copyAll(t.stack),e.source=t.source,e};var A=function(){function t(e){var n=this;Object(s.a)(this,t),this.isOnTop=function(t){return t&&t.equals(n.getTop())},this.getTop=function(){return n.stack[n.stack.length-1]},this.trip=function(){var t=n.stack[Math.floor(Math.random()*n.stack.length)];return t&&t.causeEntropy(1),n},this.stack=Object(T.a)(e)}return Object(c.a)(t,[{key:"recycle",value:function(t){return!!t.length&&(this.stack=t.reverse().map((function(t){return t.causeEntropy(1),t.isHidden=!0,t})),!0)}}]),t}();A.copy=function(t){var e=new A([]);return e.stack=S.copyAll(t.stack),e};var _=function(){function t(e){var n=this;Object(s.a)(this,t),this.getStack=function(t){return n.stacks[t]},this.accepts=function(t,e){var a=n.getTop(t);if(!a)return e&&"K"==e.face;if(a.isHidden)return!1;var s=Object(T.a)([].concat(M));return s.indexOf(e.face)+1==s.indexOf(a.face)&&e.type.color!=a.type.color},this.popWithFollowing=function(t,e){for(var a=0;a<n.stacks[e].stack.length;a++)if(t&&t.equals(n.stacks[e].stack[a]))return n.stacks[e].stack.splice(a,n.stacks[e].stack.length);return[]},this.uncover=function(t,e){var a=n.getTop(t);return!!(a.isHidden&&e&&e.equals(n.getTop(t)))&&(a.isHidden=!1,a.causeEntropy(4),!0)},this.add=function(t,e){return n.getTop(t)&&n.getTop(t).causeEntropy(3),n.stacks[t].stack=n.stacks[t].stack.concat(e.map((function(e){return n.setCardProperties(e,t)}))),e},this.setCardProperties=function(t,e){return t.source="tableau-"+e,t.causeEntropy(4),t},this.trip=function(){var t=n.stacks[Math.floor(Math.random()*n.stacks.length)],e=t&&t.stack[Math.floor(Math.random()*t.stack.length)];return e&&e.causeEntropy(4),n},this.stacks=e?(new I).generateStacks(e):[]}return Object(c.a)(t,[{key:"getTop",value:function(t){return this.stacks[t].stack[this.stacks[t].stack.length-1]}}]),t}();_.copy=function(t){var e=new _([]);return e.stacks=t.stacks.map((function(t){return{stack:S.copyAll(t.stack)}})),e};var I=function t(){var e=this;Object(s.a)(this,t),this.generateStacks=function(t){e.deck=t,e.pointer=0,e.oldpointer=e.pointer;var n=[0,1,2,3,4,5,6];return e.stacks=n.map((function(t){return e.template(t)})),n.reverse().forEach((function(t){e.generateStack(t)})),e.stacks},this.template=function(t){return{stack:[],id:t}},this.generateStack=function(t){e.pointer+=6-t+1,e.stacks[t].stack=e.deck.slice(e.oldpointer,e.pointer).map((function(e){return Object(u.a)(Object(u.a)({},e),{},{isHidden:!0,source:"tableau-"+t})})).reverse(),e.stacks[t].stack[e.stacks[t].stack.length-1]&&(e.stacks[t].stack[e.stacks[t].stack.length-1].isHidden=!1),e.oldpointer=e.pointer}},q=function t(){var e=this;Object(s.a)(this,t),this.tryPutDown=function(t){return e.canAdd(t)&&(e.add(t)||!0)},this.add=function(t){return t&&e.stack.push(e.setCardProperties(t))},this.setCardProperties=function(t){return t.source="waste",t.isHidden=!1,t.causeEntropy(1),t},this.canAdd=function(t){return t&&(!e.getTop()||!t.equals(e.getTop()))},this.popTop=function(t){return t&&t.equals(e.getTop())&&e.stack.pop()},this.recycle=function(){return e.stack.splice(0,e.stack.length)},this.getTop=function(){return e.stack[e.stack.length-1]},this.trip=function(){var t=e.stack[Math.floor(Math.random()*e.stack.length)];return t&&t.causeEntropy(4),e},this.stack=[]};q.copy=function(t){var e=new q;return e.stack=S.copyAll(t.stack),e};var F=function t(){Object(s.a)(this,t)};F.getInitialState=function(t){return{stock:new A(Object(T.a)(t.cards.slice(28))),waste:new q,foundation:new P,tableau:new _(Object(T.a)(t.cards.slice(0,28))),hand:new H,game:new D}},F.copy=function(t){return{stock:A.copy(t.stock),waste:q.copy(t.waste),foundation:P.copy(t.foundation),tableau:_.copy(t.tableau),hand:H.copy(t.hand),game:D.copy(t.game)}},F.trip=function(t){return{stock:t.stock.trip(),waste:t.waste.trip(),foundation:t.foundation.trip(),tableau:t.tableau.trip(),hand:t.hand,game:t.game}};var R=function t(e){var n=this;Object(s.a)(this,t),this.dispatchPutDown=function(t,e){n._setState((function(a){a.hand.isHoldingCard()&&n._dispatchPutDown(t,a,e)}),null,!0)},this.dispatchPickup=function(t,e){n._setState((function(a){a.hand.isHoldingCard()||n._dispatchPickup(t,a,e)}))},this._blink=function(t,e){return n.startBlink(t,10,e)},this.startBlink=function(t,e,a){t(a).blinkFor=e,a.game.registerBlink(),t(a).unblink=function(){return setTimeout((function(){return n.toggleBlink(t,0)}),100)}},this.toggleBlink=function(t,e){return n._setState((function(n){t(n).blinkFor=e,n.game.registerBlink()}))},this._setState=function(t,n){return e.setState((function(e){e.game.modified=!1;var n=F.copy(e);return t(e),e.game.modified?(e.game.pushPreviousState(n),Object(u.a)({},e)):null}),n)}},B=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){var t;Object(s.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(t=e.call.apply(e,[this].concat(c)))._dispatchPutDown=function(e,n,a){if(!n.hand.hasMoreThanOneCard()&&n.foundation.accepts(a,n.hand.currentCard())){var s=n.hand.source;n.foundation.add(a,n.hand.putDown())&&n.game.registerMove("foundation-"+a,s),t.tryDetectEnd(n)}else t.blink(a,n)},t._dispatchPickup=function(e,n,a){var s=n.foundation.getTop(a);s&&n.foundation.getPreviousUsed(a)===s.face?n.hand.pickUp([n.foundation.remove(a,s)],s.source)&&n.game.registerPickup():t.blink(a,n)},t.blink=function(e,n){return t._blink((function(t){return t.foundation.stacks[e]}),n)},t}return Object(c.a)(n,[{key:"tryDetectEnd",value:function(t){52===t.foundation.countCards()&&(t.game.isEnded=!0,t.game.end=Date.now())}}]),n}(R),U=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){var t;Object(s.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(t=e.call.apply(e,[this].concat(c)))._dispatchPutDown=function(e,n){return t.blink(e,n)},t._dispatchPickup=function(e,n){return e?t.moveToWaste(e,n):t.recycleWaste(e,n)},t.moveToWaste=function(t,e){return e.stock.isOnTop(t)&&e.waste.add(e.stock.stack.pop())&&e.game.registerMove("waste","stock")},t.recycleWaste=function(t,e){return!e.stock.getTop()&&!!e.waste.getTop()&&e.stock.recycle(e.waste.recycle())&&e.game.registerRecycle(e)},t.blink=function(e,n){return t._blink((function(t){return t.stock}),n)},t}return n}(R),L=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){var t;Object(s.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(t=e.call.apply(e,[this].concat(c)))._dispatchPutDown=function(e,n,a){if(t.canPutDown(e,n,a)){var s=n.hand.source;n.tableau.add(a,n.hand.putDown())&&n.game.registerMove("tableau-"+a,s)}else t.blink(a,n)},t.canPutDown=function(t,e,n){return t&&t.isHidden&&e.hand.isFromCurrentSource(t)||e.tableau.accepts(n,e.hand.currentCard())||!t&&e.hand.source=="tableau-"+n},t._dispatchPickup=function(e,n,a){!e||t.tryUncover(e,a,n)||e.isHidden?e||t.blink(a,n):n.hand.pickUp(n.tableau.popWithFollowing(e,a),e.source)&&n.game.registerPickup()},t.tryUncover=function(t,e,n){return!n.hand.isHoldingCard()&&t.isHidden&&n.tableau.uncover(e,t)&&n.game.registerUncover(t,n)},t.blink=function(e,n){return t._blink((function(t){return t.tableau.stacks[e]}),n)},t}return n}(R),W=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(){var t;Object(s.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(t=e.call.apply(e,[this].concat(c)))._dispatchPutDown=function(e,n){return"waste"==n.hand.source&&n.waste.tryPutDown(n.hand.currentCard())&&n.hand.putDown()&&n.game.registerMove("waste","waste")||t.blink(e,n)},t._dispatchPickup=function(e,n){return e&&n.hand.pickUp([n.waste.popTop(e)],"waste")&&n.game.registerPickup()||t.blink(e,n)},t.blink=function(e,n){return t._blink((function(t){return t.waste}),n)},t}return n}(R),X=function(){function t(){var e=this;Object(s.a)(this,t),this.getInitialState=function(){return F.getInitialState(e.deck)},this.beat=function(t){t.setState((function(t){return F.trip(t)}))},this.reset=function(t){return t.setState((function(t){return t.game.previousStates?t.game.previousStates[0]:Object(u.a)({},e.getInitialState())}))},this.undo=function(t,e,n){return e.setState((function(e){return e.game.popPreviousState(t,n)||null}))},this.trip=function(t){console.log("start tripping"),setInterval((function(){t.setState((function(t){return F.trip(t)}))}),250)},this.deck=new N,this.deck.shuffle()}return Object(c.a)(t,[{key:"getHandlers",value:function(t,e){var n=this,a="dispatchPickup";return e&&e.hand&&e.hand.isHoldingCard()&&(a="dispatchPutDown"),{clickTableau:new L(t)[a],clickFoundation:new B(t)[a],clickStock:new U(t)[a],clickWaste:new W(t)[a],undo:function(){return n.undo(e.game.previousStates.length-1,t,e)},reset:function(){return n.reset(t)},beat:function(){return n.beat(t)},trip:function(){return n.trip(t)},undoLabel:function(){return Math.pow(2,t.state.game.multiplicator)}}}}]),t}(),K=function(t){Object(i.a)(n,t);var e=Object(o.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).game=new X,a.state=a.game.getInitialState(Object(r.a)(a)),a}return Object(c.a)(n,[{key:"render",value:function(){var t=this.game.getHandlers(this,this.state);return Object(a.jsx)(C,{subscribe:this.subscribe,model:this.state,game:this.game,handlers:t})}}]),n}(l.Component),z=n(11);n.n(z).a.render(Object(a.jsx)(d.a.StrictMode,{children:Object(a.jsx)(K,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.e3ccfa23.chunk.js.map