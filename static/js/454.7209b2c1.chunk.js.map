{"version":3,"file":"static/js/454.7209b2c1.chunk.js","mappings":"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","sources":["View/Context/GameContext.tsx","View/GlobalContext.ts","View/Context/PauseContext.tsx","View/Game/Actors/AutoDealer.tsx","Model/Business/Blinker.ts","Model/Business/Tableau.ts","Model/Business/Dealer.ts","Model/Business/Dispatcher.ts","Model/Game/Focus.ts","Model/Game/Stack.ts","Model/Game/HandHoldingStack.ts","Model/Game/FoundationStack.tsx","Model/Game/MultiStack.ts","Model/Game/Foundation.ts","Model/Business/Foundation.ts","Model/Game/Rating.ts","Model/Game/TimeMachine.ts","Model/Game/Game.ts","Model/Game/Hand.ts","Model/Business/Navigator.ts","Model/Game/Settings.ts","Model/Game/Stock.ts","Model/Business/Stock.ts","Model/Business/Waste.ts","Model/Business/Suggestions.ts","Model/Game/TableauStack.tsx","Model/Game/Tableau.ts","Model/Game/Waste.ts","Model/Model.ts","View/Game/Actors/AutoSolver.tsx","View/useGlobalTokenEffect.ts","View/Game/Actors/AutoUncoverer.tsx","View/Context/BoardContext.ts","View/Game/Navigation/BoardGamePad.tsx","View/Game/Navigation/BoardKeyboard.tsx","View/Game/Navigation/BoardNavigator.tsx","View/Game/Actors/Dealer.tsx","View/UI/PossibleFailScreen.tsx","View/Game/Actors/FailDetector.tsx","View/Game/Actors/WinDetector.tsx","View/Game/Actors/Actors.tsx","common/DndPreview.tsx","View/Game/Firework.tsx","View/Game/CardFirework.tsx","View/Game/Card.tsx","View/Game/StackBase.tsx","View/Game/Hooks/useBlinkEffect.ts","View/Game/Hooks/useStackDrop.ts","View/Game/Foundation.tsx","View/UI/Header/Clock.tsx","View/UI/Header/Hearts.tsx","View/UI/Header/Hint.tsx","View/UI/Header/Points.tsx","View/UI/Header/ToggleMenu.tsx","View/UI/Header/Undo.tsx","View/UI/Header/Header.tsx","View/UI/Menu.tsx","View/Game/Stock.tsx","View/Game/Tableau.tsx","View/Game/Waste.tsx","View/Game/Board.tsx","View/UI/EndScreen.js","View/Game/BoardWrap.tsx","View/Game/Game.tsx"],"sourcesContent":["import React from \"react\";\n\nexport interface IGameState {\n    started: number;\n    isEnded: boolean;\n    end: number;\n    winner: number;\n    loser: number;\n}\n\nexport interface IGameContext {\n    gameState: IGameState;\n    win: (player: number) => void;\n    giveUp: (player: number) => void;\n    start: () => void;\n}\n\nexport const defaultGameState = {\n    started: 0,\n    isEnded: false,\n    end: 0,\n    winner: -1,\n    loser: -1,\n};\n\nconst GameContext = React.createContext<IGameContext>({\n    gameState: defaultGameState,\n    win: () => {},\n    start: () => {},\n    giveUp: () => {},\n});\n\nconst useGameContext = () => React.useContext(GameContext);\n\nexport default useGameContext;\n\nexport const GameContextProvider = (props: { children: React.ReactNode }) => {\n    const [gameState, setGameState] = React.useState<IGameState>(defaultGameState);\n    const context = {\n        gameState,\n        win: (player: number) => setGameState({ ...gameState, end: Date.now(), isEnded: true, winner: player }),\n        start: () => setGameState({ ...gameState, started: Date.now() }),\n        giveUp: (player: number) => {\n            // @todo if one user gives up, the other should be allowed to continue to increase points\n            // - this motivates users to employ the undo function to keep trying\n            // @todo show dialog informaing that other user gave up as well\n            // - options: give up + continue\n            // @todo track \"givenUp\" status per player\n            // - winner is always the player with more points\n            setGameState({ ...gameState, end: Date.now(), isEnded: true, loser: player });\n        },\n    };\n    return <GameContext.Provider value={context}>{props.children}</GameContext.Provider>;\n};\n","import { StateReplaceFunction, StateUpdateFunction } from \"../Common\";\n\nimport Model from \"../Model/Model\";\nimport React from \"react\";\n\ninterface IGlobalContext {\n    state: Model | null;\n    replaceContext: StateReplaceFunction;\n    updateContext: StateUpdateFunction;\n    updateGameContext: StateUpdateFunction;\n    restart: () => void;\n}\n\ninterface XGlobalContext {\n    state: Model;\n    replaceContext: StateReplaceFunction;\n    updateContext: StateUpdateFunction;\n    updateGameContext: StateUpdateFunction;\n    restart: () => void;\n}\n\nconst useGlobalContext: () => XGlobalContext = () => {\n    const ctx = React.useContext(GlobalContext);\n    if (!ctx.state) {\n        throw new Error(\"no state present\");\n    }\n    return { ...ctx, state: ctx.state };\n};\n\nconst defaultValue = {\n    state: null,\n    replaceContext: () => {},\n    updateContext: () => {},\n    updateGameContext: () => {},\n    restart: () => {},\n};\n\nconst GlobalContext = React.createContext<IGlobalContext>(defaultValue);\n\nexport const Provider = GlobalContext.Provider;\n\nexport default useGlobalContext;\n","import React from \"react\";\nimport useGameContext from \"./GameContext\";\n\nexport interface IPauseState {\n    //started: number;\n    end: number;\n    paused: boolean;\n    pauses: number[];\n    pauseStartedAt: number;\n    allowed: number;\n    isSilent?: boolean;\n    pausedBy: number;\n    showMenu: boolean;\n    showCards: boolean;\n}\nexport interface IPauseContext {\n    state: IPauseState;\n    togglePause: (isPaused: boolean, pausedBy: number) => void;\n    toggleMenu: (show: boolean) => void;\n    getElapsed: () => string;\n}\nexport const defaultPauseState: IPauseState = {\n    end: 0,\n    paused: false,\n    pauses: [],\n    pauseStartedAt: 0,\n    allowed: 5,\n    pausedBy: -1,\n    showMenu: false,\n    showCards: true,\n};\nexport const defaultPauseContext = {\n    state: defaultPauseState,\n    togglePause: () => {},\n    toggleMenu: () => {},\n    getElapsed: () => \"\",\n};\n\nconst PauseContext = React.createContext<IPauseContext>(defaultPauseContext);\n\nexport const PauseProvider = (props: { children: React.ReactNode }) => {\n    const { gameState } = useGameContext();\n    const [paused, setPaused] = React.useState<IPauseState>({ ...defaultPauseState });\n    const getElapsedMs = () => {\n        const pauses = paused.pauses.reduce((a, b) => a + b, 0);\n        return (paused.end || paused.pauseStartedAt || Date.now()) - gameState.started - pauses;\n    };\n\n    const getElapsed = () => {\n        const padleft = (i: number) => ((i + \"\").length === 1 ? \"0\" + i : i);\n        let msec = getElapsedMs();\n        const hh = Math.floor(msec / 1000 / 60 / 60);\n        msec -= hh * 1000 * 60 * 60;\n        const mm = Math.floor(msec / 1000 / 60);\n        msec -= mm * 1000 * 60;\n        const ss = Math.floor(msec / 1000);\n        msec -= ss * 1000;\n        return hh ? hh + \":\" + padleft(mm) + \":\" + padleft(ss) : padleft(mm) + \":\" + padleft(ss);\n    };\n    const togglePause = (isPaused: boolean, pausedBy: number) => {\n        if (paused.showMenu) {\n            setPaused({\n                ...paused,\n                pausedBy: pausedBy,\n                pauses: [...paused.pauses, Date.now() - paused.pauseStartedAt],\n                pauseStartedAt: 0,\n                paused: false,\n                showMenu: false,\n                showCards: true,\n            });\n        } else if (paused.pauses.length < paused.allowed) {\n            setPaused({\n                ...paused,\n                pausedBy: pausedBy,\n                pauseStartedAt: Date.now(),\n                paused: true,\n                showMenu: true,\n                showCards: false,\n            });\n        } else {\n            setPaused({\n                ...paused,\n                pausedBy: pausedBy,\n                pauseStartedAt: 0,\n                paused: false,\n                showMenu: true,\n                showCards: false,\n            });\n        }\n    };\n    const toggleMenu = (show: boolean) => {\n        setPaused({\n            ...paused,\n            showMenu: show,\n            showCards: true,\n        });\n    };\n    const context = {\n        state: { ...paused, started: gameState.started },\n        togglePause,\n        toggleMenu,\n        getElapsed,\n    };\n\n    return <PauseContext.Provider value={context}>{props.children}</PauseContext.Provider>;\n};\n\nconst usePauseContext = () => React.useContext(PauseContext);\n\nexport default usePauseContext;\n","import React from \"react\";\nimport useGameContext from \"../../Context/GameContext\";\nimport useGlobalContext from \"../../GlobalContext\";\nimport usePauseContext from \"../../Context/PauseContext\";\nimport { usePrevious } from \"react-use\";\n\nconst AutoDealerRenderer = (props: { length: number; paused: boolean; started: number }) => {\n    const context = useGlobalContext();\n    const { length, started, paused } = props;\n    const previous = usePrevious({ length, paused, started });\n    React.useEffect(() => {\n        let timeout: NodeJS.Timeout | null = null;\n        if (\n            context.state.settings.launchSettings.speed &&\n            started &&\n            !paused &&\n            previous &&\n            (previous?.length !== length || previous?.started !== started || previous?.paused !== paused)\n        ) {\n            timeout = setTimeout(() => {\n                context.updateContext((state) => {\n                    if (\n                        length === state.stock.stack.length &&\n                        state.stock.passes > 0 &&\n                        (state.stock.stack.length || state.waste.stack.length)\n                    ) {\n                        if (state.hand.isFromWaste()) {\n                            state.waste.putDownHand();\n                        }\n                        if (state.stock.stack.length) {\n                            state.waste.addAll(state.stock.popTop());\n                        } else if (state.stock.canRecycle()) {\n                            state.stock.recycle(state.waste.recycle());\n                        }\n                    }\n                });\n            }, 10000);\n        }\n        return () => {\n            timeout && clearTimeout(timeout);\n        };\n    }, [context, length, paused, previous, started]);\n\n    return null;\n};\n\nconst AutoDealer = () => {\n    const { state } = useGlobalContext();\n    const pause = usePauseContext();\n    const { gameState } = useGameContext();\n    const { paused } = pause.state;\n    return <AutoDealerRenderer length={state.stock.stack.length} paused={paused} started={gameState.started} />;\n};\n\nexport default AutoDealer;\n","import Model from \"../Model\";\nimport Stock from \"../Game/Stock\";\nimport Waste from \"../Game/Waste\";\n\nexport type BlinkSelector = (state: Model) => Waste | Stock | any;\n\nexport interface IBlinker {\n    startBlink: (selector: BlinkSelector, state: Model) => void;\n}\n\nexport default class Blinker implements IBlinker {\n    startBlink = (selector: BlinkSelector, state: Model) => {\n        if (selector(state).blinkFor < 10) {\n            selector(state).blinkFor = 10;\n            state.game.registerBlink(true);\n            selector(state).unblink = (s: Model) => this.stopBlink(selector, s);\n        }\n    };\n\n    stopBlink = (selector: BlinkSelector, state: Model) => {\n        selector(state).blinkFor = 0;\n        state.game.registerBlink(false);\n    };\n}\n","import { BlinkFunction, ClickHandler } from \"../../Common\";\n\nimport Blinker from \"./Blinker\";\nimport Card from \"../Deck/Card\";\nimport Model from \"../Model\";\n\nexport default class Tableau implements ClickHandler {\n    blink: BlinkFunction = (state, index) => new Blinker().startBlink((s: Model) => s.tableau.stacks[index], state);\n\n    dispatchPutDown = (card: Card, position: any, state: Model, index: number) => {\n        if (state.tableau.wouldAcceptHand(index)) {\n            const src = state.hand.source;\n            state.tableau.putDownHand(index) && state.game.registerMove(\"tableau-\" + index, src, state.tableau.getTop(index));\n        } else {\n            this.blink(state, index);\n        }\n    };\n\n    dispatchPickup = (card: Card | null, position: any, state: Model, index: number) => {\n        if (card) {\n            state.hand.pickUp(state.tableau.popWithFollowing(card, index), card.source, position) && state.game.registerPickup();\n        } else if (!card) {\n            this.blink(state, index);\n        }\n    };\n}\n\nexport class TableauHidden extends Tableau {\n    dispatchPickup = (card: Card | null, position: any, state: Model, index: number) => {\n        if (card) {\n            this.tryUncover(card, index, state);\n        }\n    };\n\n    tryUncover = (card: Card, index: number, state: Model) =>\n        !state.hand.isHoldingCard() && card.isHidden && state.tableau.uncover(index, card) && state.game.registerUncover(state.tableau.getTop(index));\n}\n","import Model from \"../Model\";\nimport Stock from \"../Game/Stock\";\nimport Tableau from \"../Game/Tableau\";\n\nexport default class Dealer {\n    dealt: number;\n    dealingAt: number;\n    isDealt: boolean;\n\n    constructor() {\n        this.dealt = 0;\n        this.dealingAt = 0;\n        this.isDealt = false;\n    }\n\n    dealOne = (dealt: number, callback: (n: number) => void) => (state: Model) => {\n        if (dealt !== state.dealer.dealt) {\n            return null;\n        }\n\n        state.dealer.deal(state.stock, state.tableau);\n\n        if (!state.dealer.isDealt) {\n            callback(state.dealer.dealt);\n        }\n\n        return state;\n    };\n\n    dealAll = () => (state: Model) => {\n        if (this.dealt !== state.dealer.dealt) {\n            return null;\n        }\n        while (!state.dealer.isDealt) {\n            state.dealer.deal(state.stock, state.tableau);\n        }\n        return state;\n    };\n\n    deal = (stock: Stock, tableau: Tableau) => {\n        for (let i = this.dealingAt; i < tableau.stacks.length; i++) {\n            const stack = tableau.stacks[i].stack;\n            if (stack.length <= tableau.stacks.length - i - 1) {\n                const newCard = stock.popOne();\n                if (newCard) {\n                    newCard.source = tableau.stacks[i].source;\n                    if (stack.length === tableau.stacks.length - 1 - i) {\n                        newCard.isHidden = false;\n                    }\n                    tableau.deal(newCard, i);\n                    this.dealt++;\n                    this.dealingAt++;\n                    if (this.dealingAt === tableau.stacks.length) {\n                        this.dealingAt = 0;\n                    }\n                    this.isDealt = false;\n                }\n                return;\n            } else {\n                const isFirst = this.dealingAt === 0;\n                this.dealingAt = 0;\n                this.isDealt = isFirst;\n                return;\n            }\n        }\n\n        this.isDealt = true;\n    };\n}\n","import Card from \"../Deck/Card\";\nimport { ClickHandler } from \"../../Common\";\nimport Hand from \"../Game/Hand\";\nimport Model from \"../Model\";\n\nexport default class Dispatcher {\n    clickHandler: ClickHandler;\n\n    constructor(clickHandler: ClickHandler) {\n        this.clickHandler = clickHandler;\n    }\n\n    getHandler = (hand: Hand) => {\n        if (hand && hand.isHoldingCard()) {\n            return this.dispatchPutDown;\n        } else {\n            return this.dispatchPickup;\n        }\n    };\n\n    dispatchPutDown = (card: Card, position: any, index: number) => (state: Model) => {\n        if (state.hand.isHoldingCard()) {\n            this.clickHandler.dispatchPutDown(card, position, state, index);\n        }\n    };\n\n    dispatchPickup = (card: Card, position: any, index: number) => (state: Model) => {\n        if (!state.hand.isHoldingCard()) {\n            this.clickHandler.dispatchPickup(card, position, state, index);\n        }\n    };\n}\n","import Card from \"../Deck/Card\";\nimport Settings from \"./Settings\";\n\nexport default class Focus {\n    settings: Settings;\n    card: Card | null;\n    stack: string;\n    keyboard: boolean;\n    player: number;\n    constructor(settings: Settings, player: number) {\n        this.settings = settings;\n        this.card = null;\n        this.stack = \"\";\n        this.keyboard = false;\n        this.player = player;\n    }\n\n    validSettings = () => this.settings.launchSettings.players[this.player].inputMethod !== \"mouse\";\n\n    isKeyBoard = (isKeyboard: boolean) => {\n        this.keyboard = isKeyboard;\n    };\n\n    setCard = (card: Card) => {\n        this.card = card;\n        this.stack = \"\";\n    };\n\n    unsetCard = (card: Card) => {\n        if (this.card && card && Card.equals(this.card, card)) {\n            this.card = null;\n        }\n    };\n\n    unsetStack = (stack: string) => {\n        if (this.stack && stack && this.stack === stack) {\n            this.stack = \"\";\n        }\n    };\n\n    setStack = (stack: string) => {\n        this.card = null;\n        this.stack = stack;\n    };\n\n    hasCard = (card: Card) => this.keyboard && this.validSettings() && Card.equals(this.card, card);\n\n    hasStack = (stack: string) => this.keyboard && this.validSettings() && this.stack && stack && this.stack === stack;\n}\n","import Card from \"../Deck/Card\";\nimport Model from \"../Model\";\n\nexport interface IStack {\n    source: string;\n    stack: Card[];\n    getTop: () => Card | null;\n    getClickable: () => Card[];\n    clickEmpty: (p: any) => (s: Model) => void;\n    blinkFor: number;\n    unblink: (model: Model) => void;\n    suggestion: boolean;\n    accepts: (card: Card | null) => boolean;\n}\n\nabstract class BasicStack implements IStack {\n    source: string;\n    constructor(source: string) {\n        this.source = source;\n    }\n    suggestion = false;\n    stack: Card[] = [];\n    getTop: () => Card | null = () => (this.stack && this.stack.length && this.stack[this.stack.length - 1]) || null;\n    getClickable = () => this.stack.filter((card) => card.canClick());\n    blinkFor = 0;\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    onClick = (a: any) => (s: Model) => {};\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    clickEmpty = (a: any) => (s: Model) => {};\n    unblink: (model: Model) => void = () => {};\n    abstract accepts: (card: Card | null) => boolean;\n}\nexport default BasicStack;\n","import BasicStack from \"./Stack\";\nimport Hand from \"./Hand\";\n\nabstract class HandHoldingStack extends BasicStack {\n    hand: Hand;\n    constructor(source: string, hand: Hand) {\n        super(source);\n        this.hand = hand;\n    }\n    getHandContent = () => (this.hand.source === this.source ? this.hand.stack : []);\n    getClickable = () => [...this.stack.filter((card) => card.canClick()), ...this.getHandContent().filter((card) => card.canClick())];\n}\n\nexport default HandHoldingStack;\n","import Card from \"../Deck/Card\";\nimport Hand from \"./Hand\";\nimport HandHoldingStack from \"./HandHoldingStack\";\nimport Model from \"../Model\";\nimport { Suit } from \"../Deck/Suits\";\nimport { getFoundationOrder } from \"../Deck/DeckSize\";\n\nexport default class FoundationStack extends HandHoldingStack {\n    constructor(source: string, hand: Hand, suit: Suit) {\n        super(source, hand);\n        this.acceptedCards = [...getFoundationOrder()];\n        this.usedCards = [];\n        this.icon = suit.icon;\n        this.color = suit.color;\n    }\n    acceptedCards: string[] = [];\n    usedCards: any[] = [];\n    icon = \"\";\n    color = \"\";\n    getCurrentAccepted = () => {\n        return this.acceptedCards[this.acceptedCards.length - 1];\n    };\n    accepts = (card: Card | null) => {\n        if (!card) return false;\n        const currentAccepted = this.getCurrentAccepted();\n        return this.icon === card.type.icon && currentAccepted === card.denomination;\n    };\n    setOnClick = (onClick: (c: any, p: any) => (s: Model) => void, hand: Hand) => {\n        this.clickEmpty = (p) => onClick(null, p);\n        const cards = this.source === hand.source ? [...this.stack, ...hand.stack] : this.stack;\n        cards.forEach((card, sindex) => {\n            card.onClick = (p: any) => onClick({ ...card }, p);\n            card.canClick = () => sindex === cards.length - 1;\n        });\n        this.hand.setOnClick(this);\n    };\n}\n","import Hand from \"./Hand\";\nimport HandHoldingStack from \"./HandHoldingStack\";\nimport Settings from \"./Settings\";\n\nexport default class MultiStack<T extends HandHoldingStack> {\n    stacks: T[];\n    settings: Settings;\n    hand: Hand;\n    constructor(settings: Settings, hand: Hand, stacks: T[]) {\n        this.stacks = stacks;\n        this.settings = settings;\n        this.hand = hand;\n    }\n}\n","import Card from \"../Deck/Card\";\nimport FoundationStack from \"./FoundationStack\";\nimport Hand from \"./Hand\";\nimport Model from \"../Model\";\nimport MultiStack from \"./MultiStack\";\nimport Settings from \"./Settings\";\nimport Suits from \"../Deck/Suits\";\n\nexport default class Foundation extends MultiStack<FoundationStack> {\n    constructor(settings: Settings, hand: Hand) {\n        super(settings, hand, [\n            ...Object.keys(Suits)\n                .map((key: string) => Suits[key])\n                .map((suit, index) => new FoundationStack(\"foundation-\" + index, hand, suit)),\n        ]);\n    }\n\n    setOnClick = (onClick: (c: Card, p: any, index: number) => (s: Model) => void) => {\n        this.stacks.forEach((stack, index) => {\n            stack.setOnClick((c: Card, p: any) => onClick(c, p, index), this.hand);\n        });\n    };\n\n    getCurrentAccepted = (index: number) => {\n        return this.stacks[index].getCurrentAccepted();\n    };\n\n    wouldAcceptHand = (index: number) => !this.hand.hasMoreThanOneCard() && this.accepts(index, this.hand.currentCard());\n\n    putDownHand = (index: number) => this.add(index, this.hand.putDown());\n\n    accepts = (index: number, card: Card | null) => {\n        return this.stacks[index].accepts(card);\n    };\n\n    add = (index: number, cards: Card[]) => {\n        const card = cards[0];\n        card.causeEntropy(Math.min(this.settings.interactionEntropy, 3));\n        card.source = this.stacks[index].source;\n        this.stacks[index].stack.push(card);\n        return this.stacks[index].usedCards.push(this.stacks[index].acceptedCards.pop());\n    };\n\n    remove = (index: number, card: Card) => {\n        this.stacks[index].acceptedCards.push(this.stacks[index].usedCards.pop());\n        return (card && card.equals(this.getTop(index)) && this.stacks[index].stack.pop()) || null;\n    };\n\n    getPreviousUsed = (index: number) => [...this.stacks[index].usedCards].pop();\n\n    countCards = () => this.stacks.map((f) => f.stack.length).reduce((a, b) => a + b, 0);\n\n    getTop = (index: number) => this.stacks[index].stack[this.stacks[index].stack.length - 1];\n\n    static copy = (orig: Foundation, hand: Hand) => {\n        const copy = new Foundation(orig.settings, hand);\n        copy.stacks = orig.stacks.map((origStack) => {\n            const s = new FoundationStack(origStack.source, hand, origStack);\n            s.stack = Card.copyAll(origStack.stack);\n            s.acceptedCards = [...origStack.acceptedCards];\n            s.usedCards = [...origStack.usedCards];\n            s.icon = origStack.icon;\n            s.color = origStack.color;\n            return s;\n        });\n        return copy;\n    };\n\n    setEntropy = (lvl: number) => {\n        this.stacks.forEach((stack) => stack.stack.forEach((element) => element.causeEntropy(Math.min(3, lvl))));\n        return this;\n    };\n}\n","import { BlinkFunction, ClickHandler } from \"../../Common\";\n\nimport Blinker from \"./Blinker\";\nimport Card from \"../Deck/Card\";\nimport Model from \"../Model\";\n\nexport default class Foundation implements ClickHandler {\n    blink: BlinkFunction = (state, index) => new Blinker().startBlink((s: Model) => s.foundation.stacks[index], state);\n\n    dispatchPutDown = (card: Card, position: any, state: Model, index: number) => {\n        if (state.foundation.wouldAcceptHand(index)) {\n            const src = state.hand.source;\n            state.foundation.putDownHand(index) && state.game.registerMove(\"foundation-\" + index, src, state.foundation.getTop(index));\n        } else {\n            this.blink(state, index);\n        }\n    };\n\n    dispatchPickup = (_card: Card | null, position: any, state: Model, index: number) => {\n        const card = state.foundation.getTop(index);\n        if (card && state.foundation.getPreviousUsed(index) === card.denomination) {\n            state.hand.pickUp([state.foundation.remove(index, card)], card.source, position) && state.game.registerPickup();\n        } else {\n            this.blink(state, index);\n        }\n    };\n}\n","import Card from \"../Deck/Card\";\nimport Settings from \"./Settings\";\n\nexport interface AppliedRating {\n    points: number;\n    text: string;\n}\n\nexport interface AppliedRatingWithId extends AppliedRating {\n    id: number;\n}\n\nexport default class Rating {\n    settings: Settings;\n    points: number;\n    multiplicator: number;\n    ratings: AppliedRating[];\n    constructor(settings: Settings) {\n        this.settings = settings;\n        this.points = 0;\n        this.multiplicator = 1;\n        this.ratings = [];\n    }\n\n    applyRating = (points: number, text: string) => {\n        console.debug(\"RATING:\", text);\n        this.ratings.push({ points, text });\n    };\n\n    registerMove = (target: string, source: string, card: Card | null) => {\n        this.registerHint(this.settings.disableHint());\n        const currentMove = {\n            source: source,\n            target: target,\n        };\n        this.points += this.rateMove(currentMove, card);\n    };\n\n    registerRecycle = () => {\n        this.registerHint(this.settings.disableHint());\n        if (this.settings.launchSettings.drawMode === \"single\" && this.settings.launchSettings.recyclingMode === \"infinite\") {\n            if (this.points > 0) {\n                let diff = 0;\n                if (this.points < 100) {\n                    diff = this.points * -1;\n                    this.points = 0;\n                } else {\n                    this.points -= 100;\n                    diff = -100;\n                }\n                this.applyRating(diff, `subtract ${diff} (max 100 points) for RECYCLE`);\n            }\n        }\n    };\n\n    registerUncover = (card: Card | null) => {\n        this.registerHint(this.settings.disableHint());\n        card && card.setSuccess(5);\n        this.points += 5;\n        this.applyRating(5, \"add 5 points for UNCOVER\");\n    };\n\n    registerBlink(on: boolean) {\n        if (on && this.settings.launchSettings.missPenalty) {\n            this.points -= 10;\n            this.applyRating(-10, \"subtract 10 points for invalid action\");\n        }\n    }\n\n    penalize = (other: Rating) => {\n        if (this.settings.launchSettings.undoPenalty) {\n            const penalty = Math.pow(2, other.multiplicator);\n            this.applyRating(penalty * -1, `applying penalty of ${penalty} points for UNDO`);\n            this.points = Math.min(this.points, other.points) - penalty;\n            this.multiplicator = other.multiplicator + 1;\n        }\n    };\n\n    registerHint = (done: boolean) => {\n        if (done && this.settings.launchSettings.hintPenalty) {\n            this.points -= 10;\n            this.applyRating(-10, `applying penalty of 10 points for HINT`);\n        }\n    };\n\n    rateMove(move: { source: string; target: string }, card: Card | null) {\n        const isTableau = (obj: string) => obj.substr(0, 7) === \"tableau\";\n        const isFoundation = (obj: string) => obj.substr(0, 10) === \"foundation\";\n        if (isTableau(move.source)) {\n            if (isFoundation(move.target)) {\n                this.applyRating(10, \"add 10 points for MOVE tableau -> foundation\");\n                card && card.setSuccess(10);\n                return 10;\n            }\n        } else if (move.source === \"waste\") {\n            if (isFoundation(move.target)) {\n                this.applyRating(10, \"add 10 points for MOVE waste -> foundation\");\n                card && card.setSuccess(10);\n                return 10;\n            }\n            if (isTableau(move.target)) {\n                this.applyRating(5, \"add 5 points for MOVE waste -> tableau\");\n                card && card.setSuccess(5);\n                return 5;\n            }\n        } else if (isFoundation(move.source)) {\n            if (isTableau(move.target)) {\n                this.applyRating(-15, \"subtract 15 points for MOVE foundation -> tableau\");\n                return -15;\n            }\n        }\n\n        return 0;\n    }\n\n    getTimePenalty = (start: number, end: number) => {\n        const secondsToFinish = (end - start) / 1000;\n        return Math.trunc(secondsToFinish / 5) * -2;\n    };\n\n    getBonusPoints = (start: number, end: number) => {\n        const secondsToFinish = (end - start) / 1000;\n        if (secondsToFinish < 30) {\n            return 0;\n        }\n        return Math.round((20000 / secondsToFinish) * 35);\n    };\n\n    getTotal = (start: number, end: number) => {\n        return this.points + this.getBonusPoints(start, end) - this.getTimePenalty(start, end);\n    };\n\n    static copy = (orig: Rating) => {\n        const copy = new Rating(orig.settings);\n        copy.points = orig.points;\n        copy.multiplicator = orig.multiplicator;\n        copy.ratings = [...orig.ratings];\n        return copy;\n    };\n}\n","import Card from \"../Deck/Card\";\nimport { IStack } from \"./Stack\";\nimport Model from \"../Model\";\n\nexport default class TimeMachine {\n    previousStates: Model[];\n    memorable: boolean;\n    modified: boolean;\n    constructor() {\n        this.previousStates = [];\n        this.memorable = true;\n        this.modified = false;\n    }\n\n    registerMove = (target: string, source: string) => {\n        this.memorable = true;\n        this.modified = true;\n\n        if (source === target) {\n            this.memorable = false;\n        }\n    };\n\n    pushPreviousState = (state: Model) => {\n        const previous = this.previousStates[this.previousStates.length - 1];\n        if (!previous || !this.modelEquals(state, previous)) {\n            this.previousStates.push(state);\n        }\n    };\n\n    registerPickup = () => {\n        this.modified = true;\n        this.memorable = false;\n    };\n\n    popPreviousState = (id: number, current: Model) => {\n        const isRequested = this.previousStates.length - 1 === id;\n        const popPrevious = () => isRequested && this.previousStates && this.previousStates.pop();\n        let previous = popPrevious();\n        while (previous && (!previous.game.timemachine.memorable || this.modelEquals(previous, current)) && this.previousStates.length) {\n            previous = popPrevious();\n        }\n        return previous;\n    };\n\n    registerRecycle = () => {\n        this.memorable = true;\n        this.modified = true;\n    };\n\n    registerUncover = () => {\n        this.memorable = true;\n        this.modified = true;\n        return true;\n    };\n\n    registerBlink(on: boolean) {\n        if (on) {\n            this.modified = true;\n            this.memorable = false;\n        }\n    }\n\n    stackEquals = (a: IStack, b: IStack) => {\n        return a.stack.every((card, i) => Card.equals(card, b.stack[i]) && card.isHidden === b.stack[i].isHidden);\n    };\n\n    stacksEqual = (a: { stacks: IStack[] }, b: { stacks: IStack[] }) => {\n        return a.stacks.every((stack, i) => this.stackEquals(stack, b.stacks[i]));\n    };\n\n    modelEquals = (a: Model, b: Model) => {\n        return (\n            this.stackEquals(a.stock, b.stock) &&\n            this.stackEquals(a.waste, b.waste) &&\n            this.stacksEqual(a.tableau, b.tableau) &&\n            this.stacksEqual(a.foundation, b.foundation)\n        );\n    };\n\n    static copy = (orig: TimeMachine) => {\n        const copy = new TimeMachine();\n        copy.previousStates = [...orig.previousStates];\n        copy.memorable = orig.memorable;\n        copy.modified = orig.modified;\n        return copy;\n    };\n}\n","import Card from \"../Deck/Card\";\nimport Rating from \"./Rating\";\nimport Settings from \"./Settings\";\nimport TimeMachine from \"./TimeMachine\";\n\nexport default class Game {\n    settings: Settings;\n    rating: Rating;\n    timemachine: TimeMachine;\n    constructor(settings: Settings) {\n        this.settings = settings;\n        this.rating = new Rating(settings);\n        this.timemachine = new TimeMachine();\n    }\n\n    registerMove = (target: string, source: string, card: Card | null) => {\n        this.rating.registerMove(target, source, card);\n        this.timemachine.registerMove(target, source);\n        return true;\n    };\n\n    registerPickup = () => {\n        this.timemachine.registerPickup();\n        return true;\n    };\n\n    registerRecycle = () => {\n        this.rating.registerRecycle();\n        this.timemachine.registerRecycle();\n        return true;\n    };\n\n    registerUncover = (card: Card | null) => {\n        this.rating.registerUncover(card);\n        this.timemachine.registerUncover();\n        return true;\n    };\n\n    registerBlink(on: boolean) {\n        this.rating.registerBlink(on);\n        this.timemachine.registerBlink(on);\n        return true;\n    }\n\n    static copy = (orig: Game) => {\n        const copy = new Game(orig.settings);\n        copy.timemachine = TimeMachine.copy(orig.timemachine);\n        copy.rating = Rating.copy(orig.rating);\n        return copy;\n    };\n}\n","import Card from \"../Deck/Card\";\nimport { IStack } from \"./Stack\";\nimport { XY } from \"../../View/UI/XY\";\n\nexport default class Hand {\n    stack: Card[];\n    source: string;\n    position: XY | null;\n    constructor() {\n        this.stack = [];\n        this.source = \"\";\n        this.position = null;\n    }\n\n    filter: (stack: any[]) => Card[] = (stack) => {\n        return stack.filter((c) => c);\n    };\n\n    pickUp = (stack: (Card | null)[], source: string, position: XY) => {\n        if (stack && stack[0]) {\n            this.stack = this.filter(stack).map((c) => {\n                c.suggestion = false;\n                return c;\n            });\n            this.source = source;\n            this.position = position;\n        }\n\n        return stack;\n    };\n\n    putDown = () => {\n        this.source = \"\";\n        const result = this.stack.splice(0, this.stack.length);\n        return result;\n    };\n\n    setOnClick = (model: IStack) => {\n        if (this.source && this.source === model.source) {\n            let _onClick = model.clickEmpty;\n            if (model.stack.length) {\n                _onClick = model.stack[model.stack.length - 1].onClick;\n            }\n            this.stack.forEach((card) => {\n                card.onClick = _onClick;\n                card.canClick = () => true;\n            });\n        }\n    };\n\n    isHoldingCard = () => !!this.stack.length;\n\n    isHoldingKing = () => this.isHoldingCard() && this.currentCard() && this.currentCard()?.denomination === \"K\";\n\n    currentCard: () => Card | null = () => (this.isHoldingCard() && this.stack[0]) || null;\n\n    hasMoreThanOneCard = () => this.stack.length > 1;\n\n    isFromCurrentSource = (card: Card) => (this.source && card.source === this.source) || null;\n\n    isFromWaste = () => (this.source && this.source === \"waste\") || false;\n\n    isFromFoundation = (index: number) => this.source && this.source === `foundation-${index}`;\n\n    isFromTableau = (index: number) => this.source && this.source === `tableau-${index}`;\n\n    isFromAnyTableau = () => this.source && this.source.substring(0, 8) === \"tableau-\";\n\n    getTableauIndex: () => number = () => (this.source && parseInt(this.source.substring(8))) || 0;\n\n    static copy = (orig: Hand) => {\n        const copy = new Hand();\n        copy.stack = Card.copyAll(orig.stack);\n        copy.source = orig.source;\n        copy.position = orig.position;\n        return copy;\n    };\n}\n","import Card from \"../Deck/Card\";\nimport { IStack } from \"../Game/Stack\";\nimport Model from \"../Model\";\n\ninterface NavIndex {\n    x: number;\n    y: number;\n    z: number;\n}\n\nexport default class Navigator {\n    model: Model;\n    currentIndex: NavIndex;\n    rows: (IStack | undefined)[][];\n    constructor(model: Model) {\n        this.model = model;\n        this.currentIndex = { x: 0, y: 0, z: 0 };\n        this.rows = [[this.model.stock, this.model.waste, undefined, ...this.model.foundation.stacks], [...this.model.tableau.stacks]];\n    }\n\n    getZindex = (elem: IStack, card: Card) => {\n        const targets = elem.getClickable();\n        for (let i = 0; i < targets.length; i++) {\n            if (Card.equals(card, targets[i])) {\n                return i;\n            }\n        }\n        return 0;\n    };\n\n    update = (pos: string, card: Card) => {\n        for (let i = 0; i < this.rows.length; i++) {\n            const row = this.rows[i];\n            for (let j = 0; j < row.length; j++) {\n                const elem = row[j];\n                if (elem && elem.source === pos) {\n                    const zIndex = this.getZindex(elem, card);\n                    this.currentIndex = { x: j, y: i, z: zIndex };\n                    this.finishNav();\n                    return;\n                }\n            }\n        }\n    };\n\n    valid = (pos: NavIndex) => pos.x === this.currentIndex.x && pos.y === this.currentIndex.y && pos.z === this.currentIndex.z;\n\n    moveLeft = (pos: NavIndex) =>\n        this.move(pos, () => {\n            this.currentIndex.x--;\n            if (this.currentIndex.x === -1) {\n                this.currentIndex.x = 6;\n            }\n        });\n\n    moveRight = (pos: NavIndex) =>\n        this.move(pos, () => {\n            this.currentIndex.x++;\n            if (this.currentIndex.x === 7) {\n                this.currentIndex.x = 0;\n            }\n        });\n\n    move = (pos: NavIndex, direction: () => void) => {\n        if (!this.valid(pos)) {\n            return;\n        }\n        direction();\n        const current = this.current();\n        if (!current) {\n            this.move(this.currentIndex, direction);\n        } else {\n            this.currentIndex.z = current.getClickable().length - 1;\n            this.finishNav();\n        }\n    };\n\n    moveUp = (pos: NavIndex) => {\n        if (!this.valid(pos)) {\n            return;\n        }\n        const clickable = this.current()?.getClickable();\n        if (clickable && clickable.length && this.currentIndex.z > 0) {\n            this.currentIndex.z--;\n            this.finishNav();\n        } else {\n            this.toggleRow(true);\n        }\n    };\n\n    moveDown = (pos: NavIndex) => {\n        if (!this.valid(pos)) {\n            return;\n        }\n        const clickable = this.current()?.getClickable();\n        if (clickable && clickable.length && this.currentIndex.z < clickable.length - 1) {\n            this.currentIndex.z++;\n            this.finishNav();\n        } else {\n            this.toggleRow(false);\n        }\n    };\n\n    toggleRow = (pickLast: boolean) => {\n        if (this.currentIndex.y === 0) {\n            this.currentIndex.y = 1;\n        } else {\n            this.currentIndex.y = 0;\n        }\n        const current = this.current();\n        const last: number = current ? current.getClickable().length - 1 : 0;\n        this.currentIndex.z = pickLast ? last : 0;\n        if (!current) {\n            this.moveLeft(this.currentIndex);\n        } else {\n            this.finishNav();\n        }\n    };\n\n    finishNav = () => {\n        const clickable = this.current()?.getClickable();\n        if (clickable && clickable[this.currentIndex.z]) {\n            this.model.focus.setCard(clickable[this.currentIndex.z]);\n        } else {\n            this.model.focus.setStack(this.current()?.source || \"\");\n        }\n        return true;\n    };\n\n    current = () => {\n        return this.rows[this.currentIndex.y][this.currentIndex.x];\n    };\n\n    pressCurrent = (before: { card: Card | null; stack: string }) => {\n        const clickable = this.current()?.getClickable();\n        if (\n            this.model.focus.card &&\n            this.model.focus.card.canClick() &&\n            clickable &&\n            clickable[this.currentIndex.z] &&\n            clickable[this.currentIndex.z].denomination === this.model.focus.card.denomination &&\n            clickable[this.currentIndex.z].type.icon === this.model.focus.card.type.icon\n        ) {\n            return (ctx: Model) => {\n                if (this.model.focus.card && this.model.focus.card.equals(before.card)) {\n                    this.model.focus.card.onClick({ isKeyboard: true })(ctx);\n                }\n            };\n        } else if (this.model.focus.stack && this.model.focus.stack === before.stack) {\n            return (ctx: Model) => {\n                this.current()?.clickEmpty({ isKeyboard: true })(ctx);\n            };\n        } else {\n            //this is the entry point in case user starts keyboard nav with action button\n            return (ctx: Model) => {\n                ctx.navigator.finishNav();\n                ctx.game.timemachine.modified = true;\n            };\n        }\n    };\n}\n","import { FeatureSwitches, LaunchSettings } from \"../../Common\";\nimport SuggestionModes, { SuggestionMode } from \"./Settings/SuggestionModes\";\n\nexport default class Settings {\n    launchSettings: LaunchSettings;\n    baseEntropy: number;\n    interactionEntropy: number;\n    suggestionModes: SuggestionMode[];\n    suggestionMode: SuggestionMode;\n    featureSwitches: FeatureSwitches;\n\n\n    constructor(launchSettings: LaunchSettings) {\n        this.launchSettings = launchSettings;\n        this.baseEntropy = launchSettings.baseEntropy;\n        this.interactionEntropy = launchSettings.interactionEntropy;\n        this.suggestionModes = SuggestionModes.allSuggestionModes();\n        this.suggestionMode = SuggestionModes.get(launchSettings.suggestionMode);\n        this.featureSwitches = launchSettings.featureSwitches;\n    }\n\n    setSuggestionMode = (sm: string) => {\n        if (this.suggestionMode.key !== sm) {\n            this.suggestionMode = SuggestionModes.get(sm);\n        }\n    };\n\n    enableHint = () => {\n        this.suggestionMode = SuggestionModes.getHintMode();\n    };\n\n    disableHint = () => {\n        if (this.suggestionMode.isTemporary && this.suggestionMode.next) {\n            this.suggestionMode = SuggestionModes.get(this.suggestionMode.next);\n            return true;\n        }\n        return false;\n    };\n\n    static copy = (orig: Settings) => {\n        const copy = new Settings(orig.launchSettings);\n        copy.suggestionMode = orig.suggestionMode;\n        copy.baseEntropy = orig.baseEntropy;\n        copy.interactionEntropy = orig.interactionEntropy;\n        return copy;\n    };\n}\n","import BasicStack from \"./Stack\";\nimport Card from \"../Deck/Card\";\nimport Model from \"../Model\";\nimport Settings from \"./Settings\";\n\nexport default class Stock extends BasicStack {\n    settings: Settings;\n    recyclings: number;\n    passes: number;\n    constructor(stack: Card[], settings: Settings) {\n        super(\"stock\");\n        this.settings = settings;\n        this.stack = stack.map(this.setCardProperties);\n        this.recyclings = 0;\n        this.passes = -1;\n        if (this.settings.launchSettings.recyclingMode === \"1-pass\") {\n            this.passes = 1;\n        }\n        if (this.settings.launchSettings.recyclingMode === \"3-pass\") {\n            this.passes = 3;\n        }\n    }\n\n    setOnClick = (onClick: (c: any, p: any, i: any) => (s: Model) => void) => {\n        this.clickEmpty = (p) => onClick(null, p, null);\n        this.stack.forEach((card, index) => {\n            card.onClick = (p: any) => onClick({ ...card }, p, null);\n            card.canClick = () => index === this.stack.length - 1;\n        });\n    };\n    accepts = () => false;\n\n    popOne = () => {\n        const result = this.stack.pop();\n        return result;\n    };\n\n    canRecycle() {\n        return (\n            this.settings.launchSettings.recyclingMode === \"infinite\" ||\n            (this.settings.launchSettings.recyclingMode === \"3-pass\" && this.recyclings < 2)\n        );\n    }\n\n    recycle = (waste: Card[]) => {\n        if (waste.length) {\n            this.stack = waste.reverse().map(this.setCardProperties);\n            this.stack[this.stack.length - 1].canClick = () => true;\n            this.recyclings++;\n            return true;\n        }\n\n        return false;\n    };\n\n    setCardProperties = (card: Card) => {\n        card.causeEntropy(Math.min(this.settings.interactionEntropy, 1));\n        card.isHidden = true;\n        card.source = this.source;\n        return card;\n    };\n\n    isOnTop = (card: Card) => card && card.equals(this.getTop());\n\n    popTop = () => {\n        let result: Card[] = [];\n        if (this.settings.launchSettings.drawMode === \"single\") {\n            const top = this.stack.pop();\n            if (top) result = [top];\n        }\n        if (this.settings.launchSettings.drawMode === \"triple\") {\n            result = this.stack.splice(this.stack.length - 3);\n        }\n        if (this.stack.length === 0) {\n            this.passes--;\n        }\n\n        return result;\n    };\n\n    static copy = (orig: Stock) => {\n        const copy = new Stock([], orig.settings);\n        copy.stack = Card.copyAll(orig.stack);\n        copy.passes = orig.passes;\n        copy.recyclings = orig.recyclings;\n        return copy;\n    };\n\n    setEntropy = (lvl: number) => {\n        this.stack.forEach((element) => element.causeEntropy(Math.min(lvl, 1)));\n        return this;\n    };\n}\n","import { BlinkFunction, ClickHandler } from \"../../Common\";\n\nimport Blinker from \"./Blinker\";\nimport Card from \"../Deck/Card\";\nimport Model from \"../Model\";\nimport Navigator from \"./Navigator\";\n\nexport default class Stock implements ClickHandler {\n    navigator: Navigator;\n    constructor(navigator: Navigator) {\n        this.navigator = navigator;\n    }\n\n    blink: BlinkFunction = (state: Model) => new Blinker().startBlink((s: Model) => s.stock, state);\n\n    dispatchPutDown = (_card: Card, _position: any, state: Model) => this.blink(state, 0);\n\n    dispatchPickup = (card: Card | null, _position: any, state: Model) => {\n        return card != null ? this.moveToWaste(card, state) : this.recycleWaste(state);\n    };\n\n    moveToWaste = (card: Card, state: Model) => {\n        return state.stock.isOnTop(card) && state.waste.addAll(state.stock.popTop()) && state.game.registerMove(\"waste\", \"stock\", state.waste.getTop());\n    };\n\n    recycleWaste = (state: Model) => {\n        if (!state.stock.getTop()) {\n            return (\n                (!!state.waste.getTop() &&\n                    state.stock.canRecycle() &&\n                    state.stock.recycle(state.waste.recycle()) &&\n                    state.game.registerRecycle() &&\n                    this.navigator.finishNav()) ||\n                this.blink(state, 0)\n            );\n        }\n    };\n}\n","import { BlinkFunction, ClickHandler } from \"../../Common\";\n\nimport Blinker from \"./Blinker\";\nimport Card from \"../Deck/Card\";\nimport Model from \"../Model\";\n\nexport default class Waste implements ClickHandler {\n    blink: BlinkFunction = (state: Model) => new Blinker().startBlink((s: Model) => s.waste, state);\n\n    dispatchPutDown = (card: Card, position: any, state: Model) =>\n        (state.waste.wouldAcceptHand() && state.waste.putDownHand() && state.game.registerMove(\"waste\", \"waste\", state.waste.getTop())) || this.blink(state, 0);\n\n    dispatchPickup = (card: Card | null, position: any, state: Model) =>\n        (card && state.hand.pickUp([state.waste.popTop(card)], \"waste\", position) && state.game.registerPickup()) || this.blink(state, 0);\n}\n","import Model from \"../Model\";\nimport SuggestionModes from \"../Game/Settings/SuggestionModes\";\nimport Tableau from \"./Tableau\";\nimport Waste from \"./Waste\";\n\nexport default class Suggestions {\n    tableau: Tableau;\n    waste: Waste;\n\n    constructor() {\n        this.tableau = new Tableau();\n        this.waste = new Waste();\n    }\n\n    evaluateOptions = (state: Model) => {\n        this.disableAllSuggestions(state);\n        if (\n            state.settings.suggestionMode.key !== SuggestionModes.NONE &&\n            !this.getUncoverOptions(state) &&\n            !this.getPutdownSuggestions(state) &&\n            !state.hand.isHoldingCard() &&\n            (!this.getPickupOptions(state) || state.settings.suggestionMode.key === SuggestionModes.FULL) &&\n            (state.stock.getTop() || state.stock.canRecycle()) &&\n            state.settings.suggestionMode.key !== SuggestionModes.SCORED\n        ) {\n            state.stock.suggestion = true;\n        }\n    };\n\n    getPutdownSuggestions = (state: Model, onlyUseful?: boolean) => {\n        if (!state.hand.isHoldingCard() || state.settings.suggestionMode.key === SuggestionModes.NONE) {\n            return 0;\n        }\n\n        const accepted = [];\n        if (state.waste.wouldAcceptHand()) {\n            if (state.settings.suggestionMode.key === SuggestionModes.FULL || !state.hand.isFromWaste()) {\n                const move = { target: \"waste\", source: state.hand.source };\n                if (state.settings.suggestionMode.key !== SuggestionModes.SCORED || state.game.rating.rateMove(move, null) > 0) {\n                    accepted.push(move);\n                    state.waste.suggestion = true;\n                }\n            }\n        }\n\n        state.foundation.stacks.forEach((stack, index) => {\n            if (state.foundation.wouldAcceptHand(index)) {\n                if (state.settings.suggestionMode.key === SuggestionModes.FULL || !state.hand.isFromFoundation(index)) {\n                    const move = { target: stack.source, source: state.hand.source };\n                    if (state.settings.suggestionMode.key !== SuggestionModes.SCORED || state.game.rating.rateMove(move, null) > 0) {\n                        accepted.push(move);\n                        stack.suggestion = true;\n                    }\n                }\n            }\n        });\n\n        state.tableau.stacks.forEach((stack, index) => {\n            if (state.tableau.wouldAcceptHand(index)) {\n                if (state.settings.suggestionMode.key === SuggestionModes.FULL || !state.hand.isFromTableau(index)) {\n                    const isMoveOfKingBetweenEmptySlots =\n                        state.hand.isHoldingKing() &&\n                        stack.stack.length === 0 &&\n                        state.hand.isFromAnyTableau() &&\n                        state.tableau.stacks[state.hand.getTableauIndex()].stack.length === 0;\n\n                    const isMoveBetweenSimilarParentCards =\n                        stack.stack.length > 0 &&\n                        state.hand.isFromAnyTableau() &&\n                        state.tableau.stacks[state.hand.getTableauIndex()].stack.length > 0 &&\n                        stack.stack[stack.stack.length - 1].denomination ===\n                            state.tableau.stacks[state.hand.getTableauIndex()].stack[\n                                state.tableau.stacks[state.hand.getTableauIndex()].stack.length - 1\n                            ].denomination &&\n                        !state.tableau.getTop(state.hand.getTableauIndex()).isHidden;\n\n                    const isNotLoop = !isMoveOfKingBetweenEmptySlots && !isMoveBetweenSimilarParentCards;\n\n                    if (!onlyUseful || state.settings.suggestionMode.key === SuggestionModes.FULL || isNotLoop) {\n                        const move = { target: stack.source, source: state.hand.source };\n                        if (state.settings.suggestionMode.key !== SuggestionModes.SCORED || state.game.rating.rateMove(move, null) > 0) {\n                            accepted.push(move);\n                            stack.suggestion = true;\n                        }\n                    }\n                }\n            }\n        });\n\n        return accepted.length;\n    };\n\n    getPickupOptions = (state: Model) => {\n        let foundAny = false;\n        const wasteState = Model.copy(state);\n        this.waste.dispatchPickup(wasteState.waste.getTop(), null, wasteState);\n        if (wasteState.game.timemachine.modified) {\n            if (this.getPutdownSuggestions(wasteState, true) > (state.settings.suggestionMode.key === SuggestionModes.FULL ? 1 : 0)) {\n                state.waste.suggestion = true;\n                foundAny = true;\n            }\n        }\n\n        state.tableau.stacks.forEach((tableau, index) =>\n            tableau.stack\n                .map((card, cardIndex) => ({ cardIndex, card }))\n                .filter(({ card }) => !card.isHidden)\n                .forEach(({ card, cardIndex }) => {\n                    const tableauState = Model.copy(state);\n                    this.tableau.dispatchPickup(card, null, tableauState, index);\n                    if (tableauState.game.timemachine.modified) {\n                        if (\n                            this.getPutdownSuggestions(tableauState, true) >\n                            (state.settings.suggestionMode.key === SuggestionModes.FULL ? 1 : 0)\n                        ) {\n                            tableau.stack[cardIndex].suggestion = true;\n                            foundAny = true;\n                        }\n                    }\n                })\n        );\n        return foundAny;\n    };\n\n    getUncoverOptions = (state: Model) => {\n        if (!state.hand.isHoldingCard()) {\n            const filtered = state.tableau.stacks\n                .map((_stack, index) => index)\n                .filter((index) => state.tableau.getTop(index) && state.tableau.getTop(index).isHidden);\n            filtered.forEach((index) => {\n                state.tableau.getTop(index).suggestion = true;\n            });\n            return filtered.length;\n        }\n\n        return 0;\n    };\n\n    disableAllSuggestions = (state: Model) => {\n        const disableSuggestion = (obj: any) => {\n            obj.suggestion = false;\n            obj.stack && obj.stack.forEach(disableSuggestion);\n            obj.stacks && obj.stacks.forEach(disableSuggestion);\n        };\n\n        disableSuggestion(state.waste);\n        disableSuggestion(state.stock);\n        disableSuggestion(state.tableau);\n        disableSuggestion(state.foundation);\n    };\n}\n","import Card from \"../Deck/Card\";\nimport HandHoldingStack from \"./HandHoldingStack\";\nimport Model from \"../Model\";\nimport { getTableauOrder } from \"../Deck/DeckSize\";\n\nexport default class TableauStack extends HandHoldingStack {\n    id = 0;\n    accepts = (current: Card | null) => {\n        const top = this.getTop();\n        if (!top) {\n            return (current && current.denomination === \"K\") || false;\n        }\n        if (this.source === current?.source) return true;\n        if (top.isHidden) {\n            return false;\n        }\n        const range = [...getTableauOrder()];\n        const currentIndex = current ? range.indexOf(current.denomination) : 0;\n        const topIndex = range.indexOf(top.denomination);\n        return currentIndex + 1 === topIndex && current?.type.color !== top.type.color && top.denomination !== \"A\";\n    };\n    getTop = (offset?: number) => this.stack[this.stack.length - 1 - (offset || 0)];\n    canUncover = (card: Card) => {\n        const top = this.getTop();\n        return top.isHidden && card && card.equals(this.getTop());\n    };\n    setOnClick = (onClick: (a: any, b: any) => (s: Model) => void, onClickhidden: (a: any, b: any) => (s: Model) => void) => {\n        this.clickEmpty = (p: any) => onClick(null, p);\n        const cards = this.source === this.hand.source ? [...this.stack, ...this.hand.stack] : this.stack;\n        cards.forEach((card, sindex) => {\n            const click = card.isHidden && sindex === cards.length - 1 ? onClickhidden : onClick;\n            card.onClick = (p: any) => click({ ...card }, p);\n            card.canClick = () => !card.isHidden || (this.canUncover(card) && !this.hand.currentCard()) || false;\n        });\n        this.hand.setOnClick(this);\n    };\n    static copy = (orig: TableauStack) => {\n        const s = new TableauStack(orig.source, orig.hand);\n        s.id = orig.id;\n        s.stack = Card.copyAll(orig.stack);\n        return s;\n    };\n}\n","import Card from \"../Deck/Card\";\nimport Hand from \"./Hand\";\nimport Model from \"../Model\";\nimport MultiStack from \"./MultiStack\";\nimport Settings from \"./Settings\";\nimport TableauStack from \"./TableauStack\";\n\nexport default class Tableau extends MultiStack<TableauStack> {\n    constructor(settings: Settings, hand: Hand) {\n        super(\n            settings,\n            hand,\n            [0, 1, 2, 3, 4, 5, 6].map((id) => {\n                const s = new TableauStack(\"tableau-\" + id, hand);\n                s.id = id;\n                return s;\n            })\n        );\n    }\n\n    setOnClick = (\n        onClick: (a: any, b: any, index: number) => (s: Model) => void,\n        onClickhidden: (a: any, b: any, index: number) => (s: Model) => void\n    ) => {\n        this.stacks.forEach((stack, index) => {\n            stack.setOnClick(\n                (a: any, b: any) => onClick(a, b, index),\n                (a: any, b: any) => onClickhidden(a, b, index)\n            );\n        });\n    };\n\n    getStack = (index: number) => this.stacks[index];\n\n    wouldAcceptHand = (index: number) => this.canPutDown(this.getTop(index), this.hand, index);\n\n    putDownHand = (index: number) => this.add(index, this.hand.source, this.hand.putDown());\n\n    canPutDown = (card: Card, hand: Hand, index: number) =>\n        (card && card.isHidden && hand.isFromCurrentSource(card)) ||\n        this.accepts(index, hand.currentCard()) ||\n        (!card && hand.isFromTableau(index));\n\n    accepts = (index: number, current?: Card | null) => {\n        if (!current) return false;\n        return this.stacks[index].accepts(current);\n    };\n\n    getCard = (index: number, card: Card) => {\n        for (let j = 0; j < this.stacks[index].stack.length; j++) {\n            if (card && card.equals(this.stacks[index].stack[j]) && card.isHidden === this.stacks[index].stack[j].isHidden) {\n                return this.stacks[index].stack[j];\n            }\n        }\n        return false;\n    };\n\n    popWithFollowing = (card: Card, i: number) => {\n        for (let j = 0; j < this.stacks[i].stack.length; j++) {\n            if (card && card.equals(this.stacks[i].stack[j])) {\n                const result = this.stacks[i].stack.splice(j, this.stacks[i].stack.length);\n                this.stackEntropy(i);\n                return result;\n            }\n        }\n\n        return [];\n    };\n\n    deal = (card: Card, index: number) => {\n        this.stacks[index].stack.push(card);\n    };\n\n    canUncover = (index: number, card: Card) => {\n        return this.stacks[index].canUncover(card);\n    };\n\n    uncover = (index: number, card: Card) => {\n        const top = this.getTop(index);\n        if (this.canUncover(index, card)) {\n            top.isHidden = false;\n            this.stackEntropy(index);\n            return true;\n        }\n\n        return false;\n    };\n\n    //@todo entropy as animated effect, triggered after rendering gamestate like blink\n    stackEntropy = (index: number) => {\n        let entropy = this.settings.interactionEntropy;\n        let next = 1;\n        let top = this.getTop(index);\n        while (entropy && entropy !== 0 && top) {\n            top.causeEntropy(entropy);\n            entropy--;\n            top = this.getTop(index, next);\n            next++;\n        }\n    };\n\n    add = (index: number, source: string, cards: Card[]) => {\n        this.stacks[index].stack = this.stacks[index].stack.concat(cards.map((c) => this.setCardProperties(c, index)));\n        this.stackEntropy(index);\n        return cards;\n    };\n\n    setCardProperties = (card: Card, index: number) => {\n        card.source = this.stacks[index].source;\n        return card;\n    };\n\n    getTop = (index: number, offset?: number) => this.stacks[index].getTop(offset);\n\n    static copy = (orig: Tableau, hand: Hand) => {\n        const copy = new Tableau(orig.settings, hand);\n        copy.stacks = orig.stacks.map(TableauStack.copy);\n        return copy;\n    };\n\n    setEntropy = (lvl: number) => {\n        this.stacks.forEach((stack) => stack.stack.forEach((element) => element.causeEntropy(Math.min(lvl, 4))));\n        return this;\n    };\n}\n","import Card from \"../Deck/Card\";\nimport Hand from \"./Hand\";\nimport HandHoldingStack from \"./HandHoldingStack\";\nimport Model from \"../Model\";\nimport Settings from \"./Settings\";\n\nexport default class Waste extends HandHoldingStack {\n    settings: Settings;\n    constructor(settings: Settings, hand: Hand) {\n        super(\"waste\", hand);\n        this.settings = settings;\n    }\n\n    setOnClick = (onClick: (c: any, p: any, i: any) => (s: Model) => void) => {\n        this.clickEmpty = (p) => onClick(null, p, null);\n        const cards = this.source === this.hand.source ? [...this.stack, ...this.hand.stack] : this.stack;\n        cards.forEach((card, index) => {\n            card.onClick = (p: any) => onClick({ ...card }, p, null);\n            card.canClick = () => index === cards.length - 1;\n        });\n        this.hand.setOnClick(this);\n    };\n\n    putDownHand = () => this.addAll(this.hand.putDown());\n\n    add = (card: Card) => card && this.stack.push(this.setCardProperties(card));\n\n    addAll = (cards: Card[]) => cards && cards.length && cards.map(this.add);\n\n    setCardProperties = (card: Card) => {\n        card.source = this.source;\n        card.isHidden = false;\n        card.causeEntropy(Math.min(this.settings.interactionEntropy, 1));\n        return card;\n    };\n\n    wouldAcceptHand = () => this.hand.isFromWaste() && this.canAdd(this.hand.currentCard());\n\n    accepts = (card: Card | null) => this.canAdd(card) || false;\n\n    canAdd = (card: Card | null) => card && (!this.getTop() || !card.equals(this.getTop()));\n\n    popTop = (card: Card) => (card && card.equals(this.getTop()) && this.stack.pop()) || null;\n\n    recycle = () => this.stack.splice(0, this.stack.length);\n\n    static copy = (orig: Waste, hand: Hand) => {\n        const copy = new Waste(orig.settings, hand);\n        copy.stack = Card.copyAll(orig.stack);\n        return copy;\n    };\n\n    setEntropy = (lvl: number) => {\n        this.stack.forEach((element) => element.causeEntropy(Math.min(lvl, 1)));\n        return this;\n    };\n}\n","import { ClickHandler, LaunchSettings } from \"../Common\";\nimport TableauHandler, { TableauHidden } from \"./Business/Tableau\";\n\nimport Card from \"./Deck/Card\";\nimport Dealer from \"./Business/Dealer\";\nimport Deck from \"./Deck/Deck\";\nimport Dispatcher from \"./Business/Dispatcher\";\nimport Focus from \"./Game/Focus\";\nimport Foundation from \"./Game/Foundation\";\nimport FoundationHandler from \"./Business/Foundation\";\nimport Game from \"./Game/Game\";\nimport Hand from \"./Game/Hand\";\nimport { IStack } from \"./Game/Stack\";\nimport Navigator from \"./Business/Navigator\";\nimport Settings from \"./Game/Settings\";\nimport Stock from \"./Game/Stock\";\nimport StockHandler from \"./Business/Stock\";\nimport Suggestions from \"./Business/Suggestions\";\nimport Tableau from \"./Game/Tableau\";\nimport Waste from \"./Game/Waste\";\nimport WasteHandler from \"./Business/Waste\";\n\nexport default class Model {\n    stock: Stock;\n    waste: Waste;\n    foundation: Foundation;\n    tableau: Tableau;\n    hand: Hand;\n    game: Game;\n    settings: Settings;\n    focus: Focus;\n    suggestor: Suggestions;\n    dealer: Dealer;\n    navigator: Navigator;\n    token: number;\n\n    constructor(obj: any) {\n        this.stock = obj.stock;\n        this.waste = obj.waste;\n        this.foundation = obj.foundation;\n        this.tableau = obj.tableau;\n        this.hand = obj.hand;\n        this.game = obj.game;\n        this.settings = obj.settings;\n        this.focus = obj.focus;\n        this.suggestor = new Suggestions();\n        this.dealer = new Dealer();\n        this.navigator = new Navigator(this);\n        this.token = obj.token;\n    }\n\n    setToken = (token: number) => {\n        this.token = token;\n    };\n\n    withSuggestions = () => {\n        this.suggestor.evaluateOptions(this);\n        return this;\n    };\n\n    _hasSuggestion = (obj: any) => {\n        return obj.suggestion || (obj.stack && obj.stack.some(this._hasSuggestion)) || (obj.stacks && obj.stacks.some(this._hasSuggestion));\n    };\n\n    hasNonStockSuggestions = () => {\n        return (\n            this._hasSuggestion(this.waste) ||\n            this._hasSuggestion(this.tableau) ||\n            this._hasSuggestion(this.foundation)\n        );\n    }\n\n    hasSuggestions = () => {\n        return (\n            this._hasSuggestion(this.waste) ||\n            this._hasSuggestion(this.stock) ||\n            this._hasSuggestion(this.tableau) ||\n            this._hasSuggestion(this.foundation)\n        );\n    };\n\n    canAutoSolve = () => {\n        return (\n            this.waste.stack.length === 0 &&\n            this.stock.stack.length === 0 &&\n            this.tableau.stacks.every((s) => s.stack.every((c) => !c.isHidden))\n        );\n    };\n\n    setEntropy = (lvl: number) => {\n        this.settings.baseEntropy = lvl;\n        this.stock.setEntropy(lvl);\n        this.waste.setEntropy(lvl);\n        this.foundation.setEntropy(lvl);\n        this.tableau.setEntropy(lvl);\n    };\n\n    clearSuccess = (card: Card) => {\n        const clear = (c: Card, s: IStack) => {\n            s.stack.forEach((_c) => {\n                if (_c.equals(c)) {\n                    _c.success = 0;\n                }\n            });\n        };\n        clear(card, this.stock);\n        clear(card, this.waste);\n        this.foundation.stacks.forEach((s) => clear(card, s));\n        this.tableau.stacks.forEach((s) => clear(card, s));\n    };\n\n    withHandlers = () => {\n        const getHandler = (clickHandler: ClickHandler) => new Dispatcher(clickHandler).getHandler(this.hand);\n        this.stock.setOnClick(getHandler(new StockHandler(this.navigator)));\n        this.waste.setOnClick(getHandler(new WasteHandler()));\n        this.foundation.setOnClick(getHandler(new FoundationHandler()));\n        this.tableau.setOnClick(getHandler(new TableauHandler()), getHandler(new TableauHidden()));\n        return this;\n    };\n\n    static getInitialState = (launchSettings: LaunchSettings, deck: Deck, player: number) => {\n        const settings = new Settings(launchSettings);\n        const hand = new Hand();\n        const state = {\n            stock: new Stock([...deck.cards], settings),\n            waste: new Waste(settings, hand),\n            foundation: new Foundation(settings, hand),\n            tableau: new Tableau(settings, hand),\n            hand: hand,\n            game: new Game(settings),\n            settings: settings,\n            focus: new Focus(settings, player),\n            token: 0,\n        };\n        return new Model(state);\n    };\n\n    static copy = (state: Model) => {\n        const hand = Hand.copy(state.hand);\n        return new Model({\n            stock: Stock.copy(state.stock),\n            waste: Waste.copy(state.waste, hand),\n            foundation: Foundation.copy(state.foundation, hand),\n            tableau: Tableau.copy(state.tableau, hand),\n            hand: hand,\n            game: Game.copy(state.game),\n            settings: Settings.copy(state.settings),\n            focus: state.focus,\n            token: state.token,\n        });\n    };\n}\n","//- auto-resolver\n//  - check if the board can auto-resolve and offer to complete automatically\n//  - auto-complete becomes button in header and option in menu\n\nimport Model from \"../../../Model/Model\";\nimport React from \"react\";\nimport SuggestionModes from \"../../../Model/Game/Settings/SuggestionModes\";\nimport useGlobalContext from \"../../GlobalContext\";\n\nconst RenderAutoSolve = (props: { canAutosolve: boolean }) => {\n    const [solving, setSolving] = React.useState(false);\n    const { state, updateGameContext } = useGlobalContext();\n    React.useEffect(() => {\n        if (props.canAutosolve) {\n            updateGameContext((ctx) => (ctx.settings.suggestionMode = SuggestionModes.get(SuggestionModes.NONE)));\n            setSolving(true);\n        }\n    }, [props.canAutosolve, updateGameContext]);\n    const canSolve = solving && state.settings.suggestionMode.key === SuggestionModes.NONE;\n    return !canSolve ? null : <Solver />;\n};\n\nexport const AutoSolver = () => {\n    const { state } = useGlobalContext();\n    return <RenderAutoSolve canAutosolve={state.canAutoSolve()} />;\n};\n\nexport default AutoSolver;\n\n//@todo also start general confetti firework elements when autosolving\n//@todo autosolve looks and feels slow: disable individual fireworks & reduce timeout duration\n\nconst Solver = () => {\n    const { state, updateGameContext } = useGlobalContext();\n    React.useEffect(() => {\n        const timeout = setTimeout(() => {\n            const copy = Model.copy(state).withHandlers();\n            if (copy.hand.currentCard()) {\n                copy.settings.suggestionMode = SuggestionModes.get(SuggestionModes.SCORED);\n                copy.suggestor.evaluateOptions(copy);\n                if (copy._hasSuggestion(copy.foundation)) {\n                    const suggestedFoundations = copy.foundation.stacks.filter((s) => copy._hasSuggestion(s));\n                    if (suggestedFoundations.length) {\n                        const suggestedFoundation = suggestedFoundations[0];\n                        updateGameContext(suggestedFoundation.clickEmpty({ isKeyboard: false }));\n                    }\n                }\n            } else {\n                copy.settings.suggestionMode = SuggestionModes.get(SuggestionModes.SCORED);\n                copy.suggestor.evaluateOptions(copy);\n                if (copy._hasSuggestion(copy.tableau)) {\n                    const suggestedTableaus = copy.tableau.stacks.filter((s) => copy._hasSuggestion(s));\n                    if (suggestedTableaus.length) {\n                        const suggestedCards = suggestedTableaus[0].stack.filter((c) => c.suggestion);\n                        if (suggestedCards.length) {\n                            const suggestedCard = suggestedCards[0];\n                            updateGameContext(suggestedCard.onClick({ isKeyboard: false }));\n                        }\n                    }\n                }\n            }\n        }, 150);\n\n        return () => clearTimeout(timeout);\n    });\n    return null;\n};\n","import React from \"react\";\nimport useGlobalContext from \"./GlobalContext\";\n\nconst useTokenEffect = (f: React.EffectCallback) => {\n    const { state } = useGlobalContext();\n    // this hook only runs when the token changes. intentionally.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    return React.useEffect(f, [state.token]);\n};\n\nexport default useTokenEffect;\n","import React from \"react\";\nimport useGameContext from \"../../Context/GameContext\";\nimport useGlobalContext from \"../../GlobalContext\";\nimport useTokenEffect from \"../../useGlobalTokenEffect\";\n\nconst Uncoverer = () => {\n    const { state, updateGameContext } = useGlobalContext();\n    useTokenEffect(() => {\n        if (!state.hand.currentCard()) {\n            state.tableau.stacks.forEach((stack) => {\n                if (stack.getTop() && stack.getTop().isHidden && stack.getTop().canClick()) {\n                    updateGameContext(stack.getTop().onClick({ isKeyboard: true }));\n                }\n            });\n        }\n    });\n    return null;\n};\n\nconst AutoUncoverer = () => {\n    const { state } = useGlobalContext();\n    const { gameState } = useGameContext();\n    return !!state.settings.launchSettings.autoUncover && !!gameState.started ? <Uncoverer /> : null;\n};\n\nexport default AutoUncoverer;\n","import React from \"react\";\n\nconst BoardContext = React.createContext({\n    player: 0,\n});\n\nexport const useBoardContext = () => React.useContext(BoardContext);\n\nexport const BoardProvider = BoardContext.Provider;\n","import { CustomInputProps } from \"./CustomInputProps\";\nimport GameModes from \"../../../GameModes\";\nimport GamePad from \"../../../common/GamePad\";\nimport GamepadLayout from \"../../../common/GamepadLayout\";\nimport Model from \"../../../Model/Model\";\nimport React from \"react\";\nimport { useBoardContext } from \"../../Context/BoardContext\";\nimport useGlobalContext from \"../../GlobalContext\";\n\nconst BoardGamePad = (props: CustomInputProps) => {\n    const { state } = useGlobalContext();\n    const { player } = useBoardContext();\n    const isGamePadDriven = state.settings.launchSettings.players[player].inputMethod === \"gamepad\";\n    const isSinglePlayer = state.settings.launchSettings.boardMode === GameModes.SINGLEPLAYER;\n\n    const switchToGamePad = (ctx: Model) => {\n        ctx.focus.isKeyBoard(true);\n        if (isSinglePlayer) {\n            ctx.settings.launchSettings.players[player].inputMethod = \"gamepad\";\n        }\n    };\n\n    return isSinglePlayer || isGamePadDriven ? (\n        <GamePad\n            layout={GamepadLayout}\n            gamepadIndex={state.settings.launchSettings.players[player].inputLayout}\n            onLeft={() => props.onLeft(switchToGamePad)}\n            onRight={() => props.onRight(switchToGamePad)}\n            onUp={() => props.onUp(switchToGamePad)}\n            onDown={() => props.onDown(switchToGamePad)}\n            onAction={() => props.onAction(switchToGamePad)}\n            onCancel={() => props.onCancel(switchToGamePad)}\n            onHint={() => props.onHint(switchToGamePad)}\n            onUndo={() => props.onUndo()}\n            onPause={() => props.onPause(switchToGamePad)}\n            onMenu={() => props.onMenu(switchToGamePad)}\n        />\n    ) : null;\n};\n\nexport default BoardGamePad;\n","import { Universal, getKeyboardLayout } from \"../../../common/KeyboardLayouts\";\n\nimport { CustomInputProps } from \"./CustomInputProps\";\nimport GameModes from \"../../../GameModes\";\nimport Keyboard from \"../../../common/Keyboard\";\nimport Model from \"../../../Model/Model\";\nimport React from \"react\";\nimport { useBoardContext } from \"../../Context/BoardContext\";\nimport useGlobalContext from \"../../GlobalContext\";\n\nconst BoardKeyboard = (props: CustomInputProps) => {\n    const { state } = useGlobalContext();\n    const { player } = useBoardContext();\n    const isKeyboardDriven = state.settings.launchSettings.players[player].inputMethod === \"keyboard\";\n    const isSinglePlayer = state.settings.launchSettings.boardMode === GameModes.SINGLEPLAYER;\n    const layout = isSinglePlayer ? Universal : getKeyboardLayout(state.settings.launchSettings.players[player].inputLayout);\n\n    const switchToKeyboard = (ctx: Model) => {\n        ctx.focus.isKeyBoard(true);\n        if (isSinglePlayer) {\n            ctx.settings.launchSettings.players[player].inputMethod = \"keyboard\";\n        }\n    };\n\n    return isKeyboardDriven || isSinglePlayer ? (\n        <Keyboard\n            layout={layout}\n            onLeft={() => props.onLeft(switchToKeyboard)}\n            onRight={() => props.onRight(switchToKeyboard)}\n            onUp={() => props.onUp(switchToKeyboard)}\n            onDown={() => props.onDown(switchToKeyboard)}\n            onAction={() => props.onAction(switchToKeyboard)}\n            onCancel={() => props.onCancel(switchToKeyboard)}\n            onHint={() => props.onHint(switchToKeyboard)}\n            onUndo={() => props.onUndo()}\n            onPause={() => props.onPause(switchToKeyboard)}\n            onMenu={() => props.onMenu(switchToKeyboard)}\n        />\n    ) : null;\n};\n\nexport default BoardKeyboard;\n","import BoardGamePad from \"./BoardGamePad\";\nimport BoardKeyboard from \"./BoardKeyboard\";\nimport Model from \"../../../Model/Model\";\nimport React from \"react\";\nimport { useBoardContext } from \"../../Context/BoardContext\";\nimport useGlobalContext from \"../../GlobalContext\";\nimport usePauseContext from \"../../Context/PauseContext\";\n\ntype _mod = (state: Model) => void;\n\nconst BoardNavigator = () => {\n    const { state, updateContext, updateGameContext, replaceContext } = useGlobalContext();\n    const paused = usePauseContext();\n    const { player } = useBoardContext();\n    const before = { x: state.navigator.currentIndex.x, y: state.navigator.currentIndex.y, z: state.navigator.currentIndex.z };\n    const beforeFocused = { card: state.focus.card, stack: state.focus.stack };\n    const isPaused = !!paused.state.paused;\n\n    const isVisible = (state: Model) => state.settings.suggestionMode.supportsHints || state.settings.suggestionMode.isTemporary;\n    const isDisabled = (state: Model) => state.settings.suggestionMode.isTemporary;\n\n    const handlers = {\n        onLeft: (modifier: _mod) =>\n            updateContext((ctx) => {\n                modifier(ctx);\n                ctx.navigator.moveLeft(before);\n            }),\n\n        onRight: (modifier: _mod) =>\n            updateContext((ctx) => {\n                modifier(ctx);\n                ctx.navigator.moveRight(before);\n            }),\n\n        onUp: (modifier: _mod) =>\n            updateContext((ctx) => {\n                modifier(ctx);\n                ctx.navigator.moveUp(before);\n            }),\n\n        onDown: (modifier: _mod) =>\n            updateContext((ctx) => {\n                modifier(ctx);\n                ctx.navigator.moveDown(before);\n            }),\n\n        onAction: (modifier: _mod) =>\n            updateGameContext((ctx) => {\n                modifier(ctx);\n                const handler = state?.navigator?.pressCurrent(beforeFocused);\n                handler && handler(ctx);\n                ctx.navigator.finishNav();\n            }),\n\n        onCancel: (modifier: _mod) =>\n            updateContext((ctx) => {\n                modifier(ctx);\n                ctx.hand.stack.length && ctx.hand.stack[0].onClick({ isKeyboard: true })(ctx);\n            }),\n\n        onPause: (modifier: _mod) => {\n            updateContext((state) => {\n                modifier(state);\n            });\n            paused.togglePause(isPaused, player);\n        },\n\n        onHint: (modifier: _mod) => {\n            updateContext((state) => {\n                modifier(state);\n                if (isVisible(state) && !isDisabled(state)) {\n                    state.settings.enableHint();\n                }\n            });\n        },\n\n        onUndo: () => {\n            if (state.settings.featureSwitches.undo) {\n                //@todo use GlobalState token to avoid double processing (pass in token via props to always have updated version)\n                replaceContext((_state) => {\n                    const previous = _state.game.timemachine.popPreviousState(state.game.timemachine.previousStates.length - 1, state);\n                    if (previous) {\n                        previous.game.rating.penalize(_state.game.rating);\n                        return previous;\n                    }\n\n                    return null;\n                });\n            }\n        },\n        onMenu: (modifier: _mod) => {\n            updateContext((state) => {\n                modifier(state);\n            });\n            paused.togglePause(isPaused, player);\n        },\n    };\n\n    return paused.state.showMenu ? null : (\n        <>\n            <BoardKeyboard {...handlers} />\n            <BoardGamePad {...handlers} />\n        </>\n    );\n};\n\nexport default BoardNavigator;\n","import { useEffectOnce } from \"react-use\";\nimport useGameContext from \"../../Context/GameContext\";\nimport useGlobalContext from \"../../GlobalContext\";\n\nconst Dealer = () => {\n    const { state, replaceContext } = useGlobalContext();\n    const { gameState, start } = useGameContext();\n    useEffectOnce(() => {\n        if (!gameState.started) {\n            const timeouts: NodeJS.Timeout[] = [];\n            if (state.settings.launchSettings.quickDeal) {\n                if (!state.dealer.isDealt) {\n                    start();\n                    replaceContext(state.dealer.dealAll());\n                }\n            } else {\n                const deal = (dealt: number) =>\n                    timeouts.push(\n                        setTimeout(() => {\n                            if (!state.dealer.isDealt) {\n                                replaceContext(state.dealer.dealOne(dealt, deal));\n                            } else {\n                                start();\n                            }\n                        }, 35)\n                    );\n\n                deal(state.dealer.dealt);\n                return () => timeouts.forEach((timeout) => clearTimeout(timeout));\n            }\n        }\n    });\n    return null;\n};\nexport default Dealer;\n","import { mdiFlagOutline, mdiHandBackLeft, mdiPlay } from \"@mdi/js\";\n\nimport MenuButton from \"./StartScreen/Menu/MenuButton\";\nimport MenuTitle from \"./StartScreen/Menu/MenuTitle\";\nimport MenuTree from \"./StartScreen/Menu/MenuTree\";\nimport { NavigationProvider } from \"./StartScreen/Navigation/NavigationContext\";\nimport React from \"react\";\nimport { Universal } from \"../../common/KeyboardLayouts\";\nimport useGlobalContext from \"../GlobalContext\";\nimport usePauseContext from \"../Context/PauseContext\";\nimport useTokenEffect from \"../useGlobalTokenEffect\";\n\nconst PossibleFailScreen = () => {\n    const { state } = useGlobalContext();\n    const [refused, setRefused] = React.useState<{ refused: boolean; since: number }>({ refused: false, since: 0 });\n    const refuse = (val: boolean) => {\n        setRefused({\n            refused: refused.since >= 3 ? false : val,\n            since: refused.since >= 3 ? 0 : refused.since + 1,\n        });\n    };\n    useTokenEffect(() => {\n        if (!state.hand.currentCard() && refused.refused) {\n            refuse(true);\n        }\n    });\n    const pause = usePauseContext();\n    //@todo\n    //instead of immediate quit, use gamestate.giveUp, then allow quitting via EndScreen\n    //in versus this lets the other player gloat and confirm before exiting game\n    const { restart } = useGlobalContext();\n    React.useEffect(() => {\n        if (!pause.state.showMenu) {\n            pause.toggleMenu(true);\n        }\n        return () => pause.toggleMenu(false);\n        //@todo antipattern?\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [refused.refused]);\n    return !refused.refused ? (\n        <NavigationProvider>\n            <div className=\"gamemenu menu dialog\">\n                <div className=\"startscreen-jail\">\n                    <div className=\"innermenu\">\n                        <MenuTitle icon={mdiHandBackLeft} />\n                        <div className=\"announcement\">The game might be over</div>\n                        <MenuTree keyboardLayout={Universal}>\n                            <MenuButton\n                                icon={mdiPlay}\n                                title=\"Keep trying\"\n                                onClick={() => {\n                                    refuse(true);\n                                }}\n                            />\n                            <MenuButton icon={mdiFlagOutline} title=\"Give up\" onClick={() => restart()} />\n                        </MenuTree>\n                    </div>\n                </div>\n            </div>\n        </NavigationProvider>\n    ) : null;\n};\nexport default PossibleFailScreen;\n","import Card from \"../../../Model/Deck/Card\";\nimport Model from \"../../../Model/Model\";\nimport PossibleFailScreen from \"../../UI/PossibleFailScreen\";\nimport React from \"react\";\nimport SuggestionModes from \"../../../Model/Game/Settings/SuggestionModes\";\nimport useGameContext from \"../../Context/GameContext\";\nimport useGlobalContext from \"../../GlobalContext\";\nimport useTokenEffect from \"../../useGlobalTokenEffect\";\n\nconst FailDetector = () => {\n    const { state } = useGlobalContext();\n    const { gameState } = useGameContext();\n\n    const [suggestions, setSuggestions] = React.useState<{ any: boolean; stock: boolean; nonStock: boolean }>({\n        any: false,\n        stock: false,\n        nonStock: false,\n    });\n    useTokenEffect(() => {\n        if (gameState.started) {\n            const copy = Model.copy(state);\n            copy.settings.suggestionMode = SuggestionModes.get(SuggestionModes.FULL);\n            copy.suggestor.evaluateOptions(copy);\n            setSuggestions({\n                any: copy.hasSuggestions(),\n                stock: copy._hasSuggestion(copy.stock),\n                nonStock: copy.hasNonStockSuggestions(),\n            });\n        }\n    });\n\n    const [stockSuggestionCards, setStockSuggestionCards] = React.useState<Card[]>([]);\n    const [isPossibleFail, setPossibleFail] = React.useState<boolean>(false);\n    React.useEffect(() => {\n        if (!state.hand.currentCard() && gameState.started) {\n            //fail detection never ends the game, merely offers to quit or keep trying\n            //it also aquaints the user with the possibiltiy of undoing or restarting to be helpful\n            if (suggestions.nonStock) {\n                setStockSuggestionCards([]);\n                setPossibleFail(false);\n            } else if (suggestions.stock && !suggestions.nonStock) {\n                //@todo CYCLING FAIL DETECTION\n                //even with a full suggestion available, the situation may be hopeless\n                //that is true if the suggestion concerns the stock\n                //to find out if it's really hopeless, we need to track full cycles through the deck\n                //if a full cycle through the stack was performed and only stock suggestions came up\n                //it's basically a loss, same as above\n                //to achieve this we can store all cards that produced stock suggestions in a list\n                //as long as stock suggestions come up we add to the list\n                //once list has same length as stock + waste + hand(waste) we know it's over\n                //once we find a non-stock suggestion we empty out the list\n                const top = state.stock.getTop();\n                if (top) {\n                    setStockSuggestionCards([...stockSuggestionCards, top]);\n                }\n                if (state.stock.stack.length + state.waste.stack.length <= stockSuggestionCards.length) {\n                    setPossibleFail(true);\n                }\n                //however this whole fancy thing doesn't work if there are useless \"full\" suggestions.\n                //if the user is in full mode, and ignores these, it's a sign it's over\n                //if the user is in regular mode or lesser, we could recommend switching to full suggestions\n                //but that's not really the job of a faildetector\n            } else if (!suggestions.any) {\n                //@todo SIMPLE FAIL DETECTION\n                //no full suggestions = no moves possible mean fail unless all cards are in foundation\n                setPossibleFail(true);\n                //@todo implement menu clone that suggests to stop since there is nothing to do anymore\n            }\n        }\n        //@todo anti pattern?\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [suggestions]);\n\n    return isPossibleFail ? <PossibleFailScreen /> : null;\n};\n\nexport default FailDetector;\n","import React from \"react\";\nimport { useBoardContext } from \"../../Context/BoardContext\";\nimport useGameContext from \"../../Context/GameContext\";\nimport useGlobalContext from \"../../GlobalContext\";\n\nconst Detector = () => {\n    const { state } = useGlobalContext();\n    const { win } = useGameContext();\n    const { player } = useBoardContext();\n\n    React.useEffect(() => {\n        if (!state.hand.currentCard() && state.foundation.countCards() === 52) {\n            win(player);\n        }\n    }, [state.token, state.foundation, state.hand, player, win]);\n    return null;\n};\n\nconst WinDetector = () => {\n    const { state } = useGlobalContext();\n    const { gameState } = useGameContext();\n    return (!gameState.isEnded && !!state.settings.launchSettings.autoUncover && !!gameState.started && <Detector />) || null;\n};\n\nexport default WinDetector;\n","import AutoDealer from \"./AutoDealer\";\nimport AutoSolver from \"./AutoSolver\";\nimport AutoUncoverer from \"./AutoUncoverer\";\nimport BoardNavigator from \"../Navigation/BoardNavigator\";\nimport Dealer from \"./Dealer\";\nimport FailDetector from \"./FailDetector\";\nimport React from \"react\";\nimport WinDetector from \"./WinDetector\";\n\nconst Actors = () => {\n    return (\n        <>\n            <Dealer />\n            <BoardNavigator />\n            <AutoSolver />\n            <WinDetector />\n            <FailDetector />\n            <AutoDealer />\n            <AutoUncoverer />\n        </>\n    );\n};\n\nexport default Actors;\n","import React from \"react\";\nimport { WindowDimensionContext } from \"./AspectRatio/AspectRatio\";\nimport { usePreview } from \"react-dnd-preview\";\n\nconst DndPreview = (props: { reff: HTMLElement }) => {\n    const [rect, setRect] = React.useState<{ left: number; top: number }>();\n    const { width, height } = React.useContext(WindowDimensionContext);\n    React.useEffect(() => {\n        const domRect = props.reff.getBoundingClientRect();\n        setRect({\n            left: domRect.left * -1,\n            top: domRect.top * -1,\n        });\n        //@todo introduce resizeContext that we can subscribe to, so we only recalculate the BoundingClientRect of the container when window was resized\n    }, [props.reff, width, height]);\n    const { display, item, style } = usePreview();\n    if (!display || !rect || !item) {\n        return null;\n    }\n    return (\n        <div\n            style={{\n                ...style,\n                position: \"relative\",\n                width: \"100%\",\n                left: rect.left,\n                top: rect.top,\n                zIndex: 2000,\n                opacity: 1,\n            }}\n        >\n            {item.render}\n        </div>\n    );\n};\n\nexport default DndPreview;\n","import React from \"react\";\nimport confetti from \"canvas-confetti\";\n\nconst Firework = (props: { intensity: number }) => {\n    const canvasRef = React.createRef<HTMLCanvasElement>();\n    React.useEffect(() => {\n        if (canvasRef && canvasRef.current && props.intensity) {\n            const count = 15 * props.intensity;\n            const origin = {\n                x: 0.5,\n                y: 0.33,\n            };\n\n            const scalar = window.innerWidth / (1080 / 100) / 100;\n            const defaults = {\n                ticks: 50,\n                origin,\n                particleCount: 40,\n                startVelocity: scalar * 20,\n                decay: 0.8,\n                spread: 360,\n                scalar: scalar,\n            };\n            const localConfetti = confetti.create(canvasRef.current, { resize: true });\n\n            const fire = (particleRatio: number, opts: confetti.Options) => {\n                localConfetti(\n                    Object.assign({}, defaults, opts, {\n                        particleCount: Math.floor(count * particleRatio),\n                    })\n                );\n            };\n\n            fire(0.25, {\n                startVelocity: scalar * 55,\n            });\n            fire(0.2, {\n                decay: 1.2,\n            });\n            fire(0.35, {\n                decay: 0.91,\n                scalar: scalar - 0.2,\n            });\n            fire(0.1, {\n                startVelocity: scalar * 25,\n                decay: 0.92,\n                scalar: scalar + 0.2,\n            });\n            fire(0.1, {});\n            fire(0.1, {\n                startVelocity: scalar * 45,\n            });\n        }\n    }, [canvasRef, props.intensity]);\n\n    return <canvas ref={canvasRef}></canvas>;\n};\n\nexport default Firework;\n","import CardModel from \"../../Model/Deck/Card\";\nimport Firework from \"./Firework\";\nimport React from \"react\";\nimport useGlobalContext from \"../GlobalContext\";\n\nconst CardFirework = (props: { model: CardModel }) => {\n    const { state, updateContext } = useGlobalContext();\n\n    React.useEffect(() => {\n        if (props.model.success && state.settings.featureSwitches.confetti) {\n            const timeout = setTimeout(() => updateContext((ctx) => ctx.clearSuccess(props.model)));\n            return () => clearTimeout(timeout);\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [props.model.success]);\n    if (!state.settings.featureSwitches.confetti) {\n        return null;\n    }\n    return <Firework intensity={props.model.success} />;\n};\n\nexport default CardFirework;\n","import React, { MouseEventHandler, useCallback } from \"react\";\n\nimport CardFirework from \"./CardFirework\";\nimport CardModel from \"../../Model/Deck/Card\";\nimport GameModes from \"../../GameModes\";\nimport Icon from \"@mdi/react\";\nimport { getEmptyImage } from \"react-dnd-html5-backend\";\nimport { useBoardContext } from \"../Context/BoardContext\";\nimport { useDrag } from \"react-dnd\";\nimport useGlobalContext from \"../GlobalContext\";\nimport usePauseContext from \"../Context/PauseContext\";\n\nconst useCardStyle = (model: CardModel | null, props: CardProps, _isDrag: () => boolean, opacity: any) => {\n    const getCardStyle = useCallback(() => {\n        if (!model) {\n            return {};\n        }\n        const style = {\n            opacity: _isDrag() ? 0 : opacity,\n            zIndex: (props.zIndex ? props.zIndex : (props.offsetTop && props.offsetTop(props.index, props.models) > 0 ? 1 : 0) * 20) + 1,\n            top: props.offsetTop ? props.offsetTop(props.index, props.models) / 15 + \"em\" : 0,\n            ...model.entropyStyle,\n        };\n\n        //move to left on waste (triple draw)\n        if (props.offsetLeft) {\n            style.left = props.offsetLeft(props.index) * 2 + \"em\";\n        }\n\n        if (!model.onClick) {\n            style.pointerEvents = \"none\";\n        }\n\n        return style;\n    }, [model, props, _isDrag, opacity]);\n\n    const [cardStyle, setCardStyle] = React.useState<any>(getCardStyle());\n\n    React.useEffect(() => {\n        setCardStyle(getCardStyle);\n    }, [getCardStyle]);\n    return cardStyle;\n};\n\n//@todo this makes the card flash when placing on green table. class is first assigned empty\nconst useClassName = (model: CardModel | null, props: CardProps, _isDrag: () => boolean, isFocused: () => boolean) => {\n    const getClassName = useCallback(() => {\n        if (!model) {\n            return \"card card-base\";\n        }\n        const hasSuggestion = (props.isSuggested && props.isSuggested(props.index)) || model.suggestion;\n        let className = `card card-base card-${model.type.color}`;\n        className +=\n            (!props.isSelected || !props.isSelected(props.index)) && !isFocused() && !hasSuggestion ? ` card-stack-${model.source}` : \"\";\n        className += !_isDrag() && props.isSelected && props.isSelected(props.index) && !_isDrag() ? \" card-selected\" : \"\";\n        className += props.blink ? \" blink\" : \"\";\n        className += model.canClick() ? \" clickable\" : \"\";\n        className += hasSuggestion && !isFocused() ? \" card-suggested\" : \"\";\n        className += isFocused() ? \" card-focused\" : \"\";\n        return className;\n    }, [_isDrag, isFocused, model, props]);\n\n    const [className, setClassName] = React.useState<string>(getClassName());\n\n    React.useEffect(() => {\n        setClassName(getClassName());\n    }, [getClassName]);\n\n    return className;\n};\n\nconst useStackBaseStyle = (model: CardModel | null) => {\n    const getStackbaseStyle: () => React.CSSProperties = useCallback(() => {\n        if (!model || !model.onClick) {\n            return { pointerEvents: \"none\" };\n        }\n\n        return {};\n    }, [model]);\n\n    const [stackbaseStyle, setStackbaseStyle] = React.useState<any>(getStackbaseStyle());\n\n    React.useEffect(() => {\n        setStackbaseStyle(getStackbaseStyle());\n    }, [getStackbaseStyle]);\n    return stackbaseStyle;\n};\n\ntype CardProps = {\n    index: number;\n    models: CardModel[];\n    isSuggested?: (index: number) => boolean | undefined;\n    isSelected?: (index: number) => boolean;\n    blink?: number;\n    zIndex?: number;\n    offsetTop?: (index: number, models: CardModel[]) => number;\n    offsetLeft?: (index: number) => number;\n    isDrag?: boolean;\n};\n\nconst ReRender = (props: CardProps) => (\n    <Card\n        {...{\n            ...props,\n            models: props.models.slice(props.index, props.models.length),\n            offsetLeft: () => 0,\n            isSelected: () => false,\n            index: 0,\n        }}\n    />\n);\nReRender.displayName = \"ReRender\";\n\nconst Card = (props: CardProps) => {\n    const { player } = useBoardContext();\n    const { state, updateGameContext } = useGlobalContext();\n    const pause = usePauseContext();\n    const inputEl = React.useRef<HTMLButtonElement>(null);\n    const [isDrag, setDrag] = React.useState<boolean>(!!props.isDrag);\n    const model: CardModel = props.models[props.index];\n    const isFocused = useCallback(() => (!!model && state.focus.hasCard(model)) || false, [model, state.focus]);\n    const _isDrag = useCallback(() => props.isDrag || isDrag, [props.isDrag, isDrag]);\n    const [{ opacity }, dragRef, preview] = useDrag({\n        type: \"card\",\n        item: (_monitor) => {\n            setDrag(true);\n            if (model.onClick && (!props.isSelected || !props.isSelected(props.index))) {\n                updateGameContext((context) => {\n                    model.onClick({ isKeyboard: false })(context);\n                });\n            }\n            return { type: \"card\", model: model, render: ReRender(props) };\n        },\n        collect: (monitor) => {\n            return { opacity: monitor.isDragging() ? 1 : 1 };\n        },\n        canDrag: () => model.canClick() && !model.isHidden && (state.hand.currentCard() === null || model.equals(state.hand.currentCard())),\n\n        end: (_item, monitor) => {\n            setDrag(false);\n            if (!monitor.didDrop()) {\n                setTimeout(\n                    () =>\n                        updateGameContext((context) => {\n                            model.onClick({ isKeyboard: false })(context);\n                        }),\n                    1\n                );\n            }\n        },\n    });\n\n    //Deactivate native dnd preview - it's fast but it's not working on mobile.\n    React.useEffect(() => {\n        preview(getEmptyImage(), { captureDraggingState: true });\n    }, [preview]);\n\n    const getRef = useCallback(() => (model.canClick() ? dragRef : inputEl), [inputEl, model, dragRef]);\n\n    const onClick: MouseEventHandler<HTMLButtonElement> = (e) => {\n        e.preventDefault();\n        //@todo catch all focuses in hidden input element on board\n        //then remove isKeyboard logic from card\n        //tab nav wont be supported\n        const isKeyBoard = e.clientX === 0 && e.clientY === 0;\n        let ele = e.target as HTMLElement;\n\n        while (ele && !ele.className.includes(\"card-base\") && ele.offsetParent) {\n            ele = ele.offsetParent as HTMLElement;\n        }\n\n        const rect = ele.getBoundingClientRect();\n\n        const position = {\n            isKeyBoard,\n            click: {\n                x: e.clientX - (ele?.ownerDocument?.defaultView?.pageXOffset || 0),\n                y: e.clientY - (ele?.ownerDocument?.defaultView?.pageYOffset || 0),\n            },\n            element: {\n                x: rect.x,\n                y: rect.y,\n            },\n        };\n\n        // When clicking on a card, move the focus (switch from keyboard to mouse nav)\n        // @todo do the same on drag start\n        const isSinglePlayer = state.settings.launchSettings.boardMode === GameModes.SINGLEPLAYER;\n        if (model.onClick && !position.isKeyBoard) {\n            updateGameContext((context) => {\n                model.onClick(position)(context);\n                if (isSinglePlayer) {\n                    context.settings.launchSettings.players[player].inputMethod = \"mouse\";\n                }\n            });\n        }\n    };\n\n    const className = useClassName(model, props, _isDrag, isFocused);\n    const cardStyle = useCardStyle(model, props, _isDrag, opacity);\n    const stackbaseStyle = useStackBaseStyle(model);\n\n    // @todo 3d flip https://3dtransforms.desandro.com/card-flip on unhide\n    // https://medium.com/hackernoon/5-ways-to-animate-a-reactjs-app-in-2019-56eb9af6e3bf\n    //@todo entropy as animated effect, triggered after rendering of action\n\n    if (!props.models.length) {\n        return null;\n    }\n\n    //@todo creating a custom layout was fun, but the users deserve a more professional looking SVG\n    //e.g. https://totalnonsense.com/download/download-vector-playing-cards/\n\n    const SuitIcon = () => (\n        <div className=\"align-center\">\n            <Icon size=\"0.8em\" color={model.type.color} path={model.type.icon} />\n        </div>\n    );\n\n    return (\n        <>\n            <div style={stackbaseStyle} className=\"stack-base\">\n                <button\n                    style={cardStyle}\n                    ref={getRef()}\n                    className={className}\n                    onClick={onClick}\n                    disabled={!model.canClick() || !pause.state.showCards}\n                    tabIndex={model.canClick() ? 0 : -1}\n                >\n                    <CardFirework model={model} />\n                    <div className=\"card-content\">\n                        {model.isHidden || !pause.state.showCards ? (\n                            <div className=\"card-back\">&nbsp;</div>\n                        ) : (\n                            <div className=\"card-grid-container\">\n                                <div>\n                                    <SuitIcon />\n                                </div>\n                                <div>\n                                    <div className=\"align-left\">{model.denomination}</div>\n                                </div>\n                                <div>&nbsp;</div>\n                                <div>\n                                    <SuitIcon />\n                                </div>\n                                <div className=\"mainface\">\n                                    <div className=\"align-center\">{model.denomination} </div>\n                                </div>\n                                <div>\n                                    <SuitIcon />\n                                </div>\n                                <div>&nbsp;</div>\n                                <div>\n                                    <div className=\"align-right\">{model.denomination}</div>\n                                </div>\n                                <div>\n                                    <SuitIcon />\n                                </div>\n                            </div>\n                        )}\n                    </div>\n                </button>\n            </div>\n            {props.models.length - 1 > props.index && <Card {...props} isDrag={_isDrag()} index={props.index + 1} />}\n        </>\n    );\n};\n\nexport default Card;\n","import React, { MouseEventHandler, useCallback } from \"react\";\n\nimport { IStack } from \"../../Model/Game/Stack\";\nimport useGlobalContext from \"../GlobalContext\";\n\nconst StackBase = (props: { model: IStack; children?: React.ReactNode }) => {\n    const { state, updateGameContext } = useGlobalContext();\n    \n    const getClassName = useCallback(() => {\n        let classname = \"card-base socket\";\n        if (!props.model.stack.length) {\n            if (props.model.blinkFor) {\n                classname += \" socket-blink\";\n            } else if (state.focus.hasStack(props.model.source)) {\n                classname += \" socket-focused\";\n            } else {\n                classname += \" socket-empty\";\n            }\n        } else {\n            classname += \" socket-full\";\n        }\n\n        if (props.model.suggestion && !props.model.stack.length) {\n            classname += \" socket-suggested\";\n        }\n        return classname;\n    }, [props.model.stack.length, props.model.suggestion, props.model.blinkFor, props.model.source, state.focus]);\n\n    const onClick: MouseEventHandler<HTMLButtonElement> = (e) => {\n        e.preventDefault();\n        const isKeyBoard = e.clientX === 0 && e.clientY === 0;\n        if (!isKeyBoard) {\n            updateGameContext(props.model.clickEmpty({ isKeyBoard }));\n        }\n    };\n\n    return (\n        <button\n            className={getClassName()}\n            onClick={onClick}\n            disabled={!!props.model.stack.length}\n            tabIndex={!props.model.stack.length ? 0 : -1}\n        >\n            {props.children}\n        </button>\n    );\n};\nexport default StackBase;\n","import { IStack } from \"../../../Model/Game/Stack\";\nimport Model from \"../../../Model/Model\";\nimport React from \"react\";\nimport useGlobalContext from \"../../GlobalContext\";\n\ntype _selector = (model: Model) => IStack;\n\nconst useBlinkEffect = (selector: _selector) => {\n    const { updateContext, state } = useGlobalContext();\n    const model = selector(state);\n    React.useEffect(() => {\n        let timeout: NodeJS.Timeout | null = null;\n        if (state && selector(state).blinkFor) {\n            timeout = setTimeout(\n                () =>\n                    updateContext((state: Model) => {\n                        selector(state).unblink(state);\n                    }),\n                200\n            );\n        }\n        return () => {\n            timeout && clearTimeout(timeout);\n        };\n    }, [state, model.blinkFor, updateContext, selector]);\n};\n\nexport default useBlinkEffect;\n","import { IStack } from \"../../../Model/Game/Stack\";\nimport { useDrop } from \"react-dnd\";\nimport useGlobalContext from \"../../GlobalContext\";\n\nexport const useStackDrop = (model: IStack, accepts?: (c: any) => boolean) => {\n    const { updateGameContext } = useGlobalContext();\n    return useDrop({\n        accept: \"card\",\n        canDrop: (item: any) => {\n            return (accepts && accepts(item.model)) || model.accepts(item.model);\n        },\n        drop: () => {\n            updateGameContext(model.clickEmpty({ isKeyBoard: false }));\n        },\n    })[1];\n};\n","import Card from \"./Card\";\nimport FoundationStackModel from \"../../Model/Game/FoundationStack\";\nimport Hand from \"../../Model/Game/Hand\";\nimport Icon from \"@mdi/react\";\nimport React from \"react\";\nimport StackBase from \"./StackBase\";\nimport useBlinkEffect from \"./Hooks/useBlinkEffect\";\nimport useGlobalContext from \"../GlobalContext\";\nimport { useStackDrop } from \"./Hooks/useStackDrop\";\n\ntype FoundationProps = { index: number; model: FoundationStackModel; hand: Hand };\n\nconst Foundation = () => {\n    const { state } = useGlobalContext();\n    return (\n        <>\n            {state.foundation.stacks.map((foundation, index) => (\n                <FoundationStack key={index} model={foundation} index={index} hand={state.hand} />\n            ))}\n        </>\n    );\n};\n\nexport default Foundation;\n\nconst FoundationStack = (props: FoundationProps) => {\n    useBlinkEffect((model) => model.foundation.stacks[props.index]);\n    const model = props.model;\n    const drop = useStackDrop(props.model);\n    const cards = props.hand.source === model.source ? [...model.stack, ...props.hand.stack] : [...model.stack];\n    const classnames = \"board-field foundation foundation-\" + props.index;\n    return (\n        <div className={classnames} key={props.index} ref={drop}>\n            <StackBase model={model}>\n                <div className={\"align-center foundation-base suit-\" + model.icon}>\n                    <Icon path={model.icon} size=\"1em\" horizontal color={model.color} />\n                </div>\n            </StackBase>\n            <Card\n                index={0}\n                key={0}\n                models={cards}\n                blink={model.blinkFor}\n                isSuggested={(index) => model.suggestion && model.stack.length - 1 === index}\n                isSelected={(index) => index > model.stack.length - 1}\n            />\n        </div>\n    );\n};\n","import Icon from \"@mdi/react\";\nimport React from \"react\";\nimport { mdiClock } from \"@mdi/js\";\nimport useGameContext from \"../../Context/GameContext\";\nimport usePauseContext from \"../../Context/PauseContext\";\n\nconst Clock = () => {\n    const { state, getElapsed } = usePauseContext();\n    const { gameState } = useGameContext();\n    const [elapsed, setElapsed] = React.useState(\"\");\n    React.useEffect(() => {\n        const interval = setInterval(() => {\n            if (gameState.started && !state.paused) {\n                setElapsed(getElapsed());\n            }\n        }, 1000);\n\n        return () => clearInterval(interval);\n    }, [gameState.started, state.paused, getElapsed]);\n\n    return !gameState.started || !elapsed ? null : (\n        <div className=\"header-clock\">\n            <div className=\"icon-container\">\n                <Icon path={mdiClock} size=\".9em\" />\n            </div>\n            {elapsed}\n        </div>\n    );\n};\n\nexport default Clock;\n","import { mdiHeart, mdiHeartFlash, mdiHeartOff } from \"@mdi/js\";\n\nimport Icon from \"@mdi/react\";\nimport React from \"react\";\nimport useGlobalContext from \"../../GlobalContext\";\n\nconst Hearts = () => {\n    const { state } = useGlobalContext();\n    const getHearts = () => {\n        const _icon = (path: string) => <Icon path={path} size=\".9em\" />;\n        if (state.settings.launchSettings.recyclingMode === \"infinite\") {\n            return <Icon path={mdiHeartFlash} size=\".9em\" />;\n        }\n\n        if (state.settings.launchSettings.recyclingMode === \"1-pass\") {\n            return state.stock.passes > 0 ? _icon(mdiHeart) : _icon(mdiHeartOff);\n        }\n\n        if (state.settings.launchSettings.recyclingMode === \"3-pass\") {\n            const createString = (length: number, icon: string) => Array.from(new Array(length).keys()).map((i) => _icon(icon));\n            return [...createString(state.stock.passes, mdiHeart), ...createString(3 - state.stock.passes, mdiHeartOff)];\n        }\n        return null;\n    };\n    return <div className=\"heart-container\">{getHearts()}</div>;\n};\nexport default Hearts;\n","import Icon from \"@mdi/react\";\nimport Model from \"../../../Model/Model\";\nimport React from \"react\";\nimport { mdiLightbulb } from \"@mdi/js\";\nimport useGlobalContext from \"../../GlobalContext\";\n\nconst Hint = () => {\n    const { state, updateContext } = useGlobalContext();\n    const isVisible = (state: Model) => state.settings.suggestionMode.supportsHints || state.settings.suggestionMode.isTemporary;\n\n    const isDisabled = (state: Model) => state.settings.suggestionMode.isTemporary;\n\n    const suggestOnce = () =>\n        updateContext((state) => {\n            if (isVisible(state) && !isDisabled(state)) {\n                state.settings.enableHint();\n            }\n        });\n\n    return !isVisible(state) ? null : (\n        <div>\n            <button title=\"Hint\" onClick={() => suggestOnce()} disabled={isDisabled(state)}>\n                <span className=\"icon\">\n                    {\" \"}\n                    <Icon path={mdiLightbulb} size=\".9em\" />\n                </span>\n            </button>\n        </div>\n    );\n};\nexport default Hint;\n","import Icon from \"@mdi/react\";\nimport React from \"react\";\nimport { mdiTrophy } from \"@mdi/js\";\nimport { toast } from \"react-toastify\";\nimport useGlobalContext from \"../../GlobalContext\";\n\nconst Points = () => {\n    const { state } = useGlobalContext();\n    const showToast = () => {\n        toast.info(\n            <ul>\n                {state.game.rating.ratings.reverse().map((rating, index) => (\n                    <li key={index}>\n                        {rating.points} - {rating.text}\n                    </li>\n                ))}\n            </ul>,\n            { autoClose: false }\n        );\n    };\n    return (\n        <div>\n            <button title=\"Points\" onClick={showToast}>\n                <span className=\"icon\">\n                    <Icon path={mdiTrophy} size=\".9em\" />\n                </span>\n            </button>\n            {state?.game.rating.points}\n        </div>\n    );\n};\n\nexport default Points;\n","import React from \"react\";\nimport { useBoardContext } from \"../../Context/BoardContext\";\nimport usePauseContext from \"../../Context/PauseContext\";\n\nconst ToggleMenu = () => {\n    const paused = usePauseContext();\n    const { player } = useBoardContext();\n\n    return paused.state.showMenu ? null : (\n        <div>\n            <button title=\"Settings\" onClick={() => paused.togglePause(!paused.state.paused, player)}>\n                <span className=\"icon\"></span>\n            </button>\n        </div>\n    );\n};\n\nexport default ToggleMenu;\n","import Icon from \"@mdi/react\";\nimport React from \"react\";\nimport { mdiArrowULeftBottom } from \"@mdi/js\";\nimport useGlobalContext from \"../../GlobalContext\";\n\nconst Undo = () => {\n    const { state, replaceContext } = useGlobalContext();\n\n    const undo = () =>\n        replaceContext((_state) => {\n            const previous = _state.game.timemachine.popPreviousState(state.game.timemachine.previousStates.length - 1, state);\n            if (previous) {\n                previous.game.rating.penalize(_state.game.rating);\n                return previous;\n            }\n            return null;\n        });\n\n    if (!state.game.timemachine.previousStates.length || !state.settings.featureSwitches.undo) {\n        return null;\n    }\n\n    return (\n        <div>\n            <button\n                disabled={!state.game.timemachine.previousStates.length}\n                title={\"Undo\"}\n                data-penalty={Math.pow(2, state.game.rating.multiplicator)}\n                onClick={undo}\n            >\n                <span className=\"icon\">\n                    <Icon path={mdiArrowULeftBottom} size=\".8em\" />\n                </span>\n            </button>\n        </div>\n    );\n};\n\nexport default Undo;\n","import \"./Header.css\";\n\nimport Clock from \"./Clock\";\nimport Hearts from \"./Hearts\";\nimport Hint from \"./Hint\";\nimport Points from \"./Points\";\nimport React from \"react\";\nimport ToggleMenu from \"./ToggleMenu\";\nimport Undo from \"./Undo\";\n\nconst Header = (props: {mode: string}) => (\n    <div className={\"header \" + props.mode}>\n        <div className=\"header-title\">\n            <Hearts />\n            <Points />\n        </div>\n        <Clock />\n        <div className=\"header-buttons header-right\">\n            <Hint />\n            <Undo />\n            <ToggleMenu />\n        </div>\n    </div>\n);\n\nexport default Header;\n","import \"./StartScreen/Menu.scss\";\n\nimport { Universal, getKeyboardLayout } from \"../../common/KeyboardLayouts\";\nimport { mdiDelete, mdiPlay, mdiRecycle, mdiSleep, mdiWeatherTornado, mdiWeatherWindy } from \"@mdi/js\";\nimport useNavigationContext, { NavigationProvider } from \"./StartScreen/Navigation/NavigationContext\";\n\nimport EntropyLevels from \"../../Model/Game/Settings/EntropyLevels\";\nimport GameModes from \"../../GameModes\";\nimport MenuButton from \"./StartScreen/Menu/MenuButton\";\nimport MenuTitle from \"./StartScreen/Menu/MenuTitle\";\nimport MenuTree from \"./StartScreen/Menu/MenuTree\";\nimport React from \"react\";\nimport SuggestionModes from \"../../Model/Game/Settings/SuggestionModes\";\nimport { XY } from \"./XY\";\nimport { useBoardContext } from \"../Context/BoardContext\";\nimport useGlobalContext from \"../GlobalContext\";\nimport usePauseContext from \"../Context/PauseContext\";\n\nconst _Menu = () => {\n    return (\n        <NavigationProvider>\n            <Menu />\n        </NavigationProvider>\n    );\n};\nconst Menu = () => {\n    const { state, updateContext, replaceContext, restart } = useGlobalContext();\n    const pause = usePauseContext();\n    const { player } = useBoardContext();\n    const reset = () => {\n        //this is a bad hack?\n        pause.togglePause(true, -1);\n        replaceContext((state) => (state.game.timemachine.previousStates ? state.game.timemachine.previousStates[0] : null));\n    };\n\n    //@todo persist game settings in local storage too if consented and use for initialization\n    const setSuggestionMode = (sm: string) => updateContext((state) => state.settings.setSuggestionMode(sm));\n    const setBaseEntropy = (lvl: number) => updateContext((state) => state.setEntropy(lvl));\n    const setInteractionEntropy = (lvl: number) => updateContext((state) => (state.settings.interactionEntropy = lvl));\n\n    const toggleMenu = () => {\n        pause.togglePause(false, -1);\n    };\n\n    const { navigation, setNavigation } = useNavigationContext();\n\n    const switchToMenu = (menu: string, pos: XY) =>\n        setNavigation({ ...navigation, focus: \"menu\", screeen: \"\", mainMenu: menu, menu: { ...pos } });\n\n    const toggleMainMenu = (val: string, pos: XY) => {\n        if (navigation.mainMenu !== val) {\n            switchToMenu(val, pos);\n        } else {\n            switchToMenu(\"\", pos);\n        }\n    };\n\n    if (!pause.state.showMenu) {\n        return null;\n    }\n\n    const remaining = pause.state.allowed - pause.state.pauses.length - 1;\n\n    let announcement = `You can pause the game ${remaining} more times.`;\n    if (remaining === 1) {\n        announcement = `You can pause the game ${remaining} more time.`;\n    }\n    if (remaining === 0) {\n        announcement = \"This is the last remaining pause. If you continue, no more pause will be possible.\";\n    }\n    if (remaining < 0) {\n        announcement = \"The game is not paused.\";\n    }\n\n    const isSinglePlayer = state.settings.launchSettings.boardMode === GameModes.SINGLEPLAYER;\n    const keyboardLayout = isSinglePlayer ? Universal : getKeyboardLayout(state.settings.launchSettings.players[player].inputLayout);\n\n    if (pause.state.pausedBy !== player) {\n        return (\n            <div className=\"gamemenu menu\">\n                <div className=\"startscreen-jail\">\n                    <div className=\"innermenu\">\n                        <MenuTitle icon={mdiSleep } />\n                        {pause.state.pausedBy}\n                        <div className=\"announcement\">{announcement}</div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"gamemenu menu\">\n            <div className=\"startscreen-jail\">\n                <div className=\"innermenu\">\n                    <MenuTitle icon={mdiSleep } />\n\n                    <div className=\"announcement\">{announcement}</div>\n                    <MenuTree keyboardLayout={keyboardLayout}>\n                        <MenuButton\n                            icon={mdiPlay}\n                            title=\"Resume\"\n                            onClick={() => {\n                                toggleMenu();\n                            }}\n                        />\n                        <MenuButton\n                            icon={state.settings.suggestionMode.icon}\n                            title={`Suggestions: ${state.settings.suggestionMode.label}`}\n                            onClick={() => {\n                                setSuggestionMode(SuggestionModes.next(state.settings.suggestionMode).key);\n                            }}\n                        />\n                        <MenuButton\n                            icon={mdiWeatherTornado}\n                            title=\"Entropy\"\n                            onClick={(pos: XY) => toggleMainMenu(\"entropy\", pos)}\n                            toggled={navigation.mainMenu === \"entropy\"}\n                        >\n                            <MenuButton\n                                icon={mdiWeatherTornado}\n                                title={`Base Entropy: ${EntropyLevels[state.settings.baseEntropy]}`}\n                                onClick={() => {\n                                    setBaseEntropy(\n                                        state.settings.baseEntropy < EntropyLevels.length - 1 ? state.settings.baseEntropy + 1 : 0\n                                    );\n                                }}\n                            />\n                            <MenuButton\n                                icon={mdiWeatherWindy}\n                                title={`Action Entropy: ${EntropyLevels[state.settings.interactionEntropy]}`}\n                                onClick={() => {\n                                    setInteractionEntropy(\n                                        state.settings.interactionEntropy < EntropyLevels.length - 1\n                                            ? state.settings.interactionEntropy + 1\n                                            : 0\n                                    );\n                                }}\n                            />\n                        </MenuButton>\n                        <MenuButton\n                            icon={mdiRecycle}\n                            title=\"Restart Game\"\n                            onClick={() => reset()}\n                            skip={!state.game.timemachine.previousStates.length}\n                        />\n                        <MenuButton icon={mdiDelete} title=\"Quit Game\" onClick={() => restart()} />\n                    </MenuTree>\n                </div>\n            </div>\n        </div>\n    );\n};\nexport default _Menu;\n","import Card from \"./Card\";\nimport React from \"react\";\nimport StackBase from \"./StackBase\";\nimport useBlinkEffect from \"./Hooks/useBlinkEffect\";\nimport useGlobalContext from \"../GlobalContext\";\n\nconst Stock = () => {\n    useBlinkEffect((model) => model.stock);\n    const context = useGlobalContext();\n\n    if (!context || !context.state) return null;\n\n    return (\n        <div className=\"board-field stock\">\n            <StackBase model={context.state.stock} />\n            <Card\n                index={0}\n                key={0}\n                models={context.state.stock.stack}\n                offsetTop={(index) => (index / 2) * -1}\n                zIndex={0}\n                blink={context?.state?.stock.blinkFor}\n                isSuggested={(index) => context?.state?.stock.suggestion && index === context.state.stock.stack.length - 1}\n            />\n        </div>\n    );\n};\n\nexport default Stock;\n","import Card from \"./Card\";\nimport CardModel from \"../../Model/Deck/Card\";\nimport Hand from \"../../Model/Game/Hand\";\nimport React from \"react\";\nimport StackBase from \"./StackBase\";\nimport TableauModel from \"../../Model/Game/Tableau\";\nimport TableauStackModel from \"../../Model/Game/TableauStack\";\nimport useBlinkEffect from \"./Hooks/useBlinkEffect\";\nimport useGlobalContext from \"../GlobalContext\";\nimport { useStackDrop } from \"./Hooks/useStackDrop\";\n\ntype TableauProps = { index: number; model: TableauStackModel; parent: TableauModel; hand: Hand };\n\nconst Tableau = () => {\n    const { state } = useGlobalContext();\n    return (\n        <>\n            {state.tableau.stacks.map((tableau, index) => (\n                <TableauStack key={index} index={index} model={tableau} parent={state.tableau} hand={state.hand} />\n            ))}\n        </>\n    );\n};\nexport default Tableau;\n\nconst TableauStack = (props: TableauProps) => {\n    useBlinkEffect((s) => s.tableau.stacks[props.index]);\n    const drop = useStackDrop(props.model);\n    const cards = props.hand.source === props.model.source ? [...props.model.stack, ...props.hand.stack] : [...props.model.stack];\n    let offset = 1;\n    const getOffset = (index: number, cards: CardModel[]) => {\n        for (let i = 0; i <= index; i++) {\n            if (cards[i] && !cards[i].isHidden) {\n                offset = i * 12 + (index - i) * 24;\n                return offset;\n            }\n        }\n        offset = index * 12;\n        return offset;\n    };\n\n    const classNames = \"board-field tableau tableau-\" + props.index\n\n    return (\n        <div className={classNames} ref={drop}>\n            <StackBase model={props.model} />\n            <Card\n                index={0}\n                key={0}\n                models={cards}\n                blink={props.model.blinkFor}\n                isSuggested={(index) => props.model.suggestion && props.model.stack.length - 1 === index}\n                offsetTop={(index, models) => getOffset(index, models)}\n                isSelected={(index) => index > props.model.stack.length - 1}\n            />\n        </div>\n    );\n};\n","import Card from \"./Card\";\nimport React from \"react\";\nimport StackBase from \"./StackBase\";\nimport useBlinkEffect from \"./Hooks/useBlinkEffect\";\nimport useGlobalContext from \"../GlobalContext\";\nimport { useStackDrop } from \"./Hooks/useStackDrop\";\n\nconst Waste = () => {\n    const { state } = useGlobalContext();\n    useBlinkEffect((model) => model.waste);\n    const getOffset = (index: number) => {\n        if (state.settings.launchSettings.drawMode === \"single\") {\n            return 0;\n        }\n        const length = state.hand.isHoldingCard() && state.hand.isFromWaste() ? state.waste.stack.length + 1 : state.waste.stack.length;\n        let additionalOffset = 2;\n        if (length === 2) {\n            additionalOffset = 1;\n        }\n\n        if (length === 1) {\n            additionalOffset = 0;\n        }\n\n        return ((index - length - 2) % 3) + additionalOffset;\n    };\n\n    const drop = useStackDrop(state.waste, () => state.hand.isFromWaste());\n\n    const cards = state?.hand.source === state.waste.source ? [...state.waste.stack, ...state.hand.stack] : [...state.waste.stack];\n\n    return (\n        <div className=\"board-field waste\" ref={drop}>\n            <StackBase model={state.waste} />\n            <Card\n                index={0}\n                key={0}\n                models={cards}\n                offsetTop={(index) => (index / 2) * -1}\n                offsetLeft={(index) => getOffset(index)}\n                blink={state.waste.blinkFor}\n                isSuggested={(index) => state.waste.suggestion && index === state.waste.stack.length - 1}\n                isSelected={(index) => index > state.waste.stack.length - 1}\n            />\n        </div>\n    );\n};\nexport default Waste;\n","import \"./Board.scss\";\nimport \"react-toastify/dist/ReactToastify.min.css\";\n\nimport { Slide, ToastContainer } from \"react-toastify\";\n\nimport Actors from \"./Actors/Actors\";\nimport DndPreview from \"../../common/DndPreview\";\nimport Foundation from \"./Foundation\";\nimport Header from \"../UI/Header/Header\";\nimport Menu from \"../UI/Menu\";\nimport React from \"react\";\nimport Stock from \"./Stock\";\nimport Tableau from \"./Tableau\";\nimport Waste from \"./Waste\";\n\ntype BoardProps = { mode: string };\nconst Board = (props: BoardProps) => {\n    const ref = React.useRef<HTMLDivElement>(null);\n    return (\n        <>\n            <Menu />\n            <Header mode={props.mode} />\n            <ToastContainer\n                style={{ zIndex: 8888 }}\n                position=\"top-center\"\n                closeOnClick={false}\n                newestOnTop={true}\n                limit={1}\n                pauseOnFocusLoss={false}\n                draggable={false}\n                transition={Slide}\n            />\n            <div className={\"board-jail \" + props.mode}>\n                <div className={\"board-grid-container \" + props.mode}>\n                    <Stock />\n                    <Waste />\n                    <div className=\"board-field spacer\" ref={ref}>\n                        {ref.current && <DndPreview reff={ref.current} />}\n                    </div>\n                    <Foundation />\n                    <Tableau />\n                </div>\n            </div>\n            <Actors />\n        </>\n    );\n};\n\nexport default Board;\n","import \"./Screens.scss\";\n\nimport React from \"react\";\nimport useGlobalContext from \"../GlobalContext\";\nimport usePauseContext from \"../Context/PauseContext\";\n\nconst EndScreen = () => {\n    const { state, restart } = useGlobalContext();\n    const pause = usePauseContext();\n    //@todo show launch settings (draw mode, recycling mode)\n    //@todo show win or lose situation\n    //@todo how to persist the result? from here?\n    // Or track it via context from beginning on?\n\n    //@todo use new ui elements\n    return !state.game.isEnded ? null : (\n        <div className=\"ui neutral endscreen\">\n            <div className=\"title\"></div>\n            <div className=\"content\">\n                <div>Time: {pause.getElapsed()}</div>\n                <div>Points: {state.game.rating.points}</div>\n                <div>Time Penalty: {state.game.rating.getTimePenalty(state.game.started, state.game.end || Date.now())}</div>\n                <div>Bonus Points: {state.game.rating.getBonusPoints(state.game.started, state.game.end || Date.now())}</div>\n                <div>Total Points: {state.game.rating.getTotal(state.game.started, state.game.end || Date.now())}</div>\n                <div>\n                    <button onClick={restart}>\n                        <div>New Game</div>\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default EndScreen;\n","import { LaunchSettings, StateReplacer, StateUpdater } from \"../../Common\";\n\nimport Board from \"./Board\";\nimport { BoardProvider } from \"../Context/BoardContext\";\nimport Deck from \"../../Model/Deck/Deck\";\nimport EndScreen from \"../UI/EndScreen\";\nimport Model from \"../../Model/Model\";\nimport { Provider } from \"../GlobalContext\";\nimport React from \"react\";\n\ninterface BoardWrapProps {\n    settings: LaunchSettings;\n    restart: () => void;\n    deck: Deck;\n    player: number;\n}\n\n//We use class component here because setState allows partial updates\n//in theory, useState supports partial updates and bailouts too but needs testing of Object.is compatibility on Model \nexport default class BoardWrap extends React.Component<BoardWrapProps, Model> {\n    constructor(props: BoardWrapProps) {\n        super(props);\n        this.state = Model.getInitialState(props.settings, props.deck, props.player);\n    }\n\n    //replacecontext is hard replacement, for restart and undo\n    replaceContext = (modifier: StateReplacer) => this.setState(modifier);\n\n    //updatecontext is soft replacement used for navigation.\n    updateContext = (modifier: StateUpdater) =>\n        this.replaceContext((state) => {\n            modifier(state);\n            return state;\n        });\n\n    //updateGameContext is for undo-able game actions\n    updateGameContext = (modifier: StateUpdater) =>\n        this.replaceContext((state) => {\n            state.game.timemachine.modified = false;\n            const previous = Model.copy(state);\n            if (previous.game.timemachine.previousStates.length) {\n                previous.game.timemachine.previousStates = [\n                    //@todo this also assigns non-memorable states\n                    //@todo instead of array, always have single previous state\n                    //@todo this could still grow too big in memory\n                    //@todo implement model.boardEquals and pointsEquals to get rid of 'memorable' states?\n                    previous.game.timemachine.previousStates[previous.game.timemachine.previousStates.length - 1],\n                ];\n            } else {\n                previous.game.timemachine.previousStates = [];\n            }\n\n            modifier(state);\n            if (state.game.timemachine.modified) {\n                state.game.timemachine.pushPreviousState(previous);\n                state.setToken(Math.random());\n                return state;\n            }\n\n            return null;\n        });\n\n    //on every render, we refresh the click handlers in the model and the suggestions\n    render = () => {\n        const context = {\n            state: this.state.withHandlers().withSuggestions(),\n            replaceContext: this.replaceContext,\n            updateContext: this.updateContext,\n            updateGameContext: this.updateGameContext,\n            restart: this.props.restart,\n        };\n        return (\n            <Provider value={context}>\n                <BoardProvider value={{ player: this.props.player }}>\n                    <Board mode={this.props.settings.boardMode} />\n                </BoardProvider>\n                <EndScreen />\n            </Provider>\n        );\n    };\n}\n","import AspectRatio from \"../../common/AspectRatio/AspectRatio\";\nimport BoardWrap from \"./BoardWrap\";\nimport Deck from \"../../Model/Deck/Deck\";\nimport DelayedSuspense from \"../../common/DelayedSuspense\";\nimport { GameContextProvider } from \"../Context/GameContext\";\nimport GameModes from \"../../GameModes\";\nimport { LaunchSettings } from \"../../Common\";\nimport { PauseProvider } from \"../Context/PauseContext\";\nimport Ratios from \"../../common/AspectRatio/Ratios\";\nimport React from \"react\";\n\ninterface GameProps {\n    launchState: LaunchSettings;\n    deck: Deck;\n    restart: () => void;\n}\n\nconst SinglePlayer = (props: GameProps) => {\n    const { launchState, deck, restart } = props;\n    return (\n        <AspectRatio ratio={Ratios._4to3}>\n            <div className={\"layout-grid-container \" + launchState.boardMode}>\n                <BoardWrap player={0} settings={launchState} restart={restart} deck={deck} />\n            </div>\n        </AspectRatio>\n    );\n};\n\nconst SplitScreen = (props: GameProps) => {\n    const { launchState, deck, restart } = props;\n    const Wrap = (i: number) => (\n        <div className={\"layout-grid-container \" + launchState.boardMode}>\n            <BoardWrap player={i} settings={launchState} restart={restart} deck={deck.copy()} />\n        </div>\n    );\n\n    return (\n        <div className=\"game-layout-container splitscreen\">\n            {Wrap(0)}\n            {Wrap(1)}\n        </div>\n    );\n};\n\nconst Game = (props: GameProps) => {\n    return (\n        <GameContextProvider>\n            <PauseProvider>\n                <DelayedSuspense delay={500} fallback={<h3>Loading...</h3>}>\n                    {props.launchState.boardMode === GameModes.SINGLEPLAYER && <SinglePlayer {...props} />}\n                    {props.launchState.boardMode === GameModes.VERSUS && <SplitScreen {...props} />}\n                </DelayedSuspense>\n            </PauseProvider>\n        </GameContextProvider>\n    );\n};\n\nexport default Game;\n"],"names":["defaultGameState","started","isEnded","end","winner","loser","GameContext","React","gameState","win","start","giveUp","useGameContext","GameContextProvider","props","setGameState","context","player","Date","now","Provider","value","children","defaultValue","state","replaceContext","updateContext","updateGameContext","restart","GlobalContext","useGlobalContext","ctx","Error","defaultPauseState","paused","pauses","pauseStartedAt","allowed","pausedBy","showMenu","showCards","defaultPauseContext","togglePause","toggleMenu","getElapsed","PauseContext","PauseProvider","setPaused","isPaused","length","show","padleft","i","msec","getElapsedMs","reduce","a","b","hh","Math","floor","mm","ss","usePauseContext","AutoDealerRenderer","previous","usePrevious","timeout","settings","launchSettings","speed","setTimeout","stock","stack","passes","waste","hand","isFromWaste","putDownHand","addAll","popTop","canRecycle","recycle","clearTimeout","AutoDealer","pause","Blinker","startBlink","selector","blinkFor","game","registerBlink","unblink","s","stopBlink","Tableau","blink","index","tableau","stacks","dispatchPutDown","card","position","wouldAcceptHand","src","source","registerMove","getTop","dispatchPickup","pickUp","popWithFollowing","registerPickup","TableauHidden","tryUncover","isHoldingCard","isHidden","uncover","registerUncover","Dealer","dealt","dealingAt","isDealt","dealOne","callback","dealer","deal","dealAll","newCard","popOne","isFirst","this","Dispatcher","clickHandler","getHandler","Focus","keyboard","validSettings","players","inputMethod","isKeyBoard","isKeyboard","setCard","unsetCard","Card","unsetStack","setStack","hasCard","hasStack","BasicStack","suggestion","getClickable","filter","canClick","onClick","clickEmpty","accepts","HandHoldingStack","getHandContent","FoundationStack","suit","acceptedCards","usedCards","icon","color","getCurrentAccepted","currentAccepted","type","denomination","setOnClick","p","cards","forEach","sindex","getFoundationOrder","MultiStack","Foundation","Object","keys","Suits","map","key","c","hasMoreThanOneCard","currentCard","add","putDown","causeEntropy","min","interactionEntropy","push","pop","remove","equals","getPreviousUsed","countCards","f","setEntropy","lvl","element","copy","orig","origStack","foundation","_card","Rating","points","multiplicator","ratings","applyRating","text","console","debug","target","registerHint","disableHint","currentMove","rateMove","registerRecycle","drawMode","recyclingMode","diff","setSuccess","penalize","other","undoPenalty","penalty","pow","done","hintPenalty","getTimePenalty","secondsToFinish","trunc","getBonusPoints","round","getTotal","on","missPenalty","move","isTableau","obj","substr","isFoundation","TimeMachine","previousStates","memorable","modified","pushPreviousState","modelEquals","popPreviousState","id","current","isRequested","popPrevious","timemachine","stackEquals","every","stacksEqual","Game","rating","Hand","splice","model","_onClick","isHoldingKing","isFromCurrentSource","isFromFoundation","isFromTableau","isFromAnyTableau","substring","getTableauIndex","parseInt","Navigator","currentIndex","rows","getZindex","elem","targets","update","pos","row","j","zIndex","x","y","z","finishNav","valid","moveLeft","moveRight","direction","moveUp","clickable","toggleRow","moveDown","pickLast","last","focus","pressCurrent","before","navigator","undefined","Settings","baseEntropy","suggestionModes","suggestionMode","featureSwitches","setSuggestionMode","sm","SuggestionModes","enableHint","isTemporary","next","Stock","recyclings","reverse","setCardProperties","isOnTop","result","top","_position","moveToWaste","recycleWaste","Waste","Suggestions","evaluateOptions","disableAllSuggestions","getUncoverOptions","getPutdownSuggestions","getPickupOptions","onlyUseful","accepted","isMoveOfKingBetweenEmptySlots","isMoveBetweenSimilarParentCards","isNotLoop","foundAny","wasteState","Model","cardIndex","tableauState","filtered","_stack","disableSuggestion","TableauStack","range","getTableauOrder","indexOf","offset","canUncover","onClickhidden","click","getStack","canPutDown","getCard","stackEntropy","entropy","concat","canAdd","suggestor","token","setToken","withSuggestions","_hasSuggestion","some","hasNonStockSuggestions","hasSuggestions","canAutoSolve","clearSuccess","clear","_c","success","withHandlers","StockHandler","WasteHandler","FoundationHandler","TableauHandler","getInitialState","deck","RenderAutoSolve","solving","setSolving","canAutosolve","Solver","AutoSolver","suggestedFoundations","suggestedFoundation","suggestedTableaus","suggestedCards","suggestedCard","useTokenEffect","Uncoverer","AutoUncoverer","autoUncover","BoardContext","useBoardContext","BoardProvider","BoardGamePad","isGamePadDriven","isSinglePlayer","boardMode","GameModes","switchToGamePad","GamePad","layout","GamepadLayout","gamepadIndex","inputLayout","onLeft","onRight","onUp","onDown","onAction","onCancel","onHint","onUndo","onPause","onMenu","BoardKeyboard","isKeyboardDriven","Universal","getKeyboardLayout","switchToKeyboard","Keyboard","BoardNavigator","beforeFocused","handlers","modifier","handler","isVisible","supportsHints","isDisabled","undo","_state","useEffectOnce","timeouts","quickDeal","PossibleFailScreen","refused","since","setRefused","refuse","val","className","MenuTitle","mdiHandBackLeft","MenuTree","keyboardLayout","MenuButton","mdiPlay","title","mdiFlagOutline","FailDetector","any","nonStock","suggestions","setSuggestions","stockSuggestionCards","setStockSuggestionCards","isPossibleFail","setPossibleFail","Detector","WinDetector","Actors","DndPreview","rect","setRect","WindowDimensionContext","width","height","domRect","reff","getBoundingClientRect","left","usePreview","display","item","style","opacity","render","Firework","canvasRef","intensity","count","scalar","window","innerWidth","defaults","ticks","origin","particleCount","startVelocity","decay","spread","localConfetti","confetti","resize","fire","particleRatio","opts","assign","ref","CardFirework","ReRender","models","slice","offsetLeft","isSelected","displayName","inputEl","isDrag","setDrag","isFocused","useCallback","_isDrag","useDrag","_monitor","collect","monitor","isDragging","canDrag","_item","didDrop","dragRef","preview","getEmptyImage","captureDraggingState","getRef","useClassName","getClassName","hasSuggestion","isSuggested","setClassName","cardStyle","useCardStyle","getCardStyle","offsetTop","entropyStyle","pointerEvents","setCardStyle","stackbaseStyle","useStackBaseStyle","getStackbaseStyle","setStackbaseStyle","SuitIcon","size","path","e","preventDefault","clientX","clientY","ele","includes","offsetParent","ownerDocument","defaultView","pageXOffset","pageYOffset","disabled","tabIndex","StackBase","classname","useBlinkEffect","useStackDrop","useDrop","accept","canDrop","drop","classnames","horizontal","Clock","elapsed","setElapsed","interval","setInterval","clearInterval","mdiClock","Hearts","getHearts","_icon","mdiHeartFlash","mdiHeart","mdiHeartOff","createString","Array","from","Hint","suggestOnce","mdiLightbulb","Points","showToast","toast","autoClose","mdiTrophy","ToggleMenu","Undo","mdiArrowULeftBottom","Header","mode","Menu","useNavigationContext","navigation","setNavigation","switchToMenu","menu","screeen","mainMenu","remaining","announcement","mdiSleep","label","mdiWeatherTornado","toggleMainMenu","toggled","EntropyLevels","setBaseEntropy","mdiWeatherWindy","setInteractionEntropy","mdiRecycle","reset","skip","mdiDelete","_Menu","parent","classNames","getOffset","additionalOffset","Board","closeOnClick","newestOnTop","limit","pauseOnFocusLoss","draggable","transition","Slide","EndScreen","BoardWrap","setState","random","SinglePlayer","launchState","AspectRatio","ratio","Ratios","SplitScreen","Wrap","DelayedSuspense","delay","fallback"],"sourceRoot":""}