(this["webpackJsonpsolitaire-react"]=this["webpackJsonpsolitaire-react"]||[]).push([[0],{19:function(t,e,n){},20:function(t,e,n){},21:function(t,e,n){},22:function(t,e,n){},23:function(t,e,n){},24:function(t,e,n){},27:function(t,e,n){},28:function(t,e,n){},29:function(t,e,n){},30:function(t,e,n){},41:function(t,e,n){"use strict";n.r(e);var i=n(0),s=n(2),c=n(8),o=(n(19),n(20),{0:{id:0,name:"Player 1",inputMethod:"gamepad",inputLayout:0},1:{id:1,name:"Player 2",inputMethod:"keyboard",inputLayout:0}}),a=n(3),r=n(4),u=n(9),l=n(6),d=n(5),f=n(1),g=n.n(f),h=(n(21),n(22),n(23),function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t){var i;return Object(a.a)(this,n),(i=e.call(this,t)).state={width:0,height:0},i.updateWindowDimensions=i.updateWindowDimensions.bind(Object(u.a)(i)),i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"render",value:function(){var t=this.state.width>=this.state.height*this.props.ratio.multiplier?"landscape":"portrait";return Object(i.jsx)("div",{className:"appwrapper",children:Object(i.jsx)("div",{className:"appwrapper-".concat(this.props.ratio.prefix,"-")+t,children:Object(i.jsx)("div",{className:"appwrapper-".concat(this.props.ratio.prefix,"-")+t+"-inner",children:Object(i.jsx)("div",{className:"appwrapper-jail",children:this.props.children})})})})}}]),n}(g.a.Component)),p=(n(24),n(14)),b=n.n(p),j=function(t){return Object(i.jsx)(b.a,{gamepadIndex:t.gamepadIndex,onButtonDown:function(e){console.debug(e),"DPadLeft"==e&&t.onLeft&&t.onLeft(),"DPadRight"==e&&t.onRight&&t.onRight(),"DPadUp"==e&&t.onUp&&t.onUp(),"DPadDown"==e&&t.onDown&&t.onDown(),"A"==e&&t.onAction&&t.onAction(),"B"==e&&t.onCancel&&t.onCancel(),"X"==e&&t.onHint&&t.onHint(),"Y"==e&&t.onUndo&&t.onUndo(),"Start"==e&&t.onPause&&t.onPause(),"Back"==e&&t.onPause&&t.onMenu()},onConnect:function(t){console.debug("connected",t)},onDisconnect:function(t){console.debug("disconnected",t)},children:Object(i.jsx)("span",{})})},m={state:null,replaceContext:function(){},updateContext:function(){},updateGameContext:function(){},restart:function(){}},v=g.a.createContext(m),y=v.Provider,k=v,O=g.a.createContext({consented:!1,setConsented:function(){}}),x=O.Provider,C=function(t){var e=g.a.useContext(k).state,n=g.a.useContext(ee).player,s="gamepad"==e.settings.launchSettings.inputMode,c="singleplayer"===e.settings.launchSettings.boardMode,o=function(t){t.focus.isKeyBoard(!0),c&&(t.settings.launchSettings.inputMode="gamepad")};return c||s?Object(i.jsx)(j,{gamepadIndex:e.settings.launchSettings.players[n].inputLayout,onLeft:function(){return t.onLeft&&t.onLeft(o)},onRight:function(){return t.onRight&&t.onRight(o)},onUp:function(){return t.onUp&&t.onUp(o)},onDown:function(){return t.onDown&&t.onDown(o)},onAction:function(){return t.onAction&&t.onAction(o)},onCancel:function(){return t.onCancel&&t.onCancel(o)},onHint:function(){return t.onHint&&t.onHint(o)},onUndo:function(){return t.onUndo&&t.onUndo()},onPause:function(){return t.onPause&&t.onPause(o)},onMenu:function(){return t.onPause&&t.onMenu(o)},children:Object(i.jsx)("span",{})}):null},w=function(t){if(0==t)return S;if(1==t)return M;if(2==t)return E;throw"Unknown keyboard layout ID"},M={up:function(t){return 38==t.keyCode},down:function(t){return 40==t.keyCode},right:function(t){return 39==t.keyCode},left:function(t){return 37==t.keyCode},cancel:function(t){return 27==t.keyCode},action:function(t){return 96==t.keyCode},undo:function(t){return 90==t.keyCode&&t.ctrlKey},hint:function(t){return 72==t.keyCode},pause:function(t){return 80==t.keyCode},menu:function(t){return 77==t.keyCode}},S={up:function(t){return 87==t.keyCode},down:function(t){return 83==t.keyCode},right:function(t){return 68==t.keyCode},left:function(t){return 65==t.keyCode},cancel:function(t){return 69==t.keyCode},action:function(t){return 81==t.keyCode},undo:function(t){return 88==t.keyCode},hint:function(t){return 90==t.keyCode},pause:function(t){return 999==t.keyCode},menu:function(t){return 27==t.keyCode}},E={up:function(t){return 104==t.keyCode},down:function(t){return 101==t.keyCode},right:function(t){return 102==t.keyCode},left:function(t){return 100==t.keyCode},cancel:function(t){return 105==t.keyCode},action:function(t){return 103==t.keyCode},undo:function(t){return 98==t.keyCode},hint:function(t){return 97==t.keyCode},pause:function(t){return 999==t.keyCode},menu:function(t){return 99==t.keyCode}},N={up:function(t){return E.up(t)||S.up(t)||M.up(t)},down:function(t){return E.down(t)||S.down(t)||M.down(t)},right:function(t){return E.right(t)||S.right(t)||M.right(t)},left:function(t){return E.left(t)||S.left(t)||M.left(t)},cancel:function(t){return E.cancel(t)||S.cancel(t)||M.cancel(t)},action:function(t){return E.action(t)||S.action(t)||M.action(t)},undo:function(t){return E.undo(t)||S.undo(t)||M.undo(t)},hint:function(t){return E.hint(t)||S.hint(t)||M.hint(t)},pause:function(t){return E.pause(t)||S.pause(t)||M.pause(t)},menu:function(t){return E.menu(t)||S.menu(t)||M.menu(t)}},P=function(t){var e=function(e){var n=window.event?event:e,i=t.layout;i.cancel(n)&&(t.onCancel&&t.onCancel(),e.preventDefault()),i.left(n)&&(t.onLeft&&t.onLeft(),e.preventDefault()),i.right(n)&&(t.onRight&&t.onRight(),e.preventDefault()),i.up(n)&&(t.onUp&&t.onUp(),e.preventDefault()),i.down(n)&&(t.onDown&&t.onDown(),e.preventDefault()),i.action(n)&&(t.onAction&&t.onAction(),e.preventDefault()),i.undo(n)&&(t.onUndo&&t.onUndo(),e.preventDefault()),i.hint(n)&&(t.onHint&&t.onHint(),e.preventDefault()),i.pause(n)&&(t.onPause&&t.onPause(),e.preventDefault()),i.menu(n)&&(t.onPause&&t.onMenu(),e.preventDefault())};return g.a.useEffect((function(){return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[t]),null},D=function(t){var e=g.a.useContext(k).state,n=g.a.useContext(ee).player,s="keyboard"===e.settings.launchSettings.inputMode,c="singleplayer"===e.settings.launchSettings.boardMode,o=c?N:w(e.settings.launchSettings.players[n].inputLayout),a=function(t){t.focus.isKeyBoard(!0),c&&(t.settings.launchSettings.inputMode="keyboard")};return s||c?Object(i.jsx)(P,{layout:o,onLeft:function(){return t.onLeft&&t.onLeft(a)},onRight:function(){return t.onRight&&t.onRight(a)},onUp:function(){return t.onUp&&t.onUp(a)},onDown:function(){return t.onDown&&t.onDown(a)},onAction:function(){return t.onAction&&t.onAction(a)},onCancel:function(){return t.onCancel&&t.onCancel(a)},onHint:function(){return t.onHint&&t.onHint(a)},onUndo:function(){return t.onUndo&&t.onUndo()},onPause:function(){return t.onPause&&t.onPause(a)},onMenu:function(){return t.onMenu&&t.onMenu(a)}}):null},T=n(7),R={started:0,end:0,paused:!1,pauses:[],pauseStartedAt:0,allowed:5,pausedBy:-1,showMenu:!1},F={state:R,togglePause:function(){}},A=g.a.createContext(F),L=A.Provider,H=function(t){var e=g.a.useState(Object(s.a)({},R)),n=Object(c.a)(e,2),o=n[0],a=n[1],r={state:Object(s.a)(Object(s.a)({},o),{},{started:t.started}),togglePause:function(t,e){o.showMenu?a(Object(s.a)(Object(s.a)({},o),{},{pausedBy:e,pauses:[].concat(Object(T.a)(o.pauses),[Date.now()-o.pauseStartedAt]),pauseStartedAt:0,paused:!1,showMenu:!1})):o.pauses.length<o.allowed?a(Object(s.a)(Object(s.a)({},o),{},{pausedBy:e,pauseStartedAt:Date.now(),paused:!0,showMenu:!0})):a(Object(s.a)(Object(s.a)({},o),{},{pausedBy:e,pauseStartedAt:0,paused:!1,showMenu:!0}))},getElapsed:function(){var e=function(t){return 1==(t+"").length?"0"+t:t},n=function(){var e=o.pauses.reduce((function(t,e){return t+e}),0);return(o.end||o.pauseStartedAt||Date.now())-t.started-e}(),i=Math.floor(n/1e3/60/60);n-=1e3*i*60*60;var s=Math.floor(n/1e3/60);n-=1e3*s*60;var c=Math.floor(n/1e3);return n-=1e3*c,i?i+":"+e(s)+":"+e(c):e(s)+":"+e(c)}};return Object(i.jsx)(L,{value:r,children:t.children})},U=A,I=function(){var t=g.a.useContext(k),e=t.state,n=t.updateContext,s=t.updateGameContext,c=t.replaceContext,o=g.a.useContext(U),a=g.a.useContext(ee).player,r={x:e.navigator.currentIndex.x,y:e.navigator.currentIndex.y,z:e.navigator.currentIndex.z},u=!!o.state.paused,l=function(t){return n((function(e){t(e),e.navigator.moveLeft(r)}))},d=function(t){return n((function(e){t(e),e.navigator.moveRight(r)}))},f=function(t){return n((function(e){t(e),e.navigator.moveUp(r)}))},h=function(t){return n((function(e){t(e),e.navigator.moveDown(r)}))},p=function(t){return s((function(n){t(n),e.navigator.pressCurrent()(n)}))},b=function(t){return n((function(e){t(e),e.hand.stack.length&&e.hand.stack[0].onClick({isKeyboard:!0})(e)}))},j=function(){return o.togglePause(u,a)},m=function(t){n((function(e){t(e),function(t){return t.settings.suggestionMode.supportsHints||t.settings.suggestionMode.isTemporary}(e)&&!function(t){return t.settings.suggestionMode.isTemporary}(e)&&e.settings.enableHint()}))},v=function(){c((function(t){var n=t.game.timemachine.popPreviousState(e.game.timemachine.previousStates.length-1,e);return n?(n.game.rating.penalize(t.game.rating),n):null}))},y=function(t){n((function(e){t(e)})),o.togglePause(u,a)};return u?null:Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(D,{onLeft:l,onRight:d,onUp:f,onDown:h,onAction:p,onCancel:b,onHint:m,onUndo:v,onPause:j,onMenu:y}),Object(i.jsx)(C,{onLeft:l,onRight:d,onUp:f,onDown:h,onAction:p,onCancel:b,onHint:m,onUndo:v,onPause:j,onMenu:y})]})},B=function(){var t=g.a.useContext(k),e=t.state,n=t.replaceContext,i=[];if(e.settings.launchSettings.quickDeal)e&&e.dealer&&!e.dealer.isDealt&&n(e.dealer.dealAll(e));else{var s=function t(s){i.push(setTimeout((function(){e&&e.dealer&&!e.dealer.isDealt&&n(e.dealer.dealOne(s,t))}),35))};g.a.useEffect((function(){return s(e.dealer.dealt),function(){return i.forEach((function(t){clearTimeout(t)}))}}),[]),g.a.useEffect((function(){}),[e.dealer.isDealt])}return null},q=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t){var i;return Object(a.a)(this,n),(i=e.call(this)).timeout=null,i.selector=t,i}return Object(r.a)(n,[{key:"componentDidUpdate",value:function(){var t=this;this.selector(this.context.state).blinkFor&&(this.timeout=setTimeout((function(){return t.context.updateGameContext((function(e){t.selector(e).unblink(e)}))}),200))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}}]),n}(f.Component);q.contextType=k;var G=function(t){var e=g.a.useContext(k),n=e.state,c=e.updateGameContext,o=g.a.useContext(U),a=g.a.useRef(null),r=n.focus.hasCard(t.model);g.a.useEffect((function(){r&&"singleplayer"==n.settings.launchSettings.boardMode&&a&&a.current&&a.current.focus()}),[r,n.focus.card]);var u=function(e){e.preventDefault();for(var i=0==e.clientX&&0==e.clientY,s=e.target;s&&!s.className.includes("card-base");)s=s.offsetParent;var o=s.getBoundingClientRect(),a={isKeyBoard:i,click:{x:e.clientX-s.ownerDocument.defaultView.pageXOffset,y:e.clientY-s.ownerDocument.defaultView.pageYOffset},element:{x:o.x,y:o.y}},r="singleplayer"===n.settings.launchSettings.boardMode;t.model.onClick&&!a.isKeyBoard&&c((function(e){t.model.onClick(a)(e),r&&(e.settings.launchSettings.inputMode="mouse")}))},l=[0,1,2,3,4,5,6].map((function(t){return" stack "+(t+1)})),d="",f=t.model.source.split("-");return d+=f[0],f.length>1&&(d+=l[f[1]]),d+=": ",d+=t.model.isHidden?"hidden card":t.model.type.icon+t.model.face,Object(i.jsx)("div",{style:t.model.onClick?{}:{pointerEvents:"none"},className:"stack-base",children:Object(i.jsx)("button",{onFocus:function(){},onBlur:function(){},style:function(){var e=Object(s.a)({zIndex:(t.zIndex?t.zIndex:20*!!t.offsetTop)+1,top:t.offsetTop?t.offsetTop/15+"em":0},t.model.entropyStyle);return t.offsetLeft&&(e.left=2*t.offsetLeft+"em"),t.model.onClick||(e.pointerEvents="none"),e}(),ref:a,className:function(){var e=t.isSuggested||t.model.suggestion,n="card card-base suit-".concat(t.model.type.icon);return n+=t.isSelected||r||e?"":" card-stack-".concat(t.model.source),n+=t.isSelected?" card-selected":"",n+=t.blink?" blink":"",n+=t.model.canClick()?" clickable":"",n+=e&&!r?" card-suggested":"",n+=r?" card-focused":""}(),onClick:u||null,disabled:!t.model.canClick()||o.state.paused,tabIndex:t.model.canClick()?0:-1,"aria-label":d,title:d,children:Object(i.jsx)("div",{className:"card-content",children:t.model.isHidden||o.state.paused?Object(i.jsx)("div",{className:"card-back",children:"\xa0"}):Object(i.jsxs)("div",{className:"card-grid-container",children:[Object(i.jsx)("div",{children:Object(i.jsx)("div",{className:"align-center",children:t.model.type.icon})}),Object(i.jsx)("div",{children:Object(i.jsx)("div",{className:"align-left",children:t.model.face})}),Object(i.jsx)("div",{children:"\xa0"}),Object(i.jsx)("div",{children:Object(i.jsx)("div",{className:"align-center",children:t.model.type.icon})}),Object(i.jsx)("div",{className:"mainface",children:Object(i.jsx)("div",{className:"align-center",children:t.model.face})}),Object(i.jsx)("div",{children:Object(i.jsx)("div",{className:"align-center",children:t.model.type.icon})}),Object(i.jsx)("div",{children:"\xa0"}),Object(i.jsx)("div",{children:Object(i.jsx)("div",{className:"align-right",children:t.model.face})}),Object(i.jsx)("div",{children:Object(i.jsx)("div",{className:"align-center",children:t.model.type.icon})})]})})})})},z=function(t){var e=g.a.useContext(k).state;return e.hand&&t.parentModel.source===e.hand.source?Object(i.jsx)(i.Fragment,{children:[e.hand&&e.hand.stack&&e.hand.stack.map((function(e,n){return Object(i.jsx)(G,{model:e,offsetTop:t.offsetTop+24*n,offsetLeft:t.offsetLeft,zIndex:1e3+20*n,isSelected:!0,onClick:function(e,n){return t.onClick(n)}},n)}))]}):null},W=function(t){var e="card-base socket",n=g.a.useRef(null),s=g.a.useContext(k),c=s.state,o=s.updateGameContext;g.a.useEffect((function(){c.focus.hasStack(t.model.parent)&&"singleplayer"==c.settings.launchSettings.boardMode&&n&&n.current&&n.current.focus()})),t.model.stack.length?e+=" socket-full":t.model.blinkFor?e+=" socket-blink":c.focus.hasStack(t.model.source)?e+=" socket-focused":e+=" socket-empty",t.model.suggestion&&!t.model.stack.length&&(e+=" socket-suggested");var a=[0,1,2,3,4,5,6].map((function(t){return" stack "+(t+1)})),r="",u=t.model.source.split("-");return r+=u[0],u.length>1&&(r+=a[u[1]]),r+=": empty socket",Object(i.jsx)("button",{onFocus:function(){},onBlur:function(){},ref:n,className:e,onClick:function(e){e.preventDefault();var n=0==e.clientX&&0==e.clientY;n||o(t.model.clickEmpty({isKeyBoard:n}))},disabled:t.model.stack.length,tabIndex:t.model.stack.length?-1:0,"aria-label":r,title:r,children:t.children})},K=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t){return Object(a.a)(this,n),e.call(this,(function(e){return e.foundation.stacks[t.index]}))}return Object(r.a)(n,[{key:"render",value:function(){var t=this.props.model;return Object(i.jsxs)("div",{className:"board-field",children:[Object(i.jsx)(W,{model:t,children:Object(i.jsx)("div",{className:"align-center foundation-base suit-"+t.icon,children:t.icon})}),t.stack.map((function(e,n){return Object(i.jsx)(G,{model:e,blink:t.blinkFor,isSuggested:t.suggestion&&t.stack.length-1==n},n)})),Object(i.jsx)(z,{parentModel:t,stack:t.stack})]},this.props.index)}}]),n}(q);K.Stacks=function(){var t=g.a.useContext(k).state;return Object(i.jsx)(i.Fragment,{children:t.foundation.stacks.map((function(t,e){return Object(i.jsx)(K,{model:t,index:e},e)}))})};n(27);var V=function(){var t=g.a.useContext(U),e=t.state,n=t.getElapsed,s=g.a.useState(0),o=Object(c.a)(s,2),a=o[0],r=o[1];return g.a.useEffect((function(){var t=setInterval((function(){e.started&&!e.paused&&r(n())}),1e3);return function(){return clearInterval(t)}}),[e.started,e.paused]),!e.started||a<=0?null:Object(i.jsxs)("div",{className:"header-clock",children:[Object(i.jsx)("div",{className:"icon-container",children:"\ud83d\udd52"}),a]})},Y=function(){var t=g.a.useContext(k).state;return Object(i.jsx)("div",{className:"heart-container",children:function(){if("infinite"==t.settings.launchSettings.recyclingMode)return"\ud83d\udda4";if("1-pass"==t.settings.launchSettings.recyclingMode)return t.game.passes>0?"\u2764\ufe0f":"\ud83d\udc94";if("3-pass"==t.settings.launchSettings.recyclingMode){var e=function(t,e){return Array.from(new Array(t).keys()).map((function(){return e})).join("")};return e(t.stock.passes,"\u2764\ufe0f")+e(3-t.stock.passes,"\ud83d\udc94")}return null}()})},X=function(){var t=g.a.useContext(k),e=t.state,n=t.updateContext,s=function(t){return t.settings.suggestionMode.supportsHints||t.settings.suggestionMode.isTemporary},c=function(t){return t.settings.suggestionMode.isTemporary};return s(e)?Object(i.jsx)("div",{children:Object(i.jsx)("button",{title:"Hint",onClick:function(){n((function(t){s(t)&&!c(t)&&t.settings.enableHint()}))},disabled:c(e),children:Object(i.jsx)("span",{className:"icon",children:"\ud83d\udca1"})})}):null},J=function(){var t=g.a.useContext(k).state;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("div",{className:"icon-container",children:"\ud83c\udfc6"})," ",t.game.rating.points]})},Q=function(){var t=g.a.useContext(U),e=g.a.useContext(ee).player;return Object(i.jsx)("div",{children:Object(i.jsx)("button",{title:"Settings",onClick:function(){return t.togglePause(!t.state.paused,e)},children:Object(i.jsx)("span",{className:"icon",children:"\u2630"})})})},_=function(){var t=g.a.useContext(k),e=t.state,n=t.replaceContext;return e.game.timemachine.previousStates.length?Object(i.jsx)("div",{children:Object(i.jsx)("button",{disabled:!e.game.timemachine.previousStates.length,title:"Undo (Penalty:"+Math.pow(2,e.game.rating.multiplicator)+")",onClick:function(){return n((function(t){var n=t.game.timemachine.popPreviousState(e.game.timemachine.previousStates.length-1,e);return n?(n.game.rating.penalize(t.game.rating),n):null}))},children:Object(i.jsx)("span",{className:"icon",children:"\u23ea"})})}):null},Z=function(t){return Object(i.jsxs)("div",{className:"header "+t.mode,children:[Object(i.jsxs)("div",{className:"header-title",children:[Object(i.jsx)(Y,{}),Object(i.jsx)(J,{})]}),Object(i.jsx)(V,{}),Object(i.jsxs)("div",{className:"header-buttons",children:[Object(i.jsx)(X,{}),Object(i.jsx)(_,{}),Object(i.jsx)(Q,{})]})]})},$=(n(28),function t(e,n){Object(a.a)(this,t),this.key=void 0,this.label=void 0,this.isTemporary=void 0,this.supportsHints=void 0,this.next=void 0,this.icon=void 0,this.description=void 0,this.key=e,this.label=n.label,this.icon=n.icon,this.description=n.description,this.isTemporary=!!n.isTemporary,this.supportsHints=!!n.supportsHints,this.next=n.next}),tt=function t(){Object(a.a)(this,t)};tt.NONE="NONE",tt.SCORED="SCORED",tt.REGULAR="REGULAR",tt.FULL="FULL",tt.ONCE="ONCE",tt.TWICE="TWICE",tt.raw={NONE:{label:"None",description:"No distractions. This enables one-time hints.",supportsHints:!0,icon:"\u274c"},SCORED:{label:"Scored",description:"Shows all actions that increase the score.",icon:"\ud83c\udfc6"},REGULAR:{label:"Regular",description:"Shows all possible actions except circular",icon:"\ud83d\udca1"},FULL:{label:"Full",description:"Shows all possible actions, even if they are circular",icon:"\ud83c\udf93"},ONCE:{label:"Single Action",description:"triggered by manual hint in game",isTemporary:!0,next:"NONE",icon:"\u23f3"}},tt.get=function(t){return new $(t,tt.raw[t])},tt.all=function(){return Object.keys(tt.raw).map(tt.get)},tt.allSuggestionModes=function(){return tt.all().filter((function(t){return!t.isTemporary}))},tt.default=function(){return tt.get(tt.REGULAR)},tt.getHintMode=function(){return tt.get(tt.ONCE)},tt.next=function(t){var e=tt.allSuggestionModes();if(e[e.length-1].key==t.key)return e[0];for(var n=0;n<e.length;n++)if(e[n].key==t.key)return e[n+1];return e[0]};var et=function(t,e,n){!e.ratingSettings.hintPenalty&&t.hintPenalty&&(e.suggestionMode=tt.NONE),e.ratingSettings=Object(s.a)({},t),e.ratingPreset=n},nt=function t(){Object(a.a)(this,t)};nt.CHILL={timedMode:!1,missPenalty:!1,undoPenalty:!1,hintPenalty:!1},nt.REGULAR={timedMode:!0,missPenalty:!1,undoPenalty:!0,hintPenalty:!1},nt.COMPETITIVE={timedMode:!0,missPenalty:!0,undoPenalty:!0,hintPenalty:!0},nt.ALL=[{id:0,icon:"\ud83c\udf34",label:"Chill",settings:Object(s.a)({},nt.CHILL),apply:function(t){return et(nt.CHILL,t,0)}},{id:1,icon:"\u2696\ufe0f",label:"Regular",settings:Object(s.a)({},nt.REGULAR),apply:function(t){return et(nt.REGULAR,t,1)}},{id:2,icon:"\ud83c\udfc6",label:"Competitive",settings:Object(s.a)({},nt.COMPETITIVE),apply:function(t){return et(nt.COMPETITIVE,t,2)}}],nt.matchPreset=function(t){var e=nt.ALL.filter((function(e){return nt.equals(e.settings,t)}));return e.length>0?e[0].id:-1},nt.equals=function(t,e){return t.timedMode===e.timedMode&&t.missPenalty===e.missPenalty&&t.undoPenalty===e.undoPenalty&&t.hintPenalty===e.hintPenalty};var it=function(){try{var t=" -webkit- -moz- -o- -ms- ".split(" ");return"ontouchstart"in window||"undefined"!==typeof window.DocumentTouch&&document instanceof window.DocumentTouch||(e=["(",t.join("touch-enabled),("),"heartz",")"].join(""),window.matchMedia(e).matches)}catch(n){return console.error("(Touch detect failed)",n),!1}var e},st={ratingSettings:Object(s.a)({},nt.REGULAR),difficultySettings:1,ratingPreset:1,quickDeal:it(),entropySettings:{baseEntropy:it()?1:2,interactionEntropy:it()?1:2},suggestionMode:tt.REGULAR,players:o},ct=g.a.createContext({navigation:{menu:{x:0,y:0},screen:{x:0,y:0},focus:"menu",mainMenu:"",screeen:""},setNavigation:function(){}}),ot=g.a.createContext({state:{difficultySettings:0,ratingPreset:0,ratingSettings:{},entropySettings:{},quickDeal:!1,suggestionMode:tt.REGULAR,players:o},setState:function(){}}),at=ot.Provider,rt=ct.Provider,ut=ot,lt=["none","low","regular","high","extreme"],dt=function(t){var e=g.a.useRef(null),n="";t.y>0&&(n+=" indented"),t.menuX==t.x&&t.menuY==t.y&&"menu"==t.menuFocus&&!t.skip&&(n+=" highlight"),g.a.useEffect((function(){t.menuX==t.x&&t.menuY==t.y&&"menu"==t.menuFocus&&e.current&&e.current!==document.activeElement&&(r(!0),e&&e.current&&e.current.focus())}),[t.menuFocus,t.menuX,t.menuY,t.x,t.y]),t.active&&(n+=" active");var s=g.a.useState(!1),o=Object(c.a)(s,2),a=o[0],r=o[1];return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("button",{ref:e,className:n,title:t.title,onFocus:function(){a||t.menuX==t.x&&t.menuY==t.y||"menu"!=t.menuFocus||(t.onFocus({x:t.x,y:t.y}),r(!1))},onClick:function(){r(!1),t.onClick({x:t.x,y:t.y})},disabled:t.skip,onMouseDown:function(){return r(!0)},children:[Object(i.jsx)("div",{className:"icon",children:t.icon}),Object(i.jsx)("div",{className:"label",children:t.title})]}),Object(i.jsx)("div",{children:t.toggled?t.children:null})]})},ft=function(t){var e;if("undefined"==typeof t.x||"undefined"==typeof t.y)return null;var n=g.a.useContext(ct).navigation;return Object(i.jsx)(dt,{title:t.title,x:t.x||0,y:t.y||0,icon:t.icon,menuX:n.menu.x,menuY:n.menu.y,menuFocus:n.focus,disabled:t.disabled,active:!1,onFocus:t.onFocus,onClick:t.onClick,toggled:!!t.toggled,skip:t.skip,children:null===(e=t.children)||void 0===e?void 0:e.map((function(e,n){var i;return((null===(i=t.navigator)||void 0===i?void 0:i.rows)||[])[t.x||0].buttons[n+1]=Object(s.a)(Object(s.a)({},t),{},{x:t.x,y:n+1}),g.a.cloneElement(e,{key:n,x:t.x,y:n+1,navigator:t.navigator})}))})},gt=function(t){return Object(i.jsx)("div",{className:"title maintitle",children:t.label})},ht=function(t){var e=t.navigator,n=g.a.useContext(ct),c=n.navigation,o=n.setNavigation,a=function(t){if("screen"==c.focus&&o(Object(s.a)(Object(s.a)({},c),{},{screen:t})),"menu"==c.focus)throw"Invalid navigation action"},r=function(){return o(Object(s.a)(Object(s.a)({},c),{},{focus:"menu",screeen:"",mainMenu:c.mainMenu,menu:Object(s.a)({},c.menu)}))},u=function(){return a(e.moveUp(c.screen.x,c.screen.y))},l=function(){return a(e.moveDown(c.screen.x,c.screen.y))},d=function(){return a(e.moveLeft(c.screen.x,c.screen.y))},f=function(){return a(e.moveRight(c.screen.x,c.screen.y))},h=function(){e.action(c.screen)};return"screen"==c.focus?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(P,{layout:N,onUp:u,onDown:l,onRight:f,onLeft:d,onAction:h,onCancel:r}),Object(i.jsx)(j,{onUp:u,onDown:l,onRight:f,onLeft:d,onAction:h,onCancel:r})]}):null},pt=function(t){var e=t.navigator,n=g.a.useContext(ct),c=n.navigation,o=n.setNavigation,a=function(t){if("menu"==c.focus&&o(Object(s.a)(Object(s.a)({},c),{},{menu:t})),"screen"==c.focus)throw"Invalid navigation action"},r=function(){return o(Object(s.a)(Object(s.a)({},c),{},{focus:"menu",screeen:"",mainMenu:c.mainMenu,menu:Object(s.a)({},c.menu)}))},u=function(){return a(e.moveUp(c.menu.x,c.menu.y))},l=function(){return a(e.moveDown(c.menu.x,c.menu.y))},d=function(){return a(e.moveLeft(c.menu.x,c.menu.y))},f=function(){return a(e.moveRight(c.menu.x,c.menu.y))},h=function(){e.action(c.menu)};return"menu"==c.focus?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(P,{layout:t.keyboardLayout,onUp:u,onDown:l,onRight:f,onLeft:d,onAction:h,onCancel:r}),Object(i.jsx)(j,{onUp:u,onDown:l,onRight:f,onLeft:d,onAction:h,onCancel:r})]}):null},bt=function t(){var e=this;Object(a.a)(this,t),this.rows=void 0,this.getRows=function(){return e.rows},this.getRow=function(t){return e.getRows()[t]},this.goToRow=function(t){var n=e.getRows()[t.y];return n.buttons.length-1<t.x?Object(s.a)(Object(s.a)({},t),{},{x:n.buttons.length-1}):t},this.moveUp=function(t,n){if(0==t)return{x:e.rows.length-1,y:0};if(n>0)return{x:t,y:n-1};if(0==n){var i=e.getRow(t-1);return i.toggled?{x:t-1,y:i.buttons.length-1}:{x:t-1,y:n}}return{x:t-1,y:n}},this.moveDown=function(t,n){var i=e.getRow(t);return 0==n&&i.toggled?{x:t,y:1}:n>0&&n<i.buttons.length-1?{x:t,y:n+1}:n>0?{x:t+1,y:0}:t<e.rows.length-1?{x:t+1,y:n}:{x:0,y:0}},this.moveLeft=function(t,e){return{x:t,y:e}},this.moveRight=function(t,e){return{x:t,y:e}},this.action=function(){var t=document.activeElement;t&&t.click()},this.rows=[]},jt=function(t){var e=new bt;e.rows=[];var n=-1,c=-1;return Object(i.jsxs)(i.Fragment,{children:[t.children.map((function(t){return c++,t.props.skip||(n++,e.rows[n]=Object(s.a)(Object(s.a)({x:n,y:0},t.props),{},{buttons:[]})),g.a.cloneElement(t,{key:c,x:n,y:0,navigator:e})})),Object(i.jsx)(pt,{navigator:e,keyboardLayout:t.keyboardLayout})]})},mt=function(){var t=g.a.useContext(k),e=t.state,n=t.updateContext,c=t.replaceContext,o=t.restart,a=g.a.useContext(U),r=g.a.useContext(ee).player,u=g.a.useContext(ct),l=u.navigation,d=u.setNavigation,f=function(t,e){return d(Object(s.a)(Object(s.a)({},l),{},{focus:"menu",screeen:"",mainMenu:t,menu:Object(s.a)({},e)}))};if(!a.state.showMenu)return null;if(!e)return null;var h=function(t){d(Object(s.a)(Object(s.a)({},l),{},{menu:t}))},p=a.state.allowed-a.state.pauses.length-1,b="You can pause the game ".concat(p," more times.");1==p&&(b="You can pause the game ".concat(p," more time.")),0==p&&(b="This is the last remaining pause. If you continue, no more pause will be possible."),p<0&&(b="The game is not paused.");var j="singleplayer"===e.settings.launchSettings.boardMode?N:w(e.settings.launchSettings.players[r].inputLayout);return a.state.pausedBy!==r?Object(i.jsx)("div",{className:"gamemenu menu",children:Object(i.jsx)("div",{className:"startscreen-jail",children:Object(i.jsxs)("div",{className:"innermenu",children:[Object(i.jsx)(gt,{label:"\ud83d\ude34"}),a.state.pausedBy,Object(i.jsx)("div",{className:"announcement",children:b})]})})}):Object(i.jsx)("div",{className:"gamemenu menu",children:Object(i.jsx)("div",{className:"startscreen-jail",children:Object(i.jsxs)("div",{className:"innermenu",children:[Object(i.jsx)(gt,{label:"\ud83d\ude34"}),Object(i.jsx)("div",{className:"announcement",children:b}),Object(i.jsxs)(jt,{keyboardLayout:j,children:[Object(i.jsx)(ft,{icon:"\u25b6\ufe0f",title:"Resume",onClick:function(){a.togglePause(!1,-1)},onFocus:h}),Object(i.jsx)(ft,{icon:e.settings.suggestionMode.icon,title:"Suggestions: ".concat(e.settings.suggestionMode.label),onClick:function(){var t;t=tt.next(e.settings.suggestionMode).key,n((function(e){return e.settings.setSuggestionMode(t)}))},onFocus:h}),Object(i.jsxs)(ft,{icon:"\ud83c\udf2a\ufe0f",title:"Entropy",onClick:function(t){return function(t,e){l.mainMenu!==t?f(t,e):f("",e)}("entropy",t)},onFocus:h,toggled:"entropy"==l.mainMenu,children:[Object(i.jsx)(ft,{icon:"\ud83c\udf2a\ufe0f",title:"Base Entropy: ".concat(lt[e.settings.baseEntropy]),onClick:function(){var t;t=e.settings.baseEntropy<lt.length-1?e.settings.baseEntropy+1:0,n((function(e){return e.setEntropy(t)}))},onFocus:h}),Object(i.jsx)(ft,{icon:"\ud83c\udf2c\ufe0f",title:"Action Entropy: ".concat(lt[e.settings.interactionEntropy]),onClick:function(){var t;t=e.settings.interactionEntropy<lt.length-1?e.settings.interactionEntropy+1:0,n((function(e){return e.settings.interactionEntropy=t}))},onFocus:h})]}),Object(i.jsx)(ft,{icon:"\u267b\ufe0f",title:"Restart Game",onClick:function(){return a.togglePause(!0,-1),void c((function(t){return t.game.timemachine.previousStates?t.game.timemachine.previousStates[0]:null}))},onFocus:h,skip:!e.game.timemachine.previousStates.length}),Object(i.jsx)(ft,{icon:"\ud83d\uddd1\ufe0f",title:"Quit Game",onClick:function(){return o()},onFocus:h})]})]})})})},vt=function(){var t=g.a.useState({menu:{x:0,y:0},screen:{x:0,y:0},focus:"menu",mainMenu:"",screeen:""}),e=Object(c.a)(t,2),n={navigation:e[0],setNavigation:e[1]};return Object(i.jsx)(rt,{value:n,children:Object(i.jsx)(mt,{})})},yt=function(t){var e=g.a.useContext(U).state,n=e.paused,s=e.started;return Object(i.jsx)(kt,{length:t.length,paused:n,started:s})},kt=function(t){var e=g.a.useContext(k),n=t.length,s=t.started,c=t.paused,o=function(t){var e=g.a.useRef();return g.a.useEffect((function(){e.current=t})),e.current}({length:n,paused:c,started:s});return g.a.useEffect((function(){var t=null;return e.state.settings.launchSettings.speed&&o&&s&&!c&&(o.length!=n||o.started!=s||o.paused!=c)&&(t=setTimeout((function(){e.updateContext((function(t){n==t.stock.stack.length&&t.stock.passes>0&&(t.stock.stack.length||t.waste.stack.length)&&(t.hand.isFromWaste()&&t.waste.putDownHand(),t.stock.stack.length?t.waste.addAll(t.stock.popTop()):t.stock.canRecycle()&&t.stock.recycle(t.waste.recycle()))}))}),1e4)),function(){return clearTimeout(t)}}),[n,c,s]),Object(i.jsxs)("div",{className:"board-field stock",children:[Object(i.jsx)(W,{model:e.state.stock}),e.state.stock.stack.map((function(t,n){return Object(i.jsx)(G,{model:t,offsetTop:n/2*-1,zIndex:n,blink:e.state.stock.blinkFor,isSuggested:e.state.stock.suggestion&&n==e.state.stock.stack.length-1},n)}))]})},Ot=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){return Object(a.a)(this,n),e.call(this,(function(t){return t.stock}))}return Object(r.a)(n,[{key:"render",value:function(){return Object(i.jsx)(yt,{length:this.context.state.stock.stack.length})}}]),n}(q),xt=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t){return Object(a.a)(this,n),e.call(this,(function(e){return e.tableau.stacks[t.index]}))}return Object(r.a)(n,[{key:"render",value:function(){var t=this.props,e=function(e){for(var n=0;n<=e;n++)if(t.model.stack[n]&&!t.model.stack[n].isHidden)return 12*n+24*(e-n);return 12*e};return Object(i.jsxs)("div",{className:"board-field",children:[Object(i.jsx)(W,{model:t.model}),t.model.stack.map((function(n,s){return Object(i.jsx)(G,{model:n,blink:t.model.blinkFor,isSuggested:t.model.suggestion&&t.model.stack.length-1==s,offsetTop:e(s)},s)})),Object(i.jsx)(z,{parentModel:t.model,stack:t.model.stack,offsetTop:e(t.model.stack.length)})]})}}]),n}(q);xt.Stacks=function(){var t=g.a.useContext(k).state;return Object(i.jsx)(i.Fragment,{children:t.tableau.stacks.map((function(e,n){return Object(i.jsx)(xt,{index:n,model:e,parent:t.tableau},n)}))})};var Ct=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){return Object(a.a)(this,n),e.call(this,(function(t){return t.waste}))}return Object(r.a)(n,[{key:"render",value:function(){var t=this.context.state,e=function(e){if("single"==t.settings.launchSettings.drawMode)return 0;var n=t.hand.isHoldingCard()&&t.hand.isFromWaste()?t.waste.stack.length+1:t.waste.stack.length,i=2;return 2==n&&(i=1),1==n&&(i=0),(e-n-2)%3+i};return Object(i.jsxs)("div",{className:"board-field",children:[Object(i.jsx)(W,{model:t.waste}),t.waste.stack.map((function(n,s){return Object(i.jsx)(G,{model:n,offsetTop:s/2*-1,offsetLeft:e(s),blink:t.waste.blinkFor,isSuggested:t.waste.suggestion&&s==t.waste.stack.length-1},s)})),Object(i.jsx)(z,{offsetTop:t.waste.stack.length/2*-1,offsetLeft:e(t.waste.stack.length),parentModel:t.waste,stack:t.waste.stack})]})}}]),n}(q),wt=function(t){return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(vt,{}),Object(i.jsx)(Z,{mode:t.mode}),Object(i.jsx)("div",{className:"board-jail "+t.mode,children:Object(i.jsxs)("div",{className:"board-grid-container "+t.mode,children:[Object(i.jsx)(Ot,{}),Object(i.jsx)(Ct,{}),Object(i.jsx)("div",{className:"spacer",children:"\xa0"}),Object(i.jsx)(K.Stacks,{}),Object(i.jsx)(xt.Stacks,{})]})}),Object(i.jsx)(B,{}),Object(i.jsx)(I,{})]})},Mt=function t(){var e=this;Object(a.a)(this,t),this.startBlink=function(t,n){t(n).blinkFor<10&&(t(n).blinkFor=10,n.game.registerBlink(!0),t(n).unblink=function(n){return e.stopBlink(t,n)})},this.stopBlink=function(t,e){t(e).blinkFor=0,e.game.registerBlink(!1)}},St=function t(){var e=this;Object(a.a)(this,t),this.blink=function(t,e){return(new Mt).startBlink((function(t){return t.tableau.stacks[e]}),t)},this.dispatchPutDown=function(t,n,i,s){if(i.tableau.wouldAcceptHand(s)){var c=i.hand.source;i.tableau.putDownHand(s)&&i.game.registerMove("tableau-"+s,c)}else e.blink(i,s)},this.dispatchPickup=function(t,n,i,s){t?i.hand.pickUp(i.tableau.popWithFollowing(t,s),t.source,n)&&i.game.registerPickup():t||e.blink(i,s)}},Et=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){var t;Object(a.a)(this,n);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return(t=e.call.apply(e,[this].concat(s))).dispatchPickup=function(e,n,i,s){e&&t.tryUncover(e,s,i)},t.tryUncover=function(t,e,n){return!n.hand.isHoldingCard()&&t.isHidden&&n.tableau.uncover(e,t)&&n.game.registerUncover()},t}return n}(St),Nt=function t(){var e=this;Object(a.a)(this,t),this.dealt=void 0,this.dealingAt=void 0,this.isDealt=void 0,this.dealOne=function(t,e){return function(n){return t!=n.dealer.dealt?null:(n.dealer.deal(n.stock,n.tableau),n.dealer.isDealt&&(n.game.started=Date.now()),n.dealer.isDealt||e(n.dealer.dealt),n)}},this.dealAll=function(){return function(t){if(e.dealt!=t.dealer.dealt)return null;for(;!t.dealer.isDealt;)t.dealer.deal(t.stock,t.tableau);return t.game.started=Date.now(),t}},this.deal=function(t,n){for(var i=e.dealingAt;i<n.stacks.length;i++){var s=n.stacks[i].stack;if(s.length<=n.stacks.length-i-1){var c=t.popOne();return c.source=n.stacks[i].source,s.length==n.stacks.length-1-i&&(c.isHidden=!1),n.deal(c,i),e.dealt++,e.dealingAt++,e.dealingAt==n.stacks.length&&(e.dealingAt=0),void(e.isDealt=!1)}var o=0==e.dealingAt;return e.dealingAt=0,void(e.isDealt=o)}e.isDealt=!0},this.dealt=0,this.dealingAt=0,this.isDealt=!1},Pt=function t(e){var n=this;Object(a.a)(this,t),this.clickHandler=void 0,this.getHandler=function(t){return t&&t.isHoldingCard()?n.dispatchPutDown:n.dispatchPickup},this.dispatchPutDown=function(t,e,i){return function(s){s.hand.isHoldingCard()&&n.clickHandler.dispatchPutDown(t,e,s,i)}},this.dispatchPickup=function(t,e,i){return function(s){s.hand.isHoldingCard()||n.clickHandler.dispatchPickup(t,e,s,i)}},this.clickHandler=e},Dt=function(){function t(){var e=this;Object(a.a)(this,t),this.blink=function(t,e){return(new Mt).startBlink((function(t){return t.foundation.stacks[e]}),t)},this.dispatchPutDown=function(t,n,i,s){if(i.foundation.wouldAcceptHand(s)){var c=i.hand.source;i.foundation.putDownHand(s)&&i.game.registerMove("foundation-"+s,c),e.tryDetectEnd(i)}else e.blink(i,s)},this.dispatchPickup=function(t,n,i,s){var c=i.foundation.getTop(s);c&&i.foundation.getPreviousUsed(s)===c.face?i.hand.pickUp([i.foundation.remove(s,c)],c.source,n)&&i.game.registerPickup():e.blink(i,s)}}return Object(r.a)(t,[{key:"tryDetectEnd",value:function(t){52===t.foundation.countCards()&&(t.game.isEnded=!0,t.game.end=Date.now())}}]),t}(),Tt=function(){function t(e,n,i){var s=this;Object(a.a)(this,t),this.causeEntropy=function(t){var e=2*t,n=function(){return Math.random()<.5},i=function(t,e){return Math.random()*(e-t)+t};n()&&(n()?s.entropyStyle.left=i(0,e/20)+"vw":s.entropyStyle.right=i(0,e/20)+"vw"),s.entropyStyle.transform="rotate("+i(-1*e,e)+"deg)"},this.equals=function(e){return t.equals(s,e)},this.face=e,this.type=n,this.isHidden=i,this.entropyStyle={},this.source="",this.suggestion=!1}return Object(r.a)(t,null,[{key:"equals",value:function(t,e){return!t&&!e||t&&e&&e.face==t.face&&e.type.icon==t.type.icon}}]),t}();Tt.copy=function(t){var e=new Tt(t.face,t.type,t.isHidden);return e.source=t.source,e.entropyStyle=Object(s.a)({},t.entropyStyle),e.canClick=t.canClick,e.onClick=t.onClick,e},Tt.copyAll=function(t){return t.map((function(t){return Tt.copy(t)}))};var Rt=function t(e){var n=this;Object(a.a)(this,t),this.validSettings=function(){return"mouse"!==n.settings.launchSettings.inputMode},this.isKeyBoard=function(t){n.keyboard=t},this.setCard=function(t){n.card=t,n.stack=null},this.unsetCard=function(t){n.card&&t&&Tt.equals(n.card,t)&&(n.card=null)},this.unsetStack=function(t){n.stack&&t&&n.stack==t&&(n.stack=null)},this.setStack=function(t){n.card=null,n.stack=t},this.hasCard=function(t){return n.keyboard&&n.validSettings()&&n.card&&t&&Tt.equals(n.card,t)},this.hasStack=function(t){return n.keyboard&&n.validSettings()&&n.stack&&t&&n.stack==t},this.settings=e,this.card=null,this.stack=null,this.keyboard=!1},Ft=function t(e){var n=this;Object(a.a)(this,t),this.stack=[],this.getTop=function(){return n.stack&&n.stack.length&&n.stack[n.stack.length-1]},this.suggestion=!1,this.getClickable=function(){return n.stack.filter((function(t){return t.canClick()}))},this.source=e},At=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t,i){var s;return Object(a.a)(this,n),(s=e.call(this,t)).getHandContent=function(){return s.hand.source==s.source?s.hand.stack:[]},s.getClickable=function(){return[].concat(Object(T.a)(s.stack.filter((function(t){return t.canClick()}))),Object(T.a)(s.getHandContent().filter((function(t){return t.canClick()}))))},s.hand=i,s}return n}(Ft),Lt={heart:{icon:"\u2665",color:"red"},club:{icon:"\u2663",color:"black"},diamond:{icon:"\u2666",color:"red"},spade:{icon:"\u2660",color:"black"}},Ht=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],Ut=function t(e,n){var i=this;Object(a.a)(this,t),this.setOnClick=function(t){i.stacks.forEach((function(e,n){e.clickEmpty=function(e){return t(null,e,n)},e.stack.forEach((function(i,c){i.onClick=function(e){return t(Object(s.a)({},i),e,n)},i.canClick=function(){return c==e.stack.length-1}})),i.hand.setOnClick(e)}))},this.getCurrentAccepted=function(t){var e=i.stacks[t].acceptedCards;return e[e.length-1]},this.wouldAcceptHand=function(t){return!i.hand.hasMoreThanOneCard()&&i.accepts(t,i.hand.currentCard())},this.putDownHand=function(t){return i.add(t,i.hand.putDown())},this.accepts=function(t,e){var n=i.getCurrentAccepted(t);return i.stacks[t].icon==e.type.icon&&n==e.face},this.add=function(t,e){var n=e[0];return n.causeEntropy(Math.min(i.settings.interactionEntropy,3)),n.source=i.stacks[t].source,i.stacks[t].stack.push(n),i.stacks[t].usedCards.push(i.stacks[t].acceptedCards.pop())},this.remove=function(t,e){return i.stacks[t].acceptedCards.push(i.stacks[t].usedCards.pop()),e&&e.equals(i.getTop(t))&&i.stacks[t].stack.pop()},this.getPreviousUsed=function(t){return Object(T.a)(i.stacks[t].usedCards).pop()},this.countCards=function(){return i.stacks.map((function(t){return parseInt(t.stack.length)})).reduce((function(t,e){return t+e}),0)},this.getTop=function(t){return i.stacks[t].stack[i.stacks[t].stack.length-1]},this.setEntropy=function(t){return i.stacks.forEach((function(e){return e.stack.forEach((function(e){return e.causeEntropy(Math.min(3,t))}))})),i},this.settings=e,this.hand=n;var c=function(t){var e=new At("foundation-"+t,n);return e.stack=[],e.acceptedCards=Object(T.a)(["A"].concat(Object(T.a)(Ht.slice(0,Ht.length-1))).reverse()),e.usedCards=[],e.icon=null,e.color=null,e.blinkFor=0,e},o=Object.keys(Lt).map((function(t){return Lt[t]})).map((function(t,e){return Object(s.a)(Object(s.a)({},c(e)),t)}));this.stacks=Object(T.a)(o),this.blinkFor=0,this.unblink=function(){}};Ut.copy=function(t,e){var n=new Ut(t.settings,e);return n.stacks=t.stacks.map((function(t){var n=new At(t.source,e);return n.stack=Tt.copyAll(t.stack),n.acceptedCards=Object(T.a)(t.acceptedCards),n.usedCards=Object(T.a)(t.usedCards),n.icon=t.icon,n.color=t.color,n})),n};var It=function(){function t(e){var n=this;Object(a.a)(this,t),this.registerMove=function(t,e){var i={source:e,target:t};n.points+=n.rateMove(i)},this.registerRecycle=function(){"single"==n.settings.launchSettings.drawMode&&"infinite"==n.settings.launchSettings.recyclingMode&&(n.points>0&&(n.points<100?n.points=0:n.points-=100),console.debug("RATING: subtract (max) 100 points for RECYCLE"))},this.registerUncover=function(){n.points+=5,console.debug("RATING: add 5 points for UNCOVER")},this.penalize=function(t){if(n.settings.launchSettings.undoPenalty){var e=Math.pow(2,t.multiplicator);console.debug("RATING: applying penalty of ".concat(e," points for UNDO")),n.points=Math.min(n.points,t.points)-e,n.multiplicator=t.multiplicator+1}},this.registerHint=function(t){t&&n.settings.launchSettings.hintPenalty&&(n.points-=10,console.debug("RATING: applying penalty of 10 points for HINT"))},this.getTimePenalty=function(t,e){var n=(e-t)/1e3;return-2*Math.trunc(n/5)},this.getBonusPoints=function(t,e){var n=(e-t)/1e3;return n<30?0:Math.round(2e4/n*35)},this.getTotal=function(t,e){return n.points+n.getBonusPoints(t,e)-n.getTimePenalty(t,e)},this.settings=e,this.points=0,this.multiplicator=1}return Object(r.a)(t,[{key:"registerBlink",value:function(t){t&&this.settings.launchSettings.missPenalty&&(this.points-=10,console.debug("RATING: subtract 10 points for invalid action"))}},{key:"rateMove",value:function(t){var e=function(t){return"tableau"==t.substr(0,7)},n=function(t){return"foundation"==t.substr(0,10)};if(e(t.source)){if(n(t.target))return console.debug("RATING: add 10 points for MOVE tableau -> foundation"),10}else if("waste"==t.source){if(n(t.target))return console.debug("RATING: add 10 points for MOVE waste -> foundation"),10;if(e(t.target))return console.debug("RATING: add 5 points for MOVE waste -> tableau"),5}else if(n(t.source)&&e(t.target))return console.debug("RATING: subtract 15 points for MOVE foundation -> tableau"),-15;return 0}}]),t}();It.copy=function(t){var e=new It(t.settings);return e.points=t.points,e.multiplicator=t.multiplicator,e};var Bt=function(){function t(){var e=this;Object(a.a)(this,t),this.registerMove=function(t,n){e.memorable=!0,e.modified=!0,n==t&&(e.memorable=!1)},this.pushPreviousState=function(t){var n=e.previousStates[e.previousStates.length-1];n&&e.modelEquals(t,n)||e.previousStates.push(t)},this.registerPickup=function(){e.modified=!0,e.memorable=!1},this.popPreviousState=function(t,n){for(var i=e.previousStates.length-1==t,s=function(){return i&&e.previousStates&&e.previousStates.pop()},c=s();c&&(!c.game.timemachine.memorable||e.modelEquals(c,n))&&e.previousStates.length;)c=s();return c},this.registerRecycle=function(){e.memorable=!0,e.modified=!0},this.registerUncover=function(){return e.memorable=!0,e.modified=!0,!0},this.stackEquals=function(t,e){return t.stack.every((function(t,n){return Tt.equals(t,e.stack[n])&&t.isHidden==e.stack[n].isHidden}))},this.stacksEqual=function(t,n){return t.stacks.every((function(t,i){return e.stackEquals(t,n.stacks[i])}))},this.modelEquals=function(t,n){return e.stackEquals(t.stock,n.stock)&&e.stackEquals(t.waste,n.waste)&&e.stacksEqual(t.tableau,n.tableau)&&e.stacksEqual(t.foundation,n.foundation)},this.previousStates=[],this.memorable=!0,this.modified=!1}return Object(r.a)(t,[{key:"registerBlink",value:function(){this.modified=!0,this.memorable=!1}}]),t}();Bt.copy=function(t){var e=new Bt;return e.previousStates=Object(T.a)(t.previousStates),e.memorable=t.memorable,e.modified=t.modified,e};var qt=function(){function t(e){var n=this;Object(a.a)(this,t),this.registerMove=function(t,e){return n.rating.registerHint(n.settings.disableHint()),n.rating.registerMove(t,e),n.timemachine.registerMove(t,e),!0},this.registerPickup=function(){return n.timemachine.registerPickup(),!0},this.registerRecycle=function(){return n.rating.registerHint(n.settings.disableHint()),n.rating.registerRecycle(),n.timemachine.registerRecycle(),!0},this.registerUncover=function(){return n.rating.registerHint(n.settings.disableHint()),n.rating.registerUncover(),n.timemachine.registerUncover(),!0},this.settings=e,this.rating=new It(e),this.timemachine=new Bt,this.started=0,this.isEnded=!1,this.end=0}return Object(r.a)(t,[{key:"registerBlink",value:function(t){return this.rating.registerBlink(t),this.timemachine.registerBlink(t),!0}}]),t}();qt.copy=function(t){var e=new qt(t.settings);return e.timemachine=Bt.copy(t.timemachine),e.rating=It.copy(t.rating),e.paused=t.paused,e};var Gt=function t(){var e=this;Object(a.a)(this,t),this.pickUp=function(t,n,i){return t&&t[0]&&(e.stack=t.map((function(t){return t.suggestion=!1,t})),e.source=n,e.position=i),t},this.putDown=function(){return e.source=null,e.stack.splice(0,e.stack.length)},this.setOnClick=function(t){if(e.source&&e.source==t.source){var n=t.clickEmpty;t.stack.length&&(n=t.stack[t.stack.length-1].onClick),e.stack.forEach((function(t){t.onClick=n,t.canClick=function(){return!0}}))}},this.isHoldingCard=function(){return!!e.stack.length},this.isHoldingKing=function(){return e.isHoldingCard()&&"K"==e.currentCard().face},this.currentCard=function(){return e.isHoldingCard()&&e.stack[0]},this.hasMoreThanOneCard=function(){return e.stack.length>1},this.isFromCurrentSource=function(t){return e.source&&t.source==e.source},this.isFromWaste=function(){return e.source&&"waste"==e.source},this.isFromFoundation=function(t){return e.source&&e.source=="foundation-".concat(t)},this.isFromTableau=function(t){return e.source&&e.source=="tableau-".concat(t)},this.isFromAnyTableau=function(){return e.source&&"tableau-"==e.source.substring(0,8)},this.getTableauIndex=function(){return e.source&&e.source.substring(8)},this.stack=[],this.source=null,this.position=null};Gt.copy=function(t){var e=new Gt;return e.stack=Tt.copyAll(t.stack),e.source=t.source,e.position=t.position,e};var zt=function t(e){var n=this;Object(a.a)(this,t),this.setSuggestionMode=function(t){n.suggestionMode.key!==t&&(n.suggestionMode=tt.get(t))},this.enableHint=function(){n.suggestionMode=tt.getHintMode()},this.disableHint=function(){return!(!n.suggestionMode.isTemporary||!n.suggestionMode.next)&&(n.suggestionMode=tt.get(n.suggestionMode.next),!0)},this.launchSettings=e,this.baseEntropy=e.baseEntropy,this.interactionEntropy=e.interactionEntropy,this.suggestionModes=tt.allSuggestionModes(),this.suggestionMode=tt.get(e.suggestionMode)};zt.copy=function(t){var e=new zt(t.launchSettings);return e.suggestionMode=t.suggestionMode,e.baseEntropy=t.baseEntropy,e.interactionEntropy=t.interactionEntropy,e.hintMode=t.hintMode,e};var Wt=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t,i){var c;return Object(a.a)(this,n),(c=e.call(this,"stock")).setOnClick=function(t){c.clickEmpty=function(e){return t(null,e)},c.stack.forEach((function(e,n){e.onClick=function(n){return t(Object(s.a)({},e),n)},e.canClick=function(){return n==c.stack.length-1}}))},c.popOne=function(){return c.stack.pop()},c.recycle=function(t){return!!t.length&&(c.stack=t.reverse().map(c.setCardProperties),c.stack[c.stack.length-1].canClick=function(){return!0},c.recyclings++,!0)},c.setCardProperties=function(t){return t.causeEntropy(Math.min(c.settings.interactionEntropy,1)),t.isHidden=!0,t.source=c.source,t},c.isOnTop=function(t){return t&&t.equals(c.getTop())},c.popTop=function(){var t=[];return"single"==c.settings.launchSettings.drawMode&&(t=[c.stack.pop()]),"triple"==c.settings.launchSettings.drawMode&&(t=c.stack.splice(c.stack.length-3)),0==c.stack.length&&c.passes--,t},c.setEntropy=function(t){return c.stack.forEach((function(e){return e.causeEntropy(Math.min(t,1))})),Object(u.a)(c)},c.settings=i,c.stack=t.map(c.setCardProperties),c.recyclings=0,c.passes=-1,c.blinkFor=0,c.unblink=function(){},"1-pass"==c.settings.launchSettings.recyclingMode&&(c.passes=1),"3-pass"==c.settings.launchSettings.recyclingMode&&(c.passes=3),c}return Object(r.a)(n,[{key:"canRecycle",value:function(){return"infinite"==this.settings.launchSettings.recyclingMode||"3-pass"==this.settings.launchSettings.recyclingMode&&this.recyclings<2}}]),n}(Ft);Wt.copy=function(t){var e=new Wt([],t.settings,t.focus);return e.stack=Tt.copyAll(t.stack),e.dealt=t.dealt,e.dealingAt=t.dealingAt,e.isDealt=t.isDealt,e.passes=t.passes,e.recyclings=t.recyclings,e};var Kt=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){var t;Object(a.a)(this,n);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return(t=e.call.apply(e,[this].concat(s))).blinkFor=0,t.id=0,t.onClick=function(t,e){},t.clickEmpty=function(t,e){},t}return n}(At),Vt=function t(e,n){var i=this;Object(a.a)(this,t),this.stacks=void 0,this.settings=void 0,this.hand=void 0,this.setOnClick=function(t,e,n){i.stacks.forEach((function(c,o){c.clickEmpty=function(e){return t(null,e,o)},c.stack.forEach((function(n,a){var r=n.isHidden&&a==c.stack.length-1?e:t;n.onClick=function(t){return r(Object(s.a)({},n),t,o)},n.canClick=function(){return!n.isHidden||i.canUncover(o,n)}})),n.setOnClick(c)}))},this.getStack=function(t){return i.stacks[t]},this.wouldAcceptHand=function(t){return i.canPutDown(i.getTop(t),i.hand,t)},this.putDownHand=function(t){return i.add(t,i.hand.putDown())},this.canPutDown=function(t,e,n){return t&&t.isHidden&&e.isFromCurrentSource(t)||i.accepts(n,e.currentCard())||!t&&e.isFromTableau(n)},this.accepts=function(t,e){var n=i.getTop(t);if(!n)return e&&"K"===e.face;if(n.isHidden)return!1;var s=Object(T.a)([].concat(Ht));return s.indexOf(e.face)+1==s.indexOf(n.face)&&e.type.color!==n.type.color&&"A"!==n.face},this.getCard=function(t,e){for(var n=0;n<i.stacks[t].stack.length;n++)if(e&&e.equals(i.stacks[t].stack[n])&&e.isHidden===i.stacks[t].stack[n].isHidden)return i.stacks[t].stack[n];return!1},this.popWithFollowing=function(t,e){for(var n=0;n<i.stacks[e].stack.length;n++)if(t&&t.equals(i.stacks[e].stack[n])){var s=i.stacks[e].stack.splice(n,i.stacks[e].stack.length);return i.stackEntropy(e),s}return[]},this.deal=function(t,e){i.stacks[e].stack.push(t)},this.canUncover=function(t,e){return i.getTop(t).isHidden&&e&&e.equals(i.getTop(t))},this.uncover=function(t,e){var n=i.getTop(t);return!!i.canUncover(t,e)&&(n.isHidden=!1,i.stackEntropy(t),!0)},this.stackEntropy=function(t){for(var e=i.settings.interactionEntropy,n=1,s=i.getTop(t);e&&0!=e&&s;)s.causeEntropy(e),e--,s=i.getTop(t,n),n++},this.add=function(t,e){return i.stacks[t].stack=i.stacks[t].stack.concat(e.map((function(e){return i.setCardProperties(e,t)}))),i.stackEntropy(t),e},this.setCardProperties=function(t,e){return t.source=i.stacks[e].source,t},this.getTop=function(t,e){return i.stacks[t].stack[i.stacks[t].stack.length-1-(e||0)]},this.setEntropy=function(t){return i.stacks.forEach((function(e){return e.stack.forEach((function(e){return e.causeEntropy(Math.min(t,4))}))})),i};this.hand=n,this.stacks=[0,1,2,3,4,5,6].map((function(t){var e=new Kt("tableau-"+t,n);return e.stack=[],e.blinkFor=0,e.id=t,e})),this.settings=e};Vt.copy=function(t,e){var n=new Vt(t.settings,e);return n.stacks=t.stacks.map((function(t,n){var i=new Kt(t.source,e);return i.id=n,i.stack=Tt.copyAll(t.stack),i})),n};var Yt=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t,i){var c;return Object(a.a)(this,n),(c=e.call(this,"waste",i)).setOnClick=function(t){c.clickEmpty=function(e){return t(null,e)},c.stack.forEach((function(e,n){e.onClick=function(n){return t(Object(s.a)({},e),n)},e.canClick=function(){return n==c.stack.length-1}})),c.hand.setOnClick(Object(u.a)(c))},c.putDownHand=function(){return c.addAll(c.hand.putDown())},c.add=function(t){return t&&c.stack.push(c.setCardProperties(t))},c.addAll=function(t){return t&&t.length&&t.map(c.add)},c.setCardProperties=function(t){return t.source=c.source,t.isHidden=!1,t.causeEntropy(Math.min(c.settings.interactionEntropy,1)),t},c.wouldAcceptHand=function(){return c.hand.isFromWaste()&&c.canAdd(c.hand.currentCard())},c.canAdd=function(t){return t&&(!c.getTop()||!t.equals(c.getTop()))},c.popTop=function(t){return t&&t.equals(c.getTop())&&c.stack.pop()},c.recycle=function(){return c.stack.splice(0,c.stack.length)},c.setEntropy=function(t){return c.stack.forEach((function(e){return e.causeEntropy(Math.min(t,1))})),Object(u.a)(c)},c.settings=t,c.blinkFor=0,c.unblink=function(){},c}return n}(At);Yt.copy=function(t,e){var n=new Yt(t.settings,e);return n.stack=Tt.copyAll(t.stack),n};var Xt=function t(e){Object(a.a)(this,t),this.stock=void 0,this.waste=void 0,this.foundation=void 0,this.tableau=void 0,this.hand=void 0,this.game=void 0,this.settings=void 0,this.focus=void 0,this.stock=e.stock,this.waste=e.waste,this.foundation=e.foundation,this.tableau=e.tableau,this.hand=e.hand,this.game=e.game,this.settings=e.settings,this.focus=e.focus};Xt.getInitialState=function(t,e){var n=new zt(t),i=new Gt;return{stock:new Wt(Object(T.a)(e.cards),n),waste:new Yt(n,i),foundation:new Ut(n,i),tableau:new Vt(n,i),hand:i,game:new qt(n),settings:n,focus:new Rt(n)}},Xt.copy=function(t){var e=Gt.copy(t.hand);return{stock:Wt.copy(t.stock),waste:Yt.copy(t.waste,e),foundation:Ut.copy(t.foundation,e),tableau:Vt.copy(t.tableau,e),hand:e,game:qt.copy(t.game),settings:zt.copy(t.settings),focus:t.focus}};var Jt=function t(e){var n=this;Object(a.a)(this,t),this.model=void 0,this.currentIndex=void 0,this.rows=void 0,this.getZindex=function(t,e){for(var n=t.getClickable(),i=0;i<n.length;i++)if(Tt.equals(e,n[i]))return i;return 0},this.update=function(t,e){for(var i=0;i<n.rows.length;i++)for(var s=n.rows[i],c=0;c<s.length;c++){var o=s[c];if(o&&o.source==t){var a=n.getZindex(o,e);return n.currentIndex={x:c,y:i,z:a},void n.finishNav()}}},this.valid=function(t){return t.x===n.currentIndex.x&&t.y===n.currentIndex.y&&t.z===n.currentIndex.z},this.moveLeft=function(t){return n.move(t,(function(){n.currentIndex.x--,-1==n.currentIndex.x&&(n.currentIndex.x=6)}))},this.moveRight=function(t){return n.move(t,(function(){n.currentIndex.x++,7==n.currentIndex.x&&(n.currentIndex.x=0)}))},this.move=function(t,e){n.valid(t)&&(e(),void 0==n.current()?n.move(n.currentIndex,e):(n.currentIndex.z=n.current().getClickable().length-1,n.finishNav()))},this.moveUp=function(t){n.valid(t)&&(n.current().getClickable().length&&n.currentIndex.z>0?(n.currentIndex.z--,n.finishNav()):n.toggleRow(!0))},this.moveDown=function(t){if(n.valid(t)){var e=n.current().getClickable();e.length&&n.currentIndex.z<e.length-1?(n.currentIndex.z++,n.finishNav()):n.toggleRow(!1)}},this.toggleRow=function(t){0==n.currentIndex.y?n.currentIndex.y=1:n.currentIndex.y=0;var e=n.current()?n.current().getClickable().length-1:0;n.currentIndex.z=t?e:0,void 0==n.current()?n.moveLeft(n.currentIndex):n.finishNav()},this.finishNav=function(){var t=n.current().getClickable();return t&&t[n.currentIndex.z]?n.model.focus.setCard(t[n.currentIndex.z]):n.model.focus.setStack(n.current().source),!0},this.current=function(){return n.rows[n.currentIndex.y][n.currentIndex.x]},this.pressCurrent=function(){return n.model.focus.card&&n.model.focus.card.canClick()?n.model.focus.card.onClick({isKeyboard:!0}):n.model.focus.stack?(console.debug("delegating to clickempty"),n.current().clickEmpty({isKeyboard:!0})):function(t){t.navigator.finishNav(),t.game.timemachine.modified=!0}},this.model=e,this.currentIndex={x:0,y:0,z:0},this.rows=[[this.model.stock,this.model.waste,void 0].concat(Object(T.a)(this.model.foundation.stacks)),Object(T.a)(this.model.tableau.stacks)]},Qt=function t(e){var n=this;Object(a.a)(this,t),this.navigator=void 0,this.blink=function(t){return(new Mt).startBlink((function(t){return t.stock}),t)},this.dispatchPutDown=function(t,e,i){return n.blink(i,0)},this.dispatchPickup=function(t,e,i){return null!=t?n.moveToWaste(t,i):n.recycleWaste(t,i)},this.moveToWaste=function(t,e){return e.stock.isOnTop(t)&&e.waste.addAll(e.stock.popTop())&&e.game.registerMove("waste","stock")},this.recycleWaste=function(t,e){if(!e.stock.getTop())return!!e.waste.getTop()&&e.stock.canRecycle()&&e.stock.recycle(e.waste.recycle())&&e.game.registerRecycle()&&n.navigator.finishNav()||n.blink(e,0)},this.navigator=e},_t=function t(){var e=this;Object(a.a)(this,t),this.blink=function(t){return(new Mt).startBlink((function(t){return t.waste}),t)},this.dispatchPutDown=function(t,n,i){return i.waste.wouldAcceptHand()&&i.waste.putDownHand()&&i.game.registerMove("waste","waste")||e.blink(i,0)},this.dispatchPickup=function(t,n,i){return t&&i.hand.pickUp([i.waste.popTop(t)],"waste",n)&&i.game.registerPickup()||e.blink(i,0)}},Zt=function t(){var e=this;Object(a.a)(this,t),this.tableau=void 0,this.waste=void 0,this.evaluateOptions=function(t){e.disableAllSuggestions(t),t.settings.suggestionMode.key===tt.NONE||e.getUncoverOptions(t)||e.getPutdownSuggestions(t)||t.hand.isHoldingCard()||e.getPickupOptions(t)&&t.settings.suggestionMode.key!=tt.FULL||!t.stock.getTop()&&!t.stock.canRecycle()||t.settings.suggestionMode.key===tt.SCORED||(t.stock.suggestion=!0)},this.getPutdownSuggestions=function(t,e){if(!t.hand.isHoldingCard()||t.settings.suggestionMode.key==tt.NONE)return 0;var n=[];if(t.waste.wouldAcceptHand()&&(t.settings.suggestionMode.key===tt.FULL||!t.hand.isFromWaste())){var i={target:"waste",source:t.hand.source};(t.settings.suggestionMode.key!==tt.SCORED||t.game.rating.rateMove(i)>0)&&(n.push(i),t.waste.suggestion=!0)}return t.foundation.stacks.forEach((function(e,i){if(t.foundation.wouldAcceptHand(i)&&(t.settings.suggestionMode.key===tt.FULL||!t.hand.isFromFoundation(i))){var s={target:e.source,source:t.hand.source};(t.settings.suggestionMode.key!==tt.SCORED||t.game.rating.rateMove(s)>0)&&(n.push(s),e.suggestion=!0)}})),t.tableau.stacks.forEach((function(i,s){if(t.tableau.wouldAcceptHand(s)&&(t.settings.suggestionMode.key===tt.FULL||!t.hand.isFromTableau(s))){var c=t.hand.isHoldingKing()&&0==i.stack.length&&t.hand.isFromAnyTableau()&&0==t.tableau.stacks[t.hand.getTableauIndex()].stack.length,o=i.stack.length>0&&t.hand.isFromAnyTableau()&&t.tableau.stacks[t.hand.getTableauIndex()].stack.length>0&&i.stack[i.stack.length-1].face==t.tableau.stacks[t.hand.getTableauIndex()].stack[t.tableau.stacks[t.hand.getTableauIndex()].stack.length-1].face&&!t.tableau.getTop(t.hand.getTableauIndex()).isHidden,a=!c&&!o;if(!e||t.settings.suggestionMode.key===tt.FULL||a){var r={target:i.source,source:t.hand.source};(t.settings.suggestionMode.key!==tt.SCORED||t.game.rating.rateMove(r)>0)&&(n.push(r),i.suggestion=!0)}}})),n.length},this.getPickupOptions=function(t){var n=!1,i=$t.copy(t);return e.waste.dispatchPickup(i.waste.getTop(),null,i),i.game.timemachine.modified&&e.getPutdownSuggestions(i,!0)>(t.settings.suggestionMode.key==tt.FULL?1:0)&&(t.waste.suggestion=!0,n=!0),t.tableau.stacks.forEach((function(i,s){return i.stack.map((function(t,e){return{cardIndex:e,card:t}})).filter((function(t){return!t.card.isHidden})).forEach((function(c){var o=c.card,a=c.cardIndex,r=$t.copy(t);e.tableau.dispatchPickup(o,null,r,s),r.game.timemachine.modified&&e.getPutdownSuggestions(r,!0)>(t.settings.suggestionMode.key==tt.FULL?1:0)&&(i.stack[a].suggestion=!0,n=!0)}))})),n},this.getUncoverOptions=function(t){if(!t.hand.isHoldingCard()){var e=t.tableau.stacks.map((function(t,e){return e})).filter((function(e){return t.tableau.getTop(e)&&t.tableau.getTop(e).isHidden}));return e.forEach((function(e){t.tableau.getTop(e).suggestion=!0})),e.length}return 0},this.disableAllSuggestions=function(t){var e=function t(e){e.suggestion=!1,e.stack&&e.stack.forEach(t),e.stacks&&e.stacks.forEach(t)};e(t.waste),e(t.stock),e(t.tableau),e(t.foundation)},this.tableau=new St,this.waste=new _t},$t=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t){var i;return Object(a.a)(this,n),(i=e.call(this,t)).suggestor=void 0,i.dealer=void 0,i.navigator=void 0,i.withSuggestions=function(){return i.suggestor.evaluateOptions(Object(u.a)(i)),Object(u.a)(i)},i.setEntropy=function(t){i.settings.baseEntropy=t,i.stock.setEntropy(t),i.waste.setEntropy(t),i.foundation.setEntropy(t),i.tableau.setEntropy(t)},i.withHandlers=function(){var t=function(t){return new Pt(t).getHandler(i.hand)};return i.stock.setOnClick(t(new Qt(i.navigator))),i.waste.setOnClick(t(new _t)),i.foundation.setOnClick(t(new Dt)),i.tableau.setOnClick(t(new St),t(new Et),i.hand),Object(u.a)(i)},i.suggestor=new Zt,i.dealer=new Nt,i.navigator=new Jt(Object(u.a)(i)),i}return n}(Xt);$t.getInitialState=function(t,e){return new $t(Xt.getInitialState(t,e))},$t.copy=function(t){return new $t(Xt.copy(t))};n(29);var te=function(){var t=g.a.useContext(k),e=t.state,n=t.restart,s=g.a.useContext(U);return e.game.isEnded?Object(i.jsxs)("div",{className:"ui neutral endscreen",children:[Object(i.jsx)("div",{className:"title",children:"\ud83e\udd73"}),Object(i.jsxs)("div",{className:"content",children:[Object(i.jsxs)("div",{children:["Time: ",s.getElapsed()]}),Object(i.jsxs)("div",{children:["Points: ",e.game.rating.points]}),Object(i.jsxs)("div",{children:["Time Penalty: ",e.game.rating.getTimePenalty(e.game.started,e.game.end||Date.now())]}),Object(i.jsxs)("div",{children:["Bonus Points: ",e.game.rating.getBonusPoints(e.game.started,e.game.end||Date.now())]}),Object(i.jsxs)("div",{children:["Total Points: ",e.game.rating.getTotal(e.game.started,e.game.end||Date.now())]}),Object(i.jsx)("div",{children:Object(i.jsxs)("button",{onClick:n,children:["\ud83d\uddd1\ufe0f",Object(i.jsx)("div",{children:"New Game"})]})})]})]}):null},ee=g.a.createContext({player:0}),ne=ee.Provider,ie=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t){var s;return Object(a.a)(this,n),(s=e.call(this,t)).replaceContext=function(t){return s.setState(t)},s.updateContext=function(t){return s.replaceContext((function(e){return t(e),e}))},s.updateGameContext=function(t){return s.replaceContext((function(e){e.game.timemachine.modified=!1;var n=$t.copy(e);return t(e),e.game.timemachine.modified?(e.game.timemachine.pushPreviousState(n),e):null}))},s.render=function(){var t={state:s.state.withHandlers().withSuggestions(),replaceContext:s.replaceContext,updateContext:s.updateContext,updateGameContext:s.updateGameContext,restart:s.props.restart};return Object(i.jsxs)(y,{value:t,children:[Object(i.jsx)(ne,{value:{player:s.props.player},children:Object(i.jsx)(wt,{mode:s.props.settings.boardMode})}),Object(i.jsx)(te,{})]})},s.state=$t.getInitialState(t.settings,t.deck),s}return n}(g.a.Component),se=function(){function t(){Object(a.a)(this,t);var e=Object.keys(Lt);this.cards=Ht.map((function(t){return Object(T.a)(e.map((function(e){return new Tt(t,Lt[e],!0)})))})).flat().reverse()}return Object(r.a)(t,[{key:"shuffle",value:function(){return this.shuffleArray(this.cards),this}},{key:"shuffleArray",value:function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=[t[n],t[e]];t[e]=i[0],t[n]=i[1]}}},{key:"copy",value:function(){var e=new t;return e.cards=Tt.copyAll(this.cards),e}}]),t}(),ce=function t(){Object(a.a)(this,t)};ce.QUICK={key:"QUICK",title:"Quick Game",boardMode:"singleplayer",autoConfig:!0},ce.CUSTOM={key:"CUSTOM",title:"Custom Game",boardMode:"singleplayer",autoConfig:!1},ce.VERSUS={key:"VERSUS",title:"Versus",boardMode:"splitscreen",autoConfig:!1},ce.NULL={key:"",title:"",boardMode:"",autoConfig:!1};var oe=[{id:0,settings:{drawMode:"single",recyclingMode:"infinite"},icon:"\ud83d\udc2d",lines:["Turn 1 card","No Limit"]},{id:1,settings:{drawMode:"single",recyclingMode:"3-pass"},icon:"\ud83d\udc39",lines:["Turn 1 card","Three passes"]},{id:2,settings:{drawMode:"single",recyclingMode:"1-pass"},icon:"\ud83d\udc30",lines:["Turn 1 card","Only a single pass"]},{id:3,settings:{drawMode:"triple",recyclingMode:"infinite"},icon:"\ud83d\udc28",lines:["Turn 3 cards","No limit"]},{id:4,settings:{drawMode:"triple",recyclingMode:"3-pass"},icon:"\ud83d\udc3c",lines:["Turn 3 cards ","Three passes"]},{id:5,settings:{drawMode:"triple",recyclingMode:"1-pass"},icon:"\ud83d\udc3b",lines:["Turn 3 cards ","Only a single pass"]}],ae=[{id:0,icon:"\ud83d\uddb1\ufe0f",inputMethod:"mouse",inputLayout:0,lines:["Mouse or","Touchpad"]},{id:1,icon:"\ud83c\udfae",inputMethod:"gamepad",inputLayout:0,lines:["Gamepad 1"]},{id:2,icon:"\ud83c\udfae",inputMethod:"gamepad",inputLayout:1,lines:["Gamepad 2"]},{id:3,icon:"\u2328\ufe0f",inputMethod:"keyboard",inputLayout:0,lines:["Keyboard","WASD"]},{id:4,icon:"\u2328\ufe0f",inputMethod:"keyboard",inputLayout:1,lines:["Keyboard","ARROWS"]},{id:5,icon:"\u2328\ufe0f",inputMethod:"keyboard",inputLayout:2,lines:["Keyboard","NUMPAD"]}],re=g.a.createContext({closeScreen:function(){}}),ue=function(){var t=g.a.useContext(re).closeScreen;return Object(i.jsx)("div",{className:"closer",children:Object(i.jsx)("button",{onClick:t,children:"\ud83d\uddd9"})})},le=function t(){var e=this;Object(a.a)(this,t),this.hasConsent=function(){var t=localStorage.getItem("consent");return t&&!!parseInt(t)},this.giveConsent=function(){return{prompt:"Allow this game to store settings, so your changes will stay. No data leaves your computer.",confirm:function(){localStorage.setItem("consent","1")}}},this.revokeConsent=function(){return{prompt:"Delete all local stored data? All settings will be lost.",confirm:function(){localStorage.clear()}}},this.store=function(t){e.hasConsent()&&localStorage.setItem("state",JSON.stringify(t))},this.getPreviousState=function(){if(e.hasConsent()){var t=localStorage.getItem("state");return null!=t?JSON.parse(t):null}return null}},de=function(t,e){var n=t;return e.hasFocus&&(n+=" focused"),e.disabled&&(n+=" disabled"),n},fe=function(t,e){g.a.useEffect((function(){t.hasFocus&&e&&e.current&&e.current!==document.activeElement&&e.current.focus()}),[t.hasFocus,e])},ge=function(t){var e=g.a.useContext(ct).navigation,n=function(t,n){return"screen"==e.focus&&e.screen.x==n&&e.screen.y==t},s=g.a.useRef(null);fe({hasFocus:n(t.y,t.x)},s);var c="cookiebanner";return n(t.y,t.x)&&(c+=" focused"),t.consented?null:Object(i.jsxs)("button",{ref:s,className:c,onClick:function(){var e=(new le).giveConsent();!t.consented&&confirm(e.prompt)&&(e.confirm(),t.setConsented(!0))},children:[Object(i.jsx)("div",{className:"icon",children:"\ud83c\udf6a"}),Object(i.jsxs)("div",{className:"message",children:[Object(i.jsx)("b",{children:"Changes on this page will be lost after each game"}),", until you allow this app to store data on your machine. Click here to give consent."]})]})},he=function(t){if("undefined"==typeof t.x||"undefined"==typeof t.y)return null;var e=g.a.useContext(O),n=e.consented,s=e.setConsented;return Object(i.jsx)(ge,{x:t.x,y:t.y,consented:n,setConsented:s})},pe=function(t){if("undefined"==typeof t.y||"undefined"==typeof t.navigator)return null;var e=function(e,n){if(!e)return null;var i;t.skip||(((null===(i=t.navigator)||void 0===i?void 0:i.rows)||[])[t.y||0].buttons[n||0]={x:n,y:t.y});return g.a.cloneElement(e,{key:n,x:n,y:t.y})};return t.children?Object(i.jsx)("div",{className:"row",children:Array.isArray(t.children)?t.children.map(e):e(t.children,0)}):null},be=function t(){var e=this;Object(a.a)(this,t),this.rows=void 0,this.getRows=function(){return e.rows},this.getRow=function(t){return e.getRows()[t]},this.goToRow=function(t){var n=e.getRows()[t.y];return n.buttons.length-1<t.x?Object(s.a)(Object(s.a)({},t),{},{x:n.buttons.length-1}):t},this.moveUp=function(t,n){var i=e.getRows();return 0==n?e.goToRow({x:t,y:i.length-1}):e.goToRow({x:t,y:n-1})},this.moveDown=function(t,n){return n==e.getRows().length-1?e.goToRow({x:t,y:0}):e.goToRow({x:t,y:n+1})},this.moveLeft=function(t,n){var i=e.getRow(n);return 0==t?{x:i.buttons.length-1,y:n}:{x:t-1,y:n}},this.moveRight=function(t,n){return t==e.getRow(n).buttons.length-1?{x:0,y:n}:{x:t+1,y:n}},this.action=function(){var t=document.activeElement;t&&t.click()},this.rows=[]},je=function(t){var e=new be,n=-1,s=-1;return Object(i.jsxs)("div",{className:"content",children:[t.children.map((function(t){return function(t){return s++,t.props.skip||(n++,e.rows[n]={buttons:[]}),g.a.cloneElement(t,{key:s,x:0,y:n,navigator:e})}(t)})),Object(i.jsx)(ht,{navigator:e,screen:"rating"})]})},me=function(t){if("undefined"==typeof t.x||"undefined"==typeof t.y)return null;var e={x:t.x,y:t.y},n=g.a.useRef(null),c=g.a.useContext(ct),o=c.navigation,a=c.setNavigation,r="screen"==o.focus&&o.screen.x==t.x&&o.screen.y==t.y;g.a.useEffect((function(){r&&n&&n.current&&n.current!==document.activeElement&&n.current.focus()}),[n,r]),g.a.useEffect((function(){t.initialFocus&&!r&&n&&n.current&&n.current!==document.activeElement&&-1==o.screen.x&&-1==o.screen.y&&n.current.focus()}),[n]);return Object(i.jsxs)("button",{onFocus:function(){r||a(Object(s.a)(Object(s.a)({},o),{},{screen:{x:t.x||0,y:t.y||0}}))},ref:n,disabled:t.disabled,className:t.className(e),onClick:function(){t.onClick(),a(Object(s.a)(Object(s.a)({},o),{},{screen:{x:t.x||0,y:t.y||0}}))},children:[t.icon,t.lines.map((function(t,e){return Object(i.jsx)("div",{children:t},e)}))]},t.id)},ve=function(t){var e=g.a.useContext(ut),n=e.state,o=e.setState,a=g.a.useContext(ct).navigation,r=n.players[t.player];if(!r)return null;var u=g.a.useState([{found:!1,buttonPressed:!1},{found:!1,buttonPressed:!1}]),l=Object(c.a)(u,2),d=l[0],f=l[1],h=function(t){d[t].found=!0,f(Object(s.a)({},d))},p=function(t){d[t].found=!0,d[t].buttonPressed=!0,f(Object(s.a)({},d)),console.log(d)},b=g.a.useContext(O).consented,m=function(t,e){return n.players[e].inputLayout==ae[t].inputLayout&&n.players[e].inputMethod==ae[t].inputMethod},v=function(e){return m(e,t.player)},y=function(e){var i=Object(s.a)({},n.players);i[t.player].inputMethod=ae[e].inputMethod,i[t.player].inputLayout=ae[e].inputLayout,o(Object(s.a)(Object(s.a)({},n),{},{players:i}))},k=function(t,e,n){var i=e+""+n+" "+a.screen.x+a.screen.y+" ";return i+=a.screen.x==e&&a.screen.y==n?" focused":"",i+=v(t)?" active-0":" inactive-0",i+=x(t)?" disabled":""},x=function(e){var n=[0,1].filter((function(e){return e!==t.player}));return m(e,n[0])},C=function(t){return"gamepad"==t.inputMethod?[].concat(Object(T.a)(t.lines),[d[t.inputLayout].found||d[t.inputLayout].buttonPressed?"Connected":"Not Found"]):t.lines};return Object(i.jsxs)("div",{className:"controls startdetails",children:[Object(i.jsx)(ue,{}),Object(i.jsx)("div",{className:"title",children:r.name}),Object(i.jsxs)(je,{id:"settings",children:[Object(i.jsx)(pe,{skip:b,children:Object(i.jsx)(he,{})}),Object(i.jsx)(pe,{children:ae.slice(0,3).map((function(t){return Object(i.jsx)(me,{icon:t.icon,id:t.id,disabled:x(t.id),initialFocus:v(t.id),className:function(e){return k(t.id,e.x,e.y)},onClick:function(){return y(t.id)},lines:C(t)},t.id)}))}),Object(i.jsx)(pe,{children:ae.slice(3).map((function(t){return Object(i.jsx)(me,{icon:t.icon,id:t.id,disabled:x(t.id),initialFocus:v(t.id),className:function(e){return k(t.id,e.x,e.y)},onClick:function(){return y(t.id)},lines:t.lines},t.id)}))}),Object(i.jsxs)(pe,{skip:!0,children:[Object(i.jsxs)("div",{className:"togglecontainer",children:[Object(i.jsx)("div",{className:"title",children:"@todo"}),Object(i.jsx)("div",{className:"toggle"}),Object(i.jsx)("div",{className:"description",children:"Describe Layout of currently selected input method"})]}),Object(i.jsxs)("div",{className:"togglecontainer",children:[Object(i.jsx)("div",{className:"title",children:"@todo"}),Object(i.jsx)("div",{className:"toggle"}),Object(i.jsx)("div",{className:"description",children:"Describe Layout of currently selected input method"})]})]})]}),Object(i.jsx)(j,{gamepadIndex:0,onConnect:function(){return h(0)},onUp:function(){return p(0)},onDown:function(){return p(0)},onRight:function(){return p(0)},onLeft:function(){return p(0)},onAction:function(){return p(0)}}),Object(i.jsx)(j,{gamepadIndex:1,onConnect:function(){return h(1)},onUp:function(){return p(1)},onDown:function(){return p(1)},onRight:function(){return p(1)},onLeft:function(){return p(1)},onAction:function(){return p(1)}})]})},ye=function(){var t=g.a.useContext(ut),e=t.state,n=t.setState,c=g.a.useContext(ct).navigation,o=function(t){return e.difficultySettings==t},a=function(t){return Object(i.jsx)(me,{icon:t.icon,id:t.id,initialFocus:o(t.id),className:function(e){return function(t,e,n){var i=c.screen.x==n&&c.screen.y==e,s=o(t)?"active active-".concat(t):"inactive-".concat(t);return s+(i?" focused":"")}(t.id,e.y,e.x)},onClick:function(){return n(Object(s.a)(Object(s.a)({},e),{},{difficultySettings:t.id}))},lines:t.lines},t.id)},r=g.a.useContext(O).consented;return Object(i.jsxs)("div",{className:"difficulty startdetails",children:[Object(i.jsx)(ue,{}),Object(i.jsx)("div",{className:"title",children:"Difficulty"}),Object(i.jsxs)(je,{id:"difficulty",children:[Object(i.jsx)(pe,{skip:r,children:Object(i.jsx)(he,{})}),Object(i.jsx)(pe,{children:oe.slice(0,3).map(a)}),Object(i.jsx)(pe,{children:oe.slice(3).map(a)}),Object(i.jsxs)(pe,{skip:!0,children:[Object(i.jsxs)("div",{className:"togglecontainer",children:[Object(i.jsx)("div",{className:"title",children:"Draw Mode"}),Object(i.jsx)("div",{className:"toggle"}),Object(i.jsxs)("div",{className:"description",children:["triple"==oe[e.difficultySettings].settings.drawMode?"Turn 3 cards at once from the Stock to the Waste.":null,"single"==oe[e.difficultySettings].settings.drawMode?"Turn 1 card after the other from the Stock to the Waste.":null]})]}),Object(i.jsxs)("div",{className:"togglecontainer",children:[Object(i.jsx)("div",{className:"title",children:"Pass Limit"}),Object(i.jsx)("div",{className:"toggle"}),Object(i.jsxs)("div",{className:"description",children:["1-pass"==oe[e.difficultySettings].settings.recyclingMode?"One pass through the deck. Waste can not be recycled to the Stock.":null,"3-pass"==oe[e.difficultySettings].settings.recyclingMode?"Three passes through the deck. Waste can be recycled to Stock two times.":null,"infinite"==oe[e.difficultySettings].settings.recyclingMode?"No limit on passes through the deck. Waste can be recycled to Stock endlessly.":null]})]})]})]})]})},ke=function(t){var e=g.a.useRef(null);fe(t,e);var n=g.a.useContext(ct),c=n.navigation,o=n.setNavigation;return Object(i.jsxs)("div",{className:de("togglecontainer",t),children:[Object(i.jsxs)("div",{className:"title",children:[t.label,": ",t.values[t.value].label]}),Object(i.jsx)("div",{className:"button",children:Object(i.jsx)("button",{ref:e,onClick:function(){t.callBack((t.value+1<t.values.length?t.value+1:0).toString()),o(Object(s.a)(Object(s.a)({},c),{},{screen:{x:t.x,y:t.y}}))},disabled:!!t.disabled,onFocus:function(){t.hasFocus||o(Object(s.a)(Object(s.a)({},c),{},{screen:{x:t.x,y:t.y}}))},children:"\ud83d\udd01"})}),Object(i.jsx)("div",{className:"description",children:t.description})]})},Oe=function(t){if("undefined"==typeof t.x||"undefined"==typeof t.y)return null;var e,n,s=g.a.useContext(ct).navigation,c={x:t.x||0,y:t.y||0};return Object(i.jsx)(ke,{x:c.x,y:c.y,disabled:!!t.disabled,hasFocus:(e=c.y,n=c.x,"screen"==s.focus&&s.screen.x==n&&s.screen.y==e),label:t.label,description:t.description,value:t.value,values:t.values,callBack:t.callBack})},xe=(n(30),n(15)),Ce=n.n(xe),we=function(t){var e=g.a.useRef(null);fe(t,e);var n=g.a.useContext(ct),c=n.navigation,o=n.setNavigation;return function(t,e,n){g.a.useEffect((function(){t.initialFocus&&!t.hasFocus&&e&&e.current&&e.current!==document.activeElement&&-1==n.x&&-1==n.y&&e.current.focus()}),[e])}(t,e,c.screen),Object(i.jsxs)("div",{className:de("togglecontainer",t),children:[Object(i.jsx)("div",{className:"title",children:t.label}),Object(i.jsx)("div",{className:"toggle",children:Object(i.jsx)(Ce.a,{ref:e,disabled:!!t.disabled,autoFocus:t.hasFocus,onFocus:function(){t.hasFocus||o(Object(s.a)(Object(s.a)({},c),{},{screen:{x:t.x,y:t.y}}))},checked:t.value,onChange:function(){return e=!t.value,n={x:t.x,y:t.y},o(Object(s.a)(Object(s.a)({},c),{},{screen:n})),void t.callBack(e);var e,n}})}),Object(i.jsx)("div",{className:"description",children:t.description})]})},Me=function(t){if("undefined"==typeof t.x||"undefined"==typeof t.y)return null;var e,n,s=g.a.useContext(ct).navigation,c={x:t.x||0,y:t.y||0};return Object(i.jsx)(we,{x:c.x,y:c.y,disabled:!!t.disabled,hasFocus:(e=c.y,n=c.x,"screen"==s.focus&&s.screen.x==n&&s.screen.y==e),label:t.label,description:t.description,value:t.value,callBack:t.callBack,initialFocus:t.initialFocus})},Se=function(t){return[{entropy:2,quickDeal:!1,lines:[(t.quickDeal?"Optimize":"Optimized")+" for Desktop"],icon:"\ud83d\udda5\ufe0f"},{entropy:1,quickDeal:!0,lines:[(t.quickDeal?"Optimized":"Optimize")+" for Mobile"],icon:"\ud83d\udcf1"}]},Ee=function(){var t=g.a.useContext(ut),e=t.state,n=t.setState,c=g.a.useContext(ct).navigation,o=g.a.useContext(O).consented,a=function(t){return e.quickDeal==t};return Object(i.jsxs)("div",{className:"quickstart startdetails",children:[Object(i.jsx)(ue,{}),Object(i.jsx)("div",{className:"title",children:"Various"}),Object(i.jsxs)(je,{id:"settings",children:[Object(i.jsx)(pe,{skip:o,children:Object(i.jsx)(he,{})}),Object(i.jsx)(pe,{children:Se(e).map((function(t,o){return Object(i.jsx)(me,{icon:t.icon,id:o,initialFocus:a(t.quickDeal),className:function(e){return function(t,e,n){var i=c.screen.x==n&&c.screen.y==e,s=a(t.quickDeal)?"active active-0":"inactive-0";return s+(i?" focused":"")}(t,e.x,e.y)},lines:t.lines,onClick:function(){return n(Object(s.a)(Object(s.a)({},e),{},{quickDeal:t.quickDeal,entropySettings:{baseEntropy:t.entropy,interactionEntropy:t.entropy}}))}},o)}))}),Object(i.jsxs)(pe,{children:[Object(i.jsx)(Oe,{label:"Base Entropy",description:"How much chaos will the stacks on the board contain by themselves?",value:e.entropySettings.baseEntropy||0,values:lt.map((function(t,e){return{id:e,label:t}})),callBack:function(t){return n(Object(s.a)(Object(s.a)({},e),{},{entropySettings:Object(s.a)(Object(s.a)({},e.entropySettings),{},{baseEntropy:parseInt(t)})}))}}),Object(i.jsx)(Oe,{label:"Interaction Entropy",description:"How much chaos will each interaction add to a stack on the board?",value:e.entropySettings.interactionEntropy||0,values:lt.map((function(t,e){return{id:e,label:t}})),callBack:function(t){return n(Object(s.a)(Object(s.a)({},e),{},{entropySettings:Object(s.a)(Object(s.a)({},e.entropySettings),{},{interactionEntropy:parseInt(t)})}))}})]}),Object(i.jsxs)(pe,{children:[Object(i.jsx)(Me,{label:"Instant Deal",description:"Should the deal animation at the beginning of the game be skipped?",value:e.quickDeal,callBack:function(t){return n(Object(s.a)(Object(s.a)({},e),{},{quickDeal:t}))}}),Object(i.jsx)(Me,{disabled:!0,label:"Auto Deal",description:"Should the game draw one card from the stock every 5 seconds?",value:!1,callBack:function(){}})]})]})]})},Ne=function(){var t=g.a.useContext(ut),e=t.state,n=t.setState,c=g.a.useContext(ct).navigation,o=function(t){return e.ratingPreset==t},a=function(t){var i=Object(s.a)({},e);t(i.ratingSettings),i.ratingPreset=nt.matchPreset(i.ratingSettings),n(i)},r=g.a.useContext(O).consented;return Object(i.jsxs)("div",{className:"rating startdetails",children:[Object(i.jsx)(ue,{}),Object(i.jsx)("div",{className:"title",children:"Penalties"}),Object(i.jsxs)(je,{id:"penalties",children:[Object(i.jsx)(pe,{skip:r,children:Object(i.jsx)(he,{})}),Object(i.jsx)(pe,{children:nt.ALL.map((function(t){return Object(i.jsx)(me,{icon:t.icon,id:t.id,initialFocus:o(t.id)||-1==e.ratingPreset&&0==t.id,className:function(e){return function(t,e,n){var i=o(t)?"active active-".concat(t):"inactive-".concat(t);return i+(c.screen.x==n&&c.screen.y==e?" focused":"")}(t.id,e.y,e.x)},onClick:function(){return function(t){var i=Object(s.a)({},e);nt.ALL[t].apply(i),n(i)}(t.id)},lines:[t.label]},t.id)}))}),Object(i.jsxs)(pe,{children:[Object(i.jsx)(Me,{label:"Undo Penalty",description:"Undo is enabled, but excessive use will be painful. This penalty starts with 2 and increases exponentially.",value:!!e.ratingSettings.undoPenalty,callBack:function(t){return a((function(e){e.undoPenalty=t}))}}),Object(i.jsx)(Me,{label:"Time Penalty",description:"Fast players are rewarded with a time bonus, slow players will be punished.",value:!!e.ratingSettings.timedMode,callBack:function(t){return a((function(e){e.timedMode=t}))}})]}),Object(i.jsxs)(pe,{children:[Object(i.jsx)(Me,{label:"Hint Penalty",description:"Each manual hint will reduce the number of points by 10. This setting disables automatic suggestions. ",value:!!e.ratingSettings.hintPenalty,callBack:function(t){!function(t,i){var c=Object(s.a)({},e);t(c.ratingSettings),i(c),c.ratingPreset=nt.matchPreset(c.ratingSettings),n(c)}((function(e){e.hintPenalty=t}),(function(e){e.suggestionMode=t?tt.NONE:tt.REGULAR}))}}),Object(i.jsx)(Me,{label:"Miss Penalty",description:"Be careful where you click, as each invalid action will lead to a penalty of 10 points.",value:!!e.ratingSettings.missPenalty,callBack:function(t){return a((function(e){e.missPenalty=t}))}})]})]})]})},Pe=function(){var t=g.a.useContext(O).consented,e=g.a.useContext(ut),n=e.state,c=e.setState,o=tt.allSuggestionModes(),a=function(t){return n.suggestionMode==t},r=function(t){return t!==tt.NONE&&n.ratingSettings.hintPenalty};return Object(i.jsxs)("div",{className:"suggestions startdetails",children:[Object(i.jsx)(ue,{}),Object(i.jsx)("div",{className:"title",children:"Suggestions"}),Object(i.jsxs)(je,{id:"settings",children:[Object(i.jsx)(pe,{skip:t,children:Object(i.jsx)(he,{})}),Object(i.jsx)(pe,{children:o.slice(0,2).map((function(t,e){return Object(i.jsx)(Me,{value:a(t.key),disabled:r(t.key),label:t.icon+" "+t.label,callBack:function(){return c(Object(s.a)(Object(s.a)({},n),{},{suggestionMode:t.key}))},description:t.description,initialFocus:a(t.key)},e)}))}),Object(i.jsx)(pe,{children:o.slice(2).map((function(t,e){return Object(i.jsx)(Me,{value:a(t.key),disabled:r(t.key),label:t.icon+" "+t.label,callBack:function(){return c(Object(s.a)(Object(s.a)({},n),{},{suggestionMode:t.key}))},description:t.description,initialFocus:a(t.key)},e)}))})]})]})},De=function(t){var e=g.a.useContext(ct),n=e.navigation,c=e.setNavigation;return Object(i.jsx)(re.Provider,{value:{closeScreen:function(){return c(Object(s.a)(Object(s.a)({},n),{},{focus:"menu",screeen:"",mainMenu:n.mainMenu,menu:Object(s.a)({},n.menu)}))}},children:Object(i.jsx)("div",{className:"startscreen-layout",children:Object(i.jsxs)("div",{className:"startscreen-jail",children:["rating"==t.screen?Object(i.jsx)(Ne,{}):null,"difficulty"==t.screen?Object(i.jsx)(ye,{}):null,"settings"==t.screen?Object(i.jsx)(Ee,{}):null,"suggestions"==t.screen?Object(i.jsx)(Pe,{}):null,"controls0"==t.screen?Object(i.jsx)(ve,{player:0}):null,"controls1"==t.screen?Object(i.jsx)(ve,{player:1}):null]})})})},Te=function(t){return Object(i.jsx)("div",{className:"ui menu",children:Object(i.jsx)("div",{className:"startscreen-jail",children:Object(i.jsx)("div",{className:"innermenu",children:t.children})})})},Re=function(t){var e=g.a.useContext(ct),n=e.navigation,c=e.setNavigation,o=g.a.useContext(O),a=o.consented,r=o.setConsented,u=function(t,e){return c(Object(s.a)(Object(s.a)({},n),{},{focus:"menu",screeen:"",mainMenu:t,menu:Object(s.a)({},e)}))},l=function(t){return c(Object(s.a)(Object(s.a)({},n),{},{menu:t}))},d=function(t,e){n.screeen!==t?function(t,e){c(Object(s.a)(Object(s.a)({},n),{},{focus:"screen",screeen:t,screen:{x:-1,y:-1},menu:Object(s.a)({},e)}))}(t,e):u(n.mainMenu,e)},f=function(t,e){return u(n.mainMenu!==t?t:"",e)},h=new le;return Object(i.jsxs)(Te,{children:[Object(i.jsx)(gt,{label:"\u2666 Solitaire"}),Object(i.jsxs)(jt,{keyboardLayout:N,children:[Object(i.jsx)(ft,{icon:"\ud83c\udfb2",title:"Single Player",onClick:function(){return t.start(ce.CUSTOM.boardMode)},onFocus:l}),Object(i.jsxs)(ft,{icon:"\u2694\ufe0f",title:"Versus",onClick:function(t){return f("versus",t)},onFocus:l,toggled:"versus"==n.mainMenu,children:[Object(i.jsx)(ft,{icon:"\ud83c\udfae",title:"Player 1",onClick:function(t){return d("controls0",t)},onFocus:l,toggled:"controls0"==n.screeen}),Object(i.jsx)(ft,{icon:"\ud83c\udfae",title:"Player 2",onClick:function(t){return d("controls1",t)},onFocus:l,toggled:"controls1"==n.screeen}),Object(i.jsx)(ft,{icon:"\ud83c\udfb2",title:"Start",onClick:function(){return t.start(ce.VERSUS.boardMode)},onFocus:l})]}),Object(i.jsxs)(ft,{icon:"\u2699\ufe0f",title:"Options",onClick:function(t){return f("custom",t)},onFocus:l,toggled:"custom"==n.mainMenu,children:[Object(i.jsx)(ft,{icon:"\ud83d\udcaa",title:"Difficulty",onClick:function(t){return d("difficulty",t)},onFocus:l,toggled:"difficulty"==n.screeen}),Object(i.jsx)(ft,{icon:"\u2696\ufe0f",title:"Penalties",onClick:function(t){return d("rating",t)},onFocus:l,toggled:"rating"==n.screeen}),Object(i.jsx)(ft,{icon:"\ud83d\udca1",title:"Suggestions",onClick:function(t){return d("suggestions",t)},onFocus:l,toggled:"suggestions"==n.screeen}),Object(i.jsx)(ft,{icon:"\ud83e\uddf0",title:"Various",onClick:function(t){return d("settings",t)},onFocus:l,toggled:"settings"==n.screeen})]}),Object(i.jsx)(ft,{icon:"\ud83c\udf6a",title:a?"Delete Cookie":"Allow Cookie",onClick:a?function(){var t=h.revokeConsent();confirm(t.prompt)&&(t.confirm(),r(!1))}:function(){var t=h.giveConsent();confirm(t.prompt)&&(t.confirm(),r(!0))},onFocus:l,toggled:!1})]})]})},Fe=function(t){var e=new le,n=g.a.useState(!!e.hasConsent()),o=Object(c.a)(n,2),a=o[0],r=o[1],u=e.getPreviousState(),l=g.a.useState(u||st),d=Object(c.a)(l,2),f=d[0],h=d[1],p={x:0,y:0},b=g.a.useState({menu:Object(s.a)({},p),screen:Object(s.a)({},p),focus:"menu",mainMenu:"",screeen:""}),j=Object(c.a)(b,2),m=j[0],v=j[1],y={state:f,setState:function(t){h(t),e.store(t)}},k={navigation:m,setNavigation:v},O={consented:a,setConsented:r};return Object(i.jsx)(at,{value:y,children:Object(i.jsx)(rt,{value:k,children:Object(i.jsxs)(x,{value:O,children:[Object(i.jsx)(Re,{start:function(e){var n=Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},oe[f.difficultySettings].settings),f.ratingSettings),f.entropySettings),{},{players:Object(s.a)({},f.players),quickDeal:f.quickDeal,boardMode:e,initialized:!0,suggestionMode:f.suggestionMode});t.start(n)}}),Object(i.jsx)(De,{screen:m.screeen})]})})})},Ae=function t(){Object(a.a)(this,t)};Ae._16to9={prefix:"16-to-9",multiplier:1.7778},Ae._4to3={prefix:"4-to-3",multiplier:1.3333};var Le=function(){var t=g.a.useState(0),e=Object(c.a)(t,2),n=e[0],a=e[1],r={boardMode:ce.CUSTOM.boardMode,inputMode:"mouse",initialized:!1,players:o},u=g.a.useState(r),l=Object(c.a)(u,2),d=l[0],f=l[1],p=function(){f(r)},b=(new se).shuffle();if(d.initialized){var j=null;return"singleplayer"==d.boardMode&&(j=Object(i.jsx)(h,{ratio:Ae._4to3,children:Object(i.jsx)("div",{className:"layout-grid-container singleplayer",children:Object(i.jsx)(ie,{player:0,settings:d,restart:p,deck:b})})})),"splitscreen"==d.boardMode&&(j=Object(i.jsxs)("div",{className:"game-layout-container splitscreen",children:[Object(i.jsx)("div",{className:"layout-grid-container "+d.boardMode,children:Object(i.jsx)(ie,{player:0,settings:Object(s.a)(Object(s.a)({},d),{},{inputMode:d.players[0].inputMethod}),restart:p,deck:b.copy()})}),Object(i.jsx)("div",{className:"layout-grid-container "+d.boardMode,children:Object(i.jsx)(ie,{player:1,settings:Object(s.a)(Object(s.a)({},d),{},{inputMode:d.players[1].inputMethod}),restart:p,deck:b.copy()})})]})),Object(i.jsx)(H,{started:n,children:j})}return Object(i.jsx)(h,{ratio:Ae._16to9,children:Object(i.jsx)(Fe,{start:function(t){b.shuffle();var e=Object(s.a)(Object(s.a)({},d),t);f(e),a(Date.now())}})})},He=n(16);n.n(He).a.render(Object(i.jsx)(g.a.StrictMode,{children:Object(i.jsx)(Le,{})}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.bc5881f0.chunk.js.map