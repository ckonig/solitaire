"use strict";(self.webpackChunksolitaire_react=self.webpackChunksolitaire_react||[]).push([[914],{2983:function(t,e,n){n.r(e),n.d(e,{default:function(){return bn}});var s=n(8683),a=n(3718),i=n(3144),o=n(5671),r=n(9340),c=n(8347),u=(n(2542),n(577)),d=n(2791),l=n(885),f=n(184),g={started:0,isEnded:!1,end:0,winner:-1,loser:-1},h=d.createContext({gameState:g,win:function win(){},start:function start(){},giveUp:function giveUp(){}}),p=function useGameContext(){return d.useContext(h)},v=function GameContextProvider(t){var e=d.useState(g),n=(0,l.Z)(e,2),a=n[0],i=n[1],o={gameState:a,win:function win(t){return i((0,s.Z)((0,s.Z)({},a),{},{end:Date.now(),isEnded:!0,winner:t}))},start:function start(){return i((0,s.Z)((0,s.Z)({},a),{},{started:Date.now()}))},giveUp:function giveUp(t){i((0,s.Z)((0,s.Z)({},a),{},{end:Date.now(),isEnded:!0,loser:t}))}};return(0,f.jsx)(h.Provider,{value:o,children:t.children})},k={state:null,replaceContext:function replaceContext(){},updateContext:function updateContext(){},updateGameContext:function updateGameContext(){},restart:function restart(){}},m=d.createContext(k),b=m.Provider,y=function useGlobalContext(){var t=d.useContext(m);if(!t.state)throw new Error("no state present");return(0,s.Z)((0,s.Z)({},t),{},{state:t.state})},x=n(2982),C={end:0,paused:!1,pauses:[],pauseStartedAt:0,allowed:5,pausedBy:-1,showMenu:!1,showCards:!0},S={state:C,togglePause:function togglePause(){},toggleMenu:function toggleMenu(){},getElapsed:function getElapsed(){return""}},Z=d.createContext(S),w=function PauseProvider(t){var e=p().gameState,n=d.useState((0,s.Z)({},C)),a=(0,l.Z)(n,2),i=a[0],o=a[1],r={state:(0,s.Z)((0,s.Z)({},i),{},{started:e.started}),togglePause:function togglePause(t,e){i.showMenu?o((0,s.Z)((0,s.Z)({},i),{},{pausedBy:e,pauses:[].concat((0,x.Z)(i.pauses),[Date.now()-i.pauseStartedAt]),pauseStartedAt:0,paused:!1,showMenu:!1,showCards:!0})):i.pauses.length<i.allowed?o((0,s.Z)((0,s.Z)({},i),{},{pausedBy:e,pauseStartedAt:Date.now(),paused:!0,showMenu:!0,showCards:!1})):o((0,s.Z)((0,s.Z)({},i),{},{pausedBy:e,pauseStartedAt:0,paused:!1,showMenu:!0,showCards:!1}))},toggleMenu:function toggleMenu(t){o((0,s.Z)((0,s.Z)({},i),{},{showMenu:t,showCards:!0}))},getElapsed:function getElapsed(){var t=function padleft(t){return 1===(t+"").length?"0"+t:t},n=function getElapsedMs(){var t=i.pauses.reduce((function(t,e){return t+e}),0);return(i.end||i.pauseStartedAt||Date.now())-e.started-t}(),s=Math.floor(n/1e3/60/60);n-=1e3*s*60*60;var a=Math.floor(n/1e3/60);n-=1e3*a*60;var o=Math.floor(n/1e3);return n-=1e3*o,s?s+":"+t(a)+":"+t(o):t(a)+":"+t(o)}};return(0,f.jsx)(Z.Provider,{value:r,children:t.children})},E=function usePauseContext(){return d.useContext(Z)},M=n(4421),j=function AutoDealerRenderer(t){var e=y(),n=t.length,s=t.started,a=t.paused,i=(0,M.Z)({length:n,paused:a,started:s});return d.useEffect((function(){var t=null;return e.state.settings.launchSettings.speed&&s&&!a&&i&&((null===i||void 0===i?void 0:i.length)!==n||(null===i||void 0===i?void 0:i.started)!==s||(null===i||void 0===i?void 0:i.paused)!==a)&&(t=setTimeout((function(){e.updateContext((function(t){n===t.stock.stack.length&&t.stock.passes>0&&(t.stock.stack.length||t.waste.stack.length)&&(t.hand.isFromWaste()&&t.waste.putDownHand(),t.stock.stack.length?t.waste.addAll(t.stock.popTop()):t.stock.canRecycle()&&t.stock.recycle(t.waste.recycle()))}))}),1e4)),function(){t&&clearTimeout(t)}}),[e,n,a,i,s]),null},T=function AutoDealer(){var t=y().state,e=E(),n=p().gameState,s=e.state.paused;return(0,f.jsx)(j,{length:t.stock.stack.length,paused:s,started:n.started})},A=(0,i.Z)((function Blinker(){var t=this;(0,o.Z)(this,Blinker),this.startBlink=function(e,n){e(n).blinkFor<10&&(e(n).blinkFor=10,n.game.registerBlink(!0),e(n).unblink=function(n){return t.stopBlink(e,n)})},this.stopBlink=function(t,e){t(e).blinkFor=0,e.game.registerBlink(!1)}})),D=(0,i.Z)((function Tableau(){var t=this;(0,o.Z)(this,Tableau),this.blink=function(t,e){return(new A).startBlink((function(t){return t.tableau.stacks[e]}),t)},this.dispatchPutDown=function(e,n,s,a){if(s.tableau.wouldAcceptHand(a)){var i=s.hand.source;s.tableau.putDownHand(a)&&s.game.registerMove("tableau-"+a,i,s.tableau.getTop(a))}else t.blink(s,a)},this.dispatchPickup=function(e,n,s,a){e?s.hand.pickUp(s.tableau.popWithFollowing(e,a),e.source,n)&&s.game.registerPickup():e||t.blink(s,a)}})),H=function(t){(0,r.Z)(TableauHidden,t);var e=(0,c.Z)(TableauHidden);function TableauHidden(){var t;(0,o.Z)(this,TableauHidden);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(t=e.call.apply(e,[this].concat(s))).dispatchPickup=function(e,n,s,a){e&&t.tryUncover(e,a,s)},t.tryUncover=function(t,e,n){return!n.hand.isHoldingCard()&&t.isHidden&&n.tableau.uncover(e,t)&&n.game.registerUncover(n.tableau.getTop(e))},t}return(0,i.Z)(TableauHidden)}(D),P=(0,i.Z)((function Dealer(){var t=this;(0,o.Z)(this,Dealer),this.dealt=void 0,this.dealingAt=void 0,this.isDealt=void 0,this.dealOne=function(t,e){return function(n){return t!==n.dealer.dealt?null:(n.dealer.deal(n.stock,n.tableau),n.dealer.isDealt||e(n.dealer.dealt),n)}},this.dealAll=function(){return function(e){if(t.dealt!==e.dealer.dealt)return null;for(;!e.dealer.isDealt;)e.dealer.deal(e.stock,e.tableau);return e}},this.deal=function(e,n){for(var s=t.dealingAt;s<n.stacks.length;s++){var a=n.stacks[s].stack;if(a.length<=n.stacks.length-s-1){var i=e.popOne();return void(i&&(i.source=n.stacks[s].source,a.length===n.stacks.length-1-s&&(i.isHidden=!1),n.deal(i,s),t.dealt++,t.dealingAt++,t.dealingAt===n.stacks.length&&(t.dealingAt=0),t.isDealt=!1))}var o=0===t.dealingAt;return t.dealingAt=0,void(t.isDealt=o)}t.isDealt=!0},this.dealt=0,this.dealingAt=0,this.isDealt=!1})),N=(0,i.Z)((function Dispatcher(t){var e=this;(0,o.Z)(this,Dispatcher),this.clickHandler=void 0,this.getHandler=function(t){return t&&t.isHoldingCard()?e.dispatchPutDown:e.dispatchPickup},this.dispatchPutDown=function(t,n,s){return function(a){a.hand.isHoldingCard()&&e.clickHandler.dispatchPutDown(t,n,a,s)}},this.dispatchPickup=function(t,n,s){return function(a){a.hand.isHoldingCard()||e.clickHandler.dispatchPickup(t,n,a,s)}},this.clickHandler=t})),I=n(3680),R=(0,i.Z)((function Focus(t,e){var n=this;(0,o.Z)(this,Focus),this.settings=void 0,this.card=void 0,this.stack=void 0,this.keyboard=void 0,this.player=void 0,this.validSettings=function(){return"mouse"!==n.settings.launchSettings.players[n.player].inputMethod},this.isKeyBoard=function(t){n.keyboard=t},this.setCard=function(t){n.card=t,n.stack=""},this.unsetCard=function(t){n.card&&t&&I.Z.equals(n.card,t)&&(n.card=null)},this.unsetStack=function(t){n.stack&&t&&n.stack===t&&(n.stack="")},this.setStack=function(t){n.card=null,n.stack=t},this.hasCard=function(t){return n.keyboard&&n.validSettings()&&I.Z.equals(n.card,t)},this.hasStack=function(t){return n.keyboard&&n.validSettings()&&n.stack&&t&&n.stack===t},this.settings=t,this.card=null,this.stack="",this.keyboard=!1,this.player=e})),U=n(7326),O=(0,i.Z)((function BasicStack(t){var e=this;(0,o.Z)(this,BasicStack),this.source=void 0,this.suggestion=!1,this.stack=[],this.getTop=function(){return e.stack&&e.stack.length&&e.stack[e.stack.length-1]||null},this.getClickable=function(){return e.stack.filter((function(t){return t.canClick()}))},this.blinkFor=0,this.onClick=function(t){return function(t){}},this.clickEmpty=function(t){return function(t){}},this.unblink=function(){},this.accepts=void 0,this.source=t})),B=function(t){(0,r.Z)(HandHoldingStack,t);var e=(0,c.Z)(HandHoldingStack);function HandHoldingStack(t,n){var s;return(0,o.Z)(this,HandHoldingStack),(s=e.call(this,t)).hand=void 0,s.getHandContent=function(){return s.hand.source===s.source?s.hand.stack:[]},s.getClickable=function(){return[].concat((0,x.Z)(s.stack.filter((function(t){return t.canClick()}))),(0,x.Z)(s.getHandContent().filter((function(t){return t.canClick()}))))},s.hand=n,s}return(0,i.Z)(HandHoldingStack)}(O),F=n(9093),L=function(t){(0,r.Z)(FoundationStack,t);var e=(0,c.Z)(FoundationStack);function FoundationStack(t,n,a){var i;return(0,o.Z)(this,FoundationStack),(i=e.call(this,t,n)).acceptedCards=[],i.usedCards=[],i.icon="",i.name="",i.color="",i.getCurrentAccepted=function(){return i.acceptedCards[i.acceptedCards.length-1]},i.accepts=function(t){if(!t)return!1;var e=i.getCurrentAccepted();return i.icon===t.type.icon&&e===t.denomination},i.setOnClick=function(t,e){i.clickEmpty=function(e){return t(null,e)};var n=i.source===e.source?[].concat((0,x.Z)(i.stack),(0,x.Z)(e.stack)):i.stack;n.forEach((function(e,a){e.onClick=function(n){return t((0,s.Z)({},e),n)},e.canClick=function(){return a===n.length-1}})),i.hand.setOnClick((0,U.Z)(i))},i.acceptedCards=(0,x.Z)((0,F.qW)()),i.usedCards=[],i.icon=a.icon,i.color=a.color,i.name=a.name,i}return(0,i.Z)(FoundationStack)}(B),G=(0,i.Z)((function MultiStack(t,e,n){(0,o.Z)(this,MultiStack),this.stacks=void 0,this.settings=void 0,this.hand=void 0,this.stacks=n,this.settings=t,this.hand=e})),K=n(7909),z=function(t){(0,r.Z)(Foundation,t);var e=(0,c.Z)(Foundation);function Foundation(t,n){var s;return(0,o.Z)(this,Foundation),(s=e.call(this,t,n,(0,x.Z)(Object.keys(K.Z).map((function(t){return K.Z[t]})).map((function(t,e){return new L("foundation-"+e,n,t)}))))).setOnClick=function(t){s.stacks.forEach((function(e,n){e.setOnClick((function(e,s){return t(e,s,n)}),s.hand)}))},s.getCurrentAccepted=function(t){return s.stacks[t].getCurrentAccepted()},s.wouldAcceptHand=function(t){return!s.hand.hasMoreThanOneCard()&&s.accepts(t,s.hand.currentCard())},s.putDownHand=function(t){return s.add(t,s.hand.putDown())},s.accepts=function(t,e){return s.stacks[t].accepts(e)},s.add=function(t,e){var n=e[0];return n.causeEntropy(Math.min(s.settings.interactionEntropy,3)),n.source=s.stacks[t].source,s.stacks[t].stack.push(n),s.stacks[t].usedCards.push(s.stacks[t].acceptedCards.pop())},s.remove=function(t,e){return s.stacks[t].acceptedCards.push(s.stacks[t].usedCards.pop()),e&&e.equals(s.getTop(t))&&s.stacks[t].stack.pop()||null},s.getPreviousUsed=function(t){return(0,x.Z)(s.stacks[t].usedCards).pop()},s.countCards=function(){return s.stacks.map((function(t){return t.stack.length})).reduce((function(t,e){return t+e}),0)},s.getTop=function(t){return s.stacks[t].stack[s.stacks[t].stack.length-1]},s.setEntropy=function(t){return s.stacks.forEach((function(e){return e.stack.forEach((function(e){return e.causeEntropy(Math.min(3,t))}))})),(0,U.Z)(s)},s}return(0,i.Z)(Foundation)}(G);z.copy=function(t,e){var n=new z(t.settings,e);return n.stacks=t.stacks.map((function(t){var n=new L(t.source,e,t);return n.stack=I.Z.copyAll(t.stack),n.acceptedCards=(0,x.Z)(t.acceptedCards),n.usedCards=(0,x.Z)(t.usedCards),n.icon=t.icon,n.color=t.color,n})),n};var W=(0,i.Z)((function Foundation(){var t=this;(0,o.Z)(this,Foundation),this.blink=function(t,e){return(new A).startBlink((function(t){return t.foundation.stacks[e]}),t)},this.dispatchPutDown=function(e,n,s,a){if(s.foundation.wouldAcceptHand(a)){var i=s.hand.source;s.foundation.putDownHand(a)&&s.game.registerMove("foundation-"+a,i,s.foundation.getTop(a))}else t.blink(s,a)},this.dispatchPickup=function(e,n,s,a){var i=s.foundation.getTop(a);i&&s.foundation.getPreviousUsed(a)===i.denomination?s.hand.pickUp([s.foundation.remove(a,i)],i.source,n)&&s.game.registerPickup():t.blink(s,a)}})),q=function(){function Rating(t){var e=this;(0,o.Z)(this,Rating),this.settings=void 0,this.points=void 0,this.multiplicator=void 0,this.ratings=void 0,this.applyRating=function(t,n){console.debug("RATING:",n),e.ratings.push({points:t,text:n})},this.registerMove=function(t,n,s){e.registerHint(e.settings.disableHint());var a={source:n,target:t};e.points+=e.rateMove(a,s)},this.registerRecycle=function(){if(e.registerHint(e.settings.disableHint()),"single"===e.settings.launchSettings.drawMode&&"infinite"===e.settings.launchSettings.recyclingMode&&e.points>0){var t=0;e.points<100?(t=-1*e.points,e.points=0):(e.points-=100,t=-100),e.applyRating(t,"subtract ".concat(t," (max 100 points) for RECYCLE"))}},this.registerUncover=function(t){e.registerHint(e.settings.disableHint()),t&&t.setSuccess(5),e.points+=5,e.applyRating(5,"add 5 points for UNCOVER")},this.penalize=function(t){if(e.settings.launchSettings.undoPenalty){var n=Math.pow(2,t.multiplicator);e.applyRating(-1*n,"applying penalty of ".concat(n," points for UNDO")),e.points=Math.min(e.points,t.points)-n,e.multiplicator=t.multiplicator+1}},this.registerHint=function(t){t&&e.settings.launchSettings.hintPenalty&&(e.points-=10,e.applyRating(-10,"applying penalty of 10 points for HINT"))},this.getTimePenalty=function(t,e){var n=(e-t)/1e3;return-2*Math.trunc(n/5)},this.getBonusPoints=function(t,e){var n=(e-t)/1e3;return n<30?0:Math.round(2e4/n*35)},this.getTotal=function(t,n){return e.points+e.getBonusPoints(t,n)-e.getTimePenalty(t,n)},this.settings=t,this.points=0,this.multiplicator=1,this.ratings=[]}return(0,i.Z)(Rating,[{key:"registerBlink",value:function registerBlink(t){t&&this.settings.launchSettings.missPenalty&&(this.points-=10,this.applyRating(-10,"subtract 10 points for invalid action"))}},{key:"rateMove",value:function rateMove(t,e){var n=function isTableau(t){return"tableau"===t.substr(0,7)},s=function isFoundation(t){return"foundation"===t.substr(0,10)};if(n(t.source)){if(s(t.target))return this.applyRating(10,"add 10 points for MOVE tableau -> foundation"),e&&e.setSuccess(10),10}else if("waste"===t.source){if(s(t.target))return this.applyRating(10,"add 10 points for MOVE waste -> foundation"),e&&e.setSuccess(10),10;if(n(t.target))return this.applyRating(5,"add 5 points for MOVE waste -> tableau"),e&&e.setSuccess(5),5}else if(s(t.source)&&n(t.target))return this.applyRating(-15,"subtract 15 points for MOVE foundation -> tableau"),-15;return 0}}]),Rating}();q.copy=function(t){var e=new q(t.settings);return e.points=t.points,e.multiplicator=t.multiplicator,e.ratings=(0,x.Z)(t.ratings),e};var _=function(){function TimeMachine(){var t=this;(0,o.Z)(this,TimeMachine),this.previousStates=void 0,this.memorable=void 0,this.modified=void 0,this.registerMove=function(e,n){t.memorable=!0,t.modified=!0,n===e&&(t.memorable=!1)},this.pushPreviousState=function(e){var n=t.previousStates[t.previousStates.length-1];n&&t.modelEquals(e,n)||t.previousStates.push(e)},this.registerPickup=function(){t.modified=!0,t.memorable=!1},this.popPreviousState=function(e,n){for(var s=t.previousStates.length-1===e,a=function popPrevious(){return s&&t.previousStates&&t.previousStates.pop()},i=a();i&&(!i.game.timemachine.memorable||t.modelEquals(i,n))&&t.previousStates.length;)i=a();return i},this.registerRecycle=function(){t.memorable=!0,t.modified=!0},this.registerUncover=function(){return t.memorable=!0,t.modified=!0,!0},this.stackEquals=function(t,e){return t.stack.every((function(t,n){return I.Z.equals(t,e.stack[n])&&t.isHidden===e.stack[n].isHidden}))},this.stacksEqual=function(e,n){return e.stacks.every((function(e,s){return t.stackEquals(e,n.stacks[s])}))},this.modelEquals=function(e,n){return t.stackEquals(e.stock,n.stock)&&t.stackEquals(e.waste,n.waste)&&t.stacksEqual(e.tableau,n.tableau)&&t.stacksEqual(e.foundation,n.foundation)},this.previousStates=[],this.memorable=!0,this.modified=!1}return(0,i.Z)(TimeMachine,[{key:"registerBlink",value:function registerBlink(t){t&&(this.modified=!0,this.memorable=!1)}}]),TimeMachine}();_.copy=function(t){var e=new _;return e.previousStates=(0,x.Z)(t.previousStates),e.memorable=t.memorable,e.modified=t.modified,e};var V=function(){function Game(t){var e=this;(0,o.Z)(this,Game),this.settings=void 0,this.rating=void 0,this.timemachine=void 0,this.registerMove=function(t,n,s){return e.rating.registerMove(t,n,s),e.timemachine.registerMove(t,n),!0},this.registerPickup=function(){return e.timemachine.registerPickup(),!0},this.registerRecycle=function(){return e.rating.registerRecycle(),e.timemachine.registerRecycle(),!0},this.registerUncover=function(t){return e.rating.registerUncover(t),e.timemachine.registerUncover(),!0},this.settings=t,this.rating=new q(t),this.timemachine=new _}return(0,i.Z)(Game,[{key:"registerBlink",value:function registerBlink(t){return this.rating.registerBlink(t),this.timemachine.registerBlink(t),!0}}]),Game}();V.copy=function(t){var e=new V(t.settings);return e.timemachine=_.copy(t.timemachine),e.rating=q.copy(t.rating),e};var Y=(0,i.Z)((function Hand(){var t=this;(0,o.Z)(this,Hand),this.stack=void 0,this.source=void 0,this.position=void 0,this.filter=function(t){return t.filter((function(t){return t}))},this.pickUp=function(e,n,s){return e&&e[0]&&(t.stack=t.filter(e).map((function(t){return t.suggestion=!1,t})),t.source=n,t.position=s),e},this.putDown=function(){return t.source="",t.stack.splice(0,t.stack.length)},this.setOnClick=function(e){if(t.source&&t.source===e.source){var n=e.clickEmpty;e.stack.length&&(n=e.stack[e.stack.length-1].onClick),t.stack.forEach((function(t){t.onClick=n,t.canClick=function(){return!0}}))}},this.isHoldingCard=function(){return!!t.stack.length},this.isHoldingKing=function(){var e;return t.isHoldingCard()&&t.currentCard()&&"K"===(null===(e=t.currentCard())||void 0===e?void 0:e.denomination)},this.currentCard=function(){return t.isHoldingCard()&&t.stack[0]||null},this.hasMoreThanOneCard=function(){return t.stack.length>1},this.isFromCurrentSource=function(e){return t.source&&e.source===t.source||null},this.isFromWaste=function(){return t.source&&"waste"===t.source||!1},this.isFromFoundation=function(e){return t.source&&t.source==="foundation-".concat(e)},this.isFromTableau=function(e){return t.source&&t.source==="tableau-".concat(e)},this.isFromAnyTableau=function(){return t.source&&"tableau-"===t.source.substring(0,8)},this.getTableauIndex=function(){return t.source&&parseInt(t.source.substring(8))||0},this.stack=[],this.source="",this.position=null}));Y.copy=function(t){var e=new Y;return e.stack=I.Z.copyAll(t.stack),e.source=t.source,e.position=t.position,e};var Q=(0,i.Z)((function Navigator(t){var e=this;(0,o.Z)(this,Navigator),this.model=void 0,this.currentIndex=void 0,this.rows=void 0,this.getZindex=function(t,e){for(var n=t.getClickable(),s=0;s<n.length;s++)if(I.Z.equals(e,n[s]))return s;return 0},this.update=function(t,n){for(var s=0;s<e.rows.length;s++)for(var a=e.rows[s],i=0;i<a.length;i++){var o=a[i];if(o&&o.source===t){var r=e.getZindex(o,n);return e.currentIndex={x:i,y:s,z:r},void e.finishNav()}}},this.valid=function(t){return t.x===e.currentIndex.x&&t.y===e.currentIndex.y&&t.z===e.currentIndex.z},this.moveLeft=function(t){return e.move(t,(function(){e.currentIndex.x--,-1===e.currentIndex.x&&(e.currentIndex.x=6)}))},this.moveRight=function(t){return e.move(t,(function(){e.currentIndex.x++,7===e.currentIndex.x&&(e.currentIndex.x=0)}))},this.move=function(t,n){if(e.valid(t)){n();var s=e.current();s?(e.currentIndex.z=s.getClickable().length-1,e.finishNav()):e.move(e.currentIndex,n)}},this.moveUp=function(t){var n;if(e.valid(t)){var s=null===(n=e.current())||void 0===n?void 0:n.getClickable();s&&s.length&&e.currentIndex.z>0?(e.currentIndex.z--,e.finishNav()):e.toggleRow(!0)}},this.moveDown=function(t){var n;if(e.valid(t)){var s=null===(n=e.current())||void 0===n?void 0:n.getClickable();s&&s.length&&e.currentIndex.z<s.length-1?(e.currentIndex.z++,e.finishNav()):e.toggleRow(!1)}},this.toggleRow=function(t){0===e.currentIndex.y?e.currentIndex.y=1:e.currentIndex.y=0;var n=e.current(),s=n?n.getClickable().length-1:0;e.currentIndex.z=t?s:0,n?e.finishNav():e.moveLeft(e.currentIndex)},this.finishNav=function(){var t,n,s=null===(t=e.current())||void 0===t?void 0:t.getClickable();s&&s[e.currentIndex.z]?e.model.focus.setCard(s[e.currentIndex.z]):e.model.focus.setStack((null===(n=e.current())||void 0===n?void 0:n.source)||"");return!0},this.current=function(){return e.rows[e.currentIndex.y][e.currentIndex.x]},this.pressCurrent=function(t){var n,s=null===(n=e.current())||void 0===n?void 0:n.getClickable();return e.model.focus.card&&e.model.focus.card.canClick()&&s&&s[e.currentIndex.z]&&s[e.currentIndex.z].denomination===e.model.focus.card.denomination&&s[e.currentIndex.z].type.icon===e.model.focus.card.type.icon?function(n){e.model.focus.card&&e.model.focus.card.equals(t.card)&&e.model.focus.card.onClick({isKeyboard:!0})(n)}:e.model.focus.stack&&e.model.focus.stack===t.stack?function(t){var n;null===(n=e.current())||void 0===n||n.clickEmpty({isKeyboard:!0})(t)}:function(t){t.navigator.finishNav(),t.game.timemachine.modified=!0}},this.model=t,this.currentIndex={x:0,y:0,z:0},this.rows=[[this.model.stock,this.model.waste,void 0].concat((0,x.Z)(this.model.foundation.stacks)),(0,x.Z)(this.model.tableau.stacks)]})),J=n(801),X=(0,i.Z)((function Settings(t){var e=this;(0,o.Z)(this,Settings),this.launchSettings=void 0,this.baseEntropy=void 0,this.interactionEntropy=void 0,this.suggestionModes=void 0,this.suggestionMode=void 0,this.featureSwitches=void 0,this.setSuggestionMode=function(t){e.suggestionMode.key!==t&&(e.suggestionMode=J.Z.get(t))},this.enableHint=function(){e.suggestionMode=J.Z.getHintMode()},this.disableHint=function(){return!(!e.suggestionMode.isTemporary||!e.suggestionMode.next)&&(e.suggestionMode=J.Z.get(e.suggestionMode.next),!0)},this.launchSettings=t,this.baseEntropy=t.baseEntropy,this.interactionEntropy=t.interactionEntropy,this.suggestionModes=J.Z.allSuggestionModes(),this.suggestionMode=J.Z.get(t.suggestionMode),this.featureSwitches=t.featureSwitches}));X.copy=function(t){var e=new X(t.launchSettings);return e.suggestionMode=t.suggestionMode,e.baseEntropy=t.baseEntropy,e.interactionEntropy=t.interactionEntropy,e};var $=function(t){(0,r.Z)(Stock,t);var e=(0,c.Z)(Stock);function Stock(t,n){var a;return(0,o.Z)(this,Stock),(a=e.call(this,"stock")).settings=void 0,a.recyclings=void 0,a.passes=void 0,a.setOnClick=function(t){a.clickEmpty=function(e){return t(null,e,null)},a.stack.forEach((function(e,n){e.onClick=function(n){return t((0,s.Z)({},e),n,null)},e.canClick=function(){return n===a.stack.length-1}}))},a.accepts=function(){return!1},a.popOne=function(){return a.stack.pop()},a.recycle=function(t){return!!t.length&&(a.stack=t.reverse().map(a.setCardProperties),a.stack[a.stack.length-1].canClick=function(){return!0},a.recyclings++,!0)},a.setCardProperties=function(t){return t.causeEntropy(Math.min(a.settings.interactionEntropy,1)),t.isHidden=!0,t.source=a.source,t},a.isOnTop=function(t){return t&&t.equals(a.getTop())},a.popTop=function(){var t=[];if("single"===a.settings.launchSettings.drawMode){var e=a.stack.pop();e&&(t=[e])}return"triple"===a.settings.launchSettings.drawMode&&(t=a.stack.splice(a.stack.length-3)),0===a.stack.length&&a.passes--,t},a.setEntropy=function(t){return a.stack.forEach((function(e){return e.causeEntropy(Math.min(t,1))})),(0,U.Z)(a)},a.settings=n,a.stack=t.map(a.setCardProperties),a.recyclings=0,a.passes=-1,"1-pass"===a.settings.launchSettings.recyclingMode&&(a.passes=1),"3-pass"===a.settings.launchSettings.recyclingMode&&(a.passes=3),a}return(0,i.Z)(Stock,[{key:"canRecycle",value:function canRecycle(){return"infinite"===this.settings.launchSettings.recyclingMode||"3-pass"===this.settings.launchSettings.recyclingMode&&this.recyclings<2}}]),Stock}(O);$.copy=function(t){var e=new $([],t.settings);return e.stack=I.Z.copyAll(t.stack),e.passes=t.passes,e.recyclings=t.recyclings,e};var tt=(0,i.Z)((function Stock(t){var e=this;(0,o.Z)(this,Stock),this.navigator=void 0,this.blink=function(t){return(new A).startBlink((function(t){return t.stock}),t)},this.dispatchPutDown=function(t,n,s){return e.blink(s,0)},this.dispatchPickup=function(t,n,s){return null!=t?e.moveToWaste(t,s):e.recycleWaste(s)},this.moveToWaste=function(t,e){return e.stock.isOnTop(t)&&e.waste.addAll(e.stock.popTop())&&e.game.registerMove("waste","stock",e.waste.getTop())},this.recycleWaste=function(t){if(!t.stock.getTop())return!!t.waste.getTop()&&t.stock.canRecycle()&&t.stock.recycle(t.waste.recycle())&&t.game.registerRecycle()&&e.navigator.finishNav()||e.blink(t,0)},this.navigator=t})),et=(0,i.Z)((function Waste(){var t=this;(0,o.Z)(this,Waste),this.blink=function(t){return(new A).startBlink((function(t){return t.waste}),t)},this.dispatchPutDown=function(e,n,s){return s.waste.wouldAcceptHand()&&s.waste.putDownHand()&&s.game.registerMove("waste","waste",s.waste.getTop())||t.blink(s,0)},this.dispatchPickup=function(e,n,s){return e&&s.hand.pickUp([s.waste.popTop(e)],"waste",n)&&s.game.registerPickup()||t.blink(s,0)}})),nt=(0,i.Z)((function Suggestions(){var t=this;(0,o.Z)(this,Suggestions),this.tableau=void 0,this.waste=void 0,this.evaluateOptions=function(e){t.disableAllSuggestions(e),e.settings.suggestionMode.key===J.Z.NONE||t.getUncoverOptions(e)||t.getPutdownSuggestions(e)||e.hand.isHoldingCard()||t.getPickupOptions(e)&&e.settings.suggestionMode.key!==J.Z.FULL||!e.stock.getTop()&&!e.stock.canRecycle()||e.settings.suggestionMode.key===J.Z.SCORED||(e.stock.suggestion=!0)},this.getPutdownSuggestions=function(t,e){if(!t.hand.isHoldingCard()||t.settings.suggestionMode.key===J.Z.NONE)return 0;var n=[];if(t.waste.wouldAcceptHand()&&(t.settings.suggestionMode.key===J.Z.FULL||!t.hand.isFromWaste())){var s={target:"waste",source:t.hand.source};(t.settings.suggestionMode.key!==J.Z.SCORED||t.game.rating.rateMove(s,null)>0)&&(n.push(s),t.waste.suggestion=!0)}return t.foundation.stacks.forEach((function(e,s){if(t.foundation.wouldAcceptHand(s)&&(t.settings.suggestionMode.key===J.Z.FULL||!t.hand.isFromFoundation(s))){var a={target:e.source,source:t.hand.source};(t.settings.suggestionMode.key!==J.Z.SCORED||t.game.rating.rateMove(a,null)>0)&&(n.push(a),e.suggestion=!0)}})),t.tableau.stacks.forEach((function(s,a){if(t.tableau.wouldAcceptHand(a)&&(t.settings.suggestionMode.key===J.Z.FULL||!t.hand.isFromTableau(a))){var i=t.hand.isHoldingKing()&&0===s.stack.length&&t.hand.isFromAnyTableau()&&0===t.tableau.stacks[t.hand.getTableauIndex()].stack.length,o=s.stack.length>0&&t.hand.isFromAnyTableau()&&t.tableau.stacks[t.hand.getTableauIndex()].stack.length>0&&s.stack[s.stack.length-1].denomination===t.tableau.stacks[t.hand.getTableauIndex()].stack[t.tableau.stacks[t.hand.getTableauIndex()].stack.length-1].denomination&&!t.tableau.getTop(t.hand.getTableauIndex()).isHidden,r=!i&&!o;if(!e||t.settings.suggestionMode.key===J.Z.FULL||r){var c={target:s.source,source:t.hand.source};(t.settings.suggestionMode.key!==J.Z.SCORED||t.game.rating.rateMove(c,null)>0)&&(n.push(c),s.suggestion=!0)}}})),n.length},this.getPickupOptions=function(e){var n=!1,s=ot.copy(e);return t.waste.dispatchPickup(s.waste.getTop(),null,s),s.game.timemachine.modified&&t.getPutdownSuggestions(s,!0)>(e.settings.suggestionMode.key===J.Z.FULL?1:0)&&(e.waste.suggestion=!0,n=!0),e.tableau.stacks.forEach((function(s,a){return s.stack.map((function(t,e){return{cardIndex:e,card:t}})).filter((function(t){return!t.card.isHidden})).forEach((function(i){var o=i.card,r=i.cardIndex,c=ot.copy(e);t.tableau.dispatchPickup(o,null,c,a),c.game.timemachine.modified&&t.getPutdownSuggestions(c,!0)>(e.settings.suggestionMode.key===J.Z.FULL?1:0)&&(s.stack[r].suggestion=!0,n=!0)}))})),n},this.getUncoverOptions=function(t){if(!t.hand.isHoldingCard()){var e=t.tableau.stacks.map((function(t,e){return e})).filter((function(e){return t.tableau.getTop(e)&&t.tableau.getTop(e).isHidden}));return e.forEach((function(e){t.tableau.getTop(e).suggestion=!0})),e.length}return 0},this.disableAllSuggestions=function(t){var e=function disableSuggestion(t){t.suggestion=!1,t.stack&&t.stack.forEach(disableSuggestion),t.stacks&&t.stacks.forEach(disableSuggestion)};e(t.waste),e(t.stock),e(t.tableau),e(t.foundation)},this.tableau=new D,this.waste=new et})),st=function(t){(0,r.Z)(TableauStack,t);var e=(0,c.Z)(TableauStack);function TableauStack(){var t;(0,o.Z)(this,TableauStack);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))).id=0,t.accepts=function(e){var n=t.getTop();if(!n)return e&&"K"===e.denomination||!1;if(t.source===(null===e||void 0===e?void 0:e.source))return!0;if(n.isHidden)return!1;var s=(0,x.Z)((0,F.bf)());return(e?s.indexOf(e.denomination):0)+1===s.indexOf(n.denomination)&&(null===e||void 0===e?void 0:e.type.color)!==n.type.color&&"A"!==n.denomination},t.getTop=function(e){return t.stack[t.stack.length-1-(e||0)]},t.canUncover=function(e){return t.getTop().isHidden&&e&&e.equals(t.getTop())},t.setOnClick=function(e,n){t.clickEmpty=function(t){return e(null,t)};var a=t.source===t.hand.source?[].concat((0,x.Z)(t.stack),(0,x.Z)(t.hand.stack)):t.stack;a.forEach((function(i,o){var r=i.isHidden&&o===a.length-1?n:e;i.onClick=function(t){return r((0,s.Z)({},i),t)},i.canClick=function(){return!i.isHidden||t.canUncover(i)&&!t.hand.currentCard()||!1}})),t.hand.setOnClick((0,U.Z)(t))},t}return(0,i.Z)(TableauStack)}(B);st.copy=function(t){var e=new st(t.source,t.hand);return e.id=t.id,e.stack=I.Z.copyAll(t.stack),e};var at=function(t){(0,r.Z)(Tableau,t);var e=(0,c.Z)(Tableau);function Tableau(t,n){var s;return(0,o.Z)(this,Tableau),(s=e.call(this,t,n,[0,1,2,3,4,5,6].map((function(t){var e=new st("tableau-"+t,n);return e.id=t,e})))).setOnClick=function(t,e){s.stacks.forEach((function(n,s){n.setOnClick((function(e,n){return t(e,n,s)}),(function(t,n){return e(t,n,s)}))}))},s.getStack=function(t){return s.stacks[t]},s.wouldAcceptHand=function(t){return s.canPutDown(s.getTop(t),s.hand,t)},s.putDownHand=function(t){return s.add(t,s.hand.source,s.hand.putDown())},s.canPutDown=function(t,e,n){return t&&t.isHidden&&e.isFromCurrentSource(t)||s.accepts(n,e.currentCard())||!t&&e.isFromTableau(n)},s.accepts=function(t,e){return!!e&&s.stacks[t].accepts(e)},s.getCard=function(t,e){for(var n=0;n<s.stacks[t].stack.length;n++)if(e&&e.equals(s.stacks[t].stack[n])&&e.isHidden===s.stacks[t].stack[n].isHidden)return s.stacks[t].stack[n];return!1},s.popWithFollowing=function(t,e){for(var n=0;n<s.stacks[e].stack.length;n++)if(t&&t.equals(s.stacks[e].stack[n])){var a=s.stacks[e].stack.splice(n,s.stacks[e].stack.length);return s.stackEntropy(e),a}return[]},s.deal=function(t,e){s.stacks[e].stack.push(t)},s.canUncover=function(t,e){return s.stacks[t].canUncover(e)},s.uncover=function(t,e){var n=s.getTop(t);return!!s.canUncover(t,e)&&(n.isHidden=!1,s.stackEntropy(t),!0)},s.stackEntropy=function(t){for(var e=s.settings.interactionEntropy,n=1,a=s.getTop(t);e&&0!==e&&a;)a.causeEntropy(e),e--,a=s.getTop(t,n),n++},s.add=function(t,e,n){return s.stacks[t].stack=s.stacks[t].stack.concat(n.map((function(e){return s.setCardProperties(e,t)}))),s.stackEntropy(t),n},s.setCardProperties=function(t,e){return t.source=s.stacks[e].source,t},s.getTop=function(t,e){return s.stacks[t].getTop(e)},s.setEntropy=function(t){return s.stacks.forEach((function(e){return e.stack.forEach((function(e){return e.causeEntropy(Math.min(t,4))}))})),(0,U.Z)(s)},s}return(0,i.Z)(Tableau)}(G);at.copy=function(t,e){var n=new at(t.settings,e);return n.stacks=t.stacks.map(st.copy),n};var it=function(t){(0,r.Z)(Waste,t);var e=(0,c.Z)(Waste);function Waste(t,n){var a;return(0,o.Z)(this,Waste),(a=e.call(this,"waste",n)).settings=void 0,a.setOnClick=function(t){a.clickEmpty=function(e){return t(null,e,null)};var e=a.source===a.hand.source?[].concat((0,x.Z)(a.stack),(0,x.Z)(a.hand.stack)):a.stack;e.forEach((function(n,a){n.onClick=function(e){return t((0,s.Z)({},n),e,null)},n.canClick=function(){return a===e.length-1}})),a.hand.setOnClick((0,U.Z)(a))},a.putDownHand=function(){return a.addAll(a.hand.putDown())},a.add=function(t){return t&&a.stack.push(a.setCardProperties(t))},a.addAll=function(t){return t&&t.length&&t.map(a.add)},a.setCardProperties=function(t){return t.source=a.source,t.isHidden=!1,t.causeEntropy(Math.min(a.settings.interactionEntropy,1)),t},a.wouldAcceptHand=function(){return a.hand.isFromWaste()&&a.canAdd(a.hand.currentCard())},a.accepts=function(t){return a.canAdd(t)||!1},a.canAdd=function(t){return t&&(!a.getTop()||!t.equals(a.getTop()))},a.popTop=function(t){return t&&t.equals(a.getTop())&&a.stack.pop()||null},a.recycle=function(){return a.stack.splice(0,a.stack.length)},a.setEntropy=function(t){return a.stack.forEach((function(e){return e.causeEntropy(Math.min(t,1))})),(0,U.Z)(a)},a.settings=t,a}return(0,i.Z)(Waste)}(B);it.copy=function(t,e){var n=new it(t.settings,e);return n.stack=I.Z.copyAll(t.stack),n};var ot=(0,i.Z)((function Model(t){var e=this;(0,o.Z)(this,Model),this.stock=void 0,this.waste=void 0,this.foundation=void 0,this.tableau=void 0,this.hand=void 0,this.game=void 0,this.settings=void 0,this.focus=void 0,this.suggestor=void 0,this.dealer=void 0,this.navigator=void 0,this.token=void 0,this.setToken=function(t){e.token=t},this.withSuggestions=function(){return e.suggestor.evaluateOptions(e),e},this._hasSuggestion=function(t){return t.suggestion||t.stack&&t.stack.some(e._hasSuggestion)||t.stacks&&t.stacks.some(e._hasSuggestion)},this.hasNonStockSuggestions=function(){return e._hasSuggestion(e.waste)||e._hasSuggestion(e.tableau)||e._hasSuggestion(e.foundation)},this.hasSuggestions=function(){return e._hasSuggestion(e.waste)||e._hasSuggestion(e.stock)||e._hasSuggestion(e.tableau)||e._hasSuggestion(e.foundation)},this.canAutoSolve=function(){return 0===e.waste.stack.length&&0===e.stock.stack.length&&e.tableau.stacks.every((function(t){return t.stack.every((function(t){return!t.isHidden}))}))},this.setEntropy=function(t){e.settings.baseEntropy=t,e.stock.setEntropy(t),e.waste.setEntropy(t),e.foundation.setEntropy(t),e.tableau.setEntropy(t)},this.clearSuccess=function(t){var n=function clear(t,e){e.stack.forEach((function(e){e.equals(t)&&(e.success=0)}))};n(t,e.stock),n(t,e.waste),e.foundation.stacks.forEach((function(e){return n(t,e)})),e.tableau.stacks.forEach((function(e){return n(t,e)}))},this.withHandlers=function(){var t=function getHandler(t){return new N(t).getHandler(e.hand)};return e.stock.setOnClick(t(new tt(e.navigator))),e.waste.setOnClick(t(new et)),e.foundation.setOnClick(t(new W)),e.tableau.setOnClick(t(new D),t(new H)),e},this.stock=t.stock,this.waste=t.waste,this.foundation=t.foundation,this.tableau=t.tableau,this.hand=t.hand,this.game=t.game,this.settings=t.settings,this.focus=t.focus,this.suggestor=new nt,this.dealer=new P,this.navigator=new Q(this),this.token=t.token}));ot.getInitialState=function(t,e,n){var s=new X(t),a=new Y,i={stock:new $((0,x.Z)(e.cards),s),waste:new it(s,a),foundation:new z(s,a),tableau:new at(s,a),hand:a,game:new V(s),settings:s,focus:new R(s,n),token:0};return new ot(i)},ot.copy=function(t){var e=Y.copy(t.hand);return new ot({stock:$.copy(t.stock),waste:it.copy(t.waste,e),foundation:z.copy(t.foundation,e),tableau:at.copy(t.tableau,e),hand:e,game:V.copy(t.game),settings:X.copy(t.settings),focus:t.focus,token:t.token})};var rt=function RenderAutoSolve(t){var e=d.useState(!1),n=(0,l.Z)(e,2),s=n[0],a=n[1],i=y(),o=i.state,r=i.updateGameContext;return d.useEffect((function(){t.canAutosolve&&(r((function(t){return t.settings.suggestionMode=J.Z.get(J.Z.NONE)})),a(!0))}),[t.canAutosolve,r]),s&&o.settings.suggestionMode.key===J.Z.NONE?(0,f.jsx)(ut,{}):null},ct=function AutoSolver(){var t=y().state;return(0,f.jsx)(rt,{canAutosolve:t.canAutoSolve()})},ut=function Solver(){var t=y(),e=t.state,n=t.updateGameContext;return d.useEffect((function(){var t=setTimeout((function(){var t=ot.copy(e).withHandlers();if(t.hand.currentCard()){if(t.settings.suggestionMode=J.Z.get(J.Z.SCORED),t.suggestor.evaluateOptions(t),t._hasSuggestion(t.foundation)){var s=t.foundation.stacks.filter((function(e){return t._hasSuggestion(e)}));if(s.length){var a=s[0];n(a.clickEmpty({isKeyboard:!1}))}}}else if(t.settings.suggestionMode=J.Z.get(J.Z.SCORED),t.suggestor.evaluateOptions(t),t._hasSuggestion(t.tableau)){var i=t.tableau.stacks.filter((function(e){return t._hasSuggestion(e)}));if(i.length){var o=i[0].stack.filter((function(t){return t.suggestion}));if(o.length){var r=o[0];n(r.onClick({isKeyboard:!1}))}}}}),150);return function(){return clearTimeout(t)}})),null},dt=function useTokenEffect(t){var e=y().state;return d.useEffect(t,[e.token])},lt=function Uncoverer(){var t=y(),e=t.state,n=t.updateGameContext;return dt((function(){e.hand.currentCard()||e.tableau.stacks.forEach((function(t){t.getTop()&&t.getTop().isHidden&&t.getTop().canClick()&&n(t.getTop().onClick({isKeyboard:!0}))}))})),null},ft=function AutoUncoverer(){var t=y().state,e=p().gameState;return t.settings.launchSettings.autoUncover&&e.started?(0,f.jsx)(lt,{}):null},gt=n(3890),ht=n(517),pt=n(8391),vt=d.createContext({player:0}),kt=function useBoardContext(){return d.useContext(vt)},mt=vt.Provider,bt=function BoardGamePad(t){var e=y().state,n=kt().player,s="gamepad"===e.settings.launchSettings.players[n].inputMethod,a=e.settings.launchSettings.boardMode===gt.Z.SINGLEPLAYER,i=function switchToGamePad(t){t.focus.isKeyBoard(!0),a&&(t.settings.launchSettings.players[n].inputMethod="gamepad")};return a||s?(0,f.jsx)(ht.Z,{layout:pt.Z,gamepadIndex:e.settings.launchSettings.players[n].inputLayout,onLeft:function onLeft(){return t.onLeft(i)},onRight:function onRight(){return t.onRight(i)},onUp:function onUp(){return t.onUp(i)},onDown:function onDown(){return t.onDown(i)},onAction:function onAction(){return t.onAction(i)},onCancel:function onCancel(){return t.onCancel(i)},onHint:function onHint(){return t.onHint(i)},onUndo:function onUndo(){return t.onUndo()},onPause:function onPause(){return t.onPause(i)},onMenu:function onMenu(){return t.onMenu(i)}}):null},yt=n(1453),xt=n(9847),Ct=function BoardKeyboard(t){var e=y().state,n=kt().player,s="keyboard"===e.settings.launchSettings.players[n].inputMethod,a=e.settings.launchSettings.boardMode===gt.Z.SINGLEPLAYER,i=a?yt.dR:(0,yt.Vc)(e.settings.launchSettings.players[n].inputLayout),o=function switchToKeyboard(t){t.focus.isKeyBoard(!0),a&&(t.settings.launchSettings.players[n].inputMethod="keyboard")};return s||a?(0,f.jsx)(xt.Z,{layout:i,onLeft:function onLeft(){return t.onLeft(o)},onRight:function onRight(){return t.onRight(o)},onUp:function onUp(){return t.onUp(o)},onDown:function onDown(){return t.onDown(o)},onAction:function onAction(){return t.onAction(o)},onCancel:function onCancel(){return t.onCancel(o)},onHint:function onHint(){return t.onHint(o)},onUndo:function onUndo(){return t.onUndo()},onPause:function onPause(){return t.onPause(o)},onMenu:function onMenu(){return t.onMenu(o)}}):null},St=function BoardNavigator(){var t=y(),e=t.state,n=t.updateContext,a=t.updateGameContext,i=t.replaceContext,o=E(),r=kt().player,c={x:e.navigator.currentIndex.x,y:e.navigator.currentIndex.y,z:e.navigator.currentIndex.z},u={card:e.focus.card,stack:e.focus.stack},d=!!o.state.paused,l={onLeft:function onLeft(t){return n((function(e){t(e),e.navigator.moveLeft(c)}))},onRight:function onRight(t){return n((function(e){t(e),e.navigator.moveRight(c)}))},onUp:function onUp(t){return n((function(e){t(e),e.navigator.moveUp(c)}))},onDown:function onDown(t){return n((function(e){t(e),e.navigator.moveDown(c)}))},onAction:function onAction(t){return a((function(n){var s;t(n);var a=null===e||void 0===e||null===(s=e.navigator)||void 0===s?void 0:s.pressCurrent(u);a&&a(n),n.navigator.finishNav()}))},onCancel:function onCancel(t){return n((function(e){t(e),e.hand.stack.length&&e.hand.stack[0].onClick({isKeyboard:!0})(e)}))},onPause:function onPause(t){n((function(e){t(e)})),o.togglePause(d,r)},onHint:function onHint(t){n((function(e){t(e),function isVisible(t){return t.settings.suggestionMode.supportsHints||t.settings.suggestionMode.isTemporary}(e)&&!function isDisabled(t){return t.settings.suggestionMode.isTemporary}(e)&&e.settings.enableHint()}))},onUndo:function onUndo(){e.settings.featureSwitches.undo&&i((function(t){var n=t.game.timemachine.popPreviousState(e.game.timemachine.previousStates.length-1,e);return n?(n.game.rating.penalize(t.game.rating),n):null}))},onMenu:function onMenu(t){n((function(e){t(e)})),o.togglePause(d,r)}};return o.state.showMenu?null:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(Ct,(0,s.Z)({},l)),(0,f.jsx)(bt,(0,s.Z)({},l))]})},Zt=n(263),wt=function Dealer(){var t=y(),e=t.state,n=t.replaceContext,s=p(),a=s.gameState,i=s.start;return(0,Zt.Z)((function(){if(!a.started){var t=[];if(!e.settings.launchSettings.quickDeal){return function deal(s){return t.push(setTimeout((function(){e.dealer.isDealt?i():n(e.dealer.dealOne(s,deal))}),35))}(e.dealer.dealt),function(){return t.forEach((function(t){return clearTimeout(t)}))}}e.dealer.isDealt||(i(),n(e.dealer.dealAll()))}})),null},Et=n(6651),Mt=n(6874),jt=n(2108),Tt=n(2083),At=n(8133),Dt=function PossibleFailScreen(){var t=y().state,e=d.useState({refused:!1,since:0}),n=(0,l.Z)(e,2),s=n[0],a=n[1],i=function refuse(t){a({refused:!(s.since>=3)&&t,since:s.since>=3?0:s.since+1})};dt((function(){!t.hand.currentCard()&&s.refused&&i(!0)}));var o=E(),r=y().restart;return d.useEffect((function(){return o.state.showMenu||o.toggleMenu(!0),function(){return o.toggleMenu(!1)}}),[s.refused]),s.refused?null:(0,f.jsx)(At.K,{children:(0,f.jsx)("div",{className:"gamemenu menu dialog",children:(0,f.jsx)("div",{className:"startscreen-jail",children:(0,f.jsxs)("div",{className:"innermenu",children:[(0,f.jsx)(jt.Z,{icon:Et._4g}),(0,f.jsx)("div",{className:"announcement",children:"The game might be over"}),(0,f.jsxs)(Tt.Z,{keyboardLayout:yt.dR,children:[(0,f.jsx)(Mt.Z,{icon:Et._86,title:"Keep trying",onClick:function onClick(){i(!0)}}),(0,f.jsx)(Mt.Z,{icon:Et.QkA,title:"Give up",onClick:function onClick(){return r()}})]})]})})})})},Ht=function FailDetector(){var t=y().state,e=p().gameState,n=d.useState({any:!1,stock:!1,nonStock:!1}),s=(0,l.Z)(n,2),a=s[0],i=s[1];dt((function(){if(e.started){var n=ot.copy(t);n.settings.suggestionMode=J.Z.get(J.Z.FULL),n.suggestor.evaluateOptions(n),i({any:n.hasSuggestions(),stock:n._hasSuggestion(n.stock),nonStock:n.hasNonStockSuggestions()})}}));var o=d.useState([]),r=(0,l.Z)(o,2),c=r[0],u=r[1],g=d.useState(!1),h=(0,l.Z)(g,2),v=h[0],k=h[1];return d.useEffect((function(){if(!t.hand.currentCard()&&e.started)if(a.nonStock)u([]),k(!1);else if(a.stock&&!a.nonStock){var n=t.stock.getTop();n&&u([].concat((0,x.Z)(c),[n])),t.stock.stack.length+t.waste.stack.length<=c.length&&k(!0)}else a.any||k(!0)}),[a]),v?(0,f.jsx)(Dt,{}):null},Pt=function Detector(){var t=y().state,e=p().win,n=kt().player;return d.useEffect((function(){t.hand.currentCard()||52!==t.foundation.countCards()||e(n)}),[t.token,t.foundation,t.hand,n,e]),null},Nt=function WinDetector(){var t=y().state,e=p().gameState;return!e.isEnded&&!!t.settings.launchSettings.autoUncover&&!!e.started&&(0,f.jsx)(Pt,{})||null},It=function Actors(){return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(wt,{}),(0,f.jsx)(St,{}),(0,f.jsx)(ct,{}),(0,f.jsx)(Nt,{}),(0,f.jsx)(Ht,{}),(0,f.jsx)(T,{}),(0,f.jsx)(ft,{})]})},Rt=n(8201),Ut=function DndPreview(t){var e=d.useState(),n=(0,l.Z)(e,2),i=n[0],o=n[1],r=d.useContext(a.w),c=r.width,u=r.height;d.useEffect((function(){var e=t.reff.getBoundingClientRect();o({left:-1*e.left,top:-1*e.top})}),[t.reff,c,u]);var g=(0,Rt.uL)(),h=g.display,p=g.item,v=g.style;return h&&i&&p?(0,f.jsx)("div",{style:(0,s.Z)((0,s.Z)({},v),{},{position:"relative",width:"100%",left:i.left,top:i.top,zIndex:2e3,opacity:1}),children:p.render}):null},Ot=n(6584),Bt=function Firework(t){var e=d.createRef();return d.useEffect((function(){if(e&&e.current&&t.intensity){var n=15*t.intensity,s=window.innerWidth/10.8/100,a={ticks:50,origin:{x:.5,y:.33},particleCount:40,startVelocity:20*s,decay:.8,spread:360,scalar:s},i=Ot.Z.create(e.current,{resize:!0}),o=function fire(t,e){i(Object.assign({},a,e,{particleCount:Math.floor(n*t)}))};o(.25,{startVelocity:55*s}),o(.2,{decay:1.2}),o(.35,{decay:.91,scalar:s-.2}),o(.1,{startVelocity:25*s,decay:.92,scalar:s+.2}),o(.1,{}),o(.1,{startVelocity:45*s})}}),[e,t.intensity]),(0,f.jsx)("canvas",{ref:e})},Ft=function CardFirework(t){var e=y(),n=e.state,s=e.updateContext;return d.useEffect((function(){if(t.model.success&&n.settings.featureSwitches.confetti){var e=setTimeout((function(){return s((function(e){return e.clearSuccess(t.model)}))}));return function(){return clearTimeout(e)}}}),[t.model.success]),n.settings.featureSwitches.confetti?(0,f.jsx)(Bt,{intensity:t.model.success}):null};var Lt=n.p+"static/media/CLUB-1.b900a523f876c8ff4a0da51f88cb05e9.svg";var Gt=n.p+"static/media/CLUB-10.57385ac21a83d9c587a5b7a5f625a223.svg";var Kt=n.p+"static/media/CLUB-11-JACK.458c5f1c40cb7ac950d2e1ad96b1c61d.svg";var zt=n.p+"static/media/CLUB-12-QUEEN.e188a1f66afca1a0fa470a662679326a.svg";var Wt=n.p+"static/media/CLUB-13-KING.c0f55141fa91d2bbd6af11fb7f59c657.svg";var qt=n.p+"static/media/CLUB-2.55a5027e0ac4947ee95cc2f681895066.svg";var _t=n.p+"static/media/CLUB-3.edf0f55af8212c03e82e9e2341a08786.svg";var Vt=n.p+"static/media/CLUB-4.d0eb3cb31de2b6124264d333da27b465.svg";var Yt=n.p+"static/media/CLUB-5.d03464980b46552ac2d674db44dadc0a.svg";var Qt=n.p+"static/media/CLUB-6.ce5287a3ddb0ba9020ac7ebca5de4d0a.svg";var Jt=n.p+"static/media/CLUB-7.f48b88f6bbb17aa64c47e2447c955b91.svg";var Xt=n.p+"static/media/CLUB-8.a9dd2b901c80c5579322581e60489566.svg";var $t=n.p+"static/media/CLUB-9.55f0dd2eb26a4faae6445946739d170c.svg";var te=n.p+"static/media/DIAMOND-1.1166fdfc12b5b1777367dde6e467eecf.svg";var ee=n.p+"static/media/DIAMOND-10.eb0b29b93b3cfde3acae403e1b466fad.svg";var ne=n.p+"static/media/DIAMOND-11-JACK.285fab8df51721215e20c7d4586a0a8e.svg";var se=n.p+"static/media/DIAMOND-12-QUEEN.2f526e12967402639b7bfb796c54440f.svg";var ae=n.p+"static/media/DIAMOND-13-KING.1b1717d0fa3473bd73c45dc46139920f.svg";var ie=n.p+"static/media/DIAMOND-2.b075d6f33b5848b09e98762264014f93.svg";var oe=n.p+"static/media/DIAMOND-3.4e411bb3baef8cf64aa23f9b631620c7.svg";var re=n.p+"static/media/DIAMOND-4.27e8cea35e9ae9aa2c222e95625943f5.svg";var ce=n.p+"static/media/DIAMOND-5.665a4f0c72d25225099beb90db322086.svg";var ue=n.p+"static/media/DIAMOND-6.bacd281a27d6846421c17e96049f003e.svg";var de=n.p+"static/media/DIAMOND-7.7ec7743fba8e63e648811e9de9560739.svg";var le=n.p+"static/media/DIAMOND-8.5d640bd92c2cd8b6b813fce87e81cae7.svg";var fe=n.p+"static/media/DIAMOND-9.700f00e5c1f7302f7abb7bf99bc483fd.svg";var ge=n.p+"static/media/HEART-1.2929afdd6c0d58bc57296a090eebc185.svg";var he=n.p+"static/media/HEART-10.7b8b3c75a75b2c759eb724b720c4df01.svg";var pe=n.p+"static/media/HEART-11-JACK.dc844d9109ca5da6cfacfcd9ff9b7d08.svg";var ve=n.p+"static/media/HEART-12-QUEEN.2f9afdac9e3da7c8e2a4658a72cf1831.svg";var ke=n.p+"static/media/HEART-13-KING.15a3268da14b98c97163a5557b3b058c.svg";var me=n.p+"static/media/HEART-2.c4559df8a2d3dcd0ff97fe8452c7caab.svg";var be=n.p+"static/media/HEART-3.77f8071e66223527f1c2db7444f527bf.svg";var ye=n.p+"static/media/HEART-4.1a98de28a5fb63a2e13037b9f43d761d.svg";var xe=n.p+"static/media/HEART-5.f9be86ff64688967bf589bdde2e4c79f.svg";var Ce=n.p+"static/media/HEART-6.3dbfae8097497943933fc42a76881355.svg";var Se=n.p+"static/media/HEART-7.7ef546024d3dd377c7ff829d9a1d7798.svg";var Ze=n.p+"static/media/HEART-8.bd807bd79d7bd2cd882db9cd1d5a1038.svg";var we=n.p+"static/media/HEART-9.b1b5477b4357ef223f7e36d614abdd42.svg";var Ee=n.p+"static/media/SPADE-1.12c251df840ca2ee069ec23a8011a800.svg";var Me=n.p+"static/media/SPADE-10.6d0fcaaaeadce8948e7d1f5548f038dd.svg";var je=n.p+"static/media/SPADE-11-JACK.e184fca23474c1822fffa0fc79885554.svg";var Te=n.p+"static/media/SPADE-12-QUEEN.f4296a7fec74cb75ae6c56c3cb051c37.svg";var Ae=n.p+"static/media/SPADE-13-KING.8a23f20d384c69d42ecd360138036607.svg";var De=n.p+"static/media/SPADE-2.97b70fd67c0ceabde0d001deb1865abc.svg";var He=n.p+"static/media/SPADE-3.59f9e1eb7b387080ca8aaa79e822868d.svg";var Pe=n.p+"static/media/SPADE-4.5d79e1d440e91b4dec42372deba2a0c5.svg";var Ne=n.p+"static/media/SPADE-5.087b1fae9909f2623da56b795ad01423.svg";var Ie=n.p+"static/media/SPADE-6.96608736ee4f57b8de4a443ec9f77f29.svg";var Re=n.p+"static/media/SPADE-7.5fab32260ce1893a6ee308e6394b6094.svg";var Ue=n.p+"static/media/SPADE-8.fe80d5133ce4cab9b15ecabcfec729b6.svg";var Oe={heart:{2:me,3:be,4:ye,5:xe,6:Ce,7:Se,8:Ze,9:we,10:he,J:pe,Q:ve,K:ke,A:ge},club:{2:qt,3:_t,4:Vt,5:Yt,6:Qt,7:Jt,8:Xt,9:$t,10:Gt,J:Kt,Q:zt,K:Wt,A:Lt},diamond:{2:ie,3:oe,4:re,5:ce,6:ue,7:de,8:le,9:fe,10:ee,J:ne,Q:se,K:ae,A:te},spade:{2:De,3:He,4:Pe,5:Ne,6:Ie,7:Re,8:Ue,9:n.p+"static/media/SPADE-9.bd5ab77e9a2ade2152cfcecf0c14a21f.svg",10:Me,J:je,Q:Te,K:Ae,A:Ee}},Be=n(6541),Fe=function ReRender(t){return(0,f.jsx)(Le,(0,s.Z)({},(0,s.Z)((0,s.Z)({},t),{},{models:t.models.slice(t.index,t.models.length),offsetLeft:function offsetLeft(){return 0},isSelected:function isSelected(){return!1},index:0})))};Fe.displayName="ReRender";var Le=function Card(t){var e=kt().player,n=y(),a=n.state,i=n.updateGameContext,o=E(),r=d.useRef(null),c=d.useState(!!t.isDrag),u=(0,l.Z)(c,2),g=u[0],h=u[1],p=t.models[t.index],v=(0,d.useCallback)((function(){return!!p&&a.focus.hasCard(p)||!1}),[p,a.focus]),k=(0,d.useCallback)((function(){return t.isDrag||g}),[t.isDrag,g]),m=(0,Be.c)({type:"card",item:function item(e){return h(!0),!p.onClick||t.isSelected&&t.isSelected(t.index)||i((function(t){p.onClick({isKeyboard:!1})(t)})),{type:"card",model:p,render:Fe(t)}},collect:function collect(t){return{opacity:(t.isDragging(),1)}},canDrag:function canDrag(){return p.canClick()&&!p.isHidden&&(null===a.hand.currentCard()||p.equals(a.hand.currentCard()))},end:function end(t,e){h(!1),e.didDrop()||setTimeout((function(){return i((function(t){p.onClick({isKeyboard:!1})(t)}))}),1)}}),b=(0,l.Z)(m,2),x=b[0].opacity,C=b[1],S=(0,d.useCallback)((function(){return p.canClick()?C:r}),[r,p,C]),Z=function useClassName(t,e,n,s){var a=(0,d.useCallback)((function(){if(!t)return"card card-base";var a=e.isSuggested&&e.isSuggested(e.index)||t.suggestion,i="card card-base";return i+=e.isSelected&&e.isSelected(e.index)||s()||a?"":" card-stack-".concat(t.source),i+=!n()&&e.isSelected&&e.isSelected(e.index)&&!n()?" card-selected":"",i+=e.blink?" blink":"",i+=t.canClick()?" clickable":"",(i+=a&&!s()?" card-suggested":"")+(s()?" card-focused":"")}),[n,s,t,e]),i=d.useState(a()),o=(0,l.Z)(i,2),r=o[0],c=o[1];return d.useEffect((function(){c(a())}),[a]),r}(p,t,k,v),w=function useCardStyle(t,e,n,a){var i=(0,d.useCallback)((function(){if(!t)return{};var i=(0,s.Z)({opacity:n()?0:a,zIndex:(e.zIndex?e.zIndex:20*(e.offsetTop&&e.offsetTop(e.index,e.models)>0?1:0))+1,top:e.offsetTop?e.offsetTop(e.index,e.models)/15+"em":0},t.entropyStyle);return e.offsetLeft&&(i.left=2*e.offsetLeft(e.index)+"em"),t.onClick||(i.pointerEvents="none"),i}),[t,e,n,a]),o=d.useState(i()),r=(0,l.Z)(o,2),c=r[0],u=r[1];return d.useEffect((function(){u(i)}),[i]),c}(p,t,k,x),M=function useStackBaseStyle(t){var e=(0,d.useCallback)((function(){return t&&t.onClick?{}:{pointerEvents:"none"}}),[t]),n=d.useState(e()),s=(0,l.Z)(n,2),a=s[0],i=s[1];return d.useEffect((function(){i(e())}),[e]),a}(p);return t.models.length?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{style:M,className:"stack-base",children:(0,f.jsxs)("button",{style:w,ref:S(),className:Z,onClick:function onClick(t){var n,s,o,r,c,u;t.preventDefault();for(var d=0===t.clientX&&0===t.clientY,l=t.target;l&&!l.className.includes("card-base")&&l.offsetParent;)l=l.offsetParent;var f=l.getBoundingClientRect(),g={isKeyBoard:d,click:{x:t.clientX-((null===(n=l)||void 0===n||null===(s=n.ownerDocument)||void 0===s||null===(o=s.defaultView)||void 0===o?void 0:o.pageXOffset)||0),y:t.clientY-((null===(r=l)||void 0===r||null===(c=r.ownerDocument)||void 0===c||null===(u=c.defaultView)||void 0===u?void 0:u.pageYOffset)||0)},element:{x:f.x,y:f.y}},h=a.settings.launchSettings.boardMode===gt.Z.SINGLEPLAYER;p.onClick&&!g.isKeyBoard&&i((function(t){p.onClick(g)(t),h&&(t.settings.launchSettings.players[e].inputMethod="mouse")}))},disabled:!p.canClick()||!o.state.showCards,tabIndex:p.canClick()?0:-1,children:[(0,f.jsx)(Ft,{model:p}),(0,f.jsx)("div",{className:"card-content",children:p.isHidden||!o.state.showCards?(0,f.jsx)("div",{className:"card-back",children:"\xa0"}):(0,f.jsx)("img",{width:"100%",src:Oe[p.type.name][p.denomination],alt:"".concat(p.type.name," ").concat(p.denomination)})})]})}),t.models.length-1>t.index&&(0,f.jsx)(Card,(0,s.Z)((0,s.Z)({},t),{},{isDrag:k(),index:t.index+1}))]}):null},Ge=Le,Ke=n(1523),ze=n.n(Ke),We=function StackBase(t){var e=y(),n=e.state,s=e.updateGameContext,a=(0,d.useCallback)((function(){var e="card-base socket";return t.model.stack.length?e+=" socket-full":t.model.blinkFor?e+=" socket-blink":n.focus.hasStack(t.model.source)?e+=" socket-focused":e+=" socket-empty",t.model.suggestion&&!t.model.stack.length&&(e+=" socket-suggested"),e}),[t.model.stack.length,t.model.suggestion,t.model.blinkFor,t.model.source,n.focus]);return(0,f.jsx)("button",{className:a(),onClick:function onClick(e){e.preventDefault();var n=0===e.clientX&&0===e.clientY;n||s(t.model.clickEmpty({isKeyBoard:n}))},disabled:!!t.model.stack.length,tabIndex:t.model.stack.length?-1:0,children:t.children})},qe=function useBlinkEffect(t){var e=y(),n=e.updateContext,s=e.state,a=t(s);d.useEffect((function(){var e=null;return s&&t(s).blinkFor&&(e=setTimeout((function(){return n((function(e){t(e).unblink(e)}))}),200)),function(){e&&clearTimeout(e)}}),[s,a.blinkFor,n,t])},_e=n(1053),Ve=function useStackDrop(t,e){var n=y().updateGameContext;return(0,_e.L)({accept:"card",canDrop:function canDrop(n){return e&&e(n.model)||t.accepts(n.model)},drop:function drop(){n(t.clickEmpty({isKeyBoard:!1}))}})[1]},Ye=function Foundation(){var t=y().state;return(0,f.jsx)(f.Fragment,{children:t.foundation.stacks.map((function(e,n){return(0,f.jsx)(Qe,{model:e,index:n,hand:t.hand},n)}))})},Qe=function FoundationStack(t){qe((function(e){return e.foundation.stacks[t.index]}));var e=t.model,n=Ve(t.model),s=t.hand.source===e.source?[].concat((0,x.Z)(e.stack),(0,x.Z)(t.hand.stack)):(0,x.Z)(e.stack),a="board-field foundation foundation-"+t.index;return(0,f.jsxs)("div",{className:a,ref:n,children:[(0,f.jsx)(We,{model:e,children:(0,f.jsx)("div",{className:"align-center foundation-base suit-"+e.icon,children:(0,f.jsx)(ze(),{path:e.icon,size:"1em",horizontal:!0,color:e.color})})}),(0,f.jsx)(Ge,{index:0,models:s,blink:e.blinkFor,isSuggested:function isSuggested(t){return e.suggestion&&e.stack.length-1===t},isSelected:function isSelected(t){return t>e.stack.length-1}},0)]},t.index)},Je=function Clock(){var t=E(),e=t.state,n=t.getElapsed,s=p().gameState,a=d.useState(""),i=(0,l.Z)(a,2),o=i[0],r=i[1];return d.useEffect((function(){var t=setInterval((function(){s.started&&!e.paused&&r(n())}),1e3);return function(){return clearInterval(t)}}),[s.started,e.paused,n]),s.started&&o?(0,f.jsxs)("div",{className:"header-clock",children:[(0,f.jsx)("div",{className:"icon-container",children:(0,f.jsx)(ze(),{path:Et.yFX,size:".9em"})}),o]}):null},Xe=function Hearts(){var t=y().state;return(0,f.jsx)("div",{className:"heart-container",children:function getHearts(){var e=function _icon(t){return(0,f.jsx)(ze(),{path:t,size:".9em"})};if("infinite"===t.settings.launchSettings.recyclingMode)return(0,f.jsx)(ze(),{path:Et.GKq,size:".9em"});if("1-pass"===t.settings.launchSettings.recyclingMode)return t.stock.passes>0?e(Et.sMo):e(Et.MV4);if("3-pass"===t.settings.launchSettings.recyclingMode){var n=function createString(t,n){return Array.from(new Array(t).keys()).map((function(t){return e(n)}))};return[].concat((0,x.Z)(n(t.stock.passes,Et.sMo)),(0,x.Z)(n(3-t.stock.passes,Et.MV4)))}return null}()})},$e=function Hint(){var t=y(),e=t.state,n=t.updateContext,s=function isVisible(t){return t.settings.suggestionMode.supportsHints||t.settings.suggestionMode.isTemporary},a=function isDisabled(t){return t.settings.suggestionMode.isTemporary};return s(e)?(0,f.jsx)("div",{children:(0,f.jsx)("button",{title:"Hint",onClick:function onClick(){return function suggestOnce(){return n((function(t){s(t)&&!a(t)&&t.settings.enableHint()}))}()},disabled:a(e),children:(0,f.jsxs)("span",{className:"icon",children:[" ",(0,f.jsx)(ze(),{path:Et.LLp,size:".9em"})]})})}):null},tn=function Points(){var t=y().state;return(0,f.jsxs)("div",{children:[(0,f.jsx)("button",{title:"Points",onClick:function showToast(){u.Am.info((0,f.jsx)("ul",{children:t.game.rating.ratings.reverse().map((function(t,e){return(0,f.jsxs)("li",{children:[t.points," - ",t.text]},e)}))}),{autoClose:!1})},children:(0,f.jsx)("span",{className:"icon",children:(0,f.jsx)(ze(),{path:Et.lEW,size:".9em"})})}),null===t||void 0===t?void 0:t.game.rating.points]})},en=function ToggleMenu(){var t=E(),e=kt().player;return t.state.showMenu?null:(0,f.jsx)("div",{children:(0,f.jsx)("button",{title:"Settings",onClick:function onClick(){return t.togglePause(!t.state.paused,e)},children:(0,f.jsx)("span",{className:"icon",children:"\u2630"})})})},nn=function Undo(){var t=y(),e=t.state,n=t.replaceContext;return e.game.timemachine.previousStates.length&&e.settings.featureSwitches.undo?(0,f.jsx)("div",{children:(0,f.jsx)("button",{disabled:!e.game.timemachine.previousStates.length,title:"Undo","data-penalty":Math.pow(2,e.game.rating.multiplicator),onClick:function undo(){return n((function(t){var n=t.game.timemachine.popPreviousState(e.game.timemachine.previousStates.length-1,e);return n?(n.game.rating.penalize(t.game.rating),n):null}))},children:(0,f.jsx)("span",{className:"icon",children:(0,f.jsx)(ze(),{path:Et.BaD,size:".8em"})})})}):null},sn=function Header(t){return(0,f.jsxs)("div",{className:"header "+t.mode,children:[(0,f.jsxs)("div",{className:"header-title",children:[(0,f.jsx)(Xe,{}),(0,f.jsx)(tn,{})]}),(0,f.jsx)(Je,{}),(0,f.jsxs)("div",{className:"header-buttons header-right",children:[(0,f.jsx)($e,{}),(0,f.jsx)(nn,{}),(0,f.jsx)(en,{})]})]})},an=(n(9e3),n(3985)),on=function Menu(){var t=y(),e=t.state,n=t.updateContext,a=t.replaceContext,i=t.restart,o=E(),r=kt().player,c=(0,At.Z)(),u=c.navigation,d=c.setNavigation,l=function switchToMenu(t,e){return d((0,s.Z)((0,s.Z)({},u),{},{focus:"menu",screeen:"",mainMenu:t,menu:(0,s.Z)({},e)}))};if(!o.state.showMenu)return null;var g=o.state.allowed-o.state.pauses.length-1,h="You can pause the game ".concat(g," more times.");1===g&&(h="You can pause the game ".concat(g," more time.")),0===g&&(h="This is the last remaining pause. If you continue, no more pause will be possible."),g<0&&(h="The game is not paused.");var p=e.settings.launchSettings.boardMode===gt.Z.SINGLEPLAYER?yt.dR:(0,yt.Vc)(e.settings.launchSettings.players[r].inputLayout);return o.state.pausedBy!==r?(0,f.jsx)("div",{className:"gamemenu menu",children:(0,f.jsx)("div",{className:"startscreen-jail",children:(0,f.jsxs)("div",{className:"innermenu",children:[(0,f.jsx)(jt.Z,{icon:Et.e_f}),o.state.pausedBy,(0,f.jsx)("div",{className:"announcement",children:h})]})})}):(0,f.jsx)("div",{className:"gamemenu menu",children:(0,f.jsx)("div",{className:"startscreen-jail",children:(0,f.jsxs)("div",{className:"innermenu",children:[(0,f.jsx)(jt.Z,{icon:Et.e_f}),(0,f.jsx)("div",{className:"announcement",children:h}),(0,f.jsxs)(Tt.Z,{keyboardLayout:p,children:[(0,f.jsx)(Mt.Z,{icon:Et._86,title:"Resume",onClick:function onClick(){!function toggleMenu(){o.togglePause(!1,-1)}()}}),(0,f.jsx)(Mt.Z,{icon:e.settings.suggestionMode.icon,title:"Suggestions: ".concat(e.settings.suggestionMode.label),onClick:function onClick(){!function setSuggestionMode(t){n((function(e){return e.settings.setSuggestionMode(t)}))}(J.Z.next(e.settings.suggestionMode).key)}}),(0,f.jsxs)(Mt.Z,{icon:Et.xuG,title:"Entropy",onClick:function onClick(t){return function toggleMainMenu(t,e){u.mainMenu!==t?l(t,e):l("",e)}("entropy",t)},toggled:"entropy"===u.mainMenu,children:[(0,f.jsx)(Mt.Z,{icon:Et.xuG,title:"Base Entropy: ".concat(an.Z[e.settings.baseEntropy]),onClick:function onClick(){!function setBaseEntropy(t){n((function(e){return e.setEntropy(t)}))}(e.settings.baseEntropy<an.Z.length-1?e.settings.baseEntropy+1:0)}}),(0,f.jsx)(Mt.Z,{icon:Et.GOG,title:"Action Entropy: ".concat(an.Z[e.settings.interactionEntropy]),onClick:function onClick(){!function setInteractionEntropy(t){n((function(e){return e.settings.interactionEntropy=t}))}(e.settings.interactionEntropy<an.Z.length-1?e.settings.interactionEntropy+1:0)}})]}),(0,f.jsx)(Mt.Z,{icon:Et.HAU,title:"Restart Game",onClick:function onClick(){return function reset(){o.togglePause(!0,-1),a((function(t){return t.game.timemachine.previousStates?t.game.timemachine.previousStates[0]:null}))}()},skip:!e.game.timemachine.previousStates.length}),(0,f.jsx)(Mt.Z,{icon:Et.x9U,title:"Quit Game",onClick:function onClick(){return i()}})]})]})})})},rn=function _Menu(){return(0,f.jsx)(At.K,{children:(0,f.jsx)(on,{})})},cn=function Stock(){var t;qe((function(t){return t.stock}));var e=y();return e&&e.state?(0,f.jsxs)("div",{className:"board-field stock",children:[(0,f.jsx)(We,{model:e.state.stock}),(0,f.jsx)(Ge,{index:0,models:e.state.stock.stack,offsetTop:function offsetTop(t){return t/2*-1},zIndex:0,blink:null===e||void 0===e||null===(t=e.state)||void 0===t?void 0:t.stock.blinkFor,isSuggested:function isSuggested(t){var n;return(null===e||void 0===e||null===(n=e.state)||void 0===n?void 0:n.stock.suggestion)&&t===e.state.stock.stack.length-1}},0)]}):null},un=function Tableau(){var t=y().state;return(0,f.jsx)(f.Fragment,{children:t.tableau.stacks.map((function(e,n){return(0,f.jsx)(dn,{index:n,model:e,parent:t.tableau,hand:t.hand},n)}))})},dn=function TableauStack(t){qe((function(e){return e.tableau.stacks[t.index]}));var e=Ve(t.model),n=t.hand.source===t.model.source?[].concat((0,x.Z)(t.model.stack),(0,x.Z)(t.hand.stack)):(0,x.Z)(t.model.stack),s="board-field tableau tableau-"+t.index;return(0,f.jsxs)("div",{className:s,ref:e,children:[(0,f.jsx)(We,{model:t.model}),(0,f.jsx)(Ge,{index:0,models:n,blink:t.model.blinkFor,isSuggested:function isSuggested(e){return t.model.suggestion&&t.model.stack.length-1===e},offsetTop:function offsetTop(t,e){return function getOffset(t,e){for(var n=0;n<=t;n++)if(e[n]&&!e[n].isHidden)return 12*n+24*(t-n);return 12*t}(t,e)},isSelected:function isSelected(e){return e>t.model.stack.length-1}},0)]})},ln=function Waste(){var t=y().state;qe((function(t){return t.waste}));var e=Ve(t.waste,(function(){return t.hand.isFromWaste()})),n=(null===t||void 0===t?void 0:t.hand.source)===t.waste.source?[].concat((0,x.Z)(t.waste.stack),(0,x.Z)(t.hand.stack)):(0,x.Z)(t.waste.stack);return(0,f.jsxs)("div",{className:"board-field waste",ref:e,children:[(0,f.jsx)(We,{model:t.waste}),(0,f.jsx)(Ge,{index:0,models:n,offsetTop:function offsetTop(t){return t/2*-1},offsetLeft:function offsetLeft(e){return function getOffset(e){if("single"===t.settings.launchSettings.drawMode)return 0;var n=t.hand.isHoldingCard()&&t.hand.isFromWaste()?t.waste.stack.length+1:t.waste.stack.length,s=2;return 2===n&&(s=1),1===n&&(s=0),(e-n-2)%3+s}(e)},blink:t.waste.blinkFor,isSuggested:function isSuggested(e){return t.waste.suggestion&&e===t.waste.stack.length-1},isSelected:function isSelected(e){return e>t.waste.stack.length-1}},0)]})},fn=function Board(t){var e=d.useRef(null);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(rn,{}),(0,f.jsx)(sn,{mode:t.mode}),(0,f.jsx)(u.Ix,{style:{zIndex:8888},position:"top-center",closeOnClick:!1,newestOnTop:!0,limit:1,pauseOnFocusLoss:!1,draggable:!1,transition:u.Mi}),(0,f.jsx)("div",{className:"board-jail "+t.mode,children:(0,f.jsxs)("div",{className:"board-grid-container "+t.mode,children:[(0,f.jsx)(cn,{}),(0,f.jsx)(ln,{}),(0,f.jsx)("div",{className:"board-field spacer",ref:e,children:e.current&&(0,f.jsx)(Ut,{reff:e.current})}),(0,f.jsx)(Ye,{}),(0,f.jsx)(un,{})]})}),(0,f.jsx)(It,{})]})},gn=function EndScreen(){var t=y(),e=t.state,n=t.restart,s=E();return e.game.isEnded?(0,f.jsxs)("div",{className:"ui neutral endscreen",children:[(0,f.jsx)("div",{className:"title",children:"\ud83e\udd73"}),(0,f.jsxs)("div",{className:"content",children:[(0,f.jsxs)("div",{children:["Time: ",s.getElapsed()]}),(0,f.jsxs)("div",{children:["Points: ",e.game.rating.points]}),(0,f.jsxs)("div",{children:["Time Penalty: ",e.game.rating.getTimePenalty(e.game.started,e.game.end||Date.now())]}),(0,f.jsxs)("div",{children:["Bonus Points: ",e.game.rating.getBonusPoints(e.game.started,e.game.end||Date.now())]}),(0,f.jsxs)("div",{children:["Total Points: ",e.game.rating.getTotal(e.game.started,e.game.end||Date.now())]}),(0,f.jsx)("div",{children:(0,f.jsxs)("button",{onClick:n,children:["\ud83d\uddd1\ufe0f",(0,f.jsx)("div",{children:"New Game"})]})})]})]}):null},hn=function(t){(0,r.Z)(BoardWrap,t);var e=(0,c.Z)(BoardWrap);function BoardWrap(t){var n;return(0,o.Z)(this,BoardWrap),(n=e.call(this,t)).replaceContext=function(t){return n.setState(t)},n.updateContext=function(t){return n.replaceContext((function(e){return t(e),e}))},n.updateGameContext=function(t){return n.replaceContext((function(e){if(e.game.timemachine.modified=!1,e.settings.featureSwitches.undo){var n=ot.copy(e);return n.game.timemachine.previousStates.length?n.game.timemachine.previousStates=[n.game.timemachine.previousStates[n.game.timemachine.previousStates.length-1]]:n.game.timemachine.previousStates=[],t(e),e.game.timemachine.modified?(e.game.timemachine.pushPreviousState(n),e.setToken(Math.random()),e):null}return t(e),e.game.timemachine.modified?(e.setToken(Math.random()),e):null}))},n.render=function(){var t={state:n.state.withHandlers().withSuggestions(),replaceContext:n.replaceContext,updateContext:n.updateContext,updateGameContext:n.updateGameContext,restart:n.props.restart};return(0,f.jsxs)(b,{value:t,children:[(0,f.jsx)(mt,{value:{player:n.props.player},children:(0,f.jsx)(fn,{mode:n.props.settings.boardMode})}),(0,f.jsx)(gn,{})]})},n.state=ot.getInitialState(t.settings,t.deck,t.player),n}return(0,i.Z)(BoardWrap)}(d.Component),pn=n(6993),vn=n(1887),kn=function SinglePlayer(t){var e=t.launchState,n=t.deck,s=t.restart;return(0,f.jsx)(a.Z,{ratio:vn.Z._4to3,children:(0,f.jsx)("div",{className:"layout-grid-container "+e.boardMode,children:(0,f.jsx)(hn,{player:0,settings:e,restart:s,deck:n})})})},mn=function SplitScreen(t){var e=t.launchState,n=t.deck,s=t.restart,a=function Wrap(t){return(0,f.jsx)("div",{className:"layout-grid-container "+e.boardMode,children:(0,f.jsx)(hn,{player:t,settings:e,restart:s,deck:n.copy()})})};return(0,f.jsxs)("div",{className:"game-layout-container splitscreen",children:[a(0),a(1)]})},bn=function Game(t){return(0,f.jsx)(v,{children:(0,f.jsx)(w,{children:(0,f.jsxs)(pn.Z,{delay:500,fallback:(0,f.jsx)("h3",{children:"Loading..."}),children:[t.launchState.boardMode===gt.Z.SINGLEPLAYER&&(0,f.jsx)(kn,(0,s.Z)({},t)),t.launchState.boardMode===gt.Z.VERSUS&&(0,f.jsx)(mn,(0,s.Z)({},t))]})})})}}}]);
//# sourceMappingURL=914.82fc1cf2.chunk.js.map