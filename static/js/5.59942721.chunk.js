(this["webpackJsonpsolitaire-react"]=this["webpackJsonpsolitaire-react"]||[]).push([[5],{58:function(t,e,n){},59:function(t,e,n){},60:function(t,e,n){},61:function(t,e,n){"use strict";n.r(e),n.d(e,"BoardContext",(function(){return yt})),n.d(e,"default",(function(){return wt}));var s=n(15),i=n(21),a=n(20),c=n(0),o=(n(58),n(29)),r=n(17),u=n(1),l=n.n(u),d=function(t){var e=l.a.useContext(r.d).state,n=l.a.useContext(yt).player,s="gamepad"==e.settings.launchSettings.inputMode,i="singleplayer"===e.settings.launchSettings.boardMode,a=function(t){t.focus.isKeyBoard(!0),i&&(t.settings.launchSettings.inputMode="gamepad")};return i||s?Object(c.jsx)(o.a,{gamepadIndex:e.settings.launchSettings.players[n].inputLayout,onLeft:function(){return t.onLeft&&t.onLeft(a)},onRight:function(){return t.onRight&&t.onRight(a)},onUp:function(){return t.onUp&&t.onUp(a)},onDown:function(){return t.onDown&&t.onDown(a)},onAction:function(){return t.onAction&&t.onAction(a)},onCancel:function(){return t.onCancel&&t.onCancel(a)},onHint:function(){return t.onHint&&t.onHint(a)},onUndo:function(){return t.onUndo&&t.onUndo()},onPause:function(){return t.onPause&&t.onPause(a)},onMenu:function(){return t.onPause&&t.onMenu(a)},children:Object(c.jsx)("span",{})}):null},g=n(27),f=n(35),h=function(t){var e=l.a.useContext(r.d).state,n=l.a.useContext(yt).player,s="keyboard"===e.settings.launchSettings.inputMode,i="singleplayer"===e.settings.launchSettings.boardMode,a=i?g.a:Object(g.b)(e.settings.launchSettings.players[n].inputLayout),o=function(t){t.focus.isKeyBoard(!0),i&&(t.settings.launchSettings.inputMode="keyboard")};return s||i?Object(c.jsx)(f.a,{layout:a,onLeft:function(){return t.onLeft&&t.onLeft(o)},onRight:function(){return t.onRight&&t.onRight(o)},onUp:function(){return t.onUp&&t.onUp(o)},onDown:function(){return t.onDown&&t.onDown(o)},onAction:function(){return t.onAction&&t.onAction(o)},onCancel:function(){return t.onCancel&&t.onCancel(o)},onHint:function(){return t.onHint&&t.onHint(o)},onUndo:function(){return t.onUndo&&t.onUndo()},onPause:function(){return t.onPause&&t.onPause(o)},onMenu:function(){return t.onMenu&&t.onMenu(o)}}):null},p=n(25),k=function(){var t=l.a.useContext(r.d),e=t.state,n=t.updateContext,s=t.updateGameContext,i=t.replaceContext,a=l.a.useContext(p.b),o=l.a.useContext(yt).player,u={x:e.navigator.currentIndex.x,y:e.navigator.currentIndex.y,z:e.navigator.currentIndex.z},g=!!a.state.paused,f=function(t){return n((function(e){t(e),e.navigator.moveLeft(u)}))},k=function(t){return n((function(e){t(e),e.navigator.moveRight(u)}))},b=function(t){return n((function(e){t(e),e.navigator.moveUp(u)}))},m=function(t){return n((function(e){t(e),e.navigator.moveDown(u)}))},v=function(t){return s((function(n){t(n),e.navigator.pressCurrent()(n)}))},j=function(t){return n((function(e){t(e),e.hand.stack.length&&e.hand.stack[0].onClick({isKeyboard:!0})(e)}))},O=function(){return a.togglePause(g,o)},x=function(t){n((function(e){t(e),function(t){return t.settings.suggestionMode.supportsHints||t.settings.suggestionMode.isTemporary}(e)&&!function(t){return t.settings.suggestionMode.isTemporary}(e)&&e.settings.enableHint()}))},y=function(){i((function(t){var n=t.game.timemachine.popPreviousState(e.game.timemachine.previousStates.length-1,e);return n?(n.game.rating.penalize(t.game.rating),n):null}))},C=function(t){n((function(e){t(e)})),a.togglePause(g,o)};return g?null:Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(h,{onLeft:f,onRight:k,onUp:b,onDown:m,onAction:v,onCancel:j,onHint:x,onUndo:y,onPause:O,onMenu:C}),Object(c.jsx)(d,{onLeft:f,onRight:k,onUp:b,onDown:m,onAction:v,onCancel:j,onHint:x,onUndo:y,onPause:O,onMenu:C})]})},b=function(){var t=l.a.useContext(r.d),e=t.state,n=t.replaceContext,s=[];if(e.settings.launchSettings.quickDeal)e&&e.dealer&&!e.dealer.isDealt&&n(e.dealer.dealAll(e));else{var i=function t(i){s.push(setTimeout((function(){e&&e.dealer&&!e.dealer.isDealt&&n(e.dealer.dealOne(i,t))}),35))};l.a.useEffect((function(){return i(e.dealer.dealt),function(){return s.forEach((function(t){clearTimeout(t)}))}}),[]),l.a.useEffect((function(){}),[e.dealer.isDealt])}return null},m=n(19),v=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(t){var i;return Object(s.a)(this,n),(i=e.call(this)).timeout=null,i.selector=t,i}return Object(m.a)(n,[{key:"componentDidUpdate",value:function(){var t=this;this.selector(this.context.state).blinkFor&&(this.timeout=setTimeout((function(){return t.context.updateGameContext((function(e){t.selector(e).unblink(e)}))}),200))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}}]),n}(u.Component);v.contextType=r.d;var j=n(16),O=function(t){var e=l.a.useContext(r.d),n=e.state,s=e.updateGameContext,i=l.a.useContext(p.b),a=l.a.useRef(null),o=n.focus.hasCard(t.model);l.a.useEffect((function(){o&&"singleplayer"==n.settings.launchSettings.boardMode&&a&&a.current&&a.current.focus()}),[o,n.focus.card]);var u=function(e){e.preventDefault();for(var i=0==e.clientX&&0==e.clientY,a=e.target;a&&!a.className.includes("card-base");)a=a.offsetParent;var c=a.getBoundingClientRect(),o={isKeyBoard:i,click:{x:e.clientX-a.ownerDocument.defaultView.pageXOffset,y:e.clientY-a.ownerDocument.defaultView.pageYOffset},element:{x:c.x,y:c.y}},r="singleplayer"===n.settings.launchSettings.boardMode;t.model.onClick&&!o.isKeyBoard&&s((function(e){t.model.onClick(o)(e),r&&(e.settings.launchSettings.inputMode="mouse")}))},d=[0,1,2,3,4,5,6].map((function(t){return" stack "+(t+1)})),g="",f=t.model.source.split("-");return g+=f[0],f.length>1&&(g+=d[f[1]]),g+=": ",g+=t.model.isHidden?"hidden card":t.model.type.icon+t.model.face,Object(c.jsx)("div",{style:t.model.onClick?{}:{pointerEvents:"none"},className:"stack-base",children:Object(c.jsx)("button",{onFocus:function(){},onBlur:function(){},style:function(){var e=Object(j.a)({zIndex:(t.zIndex?t.zIndex:20*!!t.offsetTop)+1,top:t.offsetTop?t.offsetTop/15+"em":0},t.model.entropyStyle);return t.offsetLeft&&(e.left=2*t.offsetLeft+"em"),t.model.onClick||(e.pointerEvents="none"),e}(),ref:a,className:function(){var e=t.isSuggested||t.model.suggestion,n="card card-base suit-".concat(t.model.type.icon);return n+=t.isSelected||o||e?"":" card-stack-".concat(t.model.source),n+=t.isSelected?" card-selected":"",n+=t.blink?" blink":"",n+=t.model.canClick()?" clickable":"",n+=e&&!o?" card-suggested":"",n+=o?" card-focused":""}(),onClick:u||null,disabled:!t.model.canClick()||i.state.paused,tabIndex:t.model.canClick()?0:-1,"aria-label":g,title:g,children:Object(c.jsx)("div",{className:"card-content",children:t.model.isHidden||i.state.paused?Object(c.jsx)("div",{className:"card-back",children:"\xa0"}):Object(c.jsxs)("div",{className:"card-grid-container",children:[Object(c.jsx)("div",{children:Object(c.jsx)("div",{className:"align-center",children:t.model.type.icon})}),Object(c.jsx)("div",{children:Object(c.jsx)("div",{className:"align-left",children:t.model.face})}),Object(c.jsx)("div",{children:"\xa0"}),Object(c.jsx)("div",{children:Object(c.jsx)("div",{className:"align-center",children:t.model.type.icon})}),Object(c.jsx)("div",{className:"mainface",children:Object(c.jsx)("div",{className:"align-center",children:t.model.face})}),Object(c.jsx)("div",{children:Object(c.jsx)("div",{className:"align-center",children:t.model.type.icon})}),Object(c.jsx)("div",{children:"\xa0"}),Object(c.jsx)("div",{children:Object(c.jsx)("div",{className:"align-right",children:t.model.face})}),Object(c.jsx)("div",{children:Object(c.jsx)("div",{className:"align-center",children:t.model.type.icon})})]})})})})},x=function(t){var e=l.a.useContext(r.d).state;return e.hand&&t.parentModel.source===e.hand.source?Object(c.jsx)(c.Fragment,{children:[e.hand&&e.hand.stack&&e.hand.stack.map((function(e,n){return Object(c.jsx)(O,{model:e,offsetTop:t.offsetTop+24*n,offsetLeft:t.offsetLeft,zIndex:1e3+20*n,isSelected:!0,onClick:function(e,n){return t.onClick(n)}},n)}))]}):null},y=function(t){var e="card-base socket",n=l.a.useRef(null),s=l.a.useContext(r.d),i=s.state,a=s.updateGameContext;l.a.useEffect((function(){i.focus.hasStack(t.model.parent)&&"singleplayer"==i.settings.launchSettings.boardMode&&n&&n.current&&n.current.focus()})),t.model.stack.length?e+=" socket-full":t.model.blinkFor?e+=" socket-blink":i.focus.hasStack(t.model.source)?e+=" socket-focused":e+=" socket-empty",t.model.suggestion&&!t.model.stack.length&&(e+=" socket-suggested");var o=[0,1,2,3,4,5,6].map((function(t){return" stack "+(t+1)})),u="",d=t.model.source.split("-");return u+=d[0],d.length>1&&(u+=o[d[1]]),u+=": empty socket",Object(c.jsx)("button",{onFocus:function(){},onBlur:function(){},ref:n,className:e,onClick:function(e){e.preventDefault();var n=0==e.clientX&&0==e.clientY;n||a(t.model.clickEmpty({isKeyBoard:n}))},disabled:t.model.stack.length,tabIndex:t.model.stack.length?-1:0,"aria-label":u,title:u,children:t.children})},C=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(t){return Object(s.a)(this,n),e.call(this,(function(e){return e.foundation.stacks[t.index]}))}return Object(m.a)(n,[{key:"render",value:function(){var t=this.props.model;return Object(c.jsxs)("div",{className:"board-field",children:[Object(c.jsx)(y,{model:t,children:Object(c.jsx)("div",{className:"align-center foundation-base suit-"+t.icon,children:t.icon})}),t.stack.map((function(e,n){return Object(c.jsx)(O,{model:e,blink:t.blinkFor,isSuggested:t.suggestion&&t.stack.length-1==n},n)})),Object(c.jsx)(x,{parentModel:t,stack:t.stack})]},this.props.index)}}]),n}(v);C.Stacks=function(){var t=l.a.useContext(r.d).state;return Object(c.jsx)(c.Fragment,{children:t.foundation.stacks.map((function(t,e){return Object(c.jsx)(C,{model:t,index:e},e)}))})};n(59);var w=n(4),E=function(){var t=l.a.useContext(p.b),e=t.state,n=t.getElapsed,s=l.a.useState(""),i=Object(w.a)(s,2),a=i[0],o=i[1];return l.a.useEffect((function(){var t=setInterval((function(){e.started&&!e.paused&&o(n())}),1e3);return function(){return clearInterval(t)}}),[e.started,e.paused]),e.started&&a?Object(c.jsxs)("div",{className:"header-clock",children:[Object(c.jsx)("div",{className:"icon-container",children:"\ud83d\udd52"}),a]}):null},M=function(){var t=l.a.useContext(r.d).state;if(!t)return null;return Object(c.jsx)("div",{className:"heart-container",children:function(){if("infinite"==t.settings.launchSettings.recyclingMode)return"\ud83d\udda4";if("1-pass"==t.settings.launchSettings.recyclingMode)return t.stock.passes>0?"\u2764\ufe0f":"\ud83d\udc94";if("3-pass"==t.settings.launchSettings.recyclingMode){var e=function(t,e){return Array.from(new Array(t).keys()).map((function(){return e})).join("")};return e(t.stock.passes,"\u2764\ufe0f")+e(3-t.stock.passes,"\ud83d\udc94")}return null}()})},S=function(){var t=l.a.useContext(r.d),e=t.state,n=t.updateContext;if(!e)return null;var s=function(t){return t.settings.suggestionMode.supportsHints||t.settings.suggestionMode.isTemporary},i=function(t){return t.settings.suggestionMode.isTemporary};return s(e)?Object(c.jsx)("div",{children:Object(c.jsx)("button",{title:"Hint",onClick:function(){return n((function(t){s(t)&&!i(t)&&t.settings.enableHint()}))},disabled:i(e),children:Object(c.jsx)("span",{className:"icon",children:"\ud83d\udca1"})})}):null},T=function(){var t=l.a.useContext(r.d).state;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("div",{className:"icon-container",children:"\ud83c\udfc6"})," ",null===t||void 0===t?void 0:t.game.rating.points]})},H=function(){var t=l.a.useContext(p.b),e=l.a.useContext(yt).player;return Object(c.jsx)("div",{children:Object(c.jsx)("button",{title:"Settings",onClick:function(){return t.togglePause(!t.state.paused,e)},children:Object(c.jsx)("span",{className:"icon",children:"\u2630"})})})},P=function(){var t=l.a.useContext(r.d),e=t.state,n=t.replaceContext;if(!e)return null;return e.game.timemachine.previousStates.length?Object(c.jsx)("div",{children:Object(c.jsx)("button",{disabled:!e.game.timemachine.previousStates.length,title:"Undo (Penalty:"+Math.pow(2,e.game.rating.multiplicator)+")",onClick:function(){return n((function(t){var n=t.game.timemachine.popPreviousState(e.game.timemachine.previousStates.length-1,e);return n?(n.game.rating.penalize(t.game.rating),n):null}))},children:Object(c.jsx)("span",{className:"icon",children:"\u23ea"})})}):null},N=function(t){return Object(c.jsxs)("div",{className:"header "+t.mode,children:[Object(c.jsxs)("div",{className:"header-title",children:[Object(c.jsx)(M,{}),Object(c.jsx)(T,{})]}),Object(c.jsx)(E,{}),Object(c.jsxs)("div",{className:"header-buttons",children:[Object(c.jsx)(S,{}),Object(c.jsx)(P,{}),Object(c.jsx)(H,{})]})]})},I=(n(37),n(18)),A=n(36),D=n(38),F=n(39),U=n(40),R=n(24),L=function(){var t=l.a.useContext(r.d),e=t.state,n=t.updateContext,s=t.replaceContext,i=t.restart,a=l.a.useContext(p.b),o=l.a.useContext(yt).player,u=l.a.useContext(I.a),d=u.navigation,f=u.setNavigation,h=function(t,e){return f(Object(j.a)(Object(j.a)({},d),{},{focus:"menu",screeen:"",mainMenu:t,menu:Object(j.a)({},e)}))};if(!a.state.showMenu)return null;if(!e)return null;var k=function(t){f(Object(j.a)(Object(j.a)({},d),{},{menu:t}))},b=a.state.allowed-a.state.pauses.length-1,m="You can pause the game ".concat(b," more times.");1==b&&(m="You can pause the game ".concat(b," more time.")),0==b&&(m="This is the last remaining pause. If you continue, no more pause will be possible."),b<0&&(m="The game is not paused.");var v="singleplayer"===e.settings.launchSettings.boardMode?g.a:Object(g.b)(e.settings.launchSettings.players[o].inputLayout);return a.state.pausedBy!==o?Object(c.jsx)("div",{className:"gamemenu menu",children:Object(c.jsx)("div",{className:"startscreen-jail",children:Object(c.jsxs)("div",{className:"innermenu",children:[Object(c.jsx)(F.a,{label:"\ud83d\ude34"}),a.state.pausedBy,Object(c.jsx)("div",{className:"announcement",children:m})]})})}):Object(c.jsx)("div",{className:"gamemenu menu",children:Object(c.jsx)("div",{className:"startscreen-jail",children:Object(c.jsxs)("div",{className:"innermenu",children:[Object(c.jsx)(F.a,{label:"\ud83d\ude34"}),Object(c.jsx)("div",{className:"announcement",children:m}),Object(c.jsxs)(U.a,{keyboardLayout:v,children:[Object(c.jsx)(D.a,{icon:"\u25b6\ufe0f",title:"Resume",onClick:function(){a.togglePause(!1,-1)},onFocus:k}),Object(c.jsx)(D.a,{icon:e.settings.suggestionMode.icon,title:"Suggestions: ".concat(e.settings.suggestionMode.label),onClick:function(){var t;t=R.a.next(e.settings.suggestionMode).key,n((function(e){return e.settings.setSuggestionMode(t)}))},onFocus:k}),Object(c.jsxs)(D.a,{icon:"\ud83c\udf2a\ufe0f",title:"Entropy",onClick:function(t){return function(t,e){d.mainMenu!==t?h(t,e):h("",e)}("entropy",t)},onFocus:k,toggled:"entropy"==d.mainMenu,children:[Object(c.jsx)(D.a,{icon:"\ud83c\udf2a\ufe0f",title:"Base Entropy: ".concat(A.a[e.settings.baseEntropy]),onClick:function(){var t;t=e.settings.baseEntropy<A.a.length-1?e.settings.baseEntropy+1:0,n((function(e){return e.setEntropy(t)}))},onFocus:k}),Object(c.jsx)(D.a,{icon:"\ud83c\udf2c\ufe0f",title:"Action Entropy: ".concat(A.a[e.settings.interactionEntropy]),onClick:function(){var t;t=e.settings.interactionEntropy<A.a.length-1?e.settings.interactionEntropy+1:0,n((function(e){return e.settings.interactionEntropy=t}))},onFocus:k})]}),Object(c.jsx)(D.a,{icon:"\u267b\ufe0f",title:"Restart Game",onClick:function(){return a.togglePause(!0,-1),void s((function(t){return t.game.timemachine.previousStates?t.game.timemachine.previousStates[0]:null}))},onFocus:k,skip:!e.game.timemachine.previousStates.length}),Object(c.jsx)(D.a,{icon:"\ud83d\uddd1\ufe0f",title:"Quit Game",onClick:function(){return i()},onFocus:k})]})]})})})},B=function(){var t=l.a.useState({menu:{x:0,y:0},screen:{x:0,y:0},focus:"menu",mainMenu:"",screeen:""}),e=Object(w.a)(t,2),n={navigation:e[0],setNavigation:e[1]};return Object(c.jsx)(I.b,{value:n,children:Object(c.jsx)(L,{})})},q=function(t){var e=l.a.useContext(p.b).state,n=e.paused,s=e.started;return Object(c.jsx)(z,{length:t.length,paused:n,started:s})},z=function(t){var e=l.a.useContext(r.d),n=t.length,s=t.started,i=t.paused,a=function(t){var e=l.a.useRef();return l.a.useEffect((function(){e.current=t})),e.current}({length:n,paused:i,started:s});return l.a.useEffect((function(){var t=null;return e.state.settings.launchSettings.speed&&a&&s&&!i&&(a.length!=n||a.started!=s||a.paused!=i)&&(t=setTimeout((function(){e.updateContext((function(t){n==t.stock.stack.length&&t.stock.passes>0&&(t.stock.stack.length||t.waste.stack.length)&&(t.hand.isFromWaste()&&t.waste.putDownHand(),t.stock.stack.length?t.waste.addAll(t.stock.popTop()):t.stock.canRecycle()&&t.stock.recycle(t.waste.recycle()))}))}),1e4)),function(){return clearTimeout(t)}}),[n,i,s]),Object(c.jsxs)("div",{className:"board-field stock",children:[Object(c.jsx)(y,{model:e.state.stock}),e.state.stock.stack.map((function(t,n){return Object(c.jsx)(O,{model:t,offsetTop:n/2*-1,zIndex:n,blink:e.state.stock.blinkFor,isSuggested:e.state.stock.suggestion&&n==e.state.stock.stack.length-1},n)}))]})},G=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(){return Object(s.a)(this,n),e.call(this,(function(t){return t.stock}))}return Object(m.a)(n,[{key:"render",value:function(){return Object(c.jsx)(q,{length:this.context.state.stock.stack.length})}}]),n}(v),K=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(t){return Object(s.a)(this,n),e.call(this,(function(e){return e.tableau.stacks[t.index]}))}return Object(m.a)(n,[{key:"render",value:function(){var t=this.props,e=function(e){for(var n=0;n<=e;n++)if(t.model.stack[n]&&!t.model.stack[n].isHidden)return 12*n+24*(e-n);return 12*e};return Object(c.jsxs)("div",{className:"board-field",children:[Object(c.jsx)(y,{model:t.model}),t.model.stack.map((function(n,s){return Object(c.jsx)(O,{model:n,blink:t.model.blinkFor,isSuggested:t.model.suggestion&&t.model.stack.length-1==s,offsetTop:e(s)},s)})),Object(c.jsx)(x,{parentModel:t.model,stack:t.model.stack,offsetTop:e(t.model.stack.length)})]})}}]),n}(v);K.Stacks=function(){var t=l.a.useContext(r.d).state;return Object(c.jsx)(c.Fragment,{children:t.tableau.stacks.map((function(e,n){return Object(c.jsx)(K,{index:n,model:e,parent:t.tableau},n)}))})};var W=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(){return Object(s.a)(this,n),e.call(this,(function(t){return t.waste}))}return Object(m.a)(n,[{key:"render",value:function(){var t=this.context.state,e=function(e){if("single"==t.settings.launchSettings.drawMode)return 0;var n=t.hand.isHoldingCard()&&t.hand.isFromWaste()?t.waste.stack.length+1:t.waste.stack.length,s=2;return 2==n&&(s=1),1==n&&(s=0),(e-n-2)%3+s};return Object(c.jsxs)("div",{className:"board-field",children:[Object(c.jsx)(y,{model:t.waste}),t.waste.stack.map((function(n,s){return Object(c.jsx)(O,{model:n,offsetTop:s/2*-1,offsetLeft:e(s),blink:t.waste.blinkFor,isSuggested:t.waste.suggestion&&s==t.waste.stack.length-1},s)})),Object(c.jsx)(x,{offsetTop:t.waste.stack.length/2*-1,offsetLeft:e(t.waste.stack.length),parentModel:t.waste,stack:t.waste.stack})]})}}]),n}(v),V=function(t){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(B,{}),Object(c.jsx)(N,{mode:t.mode}),Object(c.jsx)("div",{className:"board-jail "+t.mode,children:Object(c.jsxs)("div",{className:"board-grid-container "+t.mode,children:[Object(c.jsx)(G,{}),Object(c.jsx)(W,{}),Object(c.jsx)("div",{className:"spacer",children:"\xa0"}),Object(c.jsx)(C.Stacks,{}),Object(c.jsx)(K.Stacks,{})]})}),Object(c.jsx)(b,{}),Object(c.jsx)(k,{})]})},Y=(n(60),function(){var t=l.a.useContext(r.d),e=t.state,n=t.restart,s=l.a.useContext(p.b);return e.game.isEnded?Object(c.jsxs)("div",{className:"ui neutral endscreen",children:[Object(c.jsx)("div",{className:"title",children:"\ud83e\udd73"}),Object(c.jsxs)("div",{className:"content",children:[Object(c.jsxs)("div",{children:["Time: ",s.getElapsed()]}),Object(c.jsxs)("div",{children:["Points: ",e.game.rating.points]}),Object(c.jsxs)("div",{children:["Time Penalty: ",e.game.rating.getTimePenalty(e.game.started,e.game.end||Date.now())]}),Object(c.jsxs)("div",{children:["Bonus Points: ",e.game.rating.getBonusPoints(e.game.started,e.game.end||Date.now())]}),Object(c.jsxs)("div",{children:["Total Points: ",e.game.rating.getTotal(e.game.started,e.game.end||Date.now())]}),Object(c.jsx)("div",{children:Object(c.jsxs)("button",{onClick:n,children:["\ud83d\uddd1\ufe0f",Object(c.jsx)("div",{children:"New Game"})]})})]})]}):null}),X=n(22),J=function t(){var e=this;Object(s.a)(this,t),this.startBlink=function(t,n){t(n).blinkFor<10&&(t(n).blinkFor=10,n.game.registerBlink(!0),t(n).unblink=function(n){return e.stopBlink(t,n)})},this.stopBlink=function(t,e){t(e).blinkFor=0,e.game.registerBlink(!1)}},Z=function t(){var e=this;Object(s.a)(this,t),this.blink=function(t,e){return(new J).startBlink((function(t){return t.tableau.stacks[e]}),t)},this.dispatchPutDown=function(t,n,s,i){if(s.tableau.wouldAcceptHand(i)){var a=s.hand.source;s.tableau.putDownHand(i)&&s.game.registerMove("tableau-"+i,a)}else e.blink(s,i)},this.dispatchPickup=function(t,n,s,i){t?s.hand.pickUp(s.tableau.popWithFollowing(t,i),t.source,n)&&s.game.registerPickup():t||e.blink(s,i)}},Q=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(){var t;Object(s.a)(this,n);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).dispatchPickup=function(e,n,s,i){e&&t.tryUncover(e,i,s)},t.tryUncover=function(t,e,n){return!n.hand.isHoldingCard()&&t.isHidden&&n.tableau.uncover(e,t)&&n.game.registerUncover()},t}return n}(Z),$=function t(){var e=this;Object(s.a)(this,t),this.dealt=void 0,this.dealingAt=void 0,this.isDealt=void 0,this.dealOne=function(t,e){return function(n){return t!=n.dealer.dealt?null:(n.dealer.deal(n.stock,n.tableau),n.dealer.isDealt&&(n.game.started=Date.now()),n.dealer.isDealt||e(n.dealer.dealt),n)}},this.dealAll=function(){return function(t){if(e.dealt!=t.dealer.dealt)return null;for(;!t.dealer.isDealt;)t.dealer.deal(t.stock,t.tableau);return t.game.started=Date.now(),t}},this.deal=function(t,n){for(var s=e.dealingAt;s<n.stacks.length;s++){var i=n.stacks[s].stack;if(i.length<=n.stacks.length-s-1){var a=t.popOne();return a.source=n.stacks[s].source,i.length==n.stacks.length-1-s&&(a.isHidden=!1),n.deal(a,s),e.dealt++,e.dealingAt++,e.dealingAt==n.stacks.length&&(e.dealingAt=0),void(e.isDealt=!1)}var c=0==e.dealingAt;return e.dealingAt=0,void(e.isDealt=c)}e.isDealt=!0},this.dealt=0,this.dealingAt=0,this.isDealt=!1},_=function t(e){var n=this;Object(s.a)(this,t),this.clickHandler=void 0,this.getHandler=function(t){return t&&t.isHoldingCard()?n.dispatchPutDown:n.dispatchPickup},this.dispatchPutDown=function(t,e,s){return function(i){i.hand.isHoldingCard()&&n.clickHandler.dispatchPutDown(t,e,i,s)}},this.dispatchPickup=function(t,e,s){return function(i){i.hand.isHoldingCard()||n.clickHandler.dispatchPickup(t,e,i,s)}},this.clickHandler=e},tt=n(23),et=function t(e){var n=this;Object(s.a)(this,t),this.settings=void 0,this.card=void 0,this.stack=void 0,this.keyboard=void 0,this.validSettings=function(){return"mouse"!==n.settings.launchSettings.inputMode},this.isKeyBoard=function(t){n.keyboard=t},this.setCard=function(t){n.card=t,n.stack=""},this.unsetCard=function(t){n.card&&t&&tt.a.equals(n.card,t)&&(n.card=null)},this.unsetStack=function(t){n.stack&&t&&n.stack==t&&(n.stack="")},this.setStack=function(t){n.card=null,n.stack=t},this.hasCard=function(t){return n.keyboard&&n.validSettings()&&n.card&&t&&tt.a.equals(n.card,t)},this.hasStack=function(t){return n.keyboard&&n.validSettings()&&n.stack&&t&&n.stack==t},this.settings=e,this.card=null,this.stack="",this.keyboard=!1},nt=function t(e){var n=this;Object(s.a)(this,t),this.stack=[],this.getTop=function(){return n.stack&&n.stack.length&&n.stack[n.stack.length-1]},this.suggestion=!1,this.getClickable=function(){return n.stack.filter((function(t){return t.canClick()}))},this.source=e},st=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(t,i){var a;return Object(s.a)(this,n),(a=e.call(this,t)).getHandContent=function(){return a.hand.source==a.source?a.hand.stack:[]},a.getClickable=function(){return[].concat(Object(X.a)(a.stack.filter((function(t){return t.canClick()}))),Object(X.a)(a.getHandContent().filter((function(t){return t.canClick()}))))},a.hand=i,a}return n}(nt),it=n(31),at=n(28),ct=function t(e,n){var i=this;Object(s.a)(this,t),this.setOnClick=function(t){i.stacks.forEach((function(e,n){e.clickEmpty=function(e){return t(null,e,n)},e.stack.forEach((function(s,i){s.onClick=function(e){return t(Object(j.a)({},s),e,n)},s.canClick=function(){return i==e.stack.length-1}})),i.hand.setOnClick(e)}))},this.getCurrentAccepted=function(t){var e=i.stacks[t].acceptedCards;return e[e.length-1]},this.wouldAcceptHand=function(t){return!i.hand.hasMoreThanOneCard()&&i.accepts(t,i.hand.currentCard())},this.putDownHand=function(t){return i.add(t,i.hand.putDown())},this.accepts=function(t,e){var n=i.getCurrentAccepted(t);return i.stacks[t].icon==e.type.icon&&n==e.face},this.add=function(t,e){var n=e[0];return n.causeEntropy(Math.min(i.settings.interactionEntropy,3)),n.source=i.stacks[t].source,i.stacks[t].stack.push(n),i.stacks[t].usedCards.push(i.stacks[t].acceptedCards.pop())},this.remove=function(t,e){return i.stacks[t].acceptedCards.push(i.stacks[t].usedCards.pop()),e&&e.equals(i.getTop(t))&&i.stacks[t].stack.pop()},this.getPreviousUsed=function(t){return Object(X.a)(i.stacks[t].usedCards).pop()},this.countCards=function(){return i.stacks.map((function(t){return parseInt(t.stack.length)})).reduce((function(t,e){return t+e}),0)},this.getTop=function(t){return i.stacks[t].stack[i.stacks[t].stack.length-1]},this.setEntropy=function(t){return i.stacks.forEach((function(e){return e.stack.forEach((function(e){return e.causeEntropy(Math.min(3,t))}))})),i},this.settings=e,this.hand=n;var a=Object.keys(it.a).map((function(t){return it.a[t]})).map((function(t,e){return Object(j.a)(Object(j.a)({},function(t){var e=new st("foundation-"+t,n);return e.stack=[],e.acceptedCards=Object(X.a)(Object(at.b)()),e.usedCards=[],e.icon=null,e.color=null,e.blinkFor=0,e}(e)),t)}));this.stacks=Object(X.a)(a),this.blinkFor=0,this.unblink=function(){}};ct.copy=function(t,e){var n=new ct(t.settings,e);return n.stacks=t.stacks.map((function(t){var n=new st(t.source,e);return n.stack=tt.a.copyAll(t.stack),n.acceptedCards=Object(X.a)(t.acceptedCards),n.usedCards=Object(X.a)(t.usedCards),n.icon=t.icon,n.color=t.color,n})),n};var ot=function(){function t(){var e=this;Object(s.a)(this,t),this.blink=function(t,e){return(new J).startBlink((function(t){return t.foundation.stacks[e]}),t)},this.dispatchPutDown=function(t,n,s,i){if(s.foundation.wouldAcceptHand(i)){var a=s.hand.source;s.foundation.putDownHand(i)&&s.game.registerMove("foundation-"+i,a),e.tryDetectEnd(s)}else e.blink(s,i)},this.dispatchPickup=function(t,n,s,i){var a=s.foundation.getTop(i);a&&s.foundation.getPreviousUsed(i)===a.face?s.hand.pickUp([s.foundation.remove(i,a)],a.source,n)&&s.game.registerPickup():e.blink(s,i)}}return Object(m.a)(t,[{key:"tryDetectEnd",value:function(t){52===t.foundation.countCards()&&(t.game.isEnded=!0,t.game.end=Date.now())}}]),t}(),rt=function(){function t(e){var n=this;Object(s.a)(this,t),this.registerMove=function(t,e){n.registerHint(n.settings.disableHint());var s={source:e,target:t};n.points+=n.rateMove(s)},this.registerRecycle=function(){n.registerHint(n.settings.disableHint()),"single"==n.settings.launchSettings.drawMode&&"infinite"==n.settings.launchSettings.recyclingMode&&(n.points>0&&(n.points<100?n.points=0:n.points-=100),console.debug("RATING: subtract (max) 100 points for RECYCLE"))},this.registerUncover=function(){n.registerHint(n.settings.disableHint()),n.points+=5,console.debug("RATING: add 5 points for UNCOVER")},this.penalize=function(t){if(n.settings.launchSettings.undoPenalty){var e=Math.pow(2,t.multiplicator);console.debug("RATING: applying penalty of ".concat(e," points for UNDO")),n.points=Math.min(n.points,t.points)-e,n.multiplicator=t.multiplicator+1}},this.registerHint=function(t){t&&n.settings.launchSettings.hintPenalty&&(n.points-=10,console.debug("RATING: applying penalty of 10 points for HINT"))},this.getTimePenalty=function(t,e){var n=(e-t)/1e3;return-2*Math.trunc(n/5)},this.getBonusPoints=function(t,e){var n=(e-t)/1e3;return n<30?0:Math.round(2e4/n*35)},this.getTotal=function(t,e){return n.points+n.getBonusPoints(t,e)-n.getTimePenalty(t,e)},this.settings=e,this.points=0,this.multiplicator=1}return Object(m.a)(t,[{key:"registerBlink",value:function(t){t&&this.settings.launchSettings.missPenalty&&(this.points-=10,console.debug("RATING: subtract 10 points for invalid action"))}},{key:"rateMove",value:function(t){var e=function(t){return"tableau"==t.substr(0,7)},n=function(t){return"foundation"==t.substr(0,10)};if(e(t.source)){if(n(t.target))return console.debug("RATING: add 10 points for MOVE tableau -> foundation"),10}else if("waste"==t.source){if(n(t.target))return console.debug("RATING: add 10 points for MOVE waste -> foundation"),10;if(e(t.target))return console.debug("RATING: add 5 points for MOVE waste -> tableau"),5}else if(n(t.source)&&e(t.target))return console.debug("RATING: subtract 15 points for MOVE foundation -> tableau"),-15;return 0}}]),t}();rt.copy=function(t){var e=new rt(t.settings);return e.points=t.points,e.multiplicator=t.multiplicator,e};var ut=function(){function t(){var e=this;Object(s.a)(this,t),this.registerMove=function(t,n){e.memorable=!0,e.modified=!0,n==t&&(e.memorable=!1)},this.pushPreviousState=function(t){var n=e.previousStates[e.previousStates.length-1];n&&e.modelEquals(t,n)||e.previousStates.push(t)},this.registerPickup=function(){e.modified=!0,e.memorable=!1},this.popPreviousState=function(t,n){for(var s=e.previousStates.length-1==t,i=function(){return s&&e.previousStates&&e.previousStates.pop()},a=i();a&&(!a.game.timemachine.memorable||e.modelEquals(a,n))&&e.previousStates.length;)a=i();return a},this.registerRecycle=function(){e.memorable=!0,e.modified=!0},this.registerUncover=function(){return e.memorable=!0,e.modified=!0,!0},this.stackEquals=function(t,e){return t.stack.every((function(t,n){return tt.a.equals(t,e.stack[n])&&t.isHidden==e.stack[n].isHidden}))},this.stacksEqual=function(t,n){return t.stacks.every((function(t,s){return e.stackEquals(t,n.stacks[s])}))},this.modelEquals=function(t,n){return e.stackEquals(t.stock,n.stock)&&e.stackEquals(t.waste,n.waste)&&e.stacksEqual(t.tableau,n.tableau)&&e.stacksEqual(t.foundation,n.foundation)},this.previousStates=[],this.memorable=!0,this.modified=!1}return Object(m.a)(t,[{key:"registerBlink",value:function(){this.modified=!0,this.memorable=!1}}]),t}();ut.copy=function(t){var e=new ut;return e.previousStates=Object(X.a)(t.previousStates),e.memorable=t.memorable,e.modified=t.modified,e};var lt=function(){function t(e){var n=this;Object(s.a)(this,t),this.registerMove=function(t,e){return n.rating.registerMove(t,e),n.timemachine.registerMove(t,e),!0},this.registerPickup=function(){return n.timemachine.registerPickup(),!0},this.registerRecycle=function(){return n.rating.registerRecycle(),n.timemachine.registerRecycle(),!0},this.registerUncover=function(){return n.rating.registerUncover(),n.timemachine.registerUncover(),!0},this.settings=e,this.rating=new rt(e),this.timemachine=new ut,this.started=0,this.isEnded=!1,this.end=0}return Object(m.a)(t,[{key:"registerBlink",value:function(t){return this.rating.registerBlink(t),this.timemachine.registerBlink(t),!0}}]),t}();lt.copy=function(t){var e=new lt(t.settings);return e.timemachine=ut.copy(t.timemachine),e.rating=rt.copy(t.rating),e.paused=t.paused,e};var dt=function t(){var e=this;Object(s.a)(this,t),this.stack=void 0,this.source=void 0,this.position=void 0,this.pickUp=function(t,n,s){return t&&t[0]&&(e.stack=t.map((function(t){return t.suggestion=!1,t})),e.source=n,e.position=s),t},this.putDown=function(){return e.source="",e.stack.splice(0,e.stack.length)},this.setOnClick=function(t){if(e.source&&e.source==t.source){var n=t.clickEmpty;t.stack.length&&(n=t.stack[t.stack.length-1].onClick),e.stack.forEach((function(t){t.onClick=n,t.canClick=function(){return!0}}))}},this.isHoldingCard=function(){return!!e.stack.length},this.isHoldingKing=function(){var t;return e.isHoldingCard()&&e.currentCard()&&"K"==(null===(t=e.currentCard())||void 0===t?void 0:t.face)},this.currentCard=function(){return e.isHoldingCard()&&e.stack[0]||null},this.hasMoreThanOneCard=function(){return e.stack.length>1},this.isFromCurrentSource=function(t){return e.source&&t.source==e.source||null},this.isFromWaste=function(){return e.source&&"waste"==e.source},this.isFromFoundation=function(t){return e.source&&e.source=="foundation-".concat(t)},this.isFromTableau=function(t){return e.source&&e.source=="tableau-".concat(t)},this.isFromAnyTableau=function(){return e.source&&"tableau-"==e.source.substring(0,8)},this.getTableauIndex=function(){return e.source&&parseInt(e.source.substring(8))||0},this.stack=[],this.source="",this.position=null};dt.copy=function(t){var e=new dt;return e.stack=tt.a.copyAll(t.stack),e.source=t.source,e.position=t.position,e};var gt=function t(e){var n=this;Object(s.a)(this,t),this.model=void 0,this.currentIndex=void 0,this.rows=void 0,this.getZindex=function(t,e){for(var n=t.getClickable(),s=0;s<n.length;s++)if(tt.a.equals(e,n[s]))return s;return 0},this.update=function(t,e){for(var s=0;s<n.rows.length;s++)for(var i=n.rows[s],a=0;a<i.length;a++){var c=i[a];if(c&&c.source==t){var o=n.getZindex(c,e);return n.currentIndex={x:a,y:s,z:o},void n.finishNav()}}},this.valid=function(t){return t.x===n.currentIndex.x&&t.y===n.currentIndex.y&&t.z===n.currentIndex.z},this.moveLeft=function(t){return n.move(t,(function(){n.currentIndex.x--,-1==n.currentIndex.x&&(n.currentIndex.x=6)}))},this.moveRight=function(t){return n.move(t,(function(){n.currentIndex.x++,7==n.currentIndex.x&&(n.currentIndex.x=0)}))},this.move=function(t,e){n.valid(t)&&(e(),void 0==n.current()?n.move(n.currentIndex,e):(n.currentIndex.z=n.current().getClickable().length-1,n.finishNav()))},this.moveUp=function(t){n.valid(t)&&(n.current().getClickable().length&&n.currentIndex.z>0?(n.currentIndex.z--,n.finishNav()):n.toggleRow(!0))},this.moveDown=function(t){if(n.valid(t)){var e=n.current().getClickable();e.length&&n.currentIndex.z<e.length-1?(n.currentIndex.z++,n.finishNav()):n.toggleRow(!1)}},this.toggleRow=function(t){0==n.currentIndex.y?n.currentIndex.y=1:n.currentIndex.y=0;var e=n.current()?n.current().getClickable().length-1:0;n.currentIndex.z=t?e:0,void 0==n.current()?n.moveLeft(n.currentIndex):n.finishNav()},this.finishNav=function(){var t=n.current().getClickable();return t&&t[n.currentIndex.z]?n.model.focus.setCard(t[n.currentIndex.z]):n.model.focus.setStack(n.current().source),!0},this.current=function(){return n.rows[n.currentIndex.y][n.currentIndex.x]},this.pressCurrent=function(){return n.model.focus.card&&n.model.focus.card.canClick()?n.model.focus.card.onClick({isKeyboard:!0}):n.model.focus.stack?(console.debug("delegating to clickempty"),n.current().clickEmpty({isKeyboard:!0})):function(t){t.navigator.finishNav(),t.game.timemachine.modified=!0}},this.model=e,this.currentIndex={x:0,y:0,z:0},this.rows=[[this.model.stock,this.model.waste,void 0].concat(Object(X.a)(this.model.foundation.stacks)),Object(X.a)(this.model.tableau.stacks)]},ft=function t(e){var n=this;Object(s.a)(this,t),this.launchSettings=void 0,this.baseEntropy=void 0,this.interactionEntropy=void 0,this.suggestionModes=void 0,this.suggestionMode=void 0,this.setSuggestionMode=function(t){n.suggestionMode.key!==t&&(n.suggestionMode=R.a.get(t))},this.enableHint=function(){n.suggestionMode=R.a.getHintMode()},this.disableHint=function(){return!(!n.suggestionMode.isTemporary||!n.suggestionMode.next)&&(n.suggestionMode=R.a.get(n.suggestionMode.next),!0)},this.launchSettings=e,this.baseEntropy=e.baseEntropy,this.interactionEntropy=e.interactionEntropy,this.suggestionModes=R.a.allSuggestionModes(),this.suggestionMode=R.a.get(e.suggestionMode)};ft.copy=function(t){var e=new ft(t.launchSettings);return e.suggestionMode=t.suggestionMode,e.baseEntropy=t.baseEntropy,e.interactionEntropy=t.interactionEntropy,e};var ht=n(26),pt=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(t,i){var a;return Object(s.a)(this,n),(a=e.call(this,"stock")).setOnClick=function(t){a.clickEmpty=function(e){return t(null,e)},a.stack.forEach((function(e,n){e.onClick=function(n){return t(Object(j.a)({},e),n)},e.canClick=function(){return n==a.stack.length-1}}))},a.popOne=function(){return a.stack.pop()},a.recycle=function(t){return!!t.length&&(a.stack=t.reverse().map(a.setCardProperties),a.stack[a.stack.length-1].canClick=function(){return!0},a.recyclings++,!0)},a.setCardProperties=function(t){return t.causeEntropy(Math.min(a.settings.interactionEntropy,1)),t.isHidden=!0,t.source=a.source,t},a.isOnTop=function(t){return t&&t.equals(a.getTop())},a.popTop=function(){var t=[];return"single"==a.settings.launchSettings.drawMode&&(t=[a.stack.pop()]),"triple"==a.settings.launchSettings.drawMode&&(t=a.stack.splice(a.stack.length-3)),0==a.stack.length&&a.passes--,t},a.setEntropy=function(t){return a.stack.forEach((function(e){return e.causeEntropy(Math.min(t,1))})),Object(ht.a)(a)},a.settings=i,a.stack=t.map(a.setCardProperties),a.recyclings=0,a.passes=-1,a.blinkFor=0,a.unblink=function(){},"1-pass"==a.settings.launchSettings.recyclingMode&&(a.passes=1),"3-pass"==a.settings.launchSettings.recyclingMode&&(a.passes=3),a}return Object(m.a)(n,[{key:"canRecycle",value:function(){return"infinite"==this.settings.launchSettings.recyclingMode||"3-pass"==this.settings.launchSettings.recyclingMode&&this.recyclings<2}}]),n}(nt);pt.copy=function(t){var e=new pt([],t.settings,t.focus);return e.stack=tt.a.copyAll(t.stack),e.dealt=t.dealt,e.dealingAt=t.dealingAt,e.isDealt=t.isDealt,e.passes=t.passes,e.recyclings=t.recyclings,e};var kt=function t(e){var n=this;Object(s.a)(this,t),this.navigator=void 0,this.blink=function(t){return(new J).startBlink((function(t){return t.stock}),t)},this.dispatchPutDown=function(t,e,s){return n.blink(s,0)},this.dispatchPickup=function(t,e,s){return null!=t?n.moveToWaste(t,s):n.recycleWaste(t,s)},this.moveToWaste=function(t,e){return e.stock.isOnTop(t)&&e.waste.addAll(e.stock.popTop())&&e.game.registerMove("waste","stock")},this.recycleWaste=function(t,e){if(!e.stock.getTop())return!!e.waste.getTop()&&e.stock.canRecycle()&&e.stock.recycle(e.waste.recycle())&&e.game.registerRecycle()&&n.navigator.finishNav()||n.blink(e,0)},this.navigator=e},bt=function t(){var e=this;Object(s.a)(this,t),this.blink=function(t){return(new J).startBlink((function(t){return t.waste}),t)},this.dispatchPutDown=function(t,n,s){return s.waste.wouldAcceptHand()&&s.waste.putDownHand()&&s.game.registerMove("waste","waste")||e.blink(s,0)},this.dispatchPickup=function(t,n,s){return t&&s.hand.pickUp([s.waste.popTop(t)],"waste",n)&&s.game.registerPickup()||e.blink(s,0)}},mt=function t(){var e=this;Object(s.a)(this,t),this.tableau=void 0,this.waste=void 0,this.evaluateOptions=function(t){e.disableAllSuggestions(t),t.settings.suggestionMode.key===R.a.NONE||e.getUncoverOptions(t)||e.getPutdownSuggestions(t)||t.hand.isHoldingCard()||e.getPickupOptions(t)&&t.settings.suggestionMode.key!=R.a.FULL||!t.stock.getTop()&&!t.stock.canRecycle()||t.settings.suggestionMode.key===R.a.SCORED||(t.stock.suggestion=!0)},this.getPutdownSuggestions=function(t,e){if(!t.hand.isHoldingCard()||t.settings.suggestionMode.key==R.a.NONE)return 0;var n=[];if(t.waste.wouldAcceptHand()&&(t.settings.suggestionMode.key===R.a.FULL||!t.hand.isFromWaste())){var s={target:"waste",source:t.hand.source};(t.settings.suggestionMode.key!==R.a.SCORED||t.game.rating.rateMove(s)>0)&&(n.push(s),t.waste.suggestion=!0)}return t.foundation.stacks.forEach((function(e,s){if(t.foundation.wouldAcceptHand(s)&&(t.settings.suggestionMode.key===R.a.FULL||!t.hand.isFromFoundation(s))){var i={target:e.source,source:t.hand.source};(t.settings.suggestionMode.key!==R.a.SCORED||t.game.rating.rateMove(i)>0)&&(n.push(i),e.suggestion=!0)}})),t.tableau.stacks.forEach((function(s,i){if(t.tableau.wouldAcceptHand(i)&&(t.settings.suggestionMode.key===R.a.FULL||!t.hand.isFromTableau(i))){var a=t.hand.isHoldingKing()&&0==s.stack.length&&t.hand.isFromAnyTableau()&&0==t.tableau.stacks[t.hand.getTableauIndex()].stack.length,c=s.stack.length>0&&t.hand.isFromAnyTableau()&&t.tableau.stacks[t.hand.getTableauIndex()].stack.length>0&&s.stack[s.stack.length-1].face==t.tableau.stacks[t.hand.getTableauIndex()].stack[t.tableau.stacks[t.hand.getTableauIndex()].stack.length-1].face&&!t.tableau.getTop(t.hand.getTableauIndex()).isHidden,o=!a&&!c;if(!e||t.settings.suggestionMode.key===R.a.FULL||o){var r={target:s.source,source:t.hand.source};(t.settings.suggestionMode.key!==R.a.SCORED||t.game.rating.rateMove(r)>0)&&(n.push(r),s.suggestion=!0)}}})),n.length},this.getPickupOptions=function(t){var n=!1,s=xt.copy(t);return e.waste.dispatchPickup(s.waste.getTop(),null,s),s.game.timemachine.modified&&e.getPutdownSuggestions(s,!0)>(t.settings.suggestionMode.key==R.a.FULL?1:0)&&(t.waste.suggestion=!0,n=!0),t.tableau.stacks.forEach((function(s,i){return s.stack.map((function(t,e){return{cardIndex:e,card:t}})).filter((function(t){return!t.card.isHidden})).forEach((function(a){var c=a.card,o=a.cardIndex,r=xt.copy(t);e.tableau.dispatchPickup(c,null,r,i),r.game.timemachine.modified&&e.getPutdownSuggestions(r,!0)>(t.settings.suggestionMode.key==R.a.FULL?1:0)&&(s.stack[o].suggestion=!0,n=!0)}))})),n},this.getUncoverOptions=function(t){if(!t.hand.isHoldingCard()){var e=t.tableau.stacks.map((function(t,e){return e})).filter((function(e){return t.tableau.getTop(e)&&t.tableau.getTop(e).isHidden}));return e.forEach((function(e){t.tableau.getTop(e).suggestion=!0})),e.length}return 0},this.disableAllSuggestions=function(t){var e=function t(e){e.suggestion=!1,e.stack&&e.stack.forEach(t),e.stacks&&e.stacks.forEach(t)};e(t.waste),e(t.stock),e(t.tableau),e(t.foundation)},this.tableau=new Z,this.waste=new bt},vt=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(){var t;Object(s.a)(this,n);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).blinkFor=0,t.id=0,t.onClick=function(t){},t.clickEmpty=function(t){},t.setOnClick=function(){},t}return n}(st),jt=function t(e,n){var i=this;Object(s.a)(this,t),this.stacks=void 0,this.settings=void 0,this.hand=void 0,this.setOnClick=function(t,e,n){i.stacks.forEach((function(s,a){s.clickEmpty=function(e){return t(null,e,a)},s.stack.forEach((function(n,c){var o=n.isHidden&&c==s.stack.length-1?e:t;n.onClick=function(t){return o(Object(j.a)({},n),t,a)},n.canClick=function(){return!n.isHidden||i.canUncover(a,n)}})),n.setOnClick(s)}))},this.getStack=function(t){return i.stacks[t]},this.wouldAcceptHand=function(t){return i.canPutDown(i.getTop(t),i.hand,t)},this.putDownHand=function(t){return i.add(t,i.hand.putDown())},this.canPutDown=function(t,e,n){return t&&t.isHidden&&e.isFromCurrentSource(t)||i.accepts(n,e.currentCard())||!t&&e.isFromTableau(n)},this.accepts=function(t,e){var n=i.getTop(t);if(!n)return e&&"K"===e.face;if(n.isHidden)return!1;var s=Object(X.a)(Object(at.c)());return s.indexOf(null===e||void 0===e?void 0:e.face)+1==s.indexOf(n.face)&&(null===e||void 0===e?void 0:e.type.color)!==n.type.color&&"A"!==n.face},this.getCard=function(t,e){for(var n=0;n<i.stacks[t].stack.length;n++)if(e&&e.equals(i.stacks[t].stack[n])&&e.isHidden===i.stacks[t].stack[n].isHidden)return i.stacks[t].stack[n];return!1},this.popWithFollowing=function(t,e){for(var n=0;n<i.stacks[e].stack.length;n++)if(t&&t.equals(i.stacks[e].stack[n])){var s=i.stacks[e].stack.splice(n,i.stacks[e].stack.length);return i.stackEntropy(e),s}return[]},this.deal=function(t,e){i.stacks[e].stack.push(t)},this.canUncover=function(t,e){return i.getTop(t).isHidden&&e&&e.equals(i.getTop(t))},this.uncover=function(t,e){var n=i.getTop(t);return!!i.canUncover(t,e)&&(n.isHidden=!1,i.stackEntropy(t),!0)},this.stackEntropy=function(t){for(var e=i.settings.interactionEntropy,n=1,s=i.getTop(t);e&&0!=e&&s;)s.causeEntropy(e),e--,s=i.getTop(t,n),n++},this.add=function(t,e){return i.stacks[t].stack=i.stacks[t].stack.concat(e.map((function(e){return i.setCardProperties(e,t)}))),i.stackEntropy(t),e},this.setCardProperties=function(t,e){return t.source=i.stacks[e].source,t},this.getTop=function(t,e){return i.stacks[t].stack[i.stacks[t].stack.length-1-(e||0)]},this.setEntropy=function(t){return i.stacks.forEach((function(e){return e.stack.forEach((function(e){return e.causeEntropy(Math.min(t,4))}))})),i};this.hand=n,this.stacks=[0,1,2,3,4,5,6].map((function(t){var e=new vt("tableau-"+t,n);return e.stack=[],e.blinkFor=0,e.id=t,e})),this.settings=e};jt.copy=function(t,e){var n=new jt(t.settings,e);return n.stacks=t.stacks.map((function(t,n){var s=new vt(t.source,e);return s.id=n,s.stack=tt.a.copyAll(t.stack),s})),n};var Ot=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(t,i){var a;return Object(s.a)(this,n),(a=e.call(this,"waste",i)).setOnClick=function(t){a.clickEmpty=function(e){return t(null,e)},a.stack.forEach((function(e,n){e.onClick=function(n){return t(Object(j.a)({},e),n)},e.canClick=function(){return n==a.stack.length-1}})),a.hand.setOnClick(Object(ht.a)(a))},a.putDownHand=function(){return a.addAll(a.hand.putDown())},a.add=function(t){return t&&a.stack.push(a.setCardProperties(t))},a.addAll=function(t){return t&&t.length&&t.map(a.add)},a.setCardProperties=function(t){return t.source=a.source,t.isHidden=!1,t.causeEntropy(Math.min(a.settings.interactionEntropy,1)),t},a.wouldAcceptHand=function(){return a.hand.isFromWaste()&&a.canAdd(a.hand.currentCard())},a.canAdd=function(t){return t&&(!a.getTop()||!t.equals(a.getTop()))},a.popTop=function(t){return t&&t.equals(a.getTop())&&a.stack.pop()},a.recycle=function(){return a.stack.splice(0,a.stack.length)},a.setEntropy=function(t){return a.stack.forEach((function(e){return e.causeEntropy(Math.min(t,1))})),Object(ht.a)(a)},a.settings=t,a.blinkFor=0,a.unblink=function(){},a}return n}(st);Ot.copy=function(t,e){var n=new Ot(t.settings,e);return n.stack=tt.a.copyAll(t.stack),n};var xt=function t(e){var n=this;Object(s.a)(this,t),this.stock=void 0,this.waste=void 0,this.foundation=void 0,this.tableau=void 0,this.hand=void 0,this.game=void 0,this.settings=void 0,this.focus=void 0,this.suggestor=void 0,this.dealer=void 0,this.navigator=void 0,this.withSuggestions=function(){return n.suggestor.evaluateOptions(n),n},this.setEntropy=function(t){n.settings.baseEntropy=t,n.stock.setEntropy(t),n.waste.setEntropy(t),n.foundation.setEntropy(t),n.tableau.setEntropy(t)},this.withHandlers=function(){var t=function(t){return new _(t).getHandler(n.hand)};return n.stock.setOnClick(t(new kt(n.navigator))),n.waste.setOnClick(t(new bt)),n.foundation.setOnClick(t(new ot)),n.tableau.setOnClick(t(new Z),t(new Q),n.hand),n},this.stock=e.stock,this.waste=e.waste,this.foundation=e.foundation,this.tableau=e.tableau,this.hand=e.hand,this.game=e.game,this.settings=e.settings,this.focus=e.focus,this.suggestor=new mt,this.dealer=new $,this.navigator=new gt(this)};xt.getInitialState=function(t,e){var n=new ft(t),s=new dt,i={stock:new pt(Object(X.a)(e.cards),n),waste:new Ot(n,s),foundation:new ct(n,s),tableau:new jt(n,s),hand:s,game:new lt(n),settings:n,focus:new et(n)};return new xt(i)},xt.copy=function(t){var e=dt.copy(t.hand);return new xt({stock:pt.copy(t.stock),waste:Ot.copy(t.waste,e),foundation:ct.copy(t.foundation,e),tableau:jt.copy(t.tableau,e),hand:e,game:lt.copy(t.game),settings:ft.copy(t.settings),focus:t.focus})};var yt=l.a.createContext({player:0}),Ct=yt.Provider,wt=function(t){Object(i.a)(n,t);var e=Object(a.a)(n);function n(t){var i;return Object(s.a)(this,n),(i=e.call(this,t)).replaceContext=function(t){return i.setState(t)},i.updateContext=function(t){return i.replaceContext((function(e){return t(e),e}))},i.updateGameContext=function(t){return i.replaceContext((function(e){e.game.timemachine.modified=!1;var n=xt.copy(e);return t(e),e.game.timemachine.modified?(e.game.timemachine.pushPreviousState(n),e):null}))},i.render=function(){var t={state:i.state.withHandlers().withSuggestions(),replaceContext:i.replaceContext,updateContext:i.updateContext,updateGameContext:i.updateGameContext,restart:i.props.restart};return Object(c.jsxs)(r.c,{value:t,children:[Object(c.jsx)(Ct,{value:{player:i.props.player},children:Object(c.jsx)(V,{mode:i.props.settings.boardMode})}),Object(c.jsx)(Y,{})]})},i.state=xt.getInitialState(t.settings,t.deck),i}return n}(l.a.Component)}}]);
//# sourceMappingURL=5.59942721.chunk.js.map