"use strict";(self.webpackChunksolitaire_react=self.webpackChunksolitaire_react||[]).push([[454],{4758:function(t,n,e){e.r(n),e.d(n,{default:function(){return bn}});var s=e(8683),i=e(3718),a=e(3144),o=e(5671),r=e(9340),c=e(8347),u=(e(2542),e(577)),l=e(2791),d=e(885),g=e(184),f={started:0,isEnded:!1,end:0,winner:-1,loser:-1},h=l.createContext({gameState:f,win:function win(){},start:function start(){},giveUp:function giveUp(){}}),p=function useGameContext(){return l.useContext(h)},k=function GameContextProvider(t){var n=l.useState(f),e=(0,d.Z)(n,2),i=e[0],a=e[1],o={gameState:i,win:function win(t){return a((0,s.Z)((0,s.Z)({},i),{},{end:Date.now(),isEnded:!0,winner:t}))},start:function start(){return a((0,s.Z)((0,s.Z)({},i),{},{started:Date.now()}))},giveUp:function giveUp(t){a((0,s.Z)((0,s.Z)({},i),{},{end:Date.now(),isEnded:!0,loser:t}))}};return(0,g.jsx)(h.Provider,{value:o,children:t.children})},v={state:null,replaceContext:function replaceContext(){},updateContext:function updateContext(){},updateGameContext:function updateGameContext(){},restart:function restart(){}},m=l.createContext(v),x=m.Provider,y=function useGlobalContext(){var t=l.useContext(m);if(!t.state)throw new Error("no state present");return(0,s.Z)((0,s.Z)({},t),{},{state:t.state})},S=e(2982),b={end:0,paused:!1,pauses:[],pauseStartedAt:0,allowed:5,pausedBy:-1,showMenu:!1,showCards:!0},C={state:b,togglePause:function togglePause(){},toggleMenu:function toggleMenu(){},getElapsed:function getElapsed(){return""}},Z=l.createContext(C),w=function PauseProvider(t){var n=p().gameState,e=l.useState((0,s.Z)({},b)),i=(0,d.Z)(e,2),a=i[0],o=i[1],r={state:(0,s.Z)((0,s.Z)({},a),{},{started:n.started}),togglePause:function togglePause(t,n){a.showMenu?o((0,s.Z)((0,s.Z)({},a),{},{pausedBy:n,pauses:[].concat((0,S.Z)(a.pauses),[Date.now()-a.pauseStartedAt]),pauseStartedAt:0,paused:!1,showMenu:!1,showCards:!0})):a.pauses.length<a.allowed?o((0,s.Z)((0,s.Z)({},a),{},{pausedBy:n,pauseStartedAt:Date.now(),paused:!0,showMenu:!0,showCards:!1})):o((0,s.Z)((0,s.Z)({},a),{},{pausedBy:n,pauseStartedAt:0,paused:!1,showMenu:!0,showCards:!1}))},toggleMenu:function toggleMenu(t){o((0,s.Z)((0,s.Z)({},a),{},{showMenu:t,showCards:!0}))},getElapsed:function getElapsed(){var t=function padleft(t){return 1===(t+"").length?"0"+t:t},e=function getElapsedMs(){var t=a.pauses.reduce((function(t,n){return t+n}),0);return(a.end||a.pauseStartedAt||Date.now())-n.started-t}(),s=Math.floor(e/1e3/60/60);e-=1e3*s*60*60;var i=Math.floor(e/1e3/60);e-=1e3*i*60;var o=Math.floor(e/1e3);return e-=1e3*o,s?s+":"+t(i)+":"+t(o):t(i)+":"+t(o)}};return(0,g.jsx)(Z.Provider,{value:r,children:t.children})},j=function usePauseContext(){return l.useContext(Z)},M=e(4421),E=function AutoDealerRenderer(t){var n=y(),e=t.length,s=t.started,i=t.paused,a=(0,M.Z)({length:e,paused:i,started:s});return l.useEffect((function(){var t=null;return n.state.settings.launchSettings.speed&&s&&!i&&a&&((null===a||void 0===a?void 0:a.length)!==e||(null===a||void 0===a?void 0:a.started)!==s||(null===a||void 0===a?void 0:a.paused)!==i)&&(t=setTimeout((function(){n.updateContext((function(t){e===t.stock.stack.length&&t.stock.passes>0&&(t.stock.stack.length||t.waste.stack.length)&&(t.hand.isFromWaste()&&t.waste.putDownHand(),t.stock.stack.length?t.waste.addAll(t.stock.popTop()):t.stock.canRecycle()&&t.stock.recycle(t.waste.recycle()))}))}),1e4)),function(){t&&clearTimeout(t)}}),[n,e,i,a,s]),null},T=function AutoDealer(){var t=y().state,n=j(),e=p().gameState,s=n.state.paused;return(0,g.jsx)(E,{length:t.stock.stack.length,paused:s,started:e.started})},H=(0,a.Z)((function Blinker(){var t=this;(0,o.Z)(this,Blinker),this.startBlink=function(n,e){n(e).blinkFor<10&&(n(e).blinkFor=10,e.game.registerBlink(!0),n(e).unblink=function(e){return t.stopBlink(n,e)})},this.stopBlink=function(t,n){t(n).blinkFor=0,n.game.registerBlink(!1)}})),P=(0,a.Z)((function Tableau(){var t=this;(0,o.Z)(this,Tableau),this.blink=function(t,n){return(new H).startBlink((function(t){return t.tableau.stacks[n]}),t)},this.dispatchPutDown=function(n,e,s,i){if(s.tableau.wouldAcceptHand(i)){var a=s.hand.source;s.tableau.putDownHand(i)&&s.game.registerMove("tableau-"+i,a,s.tableau.getTop(i))}else t.blink(s,i)},this.dispatchPickup=function(n,e,s,i){n?s.hand.pickUp(s.tableau.popWithFollowing(n,i),n.source,e)&&s.game.registerPickup():n||t.blink(s,i)}})),D=function(t){(0,r.Z)(TableauHidden,t);var n=(0,c.Z)(TableauHidden);function TableauHidden(){var t;(0,o.Z)(this,TableauHidden);for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return(t=n.call.apply(n,[this].concat(s))).dispatchPickup=function(n,e,s,i){n&&t.tryUncover(n,i,s)},t.tryUncover=function(t,n,e){return!e.hand.isHoldingCard()&&t.isHidden&&e.tableau.uncover(n,t)&&e.game.registerUncover(e.tableau.getTop(n))},t}return(0,a.Z)(TableauHidden)}(P),N=(0,a.Z)((function Dealer(){var t=this;(0,o.Z)(this,Dealer),this.dealt=void 0,this.dealingAt=void 0,this.isDealt=void 0,this.dealOne=function(t,n){return function(e){return t!==e.dealer.dealt?null:(e.dealer.deal(e.stock,e.tableau),e.dealer.isDealt||n(e.dealer.dealt),e)}},this.dealAll=function(){return function(n){if(t.dealt!==n.dealer.dealt)return null;for(;!n.dealer.isDealt;)n.dealer.deal(n.stock,n.tableau);return n}},this.deal=function(n,e){for(var s=t.dealingAt;s<e.stacks.length;s++){var i=e.stacks[s].stack;if(i.length<=e.stacks.length-s-1){var a=n.popOne();return void(a&&(a.source=e.stacks[s].source,i.length===e.stacks.length-1-s&&(a.isHidden=!1),e.deal(a,s),t.dealt++,t.dealingAt++,t.dealingAt===e.stacks.length&&(t.dealingAt=0),t.isDealt=!1))}var o=0===t.dealingAt;return t.dealingAt=0,void(t.isDealt=o)}t.isDealt=!0},this.dealt=0,this.dealingAt=0,this.isDealt=!1})),A=(0,a.Z)((function Dispatcher(t){var n=this;(0,o.Z)(this,Dispatcher),this.clickHandler=void 0,this.getHandler=function(t){return t&&t.isHoldingCard()?n.dispatchPutDown:n.dispatchPickup},this.dispatchPutDown=function(t,e,s){return function(i){i.hand.isHoldingCard()&&n.clickHandler.dispatchPutDown(t,e,i,s)}},this.dispatchPickup=function(t,e,s){return function(i){i.hand.isHoldingCard()||n.clickHandler.dispatchPickup(t,e,i,s)}},this.clickHandler=t})),F=e(3680),R=(0,a.Z)((function Focus(t,n){var e=this;(0,o.Z)(this,Focus),this.settings=void 0,this.card=void 0,this.stack=void 0,this.keyboard=void 0,this.player=void 0,this.validSettings=function(){return"mouse"!==e.settings.launchSettings.players[e.player].inputMethod},this.isKeyBoard=function(t){e.keyboard=t},this.setCard=function(t){e.card=t,e.stack=""},this.unsetCard=function(t){e.card&&t&&F.Z.equals(e.card,t)&&(e.card=null)},this.unsetStack=function(t){e.stack&&t&&e.stack===t&&(e.stack="")},this.setStack=function(t){e.card=null,e.stack=t},this.hasCard=function(t){return e.keyboard&&e.validSettings()&&F.Z.equals(e.card,t)},this.hasStack=function(t){return e.keyboard&&e.validSettings()&&e.stack&&t&&e.stack===t},this.settings=t,this.card=null,this.stack="",this.keyboard=!1,this.player=n})),I=e(7326),O=(0,a.Z)((function BasicStack(t){var n=this;(0,o.Z)(this,BasicStack),this.source=void 0,this.suggestion=!1,this.stack=[],this.getTop=function(){return n.stack&&n.stack.length&&n.stack[n.stack.length-1]||null},this.getClickable=function(){return n.stack.filter((function(t){return t.canClick()}))},this.blinkFor=0,this.onClick=function(t){return function(t){}},this.clickEmpty=function(t){return function(t){}},this.unblink=function(){},this.accepts=void 0,this.source=t})),U=function(t){(0,r.Z)(HandHoldingStack,t);var n=(0,c.Z)(HandHoldingStack);function HandHoldingStack(t,e){var s;return(0,o.Z)(this,HandHoldingStack),(s=n.call(this,t)).hand=void 0,s.getHandContent=function(){return s.hand.source===s.source?s.hand.stack:[]},s.getClickable=function(){return[].concat((0,S.Z)(s.stack.filter((function(t){return t.canClick()}))),(0,S.Z)(s.getHandContent().filter((function(t){return t.canClick()}))))},s.hand=e,s}return(0,a.Z)(HandHoldingStack)}(O),B=e(9093),L=function(t){(0,r.Z)(FoundationStack,t);var n=(0,c.Z)(FoundationStack);function FoundationStack(t,e,i){var a;return(0,o.Z)(this,FoundationStack),(a=n.call(this,t,e)).acceptedCards=[],a.usedCards=[],a.icon="",a.color="",a.getCurrentAccepted=function(){return a.acceptedCards[a.acceptedCards.length-1]},a.accepts=function(t){if(!t)return!1;var n=a.getCurrentAccepted();return a.icon===t.type.icon&&n===t.denomination},a.setOnClick=function(t,n){a.clickEmpty=function(n){return t(null,n)};var e=a.source===n.source?[].concat((0,S.Z)(a.stack),(0,S.Z)(n.stack)):a.stack;e.forEach((function(n,i){n.onClick=function(e){return t((0,s.Z)({},n),e)},n.canClick=function(){return i===e.length-1}})),a.hand.setOnClick((0,I.Z)(a))},a.acceptedCards=(0,S.Z)((0,B.qW)()),a.usedCards=[],a.icon=i.icon,a.color=i.color,a}return(0,a.Z)(FoundationStack)}(U),G=(0,a.Z)((function MultiStack(t,n,e){(0,o.Z)(this,MultiStack),this.stacks=void 0,this.settings=void 0,this.hand=void 0,this.stacks=e,this.settings=t,this.hand=n})),z=e(7909),W=function(t){(0,r.Z)(Foundation,t);var n=(0,c.Z)(Foundation);function Foundation(t,e){var s;return(0,o.Z)(this,Foundation),(s=n.call(this,t,e,(0,S.Z)(Object.keys(z.Z).map((function(t){return z.Z[t]})).map((function(t,n){return new L("foundation-"+n,e,t)}))))).setOnClick=function(t){s.stacks.forEach((function(n,e){n.setOnClick((function(n,s){return t(n,s,e)}),s.hand)}))},s.getCurrentAccepted=function(t){return s.stacks[t].getCurrentAccepted()},s.wouldAcceptHand=function(t){return!s.hand.hasMoreThanOneCard()&&s.accepts(t,s.hand.currentCard())},s.putDownHand=function(t){return s.add(t,s.hand.putDown())},s.accepts=function(t,n){return s.stacks[t].accepts(n)},s.add=function(t,n){var e=n[0];return e.causeEntropy(Math.min(s.settings.interactionEntropy,3)),e.source=s.stacks[t].source,s.stacks[t].stack.push(e),s.stacks[t].usedCards.push(s.stacks[t].acceptedCards.pop())},s.remove=function(t,n){return s.stacks[t].acceptedCards.push(s.stacks[t].usedCards.pop()),n&&n.equals(s.getTop(t))&&s.stacks[t].stack.pop()||null},s.getPreviousUsed=function(t){return(0,S.Z)(s.stacks[t].usedCards).pop()},s.countCards=function(){return s.stacks.map((function(t){return t.stack.length})).reduce((function(t,n){return t+n}),0)},s.getTop=function(t){return s.stacks[t].stack[s.stacks[t].stack.length-1]},s.setEntropy=function(t){return s.stacks.forEach((function(n){return n.stack.forEach((function(n){return n.causeEntropy(Math.min(3,t))}))})),(0,I.Z)(s)},s}return(0,a.Z)(Foundation)}(G);W.copy=function(t,n){var e=new W(t.settings,n);return e.stacks=t.stacks.map((function(t){var e=new L(t.source,n,t);return e.stack=F.Z.copyAll(t.stack),e.acceptedCards=(0,S.Z)(t.acceptedCards),e.usedCards=(0,S.Z)(t.usedCards),e.icon=t.icon,e.color=t.color,e})),e};var q=(0,a.Z)((function Foundation(){var t=this;(0,o.Z)(this,Foundation),this.blink=function(t,n){return(new H).startBlink((function(t){return t.foundation.stacks[n]}),t)},this.dispatchPutDown=function(n,e,s,i){if(s.foundation.wouldAcceptHand(i)){var a=s.hand.source;s.foundation.putDownHand(i)&&s.game.registerMove("foundation-"+i,a,s.foundation.getTop(i))}else t.blink(s,i)},this.dispatchPickup=function(n,e,s,i){var a=s.foundation.getTop(i);a&&s.foundation.getPreviousUsed(i)===a.denomination?s.hand.pickUp([s.foundation.remove(i,a)],a.source,e)&&s.game.registerPickup():t.blink(s,i)}})),K=function(){function Rating(t){var n=this;(0,o.Z)(this,Rating),this.settings=void 0,this.points=void 0,this.multiplicator=void 0,this.ratings=void 0,this.applyRating=function(t,e){console.debug("RATING:",e),n.ratings.push({points:t,text:e})},this.registerMove=function(t,e,s){n.registerHint(n.settings.disableHint());var i={source:e,target:t};n.points+=n.rateMove(i,s)},this.registerRecycle=function(){if(n.registerHint(n.settings.disableHint()),"single"===n.settings.launchSettings.drawMode&&"infinite"===n.settings.launchSettings.recyclingMode&&n.points>0){var t=0;n.points<100?(t=-1*n.points,n.points=0):(n.points-=100,t=-100),n.applyRating(t,"subtract ".concat(t," (max 100 points) for RECYCLE"))}},this.registerUncover=function(t){n.registerHint(n.settings.disableHint()),t&&t.setSuccess(5),n.points+=5,n.applyRating(5,"add 5 points for UNCOVER")},this.penalize=function(t){if(n.settings.launchSettings.undoPenalty){var e=Math.pow(2,t.multiplicator);n.applyRating(-1*e,"applying penalty of ".concat(e," points for UNDO")),n.points=Math.min(n.points,t.points)-e,n.multiplicator=t.multiplicator+1}},this.registerHint=function(t){t&&n.settings.launchSettings.hintPenalty&&(n.points-=10,n.applyRating(-10,"applying penalty of 10 points for HINT"))},this.getTimePenalty=function(t,n){var e=(n-t)/1e3;return-2*Math.trunc(e/5)},this.getBonusPoints=function(t,n){var e=(n-t)/1e3;return e<30?0:Math.round(2e4/e*35)},this.getTotal=function(t,e){return n.points+n.getBonusPoints(t,e)-n.getTimePenalty(t,e)},this.settings=t,this.points=0,this.multiplicator=1,this.ratings=[]}return(0,a.Z)(Rating,[{key:"registerBlink",value:function registerBlink(t){t&&this.settings.launchSettings.missPenalty&&(this.points-=10,this.applyRating(-10,"subtract 10 points for invalid action"))}},{key:"rateMove",value:function rateMove(t,n){var e=function isTableau(t){return"tableau"===t.substr(0,7)},s=function isFoundation(t){return"foundation"===t.substr(0,10)};if(e(t.source)){if(s(t.target))return this.applyRating(10,"add 10 points for MOVE tableau -> foundation"),n&&n.setSuccess(10),10}else if("waste"===t.source){if(s(t.target))return this.applyRating(10,"add 10 points for MOVE waste -> foundation"),n&&n.setSuccess(10),10;if(e(t.target))return this.applyRating(5,"add 5 points for MOVE waste -> tableau"),n&&n.setSuccess(5),5}else if(s(t.source)&&e(t.target))return this.applyRating(-15,"subtract 15 points for MOVE foundation -> tableau"),-15;return 0}}]),Rating}();K.copy=function(t){var n=new K(t.settings);return n.points=t.points,n.multiplicator=t.multiplicator,n.ratings=(0,S.Z)(t.ratings),n};var _=function(){function TimeMachine(){var t=this;(0,o.Z)(this,TimeMachine),this.previousStates=void 0,this.memorable=void 0,this.modified=void 0,this.registerMove=function(n,e){t.memorable=!0,t.modified=!0,e===n&&(t.memorable=!1)},this.pushPreviousState=function(n){var e=t.previousStates[t.previousStates.length-1];e&&t.modelEquals(n,e)||t.previousStates.push(n)},this.registerPickup=function(){t.modified=!0,t.memorable=!1},this.popPreviousState=function(n,e){for(var s=t.previousStates.length-1===n,i=function popPrevious(){return s&&t.previousStates&&t.previousStates.pop()},a=i();a&&(!a.game.timemachine.memorable||t.modelEquals(a,e))&&t.previousStates.length;)a=i();return a},this.registerRecycle=function(){t.memorable=!0,t.modified=!0},this.registerUncover=function(){return t.memorable=!0,t.modified=!0,!0},this.stackEquals=function(t,n){return t.stack.every((function(t,e){return F.Z.equals(t,n.stack[e])&&t.isHidden===n.stack[e].isHidden}))},this.stacksEqual=function(n,e){return n.stacks.every((function(n,s){return t.stackEquals(n,e.stacks[s])}))},this.modelEquals=function(n,e){return t.stackEquals(n.stock,e.stock)&&t.stackEquals(n.waste,e.waste)&&t.stacksEqual(n.tableau,e.tableau)&&t.stacksEqual(n.foundation,e.foundation)},this.previousStates=[],this.memorable=!0,this.modified=!1}return(0,a.Z)(TimeMachine,[{key:"registerBlink",value:function registerBlink(t){t&&(this.modified=!0,this.memorable=!1)}}]),TimeMachine}();_.copy=function(t){var n=new _;return n.previousStates=(0,S.Z)(t.previousStates),n.memorable=t.memorable,n.modified=t.modified,n};var V=function(){function Game(t){var n=this;(0,o.Z)(this,Game),this.settings=void 0,this.rating=void 0,this.timemachine=void 0,this.registerMove=function(t,e,s){return n.rating.registerMove(t,e,s),n.timemachine.registerMove(t,e),!0},this.registerPickup=function(){return n.timemachine.registerPickup(),!0},this.registerRecycle=function(){return n.rating.registerRecycle(),n.timemachine.registerRecycle(),!0},this.registerUncover=function(t){return n.rating.registerUncover(t),n.timemachine.registerUncover(),!0},this.settings=t,this.rating=new K(t),this.timemachine=new _}return(0,a.Z)(Game,[{key:"registerBlink",value:function registerBlink(t){return this.rating.registerBlink(t),this.timemachine.registerBlink(t),!0}}]),Game}();V.copy=function(t){var n=new V(t.settings);return n.timemachine=_.copy(t.timemachine),n.rating=K.copy(t.rating),n};var Y=(0,a.Z)((function Hand(){var t=this;(0,o.Z)(this,Hand),this.stack=void 0,this.source=void 0,this.position=void 0,this.filter=function(t){return t.filter((function(t){return t}))},this.pickUp=function(n,e,s){return n&&n[0]&&(t.stack=t.filter(n).map((function(t){return t.suggestion=!1,t})),t.source=e,t.position=s),n},this.putDown=function(){return t.source="",t.stack.splice(0,t.stack.length)},this.setOnClick=function(n){if(t.source&&t.source===n.source){var e=n.clickEmpty;n.stack.length&&(e=n.stack[n.stack.length-1].onClick),t.stack.forEach((function(t){t.onClick=e,t.canClick=function(){return!0}}))}},this.isHoldingCard=function(){return!!t.stack.length},this.isHoldingKing=function(){var n;return t.isHoldingCard()&&t.currentCard()&&"K"===(null===(n=t.currentCard())||void 0===n?void 0:n.denomination)},this.currentCard=function(){return t.isHoldingCard()&&t.stack[0]||null},this.hasMoreThanOneCard=function(){return t.stack.length>1},this.isFromCurrentSource=function(n){return t.source&&n.source===t.source||null},this.isFromWaste=function(){return t.source&&"waste"===t.source||!1},this.isFromFoundation=function(n){return t.source&&t.source==="foundation-".concat(n)},this.isFromTableau=function(n){return t.source&&t.source==="tableau-".concat(n)},this.isFromAnyTableau=function(){return t.source&&"tableau-"===t.source.substring(0,8)},this.getTableauIndex=function(){return t.source&&parseInt(t.source.substring(8))||0},this.stack=[],this.source="",this.position=null}));Y.copy=function(t){var n=new Y;return n.stack=F.Z.copyAll(t.stack),n.source=t.source,n.position=t.position,n};var X=(0,a.Z)((function Navigator(t){var n=this;(0,o.Z)(this,Navigator),this.model=void 0,this.currentIndex=void 0,this.rows=void 0,this.getZindex=function(t,n){for(var e=t.getClickable(),s=0;s<e.length;s++)if(F.Z.equals(n,e[s]))return s;return 0},this.update=function(t,e){for(var s=0;s<n.rows.length;s++)for(var i=n.rows[s],a=0;a<i.length;a++){var o=i[a];if(o&&o.source===t){var r=n.getZindex(o,e);return n.currentIndex={x:a,y:s,z:r},void n.finishNav()}}},this.valid=function(t){return t.x===n.currentIndex.x&&t.y===n.currentIndex.y&&t.z===n.currentIndex.z},this.moveLeft=function(t){return n.move(t,(function(){n.currentIndex.x--,-1===n.currentIndex.x&&(n.currentIndex.x=6)}))},this.moveRight=function(t){return n.move(t,(function(){n.currentIndex.x++,7===n.currentIndex.x&&(n.currentIndex.x=0)}))},this.move=function(t,e){if(n.valid(t)){e();var s=n.current();s?(n.currentIndex.z=s.getClickable().length-1,n.finishNav()):n.move(n.currentIndex,e)}},this.moveUp=function(t){var e;if(n.valid(t)){var s=null===(e=n.current())||void 0===e?void 0:e.getClickable();s&&s.length&&n.currentIndex.z>0?(n.currentIndex.z--,n.finishNav()):n.toggleRow(!0)}},this.moveDown=function(t){var e;if(n.valid(t)){var s=null===(e=n.current())||void 0===e?void 0:e.getClickable();s&&s.length&&n.currentIndex.z<s.length-1?(n.currentIndex.z++,n.finishNav()):n.toggleRow(!1)}},this.toggleRow=function(t){0===n.currentIndex.y?n.currentIndex.y=1:n.currentIndex.y=0;var e=n.current(),s=e?e.getClickable().length-1:0;n.currentIndex.z=t?s:0,e?n.finishNav():n.moveLeft(n.currentIndex)},this.finishNav=function(){var t,e,s=null===(t=n.current())||void 0===t?void 0:t.getClickable();s&&s[n.currentIndex.z]?n.model.focus.setCard(s[n.currentIndex.z]):n.model.focus.setStack((null===(e=n.current())||void 0===e?void 0:e.source)||"");return!0},this.current=function(){return n.rows[n.currentIndex.y][n.currentIndex.x]},this.pressCurrent=function(t){var e,s=null===(e=n.current())||void 0===e?void 0:e.getClickable();return n.model.focus.card&&n.model.focus.card.canClick()&&s&&s[n.currentIndex.z]&&s[n.currentIndex.z].denomination===n.model.focus.card.denomination&&s[n.currentIndex.z].type.icon===n.model.focus.card.type.icon?function(e){n.model.focus.card&&n.model.focus.card.equals(t.card)&&n.model.focus.card.onClick({isKeyboard:!0})(e)}:n.model.focus.stack&&n.model.focus.stack===t.stack?function(t){var e;null===(e=n.current())||void 0===e||e.clickEmpty({isKeyboard:!0})(t)}:function(t){t.navigator.finishNav(),t.game.timemachine.modified=!0}},this.model=t,this.currentIndex={x:0,y:0,z:0},this.rows=[[this.model.stock,this.model.waste,void 0].concat((0,S.Z)(this.model.foundation.stacks)),(0,S.Z)(this.model.tableau.stacks)]})),Q=e(801),J=(0,a.Z)((function Settings(t){var n=this;(0,o.Z)(this,Settings),this.launchSettings=void 0,this.baseEntropy=void 0,this.interactionEntropy=void 0,this.suggestionModes=void 0,this.suggestionMode=void 0,this.featureSwitches=void 0,this.setSuggestionMode=function(t){n.suggestionMode.key!==t&&(n.suggestionMode=Q.Z.get(t))},this.enableHint=function(){n.suggestionMode=Q.Z.getHintMode()},this.disableHint=function(){return!(!n.suggestionMode.isTemporary||!n.suggestionMode.next)&&(n.suggestionMode=Q.Z.get(n.suggestionMode.next),!0)},this.launchSettings=t,this.baseEntropy=t.baseEntropy,this.interactionEntropy=t.interactionEntropy,this.suggestionModes=Q.Z.allSuggestionModes(),this.suggestionMode=Q.Z.get(t.suggestionMode),this.featureSwitches=t.featureSwitches}));J.copy=function(t){var n=new J(t.launchSettings);return n.suggestionMode=t.suggestionMode,n.baseEntropy=t.baseEntropy,n.interactionEntropy=t.interactionEntropy,n};var $=function(t){(0,r.Z)(Stock,t);var n=(0,c.Z)(Stock);function Stock(t,e){var i;return(0,o.Z)(this,Stock),(i=n.call(this,"stock")).settings=void 0,i.recyclings=void 0,i.passes=void 0,i.setOnClick=function(t){i.clickEmpty=function(n){return t(null,n,null)},i.stack.forEach((function(n,e){n.onClick=function(e){return t((0,s.Z)({},n),e,null)},n.canClick=function(){return e===i.stack.length-1}}))},i.accepts=function(){return!1},i.popOne=function(){return i.stack.pop()},i.recycle=function(t){return!!t.length&&(i.stack=t.reverse().map(i.setCardProperties),i.stack[i.stack.length-1].canClick=function(){return!0},i.recyclings++,!0)},i.setCardProperties=function(t){return t.causeEntropy(Math.min(i.settings.interactionEntropy,1)),t.isHidden=!0,t.source=i.source,t},i.isOnTop=function(t){return t&&t.equals(i.getTop())},i.popTop=function(){var t=[];if("single"===i.settings.launchSettings.drawMode){var n=i.stack.pop();n&&(t=[n])}return"triple"===i.settings.launchSettings.drawMode&&(t=i.stack.splice(i.stack.length-3)),0===i.stack.length&&i.passes--,t},i.setEntropy=function(t){return i.stack.forEach((function(n){return n.causeEntropy(Math.min(t,1))})),(0,I.Z)(i)},i.settings=e,i.stack=t.map(i.setCardProperties),i.recyclings=0,i.passes=-1,"1-pass"===i.settings.launchSettings.recyclingMode&&(i.passes=1),"3-pass"===i.settings.launchSettings.recyclingMode&&(i.passes=3),i}return(0,a.Z)(Stock,[{key:"canRecycle",value:function canRecycle(){return"infinite"===this.settings.launchSettings.recyclingMode||"3-pass"===this.settings.launchSettings.recyclingMode&&this.recyclings<2}}]),Stock}(O);$.copy=function(t){var n=new $([],t.settings);return n.stack=F.Z.copyAll(t.stack),n.passes=t.passes,n.recyclings=t.recyclings,n};var tt=(0,a.Z)((function Stock(t){var n=this;(0,o.Z)(this,Stock),this.navigator=void 0,this.blink=function(t){return(new H).startBlink((function(t){return t.stock}),t)},this.dispatchPutDown=function(t,e,s){return n.blink(s,0)},this.dispatchPickup=function(t,e,s){return null!=t?n.moveToWaste(t,s):n.recycleWaste(s)},this.moveToWaste=function(t,n){return n.stock.isOnTop(t)&&n.waste.addAll(n.stock.popTop())&&n.game.registerMove("waste","stock",n.waste.getTop())},this.recycleWaste=function(t){if(!t.stock.getTop())return!!t.waste.getTop()&&t.stock.canRecycle()&&t.stock.recycle(t.waste.recycle())&&t.game.registerRecycle()&&n.navigator.finishNav()||n.blink(t,0)},this.navigator=t})),nt=(0,a.Z)((function Waste(){var t=this;(0,o.Z)(this,Waste),this.blink=function(t){return(new H).startBlink((function(t){return t.waste}),t)},this.dispatchPutDown=function(n,e,s){return s.waste.wouldAcceptHand()&&s.waste.putDownHand()&&s.game.registerMove("waste","waste",s.waste.getTop())||t.blink(s,0)},this.dispatchPickup=function(n,e,s){return n&&s.hand.pickUp([s.waste.popTop(n)],"waste",e)&&s.game.registerPickup()||t.blink(s,0)}})),et=(0,a.Z)((function Suggestions(){var t=this;(0,o.Z)(this,Suggestions),this.tableau=void 0,this.waste=void 0,this.evaluateOptions=function(n){t.disableAllSuggestions(n),n.settings.suggestionMode.key===Q.Z.NONE||t.getUncoverOptions(n)||t.getPutdownSuggestions(n)||n.hand.isHoldingCard()||t.getPickupOptions(n)&&n.settings.suggestionMode.key!==Q.Z.FULL||!n.stock.getTop()&&!n.stock.canRecycle()||n.settings.suggestionMode.key===Q.Z.SCORED||(n.stock.suggestion=!0)},this.getPutdownSuggestions=function(t,n){if(!t.hand.isHoldingCard()||t.settings.suggestionMode.key===Q.Z.NONE)return 0;var e=[];if(t.waste.wouldAcceptHand()&&(t.settings.suggestionMode.key===Q.Z.FULL||!t.hand.isFromWaste())){var s={target:"waste",source:t.hand.source};(t.settings.suggestionMode.key!==Q.Z.SCORED||t.game.rating.rateMove(s,null)>0)&&(e.push(s),t.waste.suggestion=!0)}return t.foundation.stacks.forEach((function(n,s){if(t.foundation.wouldAcceptHand(s)&&(t.settings.suggestionMode.key===Q.Z.FULL||!t.hand.isFromFoundation(s))){var i={target:n.source,source:t.hand.source};(t.settings.suggestionMode.key!==Q.Z.SCORED||t.game.rating.rateMove(i,null)>0)&&(e.push(i),n.suggestion=!0)}})),t.tableau.stacks.forEach((function(s,i){if(t.tableau.wouldAcceptHand(i)&&(t.settings.suggestionMode.key===Q.Z.FULL||!t.hand.isFromTableau(i))){var a=t.hand.isHoldingKing()&&0===s.stack.length&&t.hand.isFromAnyTableau()&&0===t.tableau.stacks[t.hand.getTableauIndex()].stack.length,o=s.stack.length>0&&t.hand.isFromAnyTableau()&&t.tableau.stacks[t.hand.getTableauIndex()].stack.length>0&&s.stack[s.stack.length-1].denomination===t.tableau.stacks[t.hand.getTableauIndex()].stack[t.tableau.stacks[t.hand.getTableauIndex()].stack.length-1].denomination&&!t.tableau.getTop(t.hand.getTableauIndex()).isHidden,r=!a&&!o;if(!n||t.settings.suggestionMode.key===Q.Z.FULL||r){var c={target:s.source,source:t.hand.source};(t.settings.suggestionMode.key!==Q.Z.SCORED||t.game.rating.rateMove(c,null)>0)&&(e.push(c),s.suggestion=!0)}}})),e.length},this.getPickupOptions=function(n){var e=!1,s=ot.copy(n);return t.waste.dispatchPickup(s.waste.getTop(),null,s),s.game.timemachine.modified&&t.getPutdownSuggestions(s,!0)>(n.settings.suggestionMode.key===Q.Z.FULL?1:0)&&(n.waste.suggestion=!0,e=!0),n.tableau.stacks.forEach((function(s,i){return s.stack.map((function(t,n){return{cardIndex:n,card:t}})).filter((function(t){return!t.card.isHidden})).forEach((function(a){var o=a.card,r=a.cardIndex,c=ot.copy(n);t.tableau.dispatchPickup(o,null,c,i),c.game.timemachine.modified&&t.getPutdownSuggestions(c,!0)>(n.settings.suggestionMode.key===Q.Z.FULL?1:0)&&(s.stack[r].suggestion=!0,e=!0)}))})),e},this.getUncoverOptions=function(t){if(!t.hand.isHoldingCard()){var n=t.tableau.stacks.map((function(t,n){return n})).filter((function(n){return t.tableau.getTop(n)&&t.tableau.getTop(n).isHidden}));return n.forEach((function(n){t.tableau.getTop(n).suggestion=!0})),n.length}return 0},this.disableAllSuggestions=function(t){var n=function disableSuggestion(t){t.suggestion=!1,t.stack&&t.stack.forEach(disableSuggestion),t.stacks&&t.stacks.forEach(disableSuggestion)};n(t.waste),n(t.stock),n(t.tableau),n(t.foundation)},this.tableau=new P,this.waste=new nt})),st=function(t){(0,r.Z)(TableauStack,t);var n=(0,c.Z)(TableauStack);function TableauStack(){var t;(0,o.Z)(this,TableauStack);for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return(t=n.call.apply(n,[this].concat(i))).id=0,t.accepts=function(n){var e=t.getTop();if(!e)return n&&"K"===n.denomination||!1;if(t.source===(null===n||void 0===n?void 0:n.source))return!0;if(e.isHidden)return!1;var s=(0,S.Z)((0,B.bf)());return(n?s.indexOf(n.denomination):0)+1===s.indexOf(e.denomination)&&(null===n||void 0===n?void 0:n.type.color)!==e.type.color&&"A"!==e.denomination},t.getTop=function(n){return t.stack[t.stack.length-1-(n||0)]},t.canUncover=function(n){return t.getTop().isHidden&&n&&n.equals(t.getTop())},t.setOnClick=function(n,e){t.clickEmpty=function(t){return n(null,t)};var i=t.source===t.hand.source?[].concat((0,S.Z)(t.stack),(0,S.Z)(t.hand.stack)):t.stack;i.forEach((function(a,o){var r=a.isHidden&&o===i.length-1?e:n;a.onClick=function(t){return r((0,s.Z)({},a),t)},a.canClick=function(){return!a.isHidden||t.canUncover(a)&&!t.hand.currentCard()||!1}})),t.hand.setOnClick((0,I.Z)(t))},t}return(0,a.Z)(TableauStack)}(U);st.copy=function(t){var n=new st(t.source,t.hand);return n.id=t.id,n.stack=F.Z.copyAll(t.stack),n};var it=function(t){(0,r.Z)(Tableau,t);var n=(0,c.Z)(Tableau);function Tableau(t,e){var s;return(0,o.Z)(this,Tableau),(s=n.call(this,t,e,[0,1,2,3,4,5,6].map((function(t){var n=new st("tableau-"+t,e);return n.id=t,n})))).setOnClick=function(t,n){s.stacks.forEach((function(e,s){e.setOnClick((function(n,e){return t(n,e,s)}),(function(t,e){return n(t,e,s)}))}))},s.getStack=function(t){return s.stacks[t]},s.wouldAcceptHand=function(t){return s.canPutDown(s.getTop(t),s.hand,t)},s.putDownHand=function(t){return s.add(t,s.hand.source,s.hand.putDown())},s.canPutDown=function(t,n,e){return t&&t.isHidden&&n.isFromCurrentSource(t)||s.accepts(e,n.currentCard())||!t&&n.isFromTableau(e)},s.accepts=function(t,n){return!!n&&s.stacks[t].accepts(n)},s.getCard=function(t,n){for(var e=0;e<s.stacks[t].stack.length;e++)if(n&&n.equals(s.stacks[t].stack[e])&&n.isHidden===s.stacks[t].stack[e].isHidden)return s.stacks[t].stack[e];return!1},s.popWithFollowing=function(t,n){for(var e=0;e<s.stacks[n].stack.length;e++)if(t&&t.equals(s.stacks[n].stack[e])){var i=s.stacks[n].stack.splice(e,s.stacks[n].stack.length);return s.stackEntropy(n),i}return[]},s.deal=function(t,n){s.stacks[n].stack.push(t)},s.canUncover=function(t,n){return s.stacks[t].canUncover(n)},s.uncover=function(t,n){var e=s.getTop(t);return!!s.canUncover(t,n)&&(e.isHidden=!1,s.stackEntropy(t),!0)},s.stackEntropy=function(t){for(var n=s.settings.interactionEntropy,e=1,i=s.getTop(t);n&&0!==n&&i;)i.causeEntropy(n),n--,i=s.getTop(t,e),e++},s.add=function(t,n,e){return s.stacks[t].stack=s.stacks[t].stack.concat(e.map((function(n){return s.setCardProperties(n,t)}))),s.stackEntropy(t),e},s.setCardProperties=function(t,n){return t.source=s.stacks[n].source,t},s.getTop=function(t,n){return s.stacks[t].getTop(n)},s.setEntropy=function(t){return s.stacks.forEach((function(n){return n.stack.forEach((function(n){return n.causeEntropy(Math.min(t,4))}))})),(0,I.Z)(s)},s}return(0,a.Z)(Tableau)}(G);it.copy=function(t,n){var e=new it(t.settings,n);return e.stacks=t.stacks.map(st.copy),e};var at=function(t){(0,r.Z)(Waste,t);var n=(0,c.Z)(Waste);function Waste(t,e){var i;return(0,o.Z)(this,Waste),(i=n.call(this,"waste",e)).settings=void 0,i.setOnClick=function(t){i.clickEmpty=function(n){return t(null,n,null)};var n=i.source===i.hand.source?[].concat((0,S.Z)(i.stack),(0,S.Z)(i.hand.stack)):i.stack;n.forEach((function(e,i){e.onClick=function(n){return t((0,s.Z)({},e),n,null)},e.canClick=function(){return i===n.length-1}})),i.hand.setOnClick((0,I.Z)(i))},i.putDownHand=function(){return i.addAll(i.hand.putDown())},i.add=function(t){return t&&i.stack.push(i.setCardProperties(t))},i.addAll=function(t){return t&&t.length&&t.map(i.add)},i.setCardProperties=function(t){return t.source=i.source,t.isHidden=!1,t.causeEntropy(Math.min(i.settings.interactionEntropy,1)),t},i.wouldAcceptHand=function(){return i.hand.isFromWaste()&&i.canAdd(i.hand.currentCard())},i.accepts=function(t){return i.canAdd(t)||!1},i.canAdd=function(t){return t&&(!i.getTop()||!t.equals(i.getTop()))},i.popTop=function(t){return t&&t.equals(i.getTop())&&i.stack.pop()||null},i.recycle=function(){return i.stack.splice(0,i.stack.length)},i.setEntropy=function(t){return i.stack.forEach((function(n){return n.causeEntropy(Math.min(t,1))})),(0,I.Z)(i)},i.settings=t,i}return(0,a.Z)(Waste)}(U);at.copy=function(t,n){var e=new at(t.settings,n);return e.stack=F.Z.copyAll(t.stack),e};var ot=(0,a.Z)((function Model(t){var n=this;(0,o.Z)(this,Model),this.stock=void 0,this.waste=void 0,this.foundation=void 0,this.tableau=void 0,this.hand=void 0,this.game=void 0,this.settings=void 0,this.focus=void 0,this.suggestor=void 0,this.dealer=void 0,this.navigator=void 0,this.token=void 0,this.setToken=function(t){n.token=t},this.withSuggestions=function(){return n.suggestor.evaluateOptions(n),n},this._hasSuggestion=function(t){return t.suggestion||t.stack&&t.stack.some(n._hasSuggestion)||t.stacks&&t.stacks.some(n._hasSuggestion)},this.hasNonStockSuggestions=function(){return n._hasSuggestion(n.waste)||n._hasSuggestion(n.tableau)||n._hasSuggestion(n.foundation)},this.hasSuggestions=function(){return n._hasSuggestion(n.waste)||n._hasSuggestion(n.stock)||n._hasSuggestion(n.tableau)||n._hasSuggestion(n.foundation)},this.canAutoSolve=function(){return 0===n.waste.stack.length&&0===n.stock.stack.length&&n.tableau.stacks.every((function(t){return t.stack.every((function(t){return!t.isHidden}))}))},this.setEntropy=function(t){n.settings.baseEntropy=t,n.stock.setEntropy(t),n.waste.setEntropy(t),n.foundation.setEntropy(t),n.tableau.setEntropy(t)},this.clearSuccess=function(t){var e=function clear(t,n){n.stack.forEach((function(n){n.equals(t)&&(n.success=0)}))};e(t,n.stock),e(t,n.waste),n.foundation.stacks.forEach((function(n){return e(t,n)})),n.tableau.stacks.forEach((function(n){return e(t,n)}))},this.withHandlers=function(){var t=function getHandler(t){return new A(t).getHandler(n.hand)};return n.stock.setOnClick(t(new tt(n.navigator))),n.waste.setOnClick(t(new nt)),n.foundation.setOnClick(t(new q)),n.tableau.setOnClick(t(new P),t(new D)),n},this.stock=t.stock,this.waste=t.waste,this.foundation=t.foundation,this.tableau=t.tableau,this.hand=t.hand,this.game=t.game,this.settings=t.settings,this.focus=t.focus,this.suggestor=new et,this.dealer=new N,this.navigator=new X(this),this.token=t.token}));ot.getInitialState=function(t,n,e){var s=new J(t),i=new Y,a={stock:new $((0,S.Z)(n.cards),s),waste:new at(s,i),foundation:new W(s,i),tableau:new it(s,i),hand:i,game:new V(s),settings:s,focus:new R(s,e),token:0};return new ot(a)},ot.copy=function(t){var n=Y.copy(t.hand);return new ot({stock:$.copy(t.stock),waste:at.copy(t.waste,n),foundation:W.copy(t.foundation,n),tableau:it.copy(t.tableau,n),hand:n,game:V.copy(t.game),settings:J.copy(t.settings),focus:t.focus,token:t.token})};var rt=function RenderAutoSolve(t){var n=l.useState(!1),e=(0,d.Z)(n,2),s=e[0],i=e[1],a=y(),o=a.state,r=a.updateGameContext;return l.useEffect((function(){t.canAutosolve&&(r((function(t){return t.settings.suggestionMode=Q.Z.get(Q.Z.NONE)})),i(!0))}),[t.canAutosolve,r]),s&&o.settings.suggestionMode.key===Q.Z.NONE?(0,g.jsx)(ut,{}):null},ct=function AutoSolver(){var t=y().state;return(0,g.jsx)(rt,{canAutosolve:t.canAutoSolve()})},ut=function Solver(){var t=y(),n=t.state,e=t.updateGameContext;return l.useEffect((function(){var t=setTimeout((function(){var t=ot.copy(n).withHandlers();if(t.hand.currentCard()){if(t.settings.suggestionMode=Q.Z.get(Q.Z.SCORED),t.suggestor.evaluateOptions(t),t._hasSuggestion(t.foundation)){var s=t.foundation.stacks.filter((function(n){return t._hasSuggestion(n)}));if(s.length){var i=s[0];e(i.clickEmpty({isKeyboard:!1}))}}}else if(t.settings.suggestionMode=Q.Z.get(Q.Z.SCORED),t.suggestor.evaluateOptions(t),t._hasSuggestion(t.tableau)){var a=t.tableau.stacks.filter((function(n){return t._hasSuggestion(n)}));if(a.length){var o=a[0].stack.filter((function(t){return t.suggestion}));if(o.length){var r=o[0];e(r.onClick({isKeyboard:!1}))}}}}),150);return function(){return clearTimeout(t)}})),null},lt=function useTokenEffect(t){var n=y().state;return l.useEffect(t,[n.token])},dt=function Uncoverer(){var t=y(),n=t.state,e=t.updateGameContext;return lt((function(){n.hand.currentCard()||n.tableau.stacks.forEach((function(t){t.getTop()&&t.getTop().isHidden&&t.getTop().canClick()&&e(t.getTop().onClick({isKeyboard:!0}))}))})),null},gt=function AutoUncoverer(){var t=y().state,n=p().gameState;return t.settings.launchSettings.autoUncover&&n.started?(0,g.jsx)(dt,{}):null},ft=e(3890),ht=e(517),pt=e(8391),kt=l.createContext({player:0}),vt=function useBoardContext(){return l.useContext(kt)},mt=kt.Provider,xt=function BoardGamePad(t){var n=y().state,e=vt().player,s="gamepad"===n.settings.launchSettings.players[e].inputMethod,i=n.settings.launchSettings.boardMode===ft.Z.SINGLEPLAYER,a=function switchToGamePad(t){t.focus.isKeyBoard(!0),i&&(t.settings.launchSettings.players[e].inputMethod="gamepad")};return i||s?(0,g.jsx)(ht.Z,{layout:pt.Z,gamepadIndex:n.settings.launchSettings.players[e].inputLayout,onLeft:function onLeft(){return t.onLeft(a)},onRight:function onRight(){return t.onRight(a)},onUp:function onUp(){return t.onUp(a)},onDown:function onDown(){return t.onDown(a)},onAction:function onAction(){return t.onAction(a)},onCancel:function onCancel(){return t.onCancel(a)},onHint:function onHint(){return t.onHint(a)},onUndo:function onUndo(){return t.onUndo()},onPause:function onPause(){return t.onPause(a)},onMenu:function onMenu(){return t.onMenu(a)}}):null},yt=e(1453),St=e(9847),bt=function BoardKeyboard(t){var n=y().state,e=vt().player,s="keyboard"===n.settings.launchSettings.players[e].inputMethod,i=n.settings.launchSettings.boardMode===ft.Z.SINGLEPLAYER,a=i?yt.dR:(0,yt.Vc)(n.settings.launchSettings.players[e].inputLayout),o=function switchToKeyboard(t){t.focus.isKeyBoard(!0),i&&(t.settings.launchSettings.players[e].inputMethod="keyboard")};return s||i?(0,g.jsx)(St.Z,{layout:a,onLeft:function onLeft(){return t.onLeft(o)},onRight:function onRight(){return t.onRight(o)},onUp:function onUp(){return t.onUp(o)},onDown:function onDown(){return t.onDown(o)},onAction:function onAction(){return t.onAction(o)},onCancel:function onCancel(){return t.onCancel(o)},onHint:function onHint(){return t.onHint(o)},onUndo:function onUndo(){return t.onUndo()},onPause:function onPause(){return t.onPause(o)},onMenu:function onMenu(){return t.onMenu(o)}}):null},Ct=function BoardNavigator(){var t=y(),n=t.state,e=t.updateContext,i=t.updateGameContext,a=t.replaceContext,o=j(),r=vt().player,c={x:n.navigator.currentIndex.x,y:n.navigator.currentIndex.y,z:n.navigator.currentIndex.z},u={card:n.focus.card,stack:n.focus.stack},l=!!o.state.paused,d={onLeft:function onLeft(t){return e((function(n){t(n),n.navigator.moveLeft(c)}))},onRight:function onRight(t){return e((function(n){t(n),n.navigator.moveRight(c)}))},onUp:function onUp(t){return e((function(n){t(n),n.navigator.moveUp(c)}))},onDown:function onDown(t){return e((function(n){t(n),n.navigator.moveDown(c)}))},onAction:function onAction(t){return i((function(e){var s;t(e);var i=null===n||void 0===n||null===(s=n.navigator)||void 0===s?void 0:s.pressCurrent(u);i&&i(e),e.navigator.finishNav()}))},onCancel:function onCancel(t){return e((function(n){t(n),n.hand.stack.length&&n.hand.stack[0].onClick({isKeyboard:!0})(n)}))},onPause:function onPause(t){e((function(n){t(n)})),o.togglePause(l,r)},onHint:function onHint(t){e((function(n){t(n),function isVisible(t){return t.settings.suggestionMode.supportsHints||t.settings.suggestionMode.isTemporary}(n)&&!function isDisabled(t){return t.settings.suggestionMode.isTemporary}(n)&&n.settings.enableHint()}))},onUndo:function onUndo(){n.settings.featureSwitches.undo&&a((function(t){var e=t.game.timemachine.popPreviousState(n.game.timemachine.previousStates.length-1,n);return e?(e.game.rating.penalize(t.game.rating),e):null}))},onMenu:function onMenu(t){e((function(n){t(n)})),o.togglePause(l,r)}};return o.state.showMenu?null:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(bt,(0,s.Z)({},d)),(0,g.jsx)(xt,(0,s.Z)({},d))]})},Zt=e(263),wt=function Dealer(){var t=y(),n=t.state,e=t.replaceContext,s=p(),i=s.gameState,a=s.start;return(0,Zt.Z)((function(){if(!i.started){var t=[];if(!n.settings.launchSettings.quickDeal){return function deal(s){return t.push(setTimeout((function(){n.dealer.isDealt?a():e(n.dealer.dealOne(s,deal))}),35))}(n.dealer.dealt),function(){return t.forEach((function(t){return clearTimeout(t)}))}}n.dealer.isDealt||(a(),e(n.dealer.dealAll()))}})),null},jt=e(6651),Mt=e(6874),Et=e(2108),Tt=e(2083),Ht=e(8133),Pt=function PossibleFailScreen(){var t=y().state,n=l.useState({refused:!1,since:0}),e=(0,d.Z)(n,2),s=e[0],i=e[1],a=function refuse(t){i({refused:!(s.since>=3)&&t,since:s.since>=3?0:s.since+1})};lt((function(){!t.hand.currentCard()&&s.refused&&a(!0)}));var o=j(),r=y().restart;return l.useEffect((function(){return o.state.showMenu||o.toggleMenu(!0),function(){return o.toggleMenu(!1)}}),[s.refused]),s.refused?null:(0,g.jsx)(Ht.K,{children:(0,g.jsx)("div",{className:"gamemenu menu dialog",children:(0,g.jsx)("div",{className:"startscreen-jail",children:(0,g.jsxs)("div",{className:"innermenu",children:[(0,g.jsx)(Et.Z,{icon:jt._4g}),(0,g.jsx)("div",{className:"announcement",children:"The game might be over"}),(0,g.jsxs)(Tt.Z,{keyboardLayout:yt.dR,children:[(0,g.jsx)(Mt.Z,{icon:jt._86,title:"Keep trying",onClick:function onClick(){a(!0)}}),(0,g.jsx)(Mt.Z,{icon:jt.QkA,title:"Give up",onClick:function onClick(){return r()}})]})]})})})})},Dt=function FailDetector(){var t=y().state,n=p().gameState,e=l.useState({any:!1,stock:!1,nonStock:!1}),s=(0,d.Z)(e,2),i=s[0],a=s[1];lt((function(){if(n.started){var e=ot.copy(t);e.settings.suggestionMode=Q.Z.get(Q.Z.FULL),e.suggestor.evaluateOptions(e),a({any:e.hasSuggestions(),stock:e._hasSuggestion(e.stock),nonStock:e.hasNonStockSuggestions()})}}));var o=l.useState([]),r=(0,d.Z)(o,2),c=r[0],u=r[1],f=l.useState(!1),h=(0,d.Z)(f,2),k=h[0],v=h[1];return l.useEffect((function(){if(!t.hand.currentCard()&&n.started)if(i.nonStock)u([]),v(!1);else if(i.stock&&!i.nonStock){var e=t.stock.getTop();e&&u([].concat((0,S.Z)(c),[e])),t.stock.stack.length+t.waste.stack.length<=c.length&&v(!0)}else i.any||v(!0)}),[i]),k?(0,g.jsx)(Pt,{}):null},Nt=function Detector(){var t=y().state,n=p().win,e=vt().player;return l.useEffect((function(){t.hand.currentCard()||52!==t.foundation.countCards()||n(e)}),[t.token,t.foundation,t.hand,e,n]),null},At=function WinDetector(){var t=y().state,n=p().gameState;return!n.isEnded&&!!t.settings.launchSettings.autoUncover&&!!n.started&&(0,g.jsx)(Nt,{})||null},Ft=function Actors(){return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(wt,{}),(0,g.jsx)(Ct,{}),(0,g.jsx)(ct,{}),(0,g.jsx)(At,{}),(0,g.jsx)(Dt,{}),(0,g.jsx)(T,{}),(0,g.jsx)(gt,{})]})},Rt=e(8201),It=function DndPreview(t){var n=l.useState(),e=(0,d.Z)(n,2),a=e[0],o=e[1],r=l.useContext(i.w),c=r.width,u=r.height;l.useEffect((function(){var n=t.reff.getBoundingClientRect();o({left:-1*n.left,top:-1*n.top})}),[t.reff,c,u]);var f=(0,Rt.uL)(),h=f.display,p=f.item,k=f.style;return h&&a&&p?(0,g.jsx)("div",{style:(0,s.Z)((0,s.Z)({},k),{},{position:"relative",width:"100%",left:a.left,top:a.top,zIndex:2e3,opacity:1}),children:p.render}):null},Ot=e(6584),Ut=function Firework(t){var n=l.createRef();return l.useEffect((function(){if(n&&n.current&&t.intensity){var e=15*t.intensity,s=window.innerWidth/10.8/100,i={ticks:50,origin:{x:.5,y:.33},particleCount:40,startVelocity:20*s,decay:.8,spread:360,scalar:s},a=Ot.Z.create(n.current,{resize:!0}),o=function fire(t,n){a(Object.assign({},i,n,{particleCount:Math.floor(e*t)}))};o(.25,{startVelocity:55*s}),o(.2,{decay:1.2}),o(.35,{decay:.91,scalar:s-.2}),o(.1,{startVelocity:25*s,decay:.92,scalar:s+.2}),o(.1,{}),o(.1,{startVelocity:45*s})}}),[n,t.intensity]),(0,g.jsx)("canvas",{ref:n})},Bt=function CardFirework(t){var n=y(),e=n.state,s=n.updateContext;return l.useEffect((function(){if(t.model.success&&e.settings.featureSwitches.confetti){var n=setTimeout((function(){return s((function(n){return n.clearSuccess(t.model)}))}));return function(){return clearTimeout(n)}}}),[t.model.success]),e.settings.featureSwitches.confetti?(0,g.jsx)(Ut,{intensity:t.model.success}):null},Lt=e(1523),Gt=e.n(Lt),zt=e(9014),Wt=e(6541),qt=function ReRender(t){return(0,g.jsx)(Kt,(0,s.Z)({},(0,s.Z)((0,s.Z)({},t),{},{models:t.models.slice(t.index,t.models.length),offsetLeft:function offsetLeft(){return 0},isSelected:function isSelected(){return!1},index:0})))};qt.displayName="ReRender";var Kt=function Card(t){var n=vt().player,e=y(),i=e.state,a=e.updateGameContext,o=j(),r=l.useRef(null),c=l.useState(!!t.isDrag),u=(0,d.Z)(c,2),f=u[0],h=u[1],p=t.models[t.index],k=(0,l.useCallback)((function(){return!!p&&i.focus.hasCard(p)||!1}),[p,i.focus]),v=(0,l.useCallback)((function(){return t.isDrag||f}),[t.isDrag,f]),m=(0,Wt.c)({type:"card",item:function item(n){return h(!0),!p.onClick||t.isSelected&&t.isSelected(t.index)||a((function(t){p.onClick({isKeyboard:!1})(t)})),{type:"card",model:p,render:qt(t)}},collect:function collect(t){return{opacity:(t.isDragging(),1)}},canDrag:function canDrag(){return p.canClick()&&!p.isHidden&&(null===i.hand.currentCard()||p.equals(i.hand.currentCard()))},end:function end(t,n){h(!1),n.didDrop()||setTimeout((function(){return a((function(t){p.onClick({isKeyboard:!1})(t)}))}),1)}}),x=(0,d.Z)(m,3),S=x[0].opacity,b=x[1],C=x[2];l.useEffect((function(){C((0,zt.r)(),{captureDraggingState:!0})}),[C]);var Z=(0,l.useCallback)((function(){return p.canClick()?b:r}),[r,p,b]),w=function useClassName(t,n,e,s){var i=(0,l.useCallback)((function(){if(!t)return"card card-base";var i=n.isSuggested&&n.isSuggested(n.index)||t.suggestion,a="card card-base card-".concat(t.type.color);return a+=n.isSelected&&n.isSelected(n.index)||s()||i?"":" card-stack-".concat(t.source),a+=!e()&&n.isSelected&&n.isSelected(n.index)&&!e()?" card-selected":"",a+=n.blink?" blink":"",a+=t.canClick()?" clickable":"",(a+=i&&!s()?" card-suggested":"")+(s()?" card-focused":"")}),[e,s,t,n]),a=l.useState(i()),o=(0,d.Z)(a,2),r=o[0],c=o[1];return l.useEffect((function(){c(i())}),[i]),r}(p,t,v,k),M=function useCardStyle(t,n,e,i){var a=(0,l.useCallback)((function(){if(!t)return{};var a=(0,s.Z)({opacity:e()?0:i,zIndex:(n.zIndex?n.zIndex:20*(n.offsetTop&&n.offsetTop(n.index,n.models)>0?1:0))+1,top:n.offsetTop?n.offsetTop(n.index,n.models)/15+"em":0},t.entropyStyle);return n.offsetLeft&&(a.left=2*n.offsetLeft(n.index)+"em"),t.onClick||(a.pointerEvents="none"),a}),[t,n,e,i]),o=l.useState(a()),r=(0,d.Z)(o,2),c=r[0],u=r[1];return l.useEffect((function(){u(a)}),[a]),c}(p,t,v,S),E=function useStackBaseStyle(t){var n=(0,l.useCallback)((function(){return t&&t.onClick?{}:{pointerEvents:"none"}}),[t]),e=l.useState(n()),s=(0,d.Z)(e,2),i=s[0],a=s[1];return l.useEffect((function(){a(n())}),[n]),i}(p);if(!t.models.length)return null;var T=function SuitIcon(){return(0,g.jsx)("div",{className:"align-center",children:(0,g.jsx)(Gt(),{size:"0.8em",color:p.type.color,path:p.type.icon})})};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:E,className:"stack-base",children:(0,g.jsxs)("button",{style:M,ref:Z(),className:w,onClick:function onClick(t){var e,s,o,r,c,u;t.preventDefault();for(var l=0===t.clientX&&0===t.clientY,d=t.target;d&&!d.className.includes("card-base")&&d.offsetParent;)d=d.offsetParent;var g=d.getBoundingClientRect(),f={isKeyBoard:l,click:{x:t.clientX-((null===(e=d)||void 0===e||null===(s=e.ownerDocument)||void 0===s||null===(o=s.defaultView)||void 0===o?void 0:o.pageXOffset)||0),y:t.clientY-((null===(r=d)||void 0===r||null===(c=r.ownerDocument)||void 0===c||null===(u=c.defaultView)||void 0===u?void 0:u.pageYOffset)||0)},element:{x:g.x,y:g.y}},h=i.settings.launchSettings.boardMode===ft.Z.SINGLEPLAYER;p.onClick&&!f.isKeyBoard&&a((function(t){p.onClick(f)(t),h&&(t.settings.launchSettings.players[n].inputMethod="mouse")}))},disabled:!p.canClick()||!o.state.showCards,tabIndex:p.canClick()?0:-1,children:[(0,g.jsx)(Bt,{model:p}),(0,g.jsx)("div",{className:"card-content",children:p.isHidden||!o.state.showCards?(0,g.jsx)("div",{className:"card-back",children:"\xa0"}):(0,g.jsxs)("div",{className:"card-grid-container",children:[(0,g.jsx)("div",{children:(0,g.jsx)(T,{})}),(0,g.jsx)("div",{children:(0,g.jsx)("div",{className:"align-left",children:p.denomination})}),(0,g.jsx)("div",{children:"\xa0"}),(0,g.jsx)("div",{children:(0,g.jsx)(T,{})}),(0,g.jsx)("div",{className:"mainface",children:(0,g.jsxs)("div",{className:"align-center",children:[p.denomination," "]})}),(0,g.jsx)("div",{children:(0,g.jsx)(T,{})}),(0,g.jsx)("div",{children:"\xa0"}),(0,g.jsx)("div",{children:(0,g.jsx)("div",{className:"align-right",children:p.denomination})}),(0,g.jsx)("div",{children:(0,g.jsx)(T,{})})]})})]})}),t.models.length-1>t.index&&(0,g.jsx)(Card,(0,s.Z)((0,s.Z)({},t),{},{isDrag:v(),index:t.index+1}))]})},_t=Kt,Vt=function StackBase(t){var n=y(),e=n.state,s=n.updateGameContext,i=(0,l.useCallback)((function(){var n="card-base socket";return t.model.stack.length?n+=" socket-full":t.model.blinkFor?n+=" socket-blink":e.focus.hasStack(t.model.source)?n+=" socket-focused":n+=" socket-empty",t.model.suggestion&&!t.model.stack.length&&(n+=" socket-suggested"),n}),[t.model.stack.length,t.model.suggestion,t.model.blinkFor,t.model.source,e.focus]);return(0,g.jsx)("button",{className:i(),onClick:function onClick(n){n.preventDefault();var e=0===n.clientX&&0===n.clientY;e||s(t.model.clickEmpty({isKeyBoard:e}))},disabled:!!t.model.stack.length,tabIndex:t.model.stack.length?-1:0,children:t.children})},Yt=function useBlinkEffect(t){var n=y(),e=n.updateContext,s=n.state,i=t(s);l.useEffect((function(){var n=null;return s&&t(s).blinkFor&&(n=setTimeout((function(){return e((function(n){t(n).unblink(n)}))}),200)),function(){n&&clearTimeout(n)}}),[s,i.blinkFor,e,t])},Xt=e(1053),Qt=function useStackDrop(t,n){var e=y().updateGameContext;return(0,Xt.L)({accept:"card",canDrop:function canDrop(e){return n&&n(e.model)||t.accepts(e.model)},drop:function drop(){e(t.clickEmpty({isKeyBoard:!1}))}})[1]},Jt=function Foundation(){var t=y().state;return(0,g.jsx)(g.Fragment,{children:t.foundation.stacks.map((function(n,e){return(0,g.jsx)($t,{model:n,index:e,hand:t.hand},e)}))})},$t=function FoundationStack(t){Yt((function(n){return n.foundation.stacks[t.index]}));var n=t.model,e=Qt(t.model),s=t.hand.source===n.source?[].concat((0,S.Z)(n.stack),(0,S.Z)(t.hand.stack)):(0,S.Z)(n.stack),i="board-field foundation foundation-"+t.index;return(0,g.jsxs)("div",{className:i,ref:e,children:[(0,g.jsx)(Vt,{model:n,children:(0,g.jsx)("div",{className:"align-center foundation-base suit-"+n.icon,children:(0,g.jsx)(Gt(),{path:n.icon,size:"1em",horizontal:!0,color:n.color})})}),(0,g.jsx)(_t,{index:0,models:s,blink:n.blinkFor,isSuggested:function isSuggested(t){return n.suggestion&&n.stack.length-1===t},isSelected:function isSelected(t){return t>n.stack.length-1}},0)]},t.index)},tn=function Clock(){var t=j(),n=t.state,e=t.getElapsed,s=p().gameState,i=l.useState(""),a=(0,d.Z)(i,2),o=a[0],r=a[1];return l.useEffect((function(){var t=setInterval((function(){s.started&&!n.paused&&r(e())}),1e3);return function(){return clearInterval(t)}}),[s.started,n.paused,e]),s.started&&o?(0,g.jsxs)("div",{className:"header-clock",children:[(0,g.jsx)("div",{className:"icon-container",children:(0,g.jsx)(Gt(),{path:jt.yFX,size:".9em"})}),o]}):null},nn=function Hearts(){var t=y().state;return(0,g.jsx)("div",{className:"heart-container",children:function getHearts(){var n=function _icon(t){return(0,g.jsx)(Gt(),{path:t,size:".9em"})};if("infinite"===t.settings.launchSettings.recyclingMode)return(0,g.jsx)(Gt(),{path:jt.GKq,size:".9em"});if("1-pass"===t.settings.launchSettings.recyclingMode)return t.stock.passes>0?n(jt.sMo):n(jt.MV4);if("3-pass"===t.settings.launchSettings.recyclingMode){var e=function createString(t,e){return Array.from(new Array(t).keys()).map((function(t){return n(e)}))};return[].concat((0,S.Z)(e(t.stock.passes,jt.sMo)),(0,S.Z)(e(3-t.stock.passes,jt.MV4)))}return null}()})},en=function Hint(){var t=y(),n=t.state,e=t.updateContext,s=function isVisible(t){return t.settings.suggestionMode.supportsHints||t.settings.suggestionMode.isTemporary},i=function isDisabled(t){return t.settings.suggestionMode.isTemporary};return s(n)?(0,g.jsx)("div",{children:(0,g.jsx)("button",{title:"Hint",onClick:function onClick(){return function suggestOnce(){return e((function(t){s(t)&&!i(t)&&t.settings.enableHint()}))}()},disabled:i(n),children:(0,g.jsxs)("span",{className:"icon",children:[" ",(0,g.jsx)(Gt(),{path:jt.LLp,size:".9em"})]})})}):null},sn=function Points(){var t=y().state;return(0,g.jsxs)("div",{children:[(0,g.jsx)("button",{title:"Points",onClick:function showToast(){u.Am.info((0,g.jsx)("ul",{children:t.game.rating.ratings.reverse().map((function(t,n){return(0,g.jsxs)("li",{children:[t.points," - ",t.text]},n)}))}),{autoClose:!1})},children:(0,g.jsx)("span",{className:"icon",children:(0,g.jsx)(Gt(),{path:jt.lEW,size:".9em"})})}),null===t||void 0===t?void 0:t.game.rating.points]})},an=function ToggleMenu(){var t=j(),n=vt().player;return t.state.showMenu?null:(0,g.jsx)("div",{children:(0,g.jsx)("button",{title:"Settings",onClick:function onClick(){return t.togglePause(!t.state.paused,n)},children:(0,g.jsx)("span",{className:"icon",children:"\u2630"})})})},on=function Undo(){var t=y(),n=t.state,e=t.replaceContext;return n.game.timemachine.previousStates.length&&n.settings.featureSwitches.undo?(0,g.jsx)("div",{children:(0,g.jsx)("button",{disabled:!n.game.timemachine.previousStates.length,title:"Undo","data-penalty":Math.pow(2,n.game.rating.multiplicator),onClick:function undo(){return e((function(t){var e=t.game.timemachine.popPreviousState(n.game.timemachine.previousStates.length-1,n);return e?(e.game.rating.penalize(t.game.rating),e):null}))},children:(0,g.jsx)("span",{className:"icon",children:(0,g.jsx)(Gt(),{path:jt.BaD,size:".8em"})})})}):null},rn=function Header(t){return(0,g.jsxs)("div",{className:"header "+t.mode,children:[(0,g.jsxs)("div",{className:"header-title",children:[(0,g.jsx)(nn,{}),(0,g.jsx)(sn,{})]}),(0,g.jsx)(tn,{}),(0,g.jsxs)("div",{className:"header-buttons header-right",children:[(0,g.jsx)(en,{}),(0,g.jsx)(on,{}),(0,g.jsx)(an,{})]})]})},cn=(e(9e3),e(3985)),un=function Menu(){var t=y(),n=t.state,e=t.updateContext,i=t.replaceContext,a=t.restart,o=j(),r=vt().player,c=(0,Ht.Z)(),u=c.navigation,l=c.setNavigation,d=function switchToMenu(t,n){return l((0,s.Z)((0,s.Z)({},u),{},{focus:"menu",screeen:"",mainMenu:t,menu:(0,s.Z)({},n)}))};if(!o.state.showMenu)return null;var f=o.state.allowed-o.state.pauses.length-1,h="You can pause the game ".concat(f," more times.");1===f&&(h="You can pause the game ".concat(f," more time.")),0===f&&(h="This is the last remaining pause. If you continue, no more pause will be possible."),f<0&&(h="The game is not paused.");var p=n.settings.launchSettings.boardMode===ft.Z.SINGLEPLAYER?yt.dR:(0,yt.Vc)(n.settings.launchSettings.players[r].inputLayout);return o.state.pausedBy!==r?(0,g.jsx)("div",{className:"gamemenu menu",children:(0,g.jsx)("div",{className:"startscreen-jail",children:(0,g.jsxs)("div",{className:"innermenu",children:[(0,g.jsx)(Et.Z,{icon:jt.e_f}),o.state.pausedBy,(0,g.jsx)("div",{className:"announcement",children:h})]})})}):(0,g.jsx)("div",{className:"gamemenu menu",children:(0,g.jsx)("div",{className:"startscreen-jail",children:(0,g.jsxs)("div",{className:"innermenu",children:[(0,g.jsx)(Et.Z,{icon:jt.e_f}),(0,g.jsx)("div",{className:"announcement",children:h}),(0,g.jsxs)(Tt.Z,{keyboardLayout:p,children:[(0,g.jsx)(Mt.Z,{icon:jt._86,title:"Resume",onClick:function onClick(){!function toggleMenu(){o.togglePause(!1,-1)}()}}),(0,g.jsx)(Mt.Z,{icon:n.settings.suggestionMode.icon,title:"Suggestions: ".concat(n.settings.suggestionMode.label),onClick:function onClick(){!function setSuggestionMode(t){e((function(n){return n.settings.setSuggestionMode(t)}))}(Q.Z.next(n.settings.suggestionMode).key)}}),(0,g.jsxs)(Mt.Z,{icon:jt.xuG,title:"Entropy",onClick:function onClick(t){return function toggleMainMenu(t,n){u.mainMenu!==t?d(t,n):d("",n)}("entropy",t)},toggled:"entropy"===u.mainMenu,children:[(0,g.jsx)(Mt.Z,{icon:jt.xuG,title:"Base Entropy: ".concat(cn.Z[n.settings.baseEntropy]),onClick:function onClick(){!function setBaseEntropy(t){e((function(n){return n.setEntropy(t)}))}(n.settings.baseEntropy<cn.Z.length-1?n.settings.baseEntropy+1:0)}}),(0,g.jsx)(Mt.Z,{icon:jt.GOG,title:"Action Entropy: ".concat(cn.Z[n.settings.interactionEntropy]),onClick:function onClick(){!function setInteractionEntropy(t){e((function(n){return n.settings.interactionEntropy=t}))}(n.settings.interactionEntropy<cn.Z.length-1?n.settings.interactionEntropy+1:0)}})]}),(0,g.jsx)(Mt.Z,{icon:jt.HAU,title:"Restart Game",onClick:function onClick(){return function reset(){o.togglePause(!0,-1),i((function(t){return t.game.timemachine.previousStates?t.game.timemachine.previousStates[0]:null}))}()},skip:!n.game.timemachine.previousStates.length}),(0,g.jsx)(Mt.Z,{icon:jt.x9U,title:"Quit Game",onClick:function onClick(){return a()}})]})]})})})},ln=function _Menu(){return(0,g.jsx)(Ht.K,{children:(0,g.jsx)(un,{})})},dn=function Stock(){var t;Yt((function(t){return t.stock}));var n=y();return n&&n.state?(0,g.jsxs)("div",{className:"board-field stock",children:[(0,g.jsx)(Vt,{model:n.state.stock}),(0,g.jsx)(_t,{index:0,models:n.state.stock.stack,offsetTop:function offsetTop(t){return t/2*-1},zIndex:0,blink:null===n||void 0===n||null===(t=n.state)||void 0===t?void 0:t.stock.blinkFor,isSuggested:function isSuggested(t){var e;return(null===n||void 0===n||null===(e=n.state)||void 0===e?void 0:e.stock.suggestion)&&t===n.state.stock.stack.length-1}},0)]}):null},gn=function Tableau(){var t=y().state;return(0,g.jsx)(g.Fragment,{children:t.tableau.stacks.map((function(n,e){return(0,g.jsx)(fn,{index:e,model:n,parent:t.tableau,hand:t.hand},e)}))})},fn=function TableauStack(t){Yt((function(n){return n.tableau.stacks[t.index]}));var n=Qt(t.model),e=t.hand.source===t.model.source?[].concat((0,S.Z)(t.model.stack),(0,S.Z)(t.hand.stack)):(0,S.Z)(t.model.stack),s="board-field tableau tableau-"+t.index;return(0,g.jsxs)("div",{className:s,ref:n,children:[(0,g.jsx)(Vt,{model:t.model}),(0,g.jsx)(_t,{index:0,models:e,blink:t.model.blinkFor,isSuggested:function isSuggested(n){return t.model.suggestion&&t.model.stack.length-1===n},offsetTop:function offsetTop(t,n){return function getOffset(t,n){for(var e=0;e<=t;e++)if(n[e]&&!n[e].isHidden)return 12*e+24*(t-e);return 12*t}(t,n)},isSelected:function isSelected(n){return n>t.model.stack.length-1}},0)]})},hn=function Waste(){var t=y().state;Yt((function(t){return t.waste}));var n=Qt(t.waste,(function(){return t.hand.isFromWaste()})),e=(null===t||void 0===t?void 0:t.hand.source)===t.waste.source?[].concat((0,S.Z)(t.waste.stack),(0,S.Z)(t.hand.stack)):(0,S.Z)(t.waste.stack);return(0,g.jsxs)("div",{className:"board-field waste",ref:n,children:[(0,g.jsx)(Vt,{model:t.waste}),(0,g.jsx)(_t,{index:0,models:e,offsetTop:function offsetTop(t){return t/2*-1},offsetLeft:function offsetLeft(n){return function getOffset(n){if("single"===t.settings.launchSettings.drawMode)return 0;var e=t.hand.isHoldingCard()&&t.hand.isFromWaste()?t.waste.stack.length+1:t.waste.stack.length,s=2;return 2===e&&(s=1),1===e&&(s=0),(n-e-2)%3+s}(n)},blink:t.waste.blinkFor,isSuggested:function isSuggested(n){return t.waste.suggestion&&n===t.waste.stack.length-1},isSelected:function isSelected(n){return n>t.waste.stack.length-1}},0)]})},pn=function Board(t){var n=l.useRef(null);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(ln,{}),(0,g.jsx)(rn,{mode:t.mode}),(0,g.jsx)(u.Ix,{style:{zIndex:8888},position:"top-center",closeOnClick:!1,newestOnTop:!0,limit:1,pauseOnFocusLoss:!1,draggable:!1,transition:u.Mi}),(0,g.jsx)("div",{className:"board-jail "+t.mode,children:(0,g.jsxs)("div",{className:"board-grid-container "+t.mode,children:[(0,g.jsx)(dn,{}),(0,g.jsx)(hn,{}),(0,g.jsx)("div",{className:"board-field spacer",ref:n,children:n.current&&(0,g.jsx)(It,{reff:n.current})}),(0,g.jsx)(Jt,{}),(0,g.jsx)(gn,{})]})}),(0,g.jsx)(Ft,{})]})},kn=function EndScreen(){var t=y(),n=t.state,e=t.restart,s=j();return n.game.isEnded?(0,g.jsxs)("div",{className:"ui neutral endscreen",children:[(0,g.jsx)("div",{className:"title",children:"\ud83e\udd73"}),(0,g.jsxs)("div",{className:"content",children:[(0,g.jsxs)("div",{children:["Time: ",s.getElapsed()]}),(0,g.jsxs)("div",{children:["Points: ",n.game.rating.points]}),(0,g.jsxs)("div",{children:["Time Penalty: ",n.game.rating.getTimePenalty(n.game.started,n.game.end||Date.now())]}),(0,g.jsxs)("div",{children:["Bonus Points: ",n.game.rating.getBonusPoints(n.game.started,n.game.end||Date.now())]}),(0,g.jsxs)("div",{children:["Total Points: ",n.game.rating.getTotal(n.game.started,n.game.end||Date.now())]}),(0,g.jsx)("div",{children:(0,g.jsxs)("button",{onClick:e,children:["\ud83d\uddd1\ufe0f",(0,g.jsx)("div",{children:"New Game"})]})})]})]}):null},vn=function(t){(0,r.Z)(BoardWrap,t);var n=(0,c.Z)(BoardWrap);function BoardWrap(t){var e;return(0,o.Z)(this,BoardWrap),(e=n.call(this,t)).replaceContext=function(t){return e.setState(t)},e.updateContext=function(t){return e.replaceContext((function(n){return t(n),n}))},e.updateGameContext=function(t){return e.replaceContext((function(n){n.game.timemachine.modified=!1;var e=ot.copy(n);return e.game.timemachine.previousStates.length?e.game.timemachine.previousStates=[e.game.timemachine.previousStates[e.game.timemachine.previousStates.length-1]]:e.game.timemachine.previousStates=[],t(n),n.game.timemachine.modified?(n.game.timemachine.pushPreviousState(e),n.setToken(Math.random()),n):null}))},e.render=function(){var t={state:e.state.withHandlers().withSuggestions(),replaceContext:e.replaceContext,updateContext:e.updateContext,updateGameContext:e.updateGameContext,restart:e.props.restart};return(0,g.jsxs)(x,{value:t,children:[(0,g.jsx)(mt,{value:{player:e.props.player},children:(0,g.jsx)(pn,{mode:e.props.settings.boardMode})}),(0,g.jsx)(kn,{})]})},e.state=ot.getInitialState(t.settings,t.deck,t.player),e}return(0,a.Z)(BoardWrap)}(l.Component),mn=e(6993),xn=e(1887),yn=function SinglePlayer(t){var n=t.launchState,e=t.deck,s=t.restart;return(0,g.jsx)(i.Z,{ratio:xn.Z._4to3,children:(0,g.jsx)("div",{className:"layout-grid-container "+n.boardMode,children:(0,g.jsx)(vn,{player:0,settings:n,restart:s,deck:e})})})},Sn=function SplitScreen(t){var n=t.launchState,e=t.deck,s=t.restart,i=function Wrap(t){return(0,g.jsx)("div",{className:"layout-grid-container "+n.boardMode,children:(0,g.jsx)(vn,{player:t,settings:n,restart:s,deck:e.copy()})})};return(0,g.jsxs)("div",{className:"game-layout-container splitscreen",children:[i(0),i(1)]})},bn=function Game(t){return(0,g.jsx)(k,{children:(0,g.jsx)(w,{children:(0,g.jsxs)(mn.Z,{delay:500,fallback:(0,g.jsx)("h3",{children:"Loading..."}),children:[t.launchState.boardMode===ft.Z.SINGLEPLAYER&&(0,g.jsx)(yn,(0,s.Z)({},t)),t.launchState.boardMode===ft.Z.VERSUS&&(0,g.jsx)(Sn,(0,s.Z)({},t))]})})})}}}]);
//# sourceMappingURL=454.7209b2c1.chunk.js.map