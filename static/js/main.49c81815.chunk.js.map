{"version":3,"sources":["View/Clock.js","View/Undo.js","View/Footer.js","View/BlinkingComponent.js","View/Card.js","View/MouseHand.js","View/TouchHand.js","View/Hand.js","View/StackBase.js","View/Foundation.js","View/Stock.js","View/Tableau.js","View/Waste.js","View/Board.js","Model/Deck/Card.js","Model/Deck/DeckSize.js","Model/Deck/Suits.js","Model/Deck/Deck.js","Model/Game/Foundation.js","Model/Game/Game.js","Model/Game/Hand.js","Model/Game/Settings.js","Model/Game/Stock.js","Model/Game/Tableau.js","Model/Game/Waste.js","Model/Facade.js","Service/BaseService.js","Service/Foundation.js","Service/Stock.js","Service/Tableau.js","Service/Waste.js","Service/Facade.js","App.js","index.js"],"names":["Clock","props","state","timeElapsed","setInterval","setState","msec","end","Date","now","started","hh","Math","floor","mm","ss","className","this","Component","Undo","document","addEventListener","e","evtobj","window","event","keyCode","ctrlKey","undo","onClick","undoLabel","Footer","model","points","isEnded","reset","beat","onChange","setBaseEntropy","target","value","settings","baseEntropy","entropyLevels","map","entropyLevel","index","setInteractionEntropy","interactionEntropy","setMouseMode","mouseMode","mouseModes","toggle3d","href","BlinkingComponent","blinkFor","unblink","Card","type","icon","isSelected","blink","style","zIndex","offsetTop","top","entropyStyle","console","log","shadowOffsetX","offsetY","shadowOffsetY","isHidden","face","MouseHand","myRef","React","createRef","onMouseMove","bind","onKeyDown","putBack","removeEventListener","node","current","hand","parent","source","x","clientX","y","clientY","left","position","display","ref","stack","card","error","TouchHand","c","Hand","length","StackBase","classname","visible","children","Foundation","Stock","Tableau","getOffset","i","Waste","Board","viewClassname","boardClassname","is3D","onDoubleClick","handlers","stock","clickStock","waste","clickWaste","foundation","stacks","clickFoundation","tableau","clickTableau","game","causeEntropy","lvl","level","random","randomInt","min","max","equals","other","otherCard","copy","orig","copyAll","cards","DeckSize","Suits","heart","color","club","diamond","spade","Deck","keys","Object","deckSize","key","flat","shuffleArray","array","j","getCurrentAccepted","currentFoundation","acceptedCards","accepts","currentAccepted","add","push","usedCards","pop","remove","getTop","getPreviousUsed","countCards","f","parseInt","reduce","a","b","setEntropy","forEach","element","suit","slice","reverse","origStack","Game","popPreviousState","id","isRequested","previousStates","popPrevious","previous","memorable","modelEquals","pow","multiplicator","modified","currentMove","rateMove","every","stackEquals","stacksEqual","debug","move","sourceIsTableau","substr","targetIsTableau","sourceIsFoundation","targetIsFoundation","isHoldingCard","currentCard","hasMoreThanOneCard","isFromCurrentSource","splice","Settings","isTouch","is_touch_device","drawModes","drawMode","prefixes","split","DocumentTouch","query","join","matchMedia","matches","isOnTop","getStack","range","indexOf","popWithFollowing","result","stackEntropy","uncover","entropy","next","concat","setCardProperties","TableauGenerator","generateStacks","offset","deck","pointer","oldpointer","ids","template","generateStack","tryPutDown","canAdd","popTop","recycle","Facade","getInitialState","Service","stateholder","dispatchPutDown","_setState","_dispatchPutDown","dispatchPickup","_dispatchPickup","_blink","selector","startBlink","registerBlink","setTimeout","toggleBlink","Model","pushPreviousState","_card","src","putDown","registerMove","tryDetectEnd","pickUp","registerPickup","s","moveToWaste","recycleWaste","registerRecycle","canPutDown","tryUncover","registerUncover","currentState","was3D","shuffle","handler","App","getHandlers","subscribe","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.49c81815.chunk.js","sourcesContent":["import { Component } from \"react\";\r\nimport React from \"react\";\r\n\r\nexport default class Clock extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            timeElapsed: null,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        setInterval(() => {\r\n            this.setState((state) => {\r\n                //@todo padleft or string format : 00:01\r\n                let msec = (this.props.end || Date.now()) - this.props.started;\r\n                const hh = Math.floor(msec / 1000 / 60 / 60);\r\n                msec -= hh * 1000 * 60 * 60;\r\n                const mm = Math.floor(msec / 1000 / 60);\r\n                msec -= mm * 1000 * 60;\r\n                const ss = Math.floor(msec / 1000);\r\n                msec -= ss * 1000;\r\n                state.timeElapsed = hh ? hh + \":\" + mm + \":\" + ss : mm + \":\" + ss;\r\n                return { ...state };\r\n            });\r\n        }, 1000);\r\n    }\r\n\r\n    render() {\r\n        return <span className={this.props.className}>Time Elapsed: {this.state.timeElapsed}</span>;\r\n    }\r\n}\r\n","import React, { Component } from \"react\";\r\n\r\nexport default class Undo extends Component {\r\n    componentDidMount() {\r\n        document.addEventListener(\"keydown\", (e) => {\r\n            const evtobj = window.event ? event : e;\r\n            if (evtobj.keyCode == 90 && evtobj.ctrlKey) this.props.undo();\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <button onClick={this.props.undo}>undo (penalty:-{this.props.undoLabel()})</button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import Clock from \"./Clock\";\r\nimport React from \"react\";\r\nimport Undo from \"./Undo\";\r\n\r\nconst Footer = (props) => {\r\n    return (\r\n        <div className=\"footer\">\r\n            <div className=\"footer-grid-container\">\r\n                <div>\r\n                    Game Stats\r\n                    <div>Points: {props.model.points}</div>\r\n                    <Clock className=\"clock\" started={props.model.started} end={props.model.end} />\r\n                    <div>Is Ended: {props.model.isEnded ? \"Y\" : \"N\"}</div>\r\n                </div>\r\n                <div>\r\n                    Game Actions\r\n                    <div>\r\n                        <button onClick={props.reset}>reset</button>\r\n                    </div>\r\n                    <Undo undo={props.undo} undoLabel={props.undoLabel} />\r\n                    <div></div>\r\n                </div>\r\n\r\n                <div>\r\n                    Entropy\r\n                    <div>\r\n                        <button onClick={props.beat}>beat on table</button>\r\n                    </div>\r\n                    <div>\r\n                        Base Level\r\n                        <select onChange={(e) => props.setBaseEntropy(e.target.value)} value={props.settings.baseEntropy}>\r\n                            {props.settings.entropyLevels.map((entropyLevel, index) => (\r\n                                <option key={entropyLevel} value={index}>\r\n                                    {entropyLevel}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n                    <div>\r\n                        Interaction Level\r\n                        <select onChange={(e) => props.setInteractionEntropy(e.target.value)} value={props.settings.interactionEntropy}>\r\n                            {props.settings.entropyLevels.map((entropyLevel, index) => (\r\n                                <option key={entropyLevel} value={index}>\r\n                                    {entropyLevel}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    UI Settings\r\n                    <div>\r\n                        Selected Card Behavior\r\n                        <select onChange={(e) => props.setMouseMode(e.target.value)} value={props.settings.mouseMode}>\r\n                            {props.settings.mouseModes.map((mouseMode) => (\r\n                                <option key={mouseMode} value={mouseMode}>\r\n                                    {mouseMode}\r\n                                </option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n                    <div>\r\n                        <button onClick={props.toggle3d}>Toggle 3D</button>\r\n                    </div>\r\n                </div>\r\n\r\n                <span className=\"report\">\r\n                    Report Issues <a href=\"https://github.com/ckonig/solitaire/issues\">here</a>.\r\n                </span>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\nexport default Footer;\r\n","import { Component } from \"react\";\r\n\r\nexport default class BlinkingComponent extends Component {\r\n    componentDidUpdate() {\r\n        if (this.props.model.blinkFor) {\r\n            this.props.model.unblink();\r\n        }\r\n    }\r\n}","import React from \"react\";\r\n\r\nconst Card = (props) => {\r\n    //@todo 3d flip https://3dtransforms.desandro.com/card-flip\r\n    //run css animation first like this:\r\n    //https://medium.com/hackernoon/5-ways-to-animate-a-reactjs-app-in-2019-56eb9af6e3bf\r\n    //then trigger re-render through state change in parent\r\n    const model = props.model;\r\n    let className = props.className + \" card card-base suit-\" + model.type.icon;\r\n    className += props.isSelected ? \" card-selected\" : \"\";\r\n    className += props.blink ? \" blink\" : \"\";\r\n    const style = {\r\n        zIndex: props.zIndex ? props.zIndex : !!props.offsetTop + 2,\r\n        top: props.offsetTop ? props.offsetTop / 10 + \"vw\" : 0,\r\n        ...props.model.entropyStyle,\r\n    };\r\n    if (props.model.offsetTop) {\r\n        console.log(\"found it\", props.model.offsetTop);\r\n        style[\"top\"] += props.model.offsetTop;\r\n    }\r\n    if (!props.isSelected && !props.blink && ((props.shadowOffsetX) || (!props.shadowOffsetX && props.shadowOffsetX === 0))) {\r\n        const offsetY = props.shadowOffsetY || \"-1\";\r\n        style[\"boxShadow\"] = props.shadowOffsetX + \"px \" + offsetY + \"px 4px 4px rgba(0, 0, 0, 0.75)\";\r\n    }\r\n\r\n    return (\r\n        <div className=\"stack-base\">\r\n            <div style={style} className={className} onClick={() => props.onClick({ ...model })}>\r\n                {model.isHidden ? (\r\n                    <div className=\"card-back quarot\">&nbsp;</div>\r\n                ) : (\r\n                    <div className=\"card-grid-container\">\r\n                        <div>\r\n                            <div className=\"align-center\">{model.type.icon}</div>\r\n                        </div>\r\n                        <div>\r\n                            <div className=\"align-left\">{model.face}</div>\r\n                        </div>\r\n                        <div>&nbsp;</div>\r\n                        <div>\r\n                            <div className=\"align-center\">{model.type.icon}</div>\r\n                        </div>\r\n                        <div className=\"mainface\">\r\n                            <div className=\"align-center\">{model.face}</div>\r\n                        </div>\r\n                        <div>\r\n                            <div className=\"align-center\">{model.type.icon}</div>\r\n                        </div>\r\n                        <div>&nbsp;</div>\r\n                        <div>\r\n                            <div className=\"align-right\">{model.face}</div>\r\n                        </div>\r\n                        <div>\r\n                            <div className=\"align-center\">{model.type.icon}</div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\nexport default Card;\r\n","import Card from \"./Card\";\r\nimport { Component } from \"react\";\r\nimport React from \"react\";\r\n\r\nexport default class MouseHand extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.myRef = React.createRef();\r\n        this.onMouseMove = this.onMouseMove.bind(this);\r\n        this.onKeyDown = this.onKeyDown.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener(\"mousemove\", this.onMouseMove, false);\r\n        if (this.props.putBack) {\r\n            document.addEventListener(\"keydown\", this.onKeyDown, false);\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener(\"mousemove\", this.onMouseMove, false);\r\n        document.addEventListener(\"keydown\", this.onKeyDown, false);\r\n    }\r\n\r\n    onMouseMove(e) {\r\n        const node = this.myRef.current;\r\n        if (this.props.hand && this.props.parent == this.props.hand.source) {\r\n            const x = e.clientX,\r\n                y = e.clientY;\r\n            node.style.top = y + 25 + \"px\";\r\n            node.style.left = x + 25 + \"px\";\r\n            node.style.position = \"absolute\";\r\n            node.style.display = \"block\";\r\n        } else {\r\n            node.style.display = \"none\";\r\n        }\r\n    }\r\n\r\n    onKeyDown(e) {\r\n        const evtobj = window.event ? event : e;\r\n        if (evtobj.keyCode == 27 && this.props.hand && this.props.parent == this.props.hand.source) this.props.putBack();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div ref={this.myRef}>\r\n                {this.props.hand &&\r\n                    this.props.parent == this.props.hand.source &&\r\n                    this.props.hand.stack &&\r\n                    this.props.hand.stack.map((card, index) => (\r\n                        <Card\r\n                            model={card}\r\n                            key={index}\r\n                            onClick={() => {\r\n                                console.error(\"clicked card in mouse hand\");\r\n                            }}\r\n                            offsetTop={index * 24}\r\n                            zIndex={1000 + index * 20}\r\n                            isSelected={true}\r\n                        />\r\n                    ))}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import Card from \"./Card\";\r\nimport { Component } from \"react\";\r\nimport React from \"react\";\r\n\r\nexport default class TouchHand extends Component {\r\n    render() {\r\n        if (!this.props.hand || this.props.parent !== this.props.hand.source) {\r\n            return null;\r\n        }\r\n        return (\r\n            <div>\r\n                {this.props.hand &&\r\n                    this.props.hand.stack &&\r\n                    this.props.hand.stack.map((card, index) => (\r\n                        <Card\r\n                            model={card}\r\n                            key={index}\r\n                            shadowOffsetX={this.props.shadowOffsetX}\r\n                            shadowOffsetY={this.props.shadowOffsetY}\r\n                            offsetTop={this.props.offsetTop + (index * 24)}\r\n                            zIndex={1000 + index * 20}\r\n                            isSelected={true}\r\n                            onClick={(c) => this.props.onClick(c)}\r\n                        />\r\n                    ))}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import MouseHand from \"./MouseHand\";\r\nimport React from \"react\";\r\nimport TouchHand from \"./TouchHand\";\r\n\r\nconst Hand = (props) => {\r\n    const putBack = () => props.onClick(props.stack[props.stack.length - 1], props.stack.length - 1);\r\n    if (props.settings.mouseMode == \"follow-cursor\") {\r\n        return (\r\n            <MouseHand\r\n                parent={props.parent}\r\n                hand={props.model}\r\n                offsetTop={props.offsetTop}\r\n                onClick={(c) => props.onClick(c, props.parent)}\r\n                putBack={putBack}\r\n            />\r\n        );\r\n    }\r\n    if (props.settings.mouseMode == \"remain-on-stack\") {\r\n        return (\r\n            <TouchHand\r\n                parent={props.parent}\r\n                hand={props.model}\r\n                shadowOffsetX={props.shadowOffsetX}\r\n                shadowOffsetY={props.shadowOffsetY}\r\n                offsetTop={props.offsetTop}\r\n                onClick={putBack}\r\n                stack={props.stack}\r\n            />\r\n        );\r\n    } else {\r\n        return <div>unkown moouse</div>;\r\n    }\r\n};\r\n\r\nexport default Hand;\r\n","import React from \"react\";\r\n\r\nconst StackBase = (props) => {\r\n    let classname = \"card-base\";\r\n\r\n    if (props.visible) {\r\n        if (props.blink) {\r\n            classname += \" socket-blink\";\r\n        } else {\r\n            classname += \" socket-empty\";\r\n        }\r\n    } else {\r\n        classname += \" socket-full\";\r\n    }\r\n    return (\r\n        <div className={classname} onClick={() => props.onClick()}>\r\n            {props.children}\r\n        </div>\r\n    );\r\n};\r\nexport default StackBase;\r\n","import BlinkingComponent from \"./BlinkingComponent\";\r\nimport Card from \"./Card\";\r\nimport Hand from \"./Hand\";\r\nimport React from \"react\";\r\nimport StackBase from \"./StackBase\";\r\n\r\nexport default class Foundation extends BlinkingComponent {\r\n    render() {\r\n        const props = this.props;\r\n        return (\r\n            <div>\r\n                <StackBase blink={props.model.blinkFor} onClick={() => props.onClick()} visible={!props.model.stack.length}>\r\n                    <div className={\"align-center foundation-base suit-\" + props.model.icon}>{props.model.icon}</div>\r\n                </StackBase>\r\n                {props.model.stack.map((card, index) => (\r\n                    <Card\r\n                        model={card}\r\n                        key={index}\r\n                        shadowOffsetX={props.index * 2}\r\n                        shadowOffsetY={-3}\r\n                        blink={props.model.blinkFor}\r\n                        onClick={props.onClick}\r\n                    />\r\n                ))}\r\n                <Hand\r\n                    settings={props.settings}\r\n                    parent={\"foundation-\" + props.index}\r\n                    shadowOffsetX={props.index * 2}\r\n                    shadowOffsetY={-3}\r\n                    onClick={() => props.onClick(props.model.stack[props.model.stack.length - 1])}\r\n                    model={props.hand}\r\n                    stack={props.model.stack}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import BlinkingComponent from \"./BlinkingComponent\";\r\nimport Card from \"./Card\";\r\nimport React from \"react\";\r\nimport StackBase from \"./StackBase\";\r\n\r\nexport default class Stock extends BlinkingComponent {\r\n    render() {\r\n        const props = this.props;\r\n        return (\r\n            <div>\r\n                <StackBase blink={props.model.blinkFor} onClick={props.onClick} visible={!props.model.stack.length}  />\r\n                {props.model.stack.map((card, index) => (\r\n                    <Card\r\n                        model={card}\r\n                        key={index}\r\n                        offsetTop={index/2*-1}\r\n                        blink={props.model.blinkFor}\r\n                        shadowOffsetX={-6}\r\n                        shadowOffsetY={-3}\r\n                        onClick={props.onClick}\r\n                    />\r\n                ))}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import BlinkingComponent from \"./BlinkingComponent\";\r\nimport Card from \"./Card\";\r\nimport Hand from \"./Hand\";\r\nimport React from \"react\";\r\nimport StackBase from \"./StackBase\";\r\n\r\nexport default class Tableau extends BlinkingComponent {\r\n    render() {\r\n        const props = this.props;\r\n        let offset = 0;\r\n        const getOffset = (index) => {\r\n            for (let i = 0; i <= index; i++) {\r\n                if (props.model.stack[i] && !props.model.stack[i].isHidden) {\r\n                    offset = i * 12 + (index - i) * 24;\r\n                    return offset;\r\n                }\r\n            }\r\n            offset = index * 12;\r\n            return offset;\r\n        };\r\n\r\n        return (\r\n            <div>\r\n                <StackBase\r\n                    blink={props.model.blinkFor}\r\n                    onClick={() => props.onClick(null, \"tableau-\" + props.index)}\r\n                    visible={!props.model.stack.length}\r\n                />\r\n                {props.model.stack.map((card, index) => (\r\n                    <Card\r\n                        model={card}\r\n                        key={index}\r\n                        blink={props.model.blinkFor}\r\n                        shadowOffsetX={(4 - 7 + props.index) * 2}\r\n                        offsetTop={getOffset(index)}\r\n                        onClick={props.onClick}\r\n                    />\r\n                ))}\r\n                <Hand\r\n                    settings={props.settings}\r\n                    parent={\"tableau-\" + props.index}\r\n                    onClick={props.onClick}\r\n                    model={props.hand}\r\n                    stack={props.model.stack}\r\n                    shadowOffsetX={(4 - 7 + props.index) * 2}\r\n                    offsetTop={getOffset(props.model.stack.length)}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import BlinkingComponent from \"./BlinkingComponent\";\r\nimport Card from \"./Card\";\r\nimport Hand from \"./Hand\";\r\nimport React from \"react\";\r\nimport StackBase from \"./StackBase\";\r\n\r\nexport default class Waste extends BlinkingComponent {\r\n    render() {\r\n        const props = this.props;\r\n        return (\r\n            <div>\r\n                <StackBase blink={props.model.blinkFor} onClick={props.onClick} visible={!props.model.stack.length} />\r\n                {props.model.stack.map((card, index) => (\r\n                    <Card\r\n                        model={card}\r\n                        shadowOffsetX={-4}\r\n                        shadowOffsetY={-3}\r\n                        offsetTop={(index / 2) * -1}\r\n                        key={index}\r\n                        blink={props.model.blinkFor}\r\n                        onClick={(c) => props.onClick(c)}\r\n                    />\r\n                ))}\r\n                <Hand\r\n                    settings={props.model.settings}\r\n                    shadowOffsetX={-4}\r\n                    shadowOffsetY={-3}\r\n                    offsetTop={(props.model.stack.length / 2) * -1}\r\n                    parent=\"waste\"\r\n                    onClick={props.onClick}\r\n                    model={props.hand}\r\n                    stack={props.model.stack}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import Footer from \"./Footer\";\r\nimport Foundation from \"./Foundation\";\r\nimport React from \"react\";\r\nimport Stock from \"./Stock\";\r\nimport Tableau from \"./Tableau\";\r\nimport Waste from \"./Waste\";\r\n\r\nconst Board = (props) => {\r\n    let viewClassname = \"game-view\";\r\n    let boardClassname = \"board-grid-container\";\r\n    if (props.model.settings.is3D) {\r\n        viewClassname += \" game-view-3d\";\r\n        boardClassname += \" board-3d\";\r\n    }\r\n    return (\r\n        <div onDoubleClick={props.handlers.beat}>\r\n            <div className=\"layout-grid-container\">\r\n                <div className={viewClassname}>\r\n                    <div className={boardClassname}>\r\n                        <Stock model={props.model.stock} onClick={props.handlers.clickStock} />\r\n                        <Waste model={props.model.waste} hand={props.model.hand} onClick={props.handlers.clickWaste} />\r\n                        <div className=\"spacer\">&nbsp;</div>\r\n                        {props.model.foundation.stacks.map((foundation, index) => (\r\n                            <Foundation\r\n                                settings={props.model.settings}\r\n                                key={index}\r\n                                index={index}\r\n                                model={foundation}\r\n                                hand={props.model.hand}\r\n                                onClick={(c) => props.handlers.clickFoundation(c, index)}\r\n                            />\r\n                        ))}\r\n                        {props.model.tableau.stacks.map((stack, index) => (\r\n                            <Tableau\r\n                                settings={props.model.settings}\r\n                                key={index}\r\n                                index={index}\r\n                                model={stack}\r\n                                hand={props.model.hand}\r\n                                onClick={(card) => props.handlers.clickTableau(card, index)}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n                <Footer\r\n                    reset={props.handlers.reset}\r\n                    undoLabel={props.handlers.undoLabel}\r\n                    undo={props.handlers.undo}\r\n                    setMouseMode={props.handlers.setMouseMode}\r\n                    setBaseEntropy={props.handlers.setBaseEntropy}\r\n                    setInteractionEntropy={props.handlers.setInteractionEntropy}\r\n                    toggle3d={props.handlers.toggle3d}\r\n                    beat={props.handlers.beat}\r\n                    settings={props.model.settings}\r\n                    model={props.model.game}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Board;\r\n","export default class Card {\r\n    constructor(face, type, isHidden) {\r\n        this.face = face;\r\n        this.type = type;\r\n        this.isHidden = isHidden;\r\n        this.entropyStyle = {};\r\n        this.offsetTop = 0;\r\n        this.causeEntropy(1);\r\n    }\r\n\r\n    causeEntropy = (lvl) => {\r\n        const level = lvl * 2;\r\n        //@todo this is awesome but move it to model\r\n        const random = () => Math.random() < 0.5;\r\n        const randomInt = (min, max) => Math.random() * (max - min) + min;\r\n        //shift\r\n        if (random()) {\r\n            if (random()) {\r\n                this.entropyStyle[\"left\"] = randomInt(0, level / 2);\r\n            } else {\r\n                this.entropyStyle[\"right\"] = randomInt(0, level / 2);\r\n            }\r\n            if (random()) {\r\n                //this.offsetTop -= randomInt(lvl , lvl);\r\n            }\r\n        }\r\n        //rotate\r\n        this.entropyStyle[\"transform\"] = \"rotate(\" + randomInt(level * -1, level) + \"deg)\";\r\n    };\r\n\r\n    equals = (other) => {\r\n        return Card.equals(this, other);\r\n    };\r\n\r\n    static equals(card, otherCard) {\r\n        return (!card && !otherCard) || (card && otherCard && otherCard.face == card.face && otherCard.type.icon == card.type.icon);\r\n    }\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Card(orig.face, orig.type, orig.isHidden);\r\n        copy.source = orig.source;\r\n        copy.entropyStyle = orig.entropyStyle\r\n        return copy;\r\n    };\r\n\r\n    static copyAll = (cards) => cards.map((card) => Card.copy(card));\r\n}\r\n","export const DeckSize = [\"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"J\", \"Q\", \"K\", \"A\"];\r\n\r\nexport const getFoundationOrder = () => {\r\n    return [\"A\", ...DeckSize.slice(0, DeckSize.length - 1)].reverse();\r\n};\r\n\r\nexport const getTableauOrder = () => {\r\n    return [...DeckSize];\r\n};\r\n","const Suits = {\r\n    heart: {\r\n        icon: \"♥\",\r\n        color: \"red\",\r\n    },\r\n    club: {\r\n        icon: \"♣\",\r\n        color: \"black\",\r\n    },\r\n    diamond: {\r\n        icon: \"♦\",\r\n        color: \"red\",\r\n    },\r\n    spade: {\r\n        icon: \"♠\",\r\n        color: \"black\",\r\n    },\r\n};\r\n\r\nexport default Suits;\r\n","import Card from \"./Card\";\r\nimport { DeckSize } from \"./DeckSize\";\r\nimport Suits from \"./Suits\";\r\n\r\nexport default class Deck {\r\n    constructor() {\r\n        const keys = Object.keys(Suits);\r\n        this.cards = DeckSize.map((deckSize) => [...keys.map((key) => new Card(deckSize, Suits[key], true))]).flat();\r\n    }\r\n\r\n    shuffle() {\r\n        this.shuffleArray(this.cards);\r\n        return this;\r\n    }\r\n\r\n    // credits: https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array\r\n    shuffleArray(array) {\r\n        for (let i = array.length - 1; i > 0; i--) {\r\n            const j = Math.floor(Math.random() * (i + 1));\r\n            [array[i], array[j]] = [array[j], array[i]];\r\n        }\r\n    }\r\n}\r\n","import Card from \"../Deck/Card\";\r\nimport Suits from \"../Deck/Suits\";\r\nimport { getFoundationOrder } from \"../Deck/DeckSize\";\r\n\r\nexport default class Foundation {\r\n    constructor(settings) {\r\n        this.settings = settings;\r\n        const template = () => ({\r\n            stack: [],\r\n            acceptedCards: [...getFoundationOrder()],\r\n            usedCards: [],\r\n            icon: null,\r\n            color: null,\r\n        });\r\n        const stacks = Object.keys(Suits)\r\n            .map((key) => Suits[key])\r\n            .map((suit) => ({ ...template(), ...suit }));\r\n        this.stacks = [...stacks];\r\n    }\r\n\r\n    getCurrentAccepted = (index) => {\r\n        const currentFoundation = this.stacks[index].acceptedCards;\r\n        return currentFoundation[currentFoundation.length - 1];\r\n    };\r\n\r\n    //@todo same (similar) in tableau\r\n    accepts = (index, card) => {\r\n        const currentAccepted = this.getCurrentAccepted(index);\r\n        return this.stacks[index].icon == card.type.icon && currentAccepted == card.face;\r\n    };\r\n\r\n    add = (index, cards) => {\r\n        const card = cards[0];\r\n        card.causeEntropy(Math.min(this.settings.interactionEntropy, 3));\r\n        card.source = \"foundation-\" + index;\r\n        this.stacks[index].stack.push(card);\r\n        return this.stacks[index].usedCards.push(this.stacks[index].acceptedCards.pop());\r\n    };\r\n\r\n    remove = (index, card) => {\r\n        this.stacks[index].acceptedCards.push(this.stacks[index].usedCards.pop());\r\n        return card && card.equals(this.getTop(index)) && this.stacks[index].stack.pop();\r\n    };\r\n\r\n    getPreviousUsed = (index) => {\r\n        return [...this.stacks[index].usedCards].pop();\r\n    };\r\n\r\n    countCards = () => {\r\n        this.stacks.map((f) => parseInt(f.stack.length)).reduce((a, b) => a + b, 0);\r\n    };\r\n\r\n    getTop(index) {\r\n        return this.stacks[index].stack[this.stacks[index].stack.length - 1];\r\n    }\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Foundation(orig.settings);\r\n        copy.stacks = orig.stacks.map((origStack) => ({\r\n            stack: Card.copyAll(origStack.stack),\r\n            acceptedCards: [...origStack.acceptedCards],\r\n            usedCards: [...origStack.usedCards],\r\n            icon: origStack.icon,\r\n            color: origStack.color,\r\n        }));\r\n        return copy;\r\n    };\r\n\r\n    setEntropy = (lvl) => {\r\n        this.stacks.forEach((stack) => stack.stack.forEach((element) => element.causeEntropy(Math.min(3, lvl))));\r\n        return this;\r\n    };\r\n}\r\n","import Card from \"../Deck/Card\";\r\n\r\nexport default class Game {\r\n    constructor() {\r\n        this.points = 0;\r\n        this.started = Date.now();\r\n        this.previousStates = [];\r\n        this.memorable = true;\r\n        this.modified = false;\r\n        this.multiplicator = 1;\r\n    }\r\n\r\n    registerMove(target, source) {\r\n        this.memorable = true;\r\n        this.modified = true;\r\n        const currentMove = {\r\n            source: source,\r\n            target: target,\r\n        };\r\n        if (source == target) {\r\n            this.memorable = false;\r\n        }\r\n\r\n        this.points += this.rateMove(currentMove);\r\n        return true;\r\n    }\r\n\r\n    stackEquals(a, b) {\r\n        return a.stack.every((card, i) => Card.equals(card, b.stack[i]) && card.isHidden == b.stack[i].isHidden);\r\n    }\r\n\r\n    stacksEqual(a, b) {\r\n        return a.stacks.every((stack, i) => this.stackEquals(stack, b.stacks[i]));\r\n    }\r\n\r\n    modelEquals(a, b) {\r\n        return (\r\n            this.stackEquals(a.stock, b.stock) &&\r\n            this.stackEquals(a.waste, b.waste) &&\r\n            this.stacksEqual(a.tableau, b.tableau) &&\r\n            this.stacksEqual(a.foundation, b.foundation)\r\n        );\r\n    }\r\n\r\n    pushPreviousState(state) {\r\n        const previous = this.previousStates[this.previousStates.length - 1];\r\n        if (!previous || !this.modelEquals(state, previous)) {\r\n            this.previousStates.push(state);\r\n        }\r\n    }\r\n\r\n    registerPickup() {\r\n        this.modified = true;\r\n        this.memorable = false;\r\n        return true;\r\n    }\r\n\r\n    popPreviousState = (id, current) => {\r\n        const isRequested = this.previousStates.length - 1 == id;\r\n        const popPrevious = () => isRequested && this.previousStates && this.previousStates.pop();\r\n        let previous = popPrevious();\r\n        while (previous && (!previous.game.memorable || this.modelEquals(previous, current)) && this.previousStates.length) {\r\n            previous = popPrevious();\r\n        }\r\n        if (previous && previous.game) {\r\n            previous.game.points = Math.min(previous.game.points, this.points) - Math.pow(2, this.multiplicator);\r\n            previous.game.multiplicator = this.multiplicator + 1;\r\n        }\r\n        return previous;\r\n    };\r\n\r\n    registerRecycle() {\r\n        this.memorable = true;\r\n        this.modified = true;\r\n        if (this.points > 0) {\r\n            if (this.points < 100) {\r\n                this.points = 0;\r\n            } else {\r\n                this.points -= 100;\r\n            }\r\n        }\r\n        console.debug(\"RATING: subtract (max) 100 points for RECYCLE\");\r\n    }\r\n\r\n    registerUncover() {\r\n        this.memorable = true;\r\n        this.modified = true;\r\n        this.points += 5;\r\n        console.debug(\"RATING: add 5 points for UNCOVER\");\r\n        return true;\r\n    }\r\n\r\n    registerBlink() {\r\n        this.modified = true;\r\n        this.memorable = false;\r\n        return true;\r\n    }\r\n\r\n    rateMove(move) {\r\n        const sourceIsTableau = move.source.substr(0, 7) == \"tableau\";\r\n        const targetIsTableau = move.target.substr(0, 7) == \"tableau\";\r\n        const sourceIsFoundation = move.source.substr(0, 10) == \"foundation\";\r\n        const targetIsFoundation = move.target.substr(0, 10) == \"foundation\";\r\n        if (sourceIsTableau) {\r\n            if (targetIsFoundation) {\r\n                console.debug(\"RATING: add 10 points for MOVE tableau -> foundation\");\r\n                return 10;\r\n            }\r\n        } else if (move.source == \"waste\") {\r\n            if (targetIsFoundation) {\r\n                console.debug(\"RATING: add 10 points for MOVE waste -> foundation\");\r\n                return 10;\r\n            }\r\n            if (targetIsTableau) {\r\n                console.debug(\"RATING: add 5 points for MOVE waste -> tableau\");\r\n                return 5;\r\n            }\r\n        } else if (sourceIsFoundation) {\r\n            if (targetIsTableau) {\r\n                console.debug(\"RATING: subtract 15 points for MOVE foundation -> tableau\");\r\n                return -15;\r\n            }\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Game();\r\n        copy.points = orig.points;\r\n        copy.started = orig.started;\r\n        copy.modified = orig.modified;\r\n        copy.multiplicator = orig.multiplicator;\r\n        copy.memorable = orig.memorable;\r\n        copy.previousStates = [...orig.previousStates];\r\n        return copy;\r\n    };\r\n}\r\n","import Card from \"../Deck/Card\";\r\n\r\nexport default class Hand {\r\n    constructor() {\r\n        this.stack = [];\r\n        this.source = null;\r\n    }\r\n\r\n    pickUp(stack, source) {\r\n        if (stack && stack[0]) {\r\n            this.stack = stack;\r\n            this.source = source;\r\n            console.log('picked up', this.stack)\r\n        }\r\n\r\n        return stack;\r\n    }\r\n\r\n    putDown() {\r\n        this.source = null;\r\n        return this.stack.splice(0, this.stack.length);\r\n    }\r\n\r\n    isHoldingCard = () => !!this.stack.length;\r\n\r\n    currentCard = () => this.isHoldingCard() && this.stack[0];\r\n\r\n    hasMoreThanOneCard = () => this.stack.length > 1;\r\n\r\n    isFromCurrentSource = (card) => this.source && card.source == this.source;\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Hand();\r\n        copy.stack = Card.copyAll(orig.stack)\r\n        copy.source = orig.source;\r\n        return copy;\r\n    }\r\n}\r\n","export default class Settings {\r\n    constructor() {\r\n        const isTouch = this.is_touch_device();\r\n        this.mouseModes = [\"follow-cursor\", \"remain-on-stack\"];\r\n        this.mouseMode = isTouch ? \"remain-on-stack\" : \"follow-cursor\";\r\n\r\n        this.entropyLevels = [\"none\", \"low\", \"regular\", \"high\", \"extreme\"];\r\n        this.baseEntropy = isTouch ? 1 : 2;\r\n        this.interactionEntropy = isTouch ? 1 : 2;\r\n\r\n        this.drawModes = [\"single\"];\r\n        this.drawMode = \"single\"; //@todo implement triple draw\r\n\r\n        this.is3D = true;\r\n    }\r\n\r\n    is_touch_device() {\r\n        try {\r\n            const prefixes = \" -webkit- -moz- -o- -ms- \".split(\" \");\r\n\r\n            const mq = (query) => window.matchMedia(query).matches;\r\n\r\n            if (\"ontouchstart\" in window || (typeof window.DocumentTouch !== \"undefined\" && document instanceof window.DocumentTouch)) {\r\n                return true;\r\n            }\r\n\r\n            return mq([\"(\", prefixes.join(\"touch-enabled),(\"), \"heartz\", \")\"].join(\"\"));\r\n        } catch (e) {\r\n            console.error(\"(Touch detect failed)\", e);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Settings();\r\n        copy.is3D = orig.is3D;\r\n        return copy;\r\n    }\r\n}\r\n","import Card from \"../Deck/Card\";\r\n\r\nexport default class Stock {\r\n    constructor(stack, settings) {\r\n        this.settings = settings;\r\n        this.stack = [...stack];\r\n    }\r\n\r\n    recycle(waste) {\r\n        if (waste.length) {\r\n            this.stack = waste.reverse().map((element) => {\r\n                element.causeEntropy(Math.min(this.settings.interactionEntropy, 1));\r\n                element.isHidden = true;\r\n                return element;\r\n            });\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    isOnTop = (card) => card && card.equals(this.getTop());\r\n\r\n    getTop = () => this.stack[this.stack.length - 1];\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Stock([], orig.settings);\r\n        copy.stack = Card.copyAll(orig.stack);\r\n        return copy;\r\n    }\r\n\r\n    setEntropy = (lvl) => {\r\n        this.stack.forEach(element => element.causeEntropy(Math.min(lvl,1)));\r\n        return this;\r\n    }\r\n}\r\n","import Card from \"../Deck/Card\";\r\nimport { getTableauOrder } from \"../Deck/DeckSize\";\r\n\r\nexport default class Tableau {\r\n    constructor(cards, settings) {\r\n        this.stacks = !cards ? [] : new TableauGenerator().generateStacks(cards);\r\n        this.settings = settings;\r\n    }\r\n\r\n    getStack = (index) => {\r\n        return this.stacks[index];\r\n    };\r\n\r\n    accepts = (index, current) => {\r\n        const top = this.getTop(index);\r\n        if (!top) {\r\n            return current && current.face == \"K\";\r\n        }\r\n        if (top.isHidden) {\r\n            return false;\r\n        }\r\n        const range = [...getTableauOrder()];\r\n        const currentIndex = range.indexOf(current.face);\r\n        const topIndex = range.indexOf(top.face);\r\n        return currentIndex + 1 == topIndex && current.type.color != top.type.color;\r\n    };\r\n\r\n    popWithFollowing = (card, i) => {\r\n        for (let j = 0; j < this.stacks[i].stack.length; j++) {\r\n            if (card && card.equals(this.stacks[i].stack[j])) {\r\n                const result = this.stacks[i].stack.splice(j, this.stacks[i].stack.length);\r\n                this.stackEntropy(i);\r\n                return result;\r\n            }\r\n        }\r\n\r\n        return [];\r\n    };\r\n\r\n    uncover = (index, card) => {\r\n        const top = this.getTop(index);\r\n        if (top.isHidden && card && card.equals(this.getTop(index))) {\r\n            top.isHidden = false;\r\n            this.stackEntropy(index);\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    stackEntropy = (index) => {\r\n        console.log('adding stack entropy', index, this.settings.interactionEntropy)\r\n        let entropy = this.settings.interactionEntropy;\r\n        let next = 1;\r\n        let top = this.getTop(index);\r\n        while (entropy && entropy != 0 && top) {\r\n            console.debug('loop');\r\n            top.causeEntropy(entropy);\r\n            entropy--;\r\n            top = this.getTop(index, next);\r\n            next++;\r\n        }\r\n    };\r\n\r\n    add = (index, cards) => {\r\n        this.stacks[index].stack = this.stacks[index].stack.concat(cards.map((c) => this.setCardProperties(c, index)));\r\n        this.stackEntropy(index);\r\n        return cards;\r\n    };\r\n\r\n    setCardProperties = (card, index) => {\r\n        card.source = \"tableau-\" + index;\r\n        return card;\r\n    };\r\n\r\n    getTop(index, offset) {\r\n        if (!offset) {\r\n            offset = 0;\r\n        }\r\n        return this.stacks[index].stack[this.stacks[index].stack.length - 1 - offset];\r\n    }\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Tableau([], orig.settings);\r\n        copy.stacks = orig.stacks.map((stack) => ({ stack: Card.copyAll(stack.stack) }));\r\n        return copy;\r\n    };\r\n\r\n    setEntropy = (lvl) => {\r\n        this.stacks.forEach((stack) => stack.stack.forEach((element) => element.causeEntropy(Math.min(lvl, 4))));\r\n        return this;\r\n    };\r\n}\r\n\r\nclass TableauGenerator {\r\n    generateStacks = (deck) => {\r\n        this.deck = deck;\r\n        this.pointer = 0;\r\n        this.oldpointer = this.pointer;\r\n        const ids = [0, 1, 2, 3, 4, 5, 6];\r\n        this.stacks = ids.map((id) => this.template(id));\r\n        ids.reverse().forEach((id) => {\r\n            this.generateStack(id);\r\n        });\r\n        return this.stacks;\r\n    };\r\n\r\n    template = (id) => ({\r\n        stack: [],\r\n        id,\r\n    });\r\n\r\n    generateStack = (id) => {\r\n        this.pointer += 6 - id + 1;\r\n        this.stacks[id].stack = this.deck\r\n            .slice(this.oldpointer, this.pointer)\r\n            .map((c) => ({\r\n                ...c,\r\n                isHidden: true,\r\n                source: \"tableau-\" + id,\r\n            }))\r\n            .reverse();\r\n        if (this.stacks[id].stack[this.stacks[id].stack.length - 1]) {\r\n            this.stacks[id].stack[this.stacks[id].stack.length - 1].isHidden = false;\r\n        }\r\n        this.oldpointer = this.pointer;\r\n    };\r\n}\r\n","import Card from \"../Deck/Card\";\r\n\r\nexport default class Waste {\r\n    constructor(settings) {\r\n        this.settings = settings;\r\n        this.stack = [];\r\n    }\r\n\r\n    tryPutDown = (card) => this.canAdd(card) && (this.add(card) || true);\r\n\r\n    add = (card) => card && this.stack.push(this.setCardProperties(card));\r\n\r\n    setCardProperties = (card) => {\r\n        card.source = \"waste\";\r\n        card.isHidden = false;\r\n        card.causeEntropy(Math.min(this.settings.interactionEntropy, 1));\r\n        return card;\r\n    };\r\n\r\n    canAdd = (card) => card && (!this.getTop() || !card.equals(this.getTop()));\r\n\r\n    popTop = (card) => card && card.equals(this.getTop()) && this.stack.pop();\r\n\r\n    recycle = () => this.stack.splice(0, this.stack.length);\r\n\r\n    getTop = () => this.stack[this.stack.length - 1];\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Waste(orig.settings);\r\n        copy.stack = Card.copyAll(orig.stack);\r\n        return copy;\r\n    }\r\n\r\n    setEntropy = (lvl) => {\r\n        this.stack.forEach(element => element.causeEntropy(Math.min(lvl,1)));\r\n        return this;\r\n    }\r\n}\r\n","import Foundation from \"./Game/Foundation\";\r\nimport Game from \"./Game/Game\";\r\nimport Hand from \"./Game/Hand\";\r\nimport Settings from \"./Game/Settings\";\r\nimport Stock from \"./Game/Stock\";\r\nimport Tableau from \"./Game/Tableau\";\r\nimport Waste from \"./Game/Waste\";\r\n\r\nexport default class Facade {\r\n    static getInitialState = (deck) => {\r\n        const settings = new Settings();\r\n        const state = {\r\n            stock: new Stock([...deck.cards.slice(28)], settings),\r\n            waste: new Waste(settings),\r\n            foundation: new Foundation(settings),\r\n            tableau: new Tableau([...deck.cards.slice(0, 28)], settings),\r\n            hand: new Hand(),\r\n            game: new Game(),\r\n            settings: settings,\r\n        };\r\n        return state;\r\n    };\r\n\r\n    static copy = (state) => {\r\n        return {\r\n            stock: Stock.copy(state.stock),\r\n            waste: Waste.copy(state.waste),\r\n            foundation: Foundation.copy(state.foundation),\r\n            tableau: Tableau.copy(state.tableau),\r\n            hand: Hand.copy(state.hand),\r\n            game: Game.copy(state.game),\r\n            settings: Settings.copy(state.settings),\r\n        };\r\n    };\r\n\r\n    static setEntropy = (state, lvl) => {\r\n        return {\r\n            stock: state.stock.setEntropy(lvl),\r\n            waste: state.waste.setEntropy(lvl),\r\n            foundation: state.foundation.setEntropy(lvl),\r\n            tableau: state.tableau.setEntropy(lvl),\r\n            hand: state.hand,\r\n            game: state.game,\r\n            settings: state.settings,\r\n        };\r\n    };\r\n}\r\n","import Model from \"../Model/Facade\";\r\n\r\nexport default class Service {\r\n    constructor(stateholder) {\r\n        this._setState = (a, b) =>\r\n            stateholder.setState((state) => {\r\n                state.game.modified = false;\r\n                const previous = Model.copy(state);\r\n                a(state);\r\n                if (state.game.modified) {\r\n                    state.game.pushPreviousState(previous);\r\n                    return { ...state };\r\n                }\r\n\r\n                // @todo enable undoing via browser back gesture/button\r\n                return null;\r\n            }, b);\r\n    }\r\n\r\n    dispatchPutDown = (card, index) => {\r\n        this._setState(\r\n            (state) => {\r\n                if (state.hand.isHoldingCard()) {\r\n                    this._dispatchPutDown(card, state, index);\r\n                }\r\n            },\r\n            null,\r\n            true\r\n        );\r\n    };\r\n\r\n    dispatchPickup = (card, index) => {\r\n        this._setState((state) => {\r\n            if (!state.hand.isHoldingCard()) {\r\n                this._dispatchPickup(card, state, index);\r\n            }\r\n        });\r\n    };\r\n\r\n    _blink = (selector, state) => this.startBlink(selector, 10, state);\r\n\r\n    startBlink = (selector, blinkFor, state) => {\r\n        selector(state).blinkFor = blinkFor;\r\n        state.game.registerBlink();\r\n        selector(state).unblink = () => setTimeout(() => this.toggleBlink(selector, 0), 100);\r\n    };\r\n\r\n    toggleBlink = (selector, blinkFor) =>\r\n        this._setState((state) => {\r\n            selector(state).blinkFor = blinkFor;\r\n            state.game.registerBlink();\r\n        });\r\n}\r\n","import Service from \"./BaseService\";\r\n\r\nexport default class Foundation extends Service {\r\n    _dispatchPutDown = (_card, state, index) => {\r\n        if (!state.hand.hasMoreThanOneCard() && state.foundation.accepts(index, state.hand.currentCard())) {\r\n            const src = state.hand.source;\r\n            state.foundation.add(index, state.hand.putDown()) && state.game.registerMove(\"foundation-\" + index, src);\r\n            this.tryDetectEnd(state);\r\n        } else {\r\n            this.blink(index, state);\r\n        }\r\n    };\r\n\r\n    _dispatchPickup = (_card, state, index) => {\r\n        const card = state.foundation.getTop(index);\r\n        if (card && state.foundation.getPreviousUsed(index) === card.face) {\r\n            state.hand.pickUp([state.foundation.remove(index, card)], card.source) && state.game.registerPickup();\r\n        } else {\r\n            this.blink(index, state);\r\n        }\r\n    };\r\n\r\n    tryDetectEnd(state) {\r\n        const nrofCards = state.foundation.countCards();\r\n        if (nrofCards === 52) {\r\n            state.game.isEnded = true;\r\n            state.game.end = Date.now();\r\n        }\r\n    }\r\n\r\n    blink = (index, state) => this._blink((s) => s.foundation.stacks[index], state);\r\n}\r\n","import Service from \"./BaseService\";\r\n\r\nexport default class Stock extends Service {\r\n    _dispatchPutDown = (card, state) => this.blink(card, state);\r\n\r\n    _dispatchPickup = (card, state) => (card ? this.moveToWaste(card, state) : this.recycleWaste(card, state));\r\n\r\n    moveToWaste = (card, state) =>\r\n        state.stock.isOnTop(card) && state.waste.add(state.stock.stack.pop()) && state.game.registerMove(\"waste\", \"stock\");\r\n\r\n    recycleWaste = (_card, state) =>\r\n        !state.stock.getTop() && !!state.waste.getTop() && state.stock.recycle(state.waste.recycle()) && state.game.registerRecycle(state);\r\n\r\n    blink = (_card, state) => this._blink((s) => s.stock, state);\r\n}\r\n","import Service from \"./BaseService\";\r\n\r\nexport default class Tableau extends Service {\r\n    _dispatchPutDown = (card, state, index) => {\r\n        if (this.canPutDown(card, state, index)) {\r\n            const src = state.hand.source;\r\n            state.tableau.add(index, state.hand.putDown()) && state.game.registerMove(\"tableau-\" + index, src);\r\n        } else {\r\n            this.blink(index, state);\r\n        }\r\n    };\r\n\r\n    canPutDown = (card, state, index) =>\r\n        (card && card.isHidden && state.hand.isFromCurrentSource(card)) ||\r\n        state.tableau.accepts(index, state.hand.currentCard()) ||\r\n        (!card && state.hand.source == \"tableau-\" + index);\r\n\r\n    _dispatchPickup = (card, state, index) => {\r\n        if (card && !this.tryUncover(card, index, state) && !card.isHidden) {\r\n            state.hand.pickUp(state.tableau.popWithFollowing(card, index), card.source) && state.game.registerPickup();\r\n        } else if (!card) {\r\n            this.blink(index, state);\r\n        }\r\n    };\r\n\r\n    tryUncover = (card, index, state) =>\r\n        !state.hand.isHoldingCard() && card.isHidden && state.tableau.uncover(index, card) && state.game.registerUncover(card, state);\r\n\r\n    blink = (index, state) => this._blink((s) => s.tableau.stacks[index], state);\r\n}\r\n","import Service from \"./BaseService\";\r\n\r\nexport default class Waste extends Service {\r\n    _dispatchPutDown = (card, state) =>\r\n        (state.hand.source == \"waste\" &&\r\n            state.waste.tryPutDown(state.hand.currentCard()) &&\r\n            state.hand.putDown() &&\r\n            state.game.registerMove(\"waste\", \"waste\")) ||\r\n        this.blink(card, state);\r\n\r\n    _dispatchPickup = (card, state) =>\r\n        (card && state.hand.pickUp([state.waste.popTop(card)], \"waste\") && state.game.registerPickup()) || this.blink(card, state);\r\n\r\n    blink = (card, state) => this._blink((s) => s.waste, state);\r\n}\r\n","import Deck from \"../Model/Deck/Deck\";\r\nimport Foundation from \"./Foundation\";\r\nimport Model from \"../Model/Facade\";\r\nimport Stock from \"./Stock\";\r\nimport Tableau from \"./Tableau\";\r\nimport Waste from \"./Waste\";\r\n\r\nexport default class Facade {\r\n    constructor() {\r\n        this.deck = new Deck();\r\n        this.deck.shuffle();\r\n    }\r\n\r\n    getInitialState = () => Model.getInitialState(this.deck);\r\n\r\n    getHandlers(stateholder, state) {\r\n        let handler = \"dispatchPickup\";\r\n        if (state && state.hand && state.hand.isHoldingCard()) {\r\n            handler = \"dispatchPutDown\";\r\n        }\r\n\r\n        return {\r\n            clickTableau: new Tableau(stateholder)[handler],\r\n            clickFoundation: new Foundation(stateholder)[handler],\r\n            clickStock: new Stock(stateholder)[handler],\r\n            clickWaste: new Waste(stateholder)[handler],\r\n            undo: () => this.undo(state.game.previousStates.length - 1, stateholder, state),\r\n            reset: () => this.reset(stateholder),\r\n            beat: () => this.beat(stateholder),\r\n            setBaseEntropy: (lvl) => this.setBaseEntropy(stateholder, lvl),\r\n            setInteractionEntropy: (lvl) => this.setInteractionEntropy(stateholder, lvl),\r\n            setMouseMode: (mm) => this.setMouseMode(stateholder, mm),\r\n            toggle3d: () => this.toggle3d(stateholder, state.settings.is3D),\r\n            undoLabel: () => Math.pow(2, stateholder.state.game.multiplicator),\r\n        };\r\n    }\r\n\r\n    beat = (stateholder) => {\r\n        this.setBaseEntropy(stateholder, 4);\r\n    };\r\n\r\n    reset = (stateholder) =>\r\n        stateholder.setState((state) => (state.game.previousStates ? state.game.previousStates[0] : { ...this.getInitialState() }));\r\n\r\n    undo = (id, stateholder, currentState) => stateholder.setState((state) => state.game.popPreviousState(id, currentState) || null);\r\n\r\n    setBaseEntropy = (stateholder, lvl) => {\r\n        stateholder.setState((state) => {\r\n            state.settings.baseEntropy = lvl;\r\n            stateholder.setState((state) => Model.setEntropy(state, state.settings.baseEntropy));\r\n            return state;\r\n        });\r\n    };\r\n\r\n    setInteractionEntropy = (stateholder, lvl) => {\r\n        stateholder.setState((state) => {\r\n            state.settings.interactionEntropy = lvl;\r\n            return state;\r\n        });\r\n    };\r\n\r\n    setMouseMode = (stateholder, mm) => {\r\n        stateholder.setState((state) => {\r\n            state.settings.mouseMode = mm;\r\n            return state;\r\n        });\r\n    };\r\n\r\n    toggle3d = (stateholder, was3D) => {\r\n        stateholder.setState((state) => {\r\n            console.debug(\"set 3d mode\", state.settings.is3D);\r\n            if (state.settings.is3D == was3D) {\r\n                state.settings.is3D = !state.settings.is3D;\r\n            }\r\n            console.debug(\"set 3d mode\", state.settings.is3D);\r\n            return state;\r\n        });\r\n    };\r\n}\r\n","import \"./App.css\";\r\n\r\nimport Board from \"./View/Board\";\r\nimport { Component } from \"react\";\r\nimport Game from \"./Service/Facade\";\r\nimport React from \"react\";\r\n\r\nexport default class App extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.game = new Game();\r\n        this.state = this.game.getInitialState(this);\r\n    }\r\n\r\n    render() {\r\n        const handlers = this.game.getHandlers(this, this.state);\r\n        return <Board subscribe={this.subscribe} model={this.state} game={this.game} handlers={handlers} />;\r\n    }\r\n}\r\n","import \"./App.css\";\r\n\r\nimport App from \"./App\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <App />\r\n    </React.StrictMode>,\r\n    document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}