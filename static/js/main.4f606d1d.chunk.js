(this["webpackJsonpsolitaire-react"]=this["webpackJsonpsolitaire-react"]||[]).push([[0],{14:function(t,e,n){},16:function(t,e,n){},20:function(t,e,n){},21:function(t,e,n){},22:function(t,e,n){},25:function(t,e,n){},29:function(t,e,n){"use strict";n.r(e);var s=n(0),i=n(3),a=n(9),c=(n(20),n(21),n(2)),r=n(6),o=n(5),u=(n(22),n(1)),l=n.n(u),d={state:null,replaceContext:function(){},updateContext:function(){},updateGameContext:function(){},restart:function(){}},h=l.a.createContext(d),f=h.Provider,g=h,p=function(){var t=l.a.useContext(g),e=t.state,n=t.replaceContext,s=[];if(e.settings.launchSettings.isTouch)e&&e.dealer&&!e.dealer.isDealt&&n(e.dealer.dealAll(e));else{var i=function t(i){s.push(setTimeout((function(){e&&e.dealer&&!e.dealer.isDealt&&n(e.dealer.dealOne(i,t))}),35))};l.a.useEffect((function(){return i(e.dealer.dealt),function(){return s.forEach((function(t){return clearTimeout(t)}))}}),[])}return null},b=(n(14),function(){var t=l.a.useContext(g),e=t.state,n=t.restart;return e.game.isEnded?Object(s.jsxs)("div",{className:"ui center endscreen",children:[Object(s.jsx)("div",{className:"title",children:"\ud83e\udd73"}),Object(s.jsxs)("div",{className:"content",children:[Object(s.jsxs)("div",{children:["Time: ",e.game.getElapsed()]}),Object(s.jsxs)("div",{children:["Points: ",e.game.rating.points]}),Object(s.jsxs)("div",{children:["Time Penalty: ",e.game.rating.getTimePenalty(e.game.started,e.game.end||Date.now())]}),Object(s.jsxs)("div",{children:["Bonus Points: ",e.game.rating.getBonusPoints(e.game.started,e.game.end||Date.now())]}),Object(s.jsxs)("div",{children:["Total Points: ",e.game.rating.getTotal(e.game.started,e.game.end||Date.now())]}),Object(s.jsx)("div",{children:Object(s.jsxs)("button",{onClick:n,children:["\ud83d\uddd1\ufe0f",Object(s.jsx)("div",{children:"New Game"})]})})]})]}):null}),v=n(4),k=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this)).timeout=null,s.selector=t,s}return Object(v.a)(n,[{key:"componentDidUpdate",value:function(){var t=this;this.selector(this.context.state).blinkFor&&(this.timeout=setTimeout((function(){return t.context.updateGameContext((function(e){t.selector(e).unblink(e)}))}),200))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}}]),n}(u.Component);k.contextType=g;var j=function(t){var e=l.a.useContext(g),n=e.state,a=e.updateContext,c=l.a.useRef(null),r=n.focus.hasCard(t.model);l.a.useEffect((function(){r&&c&&c.current&&c.current.focus()}),[r]);var o=function(e){e.preventDefault();for(var n=0==e.clientX&&0==e.clientY,s=e.target;s&&!s.className.includes("card-base");)s=s.offsetParent;var a=s.getBoundingClientRect(),c={isKeyBoard:n,click:{x:e.clientX-s.ownerDocument.defaultView.pageXOffset,y:e.clientY-s.ownerDocument.defaultView.pageYOffset},element:{x:a.x,y:a.y}};t.onClick&&t.onClick(Object(i.a)({},t.model),c)},u=t.model.isHidden?"hidden card":t.model.type.icon+t.model.face+" card";return Object(s.jsx)("div",{style:t.onClick?{}:{pointerEvents:"none"},className:"stack-base",children:Object(s.jsx)("button",{onFocus:function(){a((function(e){e.navigator.update(t.model.source,t.model)}))},onBlur:function(){a((function(e){return e.focus.unsetCard(t.model)}))},style:function(){var e=Object(i.a)({zIndex:t.zIndex?t.zIndex:!!t.offsetTop+2,top:t.offsetTop?t.offsetTop/10+"vw":0},t.model.entropyStyle);return t.offsetLeft&&(e.left=4*t.offsetLeft+"vw"),t.onClick||(e.pointerEvents="none"),e}(),ref:c,className:function(){var e=t.isSuggested||t.model.suggestion,n="card card-base suit-".concat(t.model.type.icon);return n+=t.isSelected||e?"":" card-stack-".concat(t.model.source),n+=t.isSelected?" card-selected":"",n+=t.blink?" blink":"",n+=t.canClick?" clickable":"",n+=e?" card-suggested":"",n+=r?" card-focused":""}(),onClick:o||null,disabled:!t.model.canClick,tabIndex:t.model.canClick?0:-1,"aria-label":u,children:t.model.isHidden?Object(s.jsx)("div",{className:"card-back",children:"\xa0"}):Object(s.jsxs)("div",{className:"card-grid-container",children:[Object(s.jsx)("div",{children:Object(s.jsx)("div",{className:"align-center",children:t.model.type.icon})}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{className:"align-left",children:t.model.face})}),Object(s.jsx)("div",{children:"\xa0"}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{className:"align-center",children:t.model.type.icon})}),Object(s.jsx)("div",{className:"mainface",children:Object(s.jsx)("div",{className:"align-center",children:t.model.face})}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{className:"align-center",children:t.model.type.icon})}),Object(s.jsx)("div",{children:"\xa0"}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{className:"align-right",children:t.model.face})}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{className:"align-center",children:t.model.type.icon})})]})})})},m=n(8),O=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).onMouseMove=function(t){s.state.positionFixed&&s.setState((function(t){return t.positionFixed=!1,Object(i.a)({},t)})),s.updateDisplay(t)},s.myRef=l.a.createRef(),s.state={positionFixed:!0},s.onMouseMove=s.onMouseMove.bind(Object(m.a)(s)),s.onKeyDown=s.onKeyDown.bind(Object(m.a)(s)),s}return Object(v.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this.onMouseMove,!1),this.props.putBack&&document.addEventListener("keydown",this.onKeyDown,!1),this.setState((function(){return{positionFixed:!0}}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this.onMouseMove,!1),document.addEventListener("keydown",this.onKeyDown,!1)}},{key:"updateDisplay",value:function(t){if(!this.state.positionFixed){var e=this.myRef.current;if(this.props.hand&&this.props.parent==this.props.hand.source&&t){var n=t.clientX-this.props.hand.position.click.x+this.props.hand.position.element.x,s=t.clientY-this.props.hand.position.click.y+this.props.hand.position.element.y;e.style.top=s+"px",e.style.left=n+"px",e.style.position="absolute"}}}},{key:"onKeyDown",value:function(t){27==(window.event?event:t).keyCode&&this.props.hand&&this.props.parent==this.props.hand.source&&this.props.putBack(null,{isKeyboard:!1})}},{key:"render",value:function(){var t=this,e=function(e){return t.state.positionFixed?t.props.offsetTop+24*e:24*e};return this.props.hand&&this.props.parent===this.props.hand.source?Object(s.jsx)("div",{ref:this.myRef,children:this.props.hand&&this.props.hand.stack&&this.props.hand.stack.map((function(t,n){return Object(s.jsx)(j,{canClick:!0,model:t,offsetTop:e(n),zIndex:1e3+20*n,isSelected:!0},n)}))}):null}}]),n}(l.a.Component),x=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(){return Object(c.a)(this,n),e.apply(this,arguments)}return Object(v.a)(n,[{key:"render",value:function(){var t=this;return this.props.hand&&this.props.parent===this.props.hand.source?[this.props.hand&&this.props.hand.stack&&this.props.hand.stack.map((function(e,n){return Object(s.jsx)(j,{model:e,canClick:!0,offsetTop:t.props.offsetTop+24*n,offsetLeft:t.props.offsetLeft,zIndex:1e3+20*n,isSelected:!0,onClick:function(e,n){return t.props.onClick(e,n)}},n)}))]:null}}]),n}(l.a.Component),y=function(t){var e=l.a.useContext(g).state;if(!e.hand||t.parent!==e.hand.source)return null;var n=function(e,n){return t.onClick(t.stack[t.stack.length-1],n,t.stack.length-1)};return"follow-cursor"==e.settings.mouseMode?Object(s.jsx)(O,{parent:t.parent,hand:e.hand,offsetTop:t.offsetTop,putBack:n}):"remain-on-stack"==e.settings.mouseMode?Object(s.jsx)(x,{parent:t.parent,hand:e.hand,offsetTop:t.offsetTop,offsetLeft:t.offsetLeft,onClick:n}):null},w=function(t){var e="card-base socket",n=l.a.useRef(null),i=l.a.useContext(g),a=i.state,c=i.updateContext;l.a.useEffect((function(){a.focus.hasStack(t.parent)&&n&&n.current&&n.current.focus()})),t.visible?t.blink?e+=" socket-blink":a.focus.hasStack(t.parent)?e+=" socket-focused":e+=" socket-empty":e+=" socket-full",t.suggested&&(e+=" socket-suggested");return Object(s.jsx)("button",{onFocus:function(){c((function(e){e.navigator.update(t.parent)}))},onBlur:function(){c((function(e){return e.focus.unsetStack(t.parent)}))},ref:n,className:e,onClick:function(e){e.preventDefault();var n=0==e.clientX&&0==e.clientY;t.onClick(null,{isKeyBoard:n})},disabled:!t.visible,tabIndex:t.visible?0:-1,children:t.children})},C=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){return Object(c.a)(this,n),e.call(this,(function(e){return e.foundation.stacks[t.index]}))}return Object(v.a)(n,[{key:"render",value:function(){var t=this,e=this.props.model;return Object(s.jsxs)("div",{children:[Object(s.jsx)(w,{parent:e.source,suggested:e.suggestion&&!e.stack.length,blink:e.blinkFor,onClick:function(e,n){return t.props.onClick(null,n,t.props.index)},visible:!e.stack.length,children:Object(s.jsx)("div",{className:"align-center foundation-base suit-"+e.icon,children:e.icon})}),e.stack.map((function(n,i){return Object(s.jsx)(j,{model:n,blink:e.blinkFor,isSuggested:e.suggestion&&e.stack.length-1==i,onClick:function(e,n){return t.props.onClick(e,n,t.props.index)}},i)})),Object(s.jsx)(y,{parent:e.source,onClick:function(n,s){return t.props.onClick(e.stack[e.stack.length-1],s,t.props.index)},stack:e.stack})]},this.props.index)}}]),n}(k);C.Stacks=function(){var t=l.a.useContext(g),e=t.state,n=t.updateGameContext,i=function(t,s,i){return n(e.foundation.onClick(t,s,i))};return e.foundation.stacks.map((function(t,e){return Object(s.jsx)(C,{model:t,index:e,onClick:i},e)}))};var M={buttons:["A","B","X","Y","LB","RB","LT","RT","Back","Start","LS","RS","DPadUp","DPadDown","DPadLeft","DPadRight","Back","Start"],axis:["LeftStickX","-LeftStickY","RightStickX","-RightStickY"],buttonAxis:[null,null,null,null,null,null,"LeftTrigger","RightTrigger"]},S=n(13),T=n.n(S),E=function(){var t=l.a.useContext(g),e=t.state,n=t.updateContext,i={x:e.navigator.currentIndex.x,y:e.navigator.currentIndex.y,z:e.navigator.currentIndex.z},a=function(t){console.log(t),"DPadLeft"==t&&n((function(t){t.settings.mouseMode="remain-on-stack",t.focus.isKeyBoard(!0),t.navigator.moveLeft(i)})),"DPadRight"==t&&n((function(t){t.settings.mouseMode="remain-on-stack",t.focus.isKeyBoard(!0),t.navigator.moveRight(i)})),"DPadUp"==t&&n((function(t){t.settings.mouseMode="remain-on-stack",t.focus.isKeyBoard(!0),t.navigator.moveUp(i)})),"DPadDown"==t&&n((function(t){t.settings.mouseMode="remain-on-stack",t.focus.isKeyBoard(!0),t.navigator.moveDown(i)})),"A"==t&&document.activeElement.click()},c=function(t){console.debug("connected",t)},r=function(t){console.debug("disconnected",t)};return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(T.a,{layout:M,gamepadIndex:0,onButtonDown:a,onConnect:c,onDisconnect:r,children:Object(s.jsx)("span",{})}),Object(s.jsx)(T.a,{layout:M,gamepadIndex:1,onButtonDown:a,onConnect:c,onDisconnect:r,children:Object(s.jsx)("span",{})})]})},N=(n(25),function(){var t=l.a.useContext(g).state,e=l.a.useState(0),n=Object(a.a)(e,2),i=n[0],c=n[1];return l.a.useEffect((function(){var e=setInterval((function(){t.game.started&&c(t.game.getElapsed())}),1e3);return function(){return clearInterval(e)}}),[]),t.game.started&&i?Object(s.jsxs)("div",{className:"header-clock",children:[Object(s.jsx)("div",{className:"icon-container",children:"\ud83d\udd52"}),i]}):null}),P=function(){var t=l.a.useContext(g).restart;return Object(s.jsx)("div",{children:Object(s.jsx)("button",{title:"End Game",onClick:t,children:"\ud83d\uddd1\ufe0f"})})},D=function(){var t=l.a.useContext(g).state;return Object(s.jsx)("div",{className:"heart-container",children:function(){if("infinite"==t.settings.launchSettings.recyclingMode)return"\ud83d\udda4";if("1-pass"==t.settings.launchSettings.recyclingMode)return t.game.passes>0?"\u2764\ufe0f":"\ud83d\udc94";if("3-pass"==t.settings.launchSettings.recyclingMode){var e=function(t,e){return Array.from(new Array(t).keys()).map((function(){return e})).join("")};return e(t.stock.passes,"\u2764\ufe0f")+e(3-t.stock.passes,"\ud83d\udc94")}return null}()})},I=function(){var t=l.a.useContext(g),e=t.state,n=t.updateContext,i=function(t){return t.settings.suggestionMode.supportsHints||t.settings.suggestionMode.isTemporary},a=function(t){return t.settings.suggestionMode.isTemporary},c=function(){n((function(t){i(t)&&!a(t)&&t.settings.enableHint()}))},r=function(t){72==(window.event?event:t).keyCode&&c()};return i(e)&&!a(e)&&l.a.useEffect((function(){return document.addEventListener("keydown",r),function(){return document.removeEventListener("keydown",r)}}),[]),i(e)?Object(s.jsx)("div",{children:Object(s.jsx)("button",{title:"Hint",onClick:function(){return c()},disabled:a(e),children:"\ud83d\udca1"})}):null},H=function(){var t=l.a.useContext(g).state;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{className:"icon-container",children:"\ud83c\udfc6"})," ",t.game.rating.points]})},A=function(){var t=l.a.useContext(g),e=t.state,n=t.replaceContext;return Object(s.jsx)("div",{children:Object(s.jsx)("button",{title:"Restart",disabled:!e.game.timemachine.previousStates.length,onClick:function(){return n((function(t){return t.game.timemachine.previousStates?t.game.timemachine.previousStates[0]:null}))},children:"\u267b\ufe0f"})})},R=function(){var t=l.a.useContext(g),e=t.state,n=t.updateContext;return Object(s.jsx)("div",{children:Object(s.jsx)("button",{title:"Settings",onClick:function(){return t=e.settings.showMenu,void n((function(e){e.settings.showMenu==t&&(e.settings.showMenu=!e.settings.showMenu)}));var t},children:"\u2699\ufe0f"})})},F=function(){var t=l.a.useContext(g),e=t.state,n=t.replaceContext,i=function(){return n((function(t){var n=t.game.timemachine.popPreviousState(e.game.timemachine.previousStates.length-1,e);return n?(n.game.rating.penalize(t.game.rating),n):null}))},a=function(t){var e=window.event?event:t;90==e.keyCode&&e.ctrlKey&&i()};return l.a.useEffect((function(){return document.addEventListener("keydown",a),function(){return document.removeEventListener("keydown",a)}})),Object(s.jsx)("div",{children:Object(s.jsx)("button",{disabled:!e.game.timemachine.previousStates.length,title:"Undo (Penalty:"+Math.pow(2,e.game.rating.multiplicator)+")",onClick:i,children:"\u23ea"})})},L=function(){return Object(s.jsxs)("div",{className:"header",children:[Object(s.jsxs)("div",{className:"header-title",children:[Object(s.jsx)(D,{}),Object(s.jsx)(H,{})]}),Object(s.jsx)(N,{}),Object(s.jsxs)("div",{className:"header-buttons",children:[Object(s.jsx)(I,{}),Object(s.jsx)(F,{}),Object(s.jsx)(A,{}),Object(s.jsx)(P,{}),Object(s.jsx)(R,{})]})]})},B=(n(16),function(){var t=l.a.useContext(g),e=t.state,n=t.updateContext;return e.settings.showMenu?Object(s.jsxs)("div",{className:"ui right menu",children:[Object(s.jsx)("div",{className:"closer",children:Object(s.jsx)("button",{onClick:function(){return t=e.settings.showMenu,void n((function(e){e.settings.showMenu==t&&(e.settings.showMenu=!e.settings.showMenu)}));var t},children:"\ud83d\uddd9"})}),Object(s.jsx)("div",{className:"title",children:"Settings"}),Object(s.jsxs)("div",{className:"content",children:[Object(s.jsxs)("div",{className:"section",children:[Object(s.jsx)("div",{className:"title",children:"Suggestions"}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"label",children:"How much help - if any - should the game offer by displaying suggestions?"}),Object(s.jsx)("select",{onChange:function(t){return e=t.target.value,n((function(t){return t.settings.setSuggestionMode(e)}));var e},value:e.settings.suggestionMode.key,disabled:e.settings.launchSettings.hintPenalty,children:e.settings.suggestionModes.map((function(t){return Object(s.jsx)("option",{value:t.key,children:t.label},t.key)}))})]})]}),Object(s.jsxs)("div",{className:"section",children:[Object(s.jsx)("div",{className:"title",children:"Active Card"}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"label",children:"Should the selected card follow the cursor or remain on the stack?"}),Object(s.jsx)("select",{onChange:function(t){return e=t.target.value,n((function(t){return t.settings.mouseMode=e}));var e},value:e.settings.mouseMode,children:e.settings.mouseModes.map((function(t){return Object(s.jsx)("option",{value:t,children:t},t)}))})]})]}),Object(s.jsxs)("div",{className:"section",children:[Object(s.jsx)("div",{className:"title",children:"Base Entropy"}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"label",children:"How much chaos will the stacks on the board contain by themselves?"}),Object(s.jsx)("select",{onChange:function(t){return e=t.target.value,n((function(t){return t.setEntropy(e)}));var e},value:e.settings.baseEntropy,children:e.settings.entropyLevels.map((function(t,e){return Object(s.jsx)("option",{value:e,children:t},t)}))})]})]}),Object(s.jsxs)("div",{className:"section",children:[Object(s.jsx)("div",{className:"title",children:"Interaction Entropy"}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"label",children:"How much chaos will each interaction add to a stack on the board?"}),Object(s.jsx)("select",{onChange:function(t){return e=t.target.value,n((function(t){return t.settings.interactionEntropy=e}));var e},value:e.settings.interactionEntropy,children:e.settings.entropyLevels.map((function(t,e){return Object(s.jsx)("option",{value:e,children:t},t)}))})]})]})]})]}):null}),U=function(){var t=l.a.useContext(g),e=t.state,n=t.updateContext,s={x:e.navigator.currentIndex.x,y:e.navigator.currentIndex.y,z:e.navigator.currentIndex.z},i=function(t){var e=window.event?event:t;37==e.keyCode&&(n((function(t){t.settings.mouseMode="remain-on-stack",t.focus.isKeyBoard(!0),t.navigator.moveLeft(s)})),t.preventDefault()),39==e.keyCode&&(n((function(t){t.settings.mouseMode="remain-on-stack",t.focus.isKeyBoard(!0),t.navigator.moveRight(s)})),t.preventDefault()),38==e.keyCode&&(n((function(t){t.settings.mouseMode="remain-on-stack",t.focus.isKeyBoard(!0),t.navigator.moveUp(s)})),t.preventDefault()),40==e.keyCode&&(n((function(t){t.settings.mouseMode="remain-on-stack",t.focus.isKeyBoard(!0),t.navigator.moveDown(s)})),t.preventDefault())};return l.a.useEffect((function(){return document.addEventListener("keydown",i),function(){document.removeEventListener("keydown",i)}}),[s]),null},z=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(){return Object(c.a)(this,n),e.call(this,(function(t){return t.stock}))}return Object(v.a)(n,[{key:"render",value:function(){var t=this.context,e=t.state,n=t.updateGameContext,i=function(t,s,i){return n(e.stock.onClick(t,s,i))};return Object(s.jsxs)("div",{children:[Object(s.jsx)(w,{parent:e.stock.source,blink:e.stock.blinkFor,onClick:i,suggested:e.stock.suggestion&&!e.stock.stack.length,visible:!e.stock.stack.length}),e.stock.stack.map((function(t,n){return Object(s.jsx)(j,{model:t,offsetTop:n/2*-1,blink:e.stock.blinkFor,isSuggested:e.stock.suggestion&&n==e.stock.stack.length-1,onClick:i},n)}))]})}}]),n}(k),q=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){return Object(c.a)(this,n),e.call(this,(function(e){return e.tableau.stacks[t.index]}))}return Object(v.a)(n,[{key:"render",value:function(){var t=this.props,e=function(e){for(var n=0;n<=e;n++)if(t.model.stack[n]&&!t.model.stack[n].isHidden)return 12*n+24*(e-n);return 12*e};return Object(s.jsxs)("div",{children:[Object(s.jsx)(w,{parent:t.model.source,suggested:t.model.suggestion&&!t.model.stack.length,blink:t.model.blinkFor,onClick:function(e,n){return t.onClick(null,n,t.index)},visible:!t.model.stack.length}),t.model.stack.map((function(n,i){return Object(s.jsx)(j,{model:n,blink:t.model.blinkFor,isSuggested:t.model.suggestion&&t.model.stack.length-1==i,offsetTop:e(i),onClick:function(e,n){return t.onClick(e,n,t.index)}},i)})),Object(s.jsx)(y,{parent:"tableau-"+t.index,onClick:function(e,n){return t.onClick(e,n,t.index)},stack:t.model.stack,offsetTop:e(t.model.stack.length)})]})}}]),n}(k);q.Stacks=function(){var t=l.a.useContext(g),e=t.state,n=t.updateGameContext,i=function(t,s,i){return n(e.tableau.onClick(t,s,i))};return e.tableau.stacks.map((function(t,n){return Object(s.jsx)(q,{index:n,model:t,parent:e.tableau,onClick:i},n)}))};var K=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(){return Object(c.a)(this,n),e.call(this,(function(t){return t.waste}))}return Object(v.a)(n,[{key:"render",value:function(){var t=this.context,e=t.state,n=t.updateGameContext,i=function(t,s,i){return n(e.waste.onClick(t,s,i))},a=function(t){if("single"==e.settings.launchSettings.drawMode)return 0;var n="remain-on-stack"==e.waste.settings.mouseMode&&e.hand.isHoldingCard()&&e.hand.isFromWaste()?e.waste.stack.length+1:e.waste.stack.length,s=2;return 2==n&&(s=1),1==n&&(s=0),(t-n-2)%3+s};return Object(s.jsxs)("div",{children:[Object(s.jsx)(w,{parent:e.waste.source,blink:e.waste.blinkFor,onClick:function(t,e){return i(null,e)},suggested:e.waste.suggestion&&!e.waste.stack.length,visible:!e.waste.stack.length}),e.waste.stack.map((function(t,n){return Object(s.jsx)(j,{model:t,offsetTop:n/2*-1,offsetLeft:a(n),blink:e.waste.blinkFor,isSuggested:e.waste.suggestion&&n==e.waste.stack.length-1,onClick:function(t,e){return i(t,e)}},n)})),Object(s.jsx)(y,{offsetTop:e.waste.stack.length/2*-1,offsetLeft:a(e.waste.stack.length),parent:"waste",onClick:i,stack:e.waste.stack})]})}}]),n}(k),G=function(){return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{className:"layout-grid-container",children:[Object(s.jsx)(L,{}),Object(s.jsxs)("div",{className:"board-grid-container",children:[Object(s.jsx)(z,{}),Object(s.jsx)(K,{}),Object(s.jsx)("div",{className:"spacer",children:"\xa0"}),Object(s.jsx)(C.Stacks,{}),Object(s.jsx)(q.Stacks,{})]})]}),Object(s.jsx)(B,{}),Object(s.jsx)(b,{}),Object(s.jsx)(p,{}),Object(s.jsx)(U,{}),Object(s.jsx)(E,{})]})},W=function t(){var e=this;Object(c.a)(this,t),this.dealt=void 0,this.dealingAt=void 0,this.isDealt=void 0,this.dealOne=function(t,e){return function(n){return t!=n.dealer.dealt?null:(n.dealer.deal(n.stock,n.tableau),n.dealer.isDealt&&(n.game.started=Date.now()),n.dealer.isDealt||e(n.dealer.dealt),n)}},this.dealAll=function(){return function(t){if(e.dealt!=t.dealer.dealt)return null;for(;!t.dealer.isDealt;)t.dealer.deal(t.stock,t.tableau);return t.game.started=Date.now(),t}},this.deal=function(t,n){for(var s=e.dealingAt;s<n.stacks.length;s++){var i=n.stacks[s].stack;if(i.length<=n.stacks.length-s-1){var a=t.popOne();return a.source=n.stacks[s].source,i.length==n.stacks.length-1-s&&(a.isHidden=!1),n.deal(a,s),e.dealt++,e.dealingAt++,e.dealingAt==n.stacks.length&&(e.dealingAt=0),void(e.isDealt=!1)}var c=0==e.dealingAt;return e.dealingAt=0,void(e.isDealt=c)}e.isDealt=!0},this.dealt=0,this.dealingAt=0,this.isDealt=!1},Y=function t(e){var n=this;Object(c.a)(this,t),this.clickHandler=void 0,this.getHandler=function(t){return t&&t.isHoldingCard()?n.dispatchPutDown:n.dispatchPickup},this.dispatchPutDown=function(t,e,s){return function(i){i.hand.isHoldingCard()&&(i.focus.isKeyBoard(e.isKeyBoard),n.clickHandler.dispatchPutDown(t,e,i,s))}},this.dispatchPickup=function(t,e,s){return function(i){i.hand.isHoldingCard()||(i.focus.isKeyBoard(e.isKeyBoard),n.clickHandler.dispatchPickup(t,e,i,s))}},this.clickHandler=e},X=function t(){var e=this;Object(c.a)(this,t),this.startBlink=function(t,n){t(n).blinkFor<10&&(t(n).blinkFor=10,n.game.registerBlink(!0),t(n).unblink=function(n){return e.stopBlink(t,n)})},this.stopBlink=function(t,e){t(e).blinkFor=0,e.game.registerBlink(!1)}},V=function(){function t(){var e=this;Object(c.a)(this,t),this.blink=function(t,e){return(new X).startBlink((function(t){return t.foundation.stacks[e]}),t)},this.dispatchPutDown=function(t,n,s,i){if(s.foundation.wouldAccept(i,s.hand)){var a=s.hand.source;s.foundation.add(i,s.hand.putDown())&&s.game.registerMove("foundation-"+i,a),e.tryDetectEnd(s)}else e.blink(s,i)},this.dispatchPickup=function(t,n,s,i){var a=s.foundation.getTop(i);a&&s.foundation.getPreviousUsed(i)===a.face?s.hand.pickUp([s.foundation.remove(i,a)],a.source,n)&&s.game.registerPickup():e.blink(s,i)}}return Object(v.a)(t,[{key:"tryDetectEnd",value:function(t){52===t.foundation.countCards()&&(t.game.isEnded=!0,t.game.end=Date.now())}}]),t}(),J=n(7),Q=function(){function t(e,n,s){var i=this;Object(c.a)(this,t),this.causeEntropy=function(t){var e=2*t,n=function(){return Math.random()<.5},s=function(t,e){return Math.random()*(e-t)+t};n()&&(n()?i.entropyStyle.left=s(0,e/20)+"vw":i.entropyStyle.right=s(0,e/20)+"vw"),i.entropyStyle.transform="rotate("+s(-1*e,e)+"deg)"},this.equals=function(e){return t.equals(i,e)},this.face=e,this.type=n,this.isHidden=s,this.entropyStyle={},this.source="",this.suggestion=!1}return Object(v.a)(t,null,[{key:"equals",value:function(t,e){return!t&&!e||t&&e&&e.face==t.face&&e.type.icon==t.type.icon}}]),t}();Q.copy=function(t){var e=new Q(t.face,t.type,t.isHidden);return e.source=t.source,e.entropyStyle=Object(i.a)({},t.entropyStyle),e.canClick=t.canClick,e},Q.copyAll=function(t){return t.map((function(t){return Q.copy(t)}))};var Z=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],_={heart:{icon:"\u2665",color:"red"},club:{icon:"\u2663",color:"black"},diamond:{icon:"\u2666",color:"red"},spade:{icon:"\u2660",color:"black"}},$=function(){function t(){Object(c.a)(this,t);var e=Object.keys(_);this.cards=Z.map((function(t){return Object(J.a)(e.map((function(e){return new Q(t,_[e],!0)})))})).flat().reverse()}return Object(v.a)(t,[{key:"shuffle",value:function(){return this.shuffleArray(this.cards),this}},{key:"shuffleArray",value:function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),s=[t[n],t[e]];t[e]=s[0],t[n]=s[1]}}}]),t}(),tt=function t(e){var n=this;Object(c.a)(this,t),this.validSettings=function(){return"follow-cursor"!==n.settings.mouseMode},this.isKeyBoard=function(t){n.keyboard=t},this.setCard=function(t){n.card=t,n.stack=null},this.unsetCard=function(t){n.card&&t&&Q.equals(n.card,t)&&(n.card=null)},this.unsetStack=function(t){n.stack&&t&&n.stack==t&&(n.stack=null)},this.setStack=function(t){n.card=null,n.stack=t},this.hasCard=function(t){return n.keyboard&&n.validSettings()&&n.card&&t&&Q.equals(n.card,t)},this.hasStack=function(t){return n.keyboard&&n.validSettings()&&n.stack&&t&&n.stack==t},this.settings=e,this.card=null,this.stack=null,this.keyboard=!1},et=function t(e){var n=this;Object(c.a)(this,t),this.stack=[],this.getTop=function(){return n.stack&&n.stack.length&&n.stack[n.stack.length-1]},this.suggestion=!1,this.getClickable=function(){return n.stack.filter((function(t){return t.canClick}))},this.source=e},nt=function t(e){var n=this;Object(c.a)(this,t),this.getCurrentAccepted=function(t){var e=n.stacks[t].acceptedCards;return e[e.length-1]},this.wouldAccept=function(t,e){return!e.hasMoreThanOneCard()&&n.accepts(t,e.currentCard())},this.accepts=function(t,e){var s=n.getCurrentAccepted(t);return n.stacks[t].icon==e.type.icon&&s==e.face},this.add=function(t,e){var s=e[0];return s.causeEntropy(Math.min(n.settings.interactionEntropy,3)),s.source=n.stacks[t].source,s.suggestion=!1,n.stacks[t].stack.push(s),n.stacks[t].usedCards.push(n.stacks[t].acceptedCards.pop())},this.remove=function(t,e){return n.stacks[t].acceptedCards.push(n.stacks[t].usedCards.pop()),e&&e.equals(n.getTop(t))&&n.stacks[t].stack.pop()},this.getPreviousUsed=function(t){return Object(J.a)(n.stacks[t].usedCards).pop()},this.countCards=function(){return n.stacks.map((function(t){return parseInt(t.stack.length)})).reduce((function(t,e){return t+e}),0)},this.getTop=function(t){return n.stacks[t].stack[n.stacks[t].stack.length-1]},this.setEntropy=function(t){return n.stacks.forEach((function(e){return e.stack.forEach((function(e){return e.causeEntropy(Math.min(3,t))}))})),n},this.settings=e;var s=function(t){var e=new et("foundation-"+t);return e.stack=[],e.acceptedCards=Object(J.a)(["A"].concat(Object(J.a)(Z.slice(0,Z.length-1))).reverse()),e.usedCards=[],e.icon=null,e.color=null,e.blinkFor=0,e},a=Object.keys(_).map((function(t){return _[t]})).map((function(t,e){return Object(i.a)(Object(i.a)({},s(e)),t)}));this.stacks=Object(J.a)(a),this.onClick=function(t,e,n){},this.blinkFor=0,this.unblink=function(){},this.suggestion=!1};nt.copy=function(t){var e=new nt(t.settings);return e.stacks=t.stacks.map((function(t){var e=new et(t.source);return e.stack=Q.copyAll(t.stack),e.acceptedCards=Object(J.a)(t.acceptedCards),e.usedCards=Object(J.a)(t.usedCards),e.icon=t.icon,e.color=t.color,e})),e};var st=function(){function t(e){var n=this;Object(c.a)(this,t),this.registerMove=function(t,e){var s={source:e,target:t};n.points+=n.rateMove(s)},this.registerRecycle=function(){"single"==n.settings.launchSettings.drawMode&&"infinite"==n.settings.launchSettings.recyclingMode&&(n.points>0&&(n.points<100?n.points=0:n.points-=100),console.debug("RATING: subtract (max) 100 points for RECYCLE"))},this.registerUncover=function(){n.points+=5,console.debug("RATING: add 5 points for UNCOVER")},this.penalize=function(t){if(n.settings.launchSettings.undoPenalty){var e=Math.pow(2,t.multiplicator);console.debug("RATING: applying penalty of ".concat(e," points for UNDO")),n.points=Math.min(n.points,t.points)-e,n.multiplicator=t.multiplicator+1}},this.registerHint=function(t){t&&n.settings.launchSettings.hintPenalty&&(n.points-=10,console.debug("RATING: applying penalty of 10 points for HINT"))},this.getTimePenalty=function(t,e){var n=(e-t)/1e3;return-2*Math.trunc(n/5)},this.getBonusPoints=function(t,e){var n=(e-t)/1e3;return n<30?0:Math.round(2e4/n*35)},this.getTotal=function(t,e){return n.points+n.getBonusPoints(t,e)-n.getTimePenalty(t,e)},this.settings=e,this.points=0,this.multiplicator=1}return Object(v.a)(t,[{key:"registerBlink",value:function(t){t&&this.settings.launchSettings.missPenalty&&(this.points-=10,console.debug("RATING: subtract 10 points for invalid action"))}},{key:"rateMove",value:function(t){var e=function(t){return"tableau"==t.substr(0,7)},n=function(t){return"foundation"==t.substr(0,10)};if(e(t.source)){if(n(t.target))return console.debug("RATING: add 10 points for MOVE tableau -> foundation"),10}else if("waste"==t.source){if(n(t.target))return console.debug("RATING: add 10 points for MOVE waste -> foundation"),10;if(e(t.target))return console.debug("RATING: add 5 points for MOVE waste -> tableau"),5}else if(n(t.source)&&e(t.target))return console.debug("RATING: subtract 15 points for MOVE foundation -> tableau"),-15;return 0}}]),t}();st.copy=function(t){var e=new st(t.settings);return e.points=t.points,e.multiplicator=t.multiplicator,e};var it=function(){function t(){var e=this;Object(c.a)(this,t),this.registerMove=function(t,n){e.memorable=!0,e.modified=!0,n==t&&(e.memorable=!1)},this.pushPreviousState=function(t){var n=e.previousStates[e.previousStates.length-1];n&&e.modelEquals(t,n)||e.previousStates.push(t)},this.registerPickup=function(){e.modified=!0,e.memorable=!1},this.popPreviousState=function(t,n){for(var s=e.previousStates.length-1==t,i=function(){return s&&e.previousStates&&e.previousStates.pop()},a=i();a&&(!a.game.timemachine.memorable||e.modelEquals(a,n))&&e.previousStates.length;)a=i();return a},this.registerRecycle=function(){e.memorable=!0,e.modified=!0},this.registerUncover=function(){return e.memorable=!0,e.modified=!0,!0},this.stackEquals=function(t,e){return t.stack.every((function(t,n){return Q.equals(t,e.stack[n])&&t.isHidden==e.stack[n].isHidden}))},this.stacksEqual=function(t,n){return t.stacks.every((function(t,s){return e.stackEquals(t,n.stacks[s])}))},this.modelEquals=function(t,n){return e.stackEquals(t.stock,n.stock)&&e.stackEquals(t.waste,n.waste)&&e.stacksEqual(t.tableau,n.tableau)&&e.stacksEqual(t.foundation,n.foundation)},this.previousStates=[],this.memorable=!0,this.modified=!1}return Object(v.a)(t,[{key:"registerBlink",value:function(){this.modified=!0,this.memorable=!1}}]),t}();it.copy=function(t){var e=new it;return e.previousStates=Object(J.a)(t.previousStates),e.memorable=t.memorable,e.modified=t.modified,e};var at=function(){function t(e){var n=this;Object(c.a)(this,t),this.registerMove=function(t,e){return n.rating.registerHint(n.settings.disableHint()),n.rating.registerMove(t,e),n.timemachine.registerMove(t,e),!0},this.registerPickup=function(){return n.timemachine.registerPickup(),!0},this.registerRecycle=function(){return n.rating.registerHint(n.settings.disableHint()),n.rating.registerRecycle(),n.timemachine.registerRecycle(),!0},this.registerUncover=function(){return n.rating.registerHint(n.settings.disableHint()),n.rating.registerUncover(),n.timemachine.registerUncover(),!0},this.getElapsed=function(){var t=function(t){return 1==(t+"").length?"0"+t:t},e=(n.end||Date.now())-n.started,s=Math.floor(e/1e3/60/60);e-=1e3*s*60*60;var i=Math.floor(e/1e3/60);e-=1e3*i*60;var a=Math.floor(e/1e3);return e-=1e3*a,s?s+":"+t(i)+":"+t(a):t(i)+":"+t(a)},this.settings=e,this.rating=new st(e),this.timemachine=new it,this.started=0,this.isEnded=!1,this.end=0}return Object(v.a)(t,[{key:"registerBlink",value:function(t){return this.rating.registerBlink(t),this.timemachine.registerBlink(t),!0}}]),t}();at.copy=function(t){var e=new at(t.settings);return e.started=t.started,e.timemachine=it.copy(t.timemachine),e.rating=st.copy(t.rating),e};var ct=function t(e){var n=this;Object(c.a)(this,t),this.pickUp=function(t,e,s){return t&&t[0]&&(n.stack=t.map((function(t){return t.suggestion=!1,t})),n.source=e,n.position=s),t},this.putDown=function(){n.source=null;var t=n.stack.splice(0,n.stack.length);return t.length&&n.focus.setCard(t[t.length-1]),t},this.isHoldingCard=function(){return!!n.stack.length},this.isHoldingKing=function(){return n.isHoldingCard()&&"K"==n.currentCard().face},this.currentCard=function(){return n.isHoldingCard()&&n.stack[0]},this.hasMoreThanOneCard=function(){return n.stack.length>1},this.isFromCurrentSource=function(t){return n.source&&t.source==n.source},this.isFromWaste=function(){return n.source&&"waste"==n.source},this.isFromFoundation=function(t){return n.source&&n.source=="foundation-".concat(t)},this.isFromTableau=function(t){return n.source&&n.source=="tableau-".concat(t)},this.isFromAnyTableau=function(){return n.source&&"tableau-"==n.source.substring(0,8)},this.getTableauIndex=function(){return n.source&&n.source.substring(8)},this.focus=e,this.stack=[],this.source=null,this.position=null};ct.copy=function(t){var e=new ct(t.focus);return e.stack=Q.copyAll(t.stack),e.source=t.source,e.position=t.position,e};var rt=function t(e,n){Object(c.a)(this,t),this.key=void 0,this.label=void 0,this.isTemporary=void 0,this.supportsHints=void 0,this.next=void 0,this.key=e,this.label=n.label,this.isTemporary=!!n.isTemporary,this.supportsHints=!!n.supportsHints,this.next=n.next},ot=function t(){Object(c.a)(this,t)};ot.NONE="NONE",ot.SCORED="SCORED",ot.REGULAR="REGULAR",ot.FULL="FULL",ot.ONCE="ONCE",ot.TWICE="TWICE",ot.raw={NONE:{label:"None",supportsHints:!0},SCORED:{label:"Scored"},REGULAR:{label:"Regular"},FULL:{label:"Full"},ONCE:{label:"Single Action",isTemporary:!0,next:"NONE"}},ot.get=function(t){return new rt(t,ot.raw[t])},ot.all=function(){return Object.keys(ot.raw).map(ot.get)},ot.allSuggestionModes=function(){return ot.all().filter((function(t){return!t.isTemporary}))},ot.default=function(){return ot.get(ot.REGULAR)},ot.getHintMode=function(){return ot.get(ot.ONCE)};var ut=function t(e){var n=this;Object(c.a)(this,t),this.setSuggestionMode=function(t){n.suggestionMode.key!==t&&(n.suggestionMode=ot.get(t))},this.enableHint=function(){n.suggestionMode=ot.getHintMode()},this.disableHint=function(){return!(!n.suggestionMode.isTemporary||!n.suggestionMode.next)&&(n.suggestionMode=ot.get(n.suggestionMode.next),!0)},this.launchSettings=e;var s=e.isTouch;this.mouseModes=["follow-cursor","remain-on-stack"],this.mouseMode=s?"remain-on-stack":"follow-cursor",this.entropyLevels=["none","low","regular","high","extreme"],this.baseEntropy=s?1:2,this.interactionEntropy=s?1:2,this.suggestionModes=ot.allSuggestionModes(),this.suggestionMode=ot.default()};ut.copy=function(t){var e=new ut(t.launchSettings);return e.suggestionMode=t.suggestionMode,e.mouseMode=t.mouseMode,e.baseEntropy=t.baseEntropy,e.interactionEntropy=t.interactionEntropy,e.hintMode=t.hintMode,e};var lt=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t,s,i){var a;return Object(c.a)(this,n),(a=e.call(this,"stock")).setClickability=function(){return a.getTop()&&(a.getTop().canClick=!0),!0},a.popOne=function(){var t=a.stack.pop();return a.setClickability(),t},a.recycle=function(t){return!!t.length&&(a.stack=t.reverse().map(a.setCardProperties),a.setClickability(),a.recyclings++,a.focus.setCard(a.getTop()),!0)},a.setCardProperties=function(t){return t.causeEntropy(Math.min(a.settings.interactionEntropy,1)),t.isHidden=!0,t.source=a.source,t.canClick=!1,t},a.isOnTop=function(t){return t&&t.equals(a.getTop())},a.popTop=function(){var t=[];return"single"==a.settings.launchSettings.drawMode&&(t=[a.stack.pop()]),"triple"==a.settings.launchSettings.drawMode&&(t=a.stack.splice(a.stack.length-3)),0==a.stack.length&&a.passes--,a.stack.length?a.focus.setCard(a.getTop()):a.focus.setStack("stock"),a.setClickability(),t},a.setEntropy=function(t){return a.stack.forEach((function(e){return e.causeEntropy(Math.min(t,1))})),Object(m.a)(a)},a.settings=s,a.focus=i,a.stack=t.map(a.setCardProperties),a.setClickability(),a.recyclings=0,a.passes=-1,a.onClick=function(t,e,n){},a.blinkFor=0,a.unblink=function(){},"1-pass"==a.settings.launchSettings.recyclingMode&&(a.passes=1),"3-pass"==a.settings.launchSettings.recyclingMode&&(a.passes=3),a}return Object(v.a)(n,[{key:"canRecycle",value:function(){return"infinite"==this.settings.launchSettings.recyclingMode||"3-pass"==this.settings.launchSettings.recyclingMode&&this.recyclings<2}}]),n}(et);lt.copy=function(t){var e=new lt([],t.settings,t.focus);return e.stack=Q.copyAll(t.stack),e.dealt=t.dealt,e.dealingAt=t.dealingAt,e.isDealt=t.isDealt,e.passes=t.passes,e.recyclings=t.recyclings,e};var dt=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(){var t;Object(c.a)(this,n);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))).blinkFor=0,t.id=0,t}return n}(et),ht=function t(e,n){var s=this;Object(c.a)(this,t),this.stacks=void 0,this.settings=void 0,this.onClick=void 0,this.focus=void 0,this.getStack=function(t){return s.stacks[t]},this.wouldAccept=function(t,e){return s.canPutDown(s.getTop(t),e,t)},this.canPutDown=function(t,e,n){return t&&t.isHidden&&e.isFromCurrentSource(t)||s.accepts(n,e.currentCard())||!t&&e.isFromTableau(n)},this.accepts=function(t,e){var n=s.getTop(t);if(!n)return e&&"K"===e.face;if(n.isHidden)return!1;var i=Object(J.a)([].concat(Z));return i.indexOf(e.face)+1==i.indexOf(n.face)&&e.type.color!==n.type.color&&"A"!==n.face},this.getCard=function(t,e){for(var n=0;n<s.stacks[t].stack.length;n++)if(e&&e.equals(s.stacks[t].stack[n])&&e.isHidden===s.stacks[t].stack[n].isHidden)return s.stacks[t].stack[n];return!1},this.popWithFollowing=function(t,e){for(var n=0;n<s.stacks[e].stack.length;n++)if(t&&t.equals(s.stacks[e].stack[n])){var i=s.stacks[e].stack.splice(n,s.stacks[e].stack.length);return s.stackEntropy(e),s.setClickability(e),i}return[]},this.deal=function(t,e){s.stacks[e].stack.push(t),s.setClickability(e)},this.canUncover=function(t,e){return s.getTop(t).isHidden&&e&&e.equals(s.getTop(t))},this.uncover=function(t,e){var n=s.getTop(t);return!!s.canUncover(t,e)&&(n.isHidden=!1,s.focus.setCard(n),s.stackEntropy(t),s.setClickability(t),!0)},this.stackEntropy=function(t){for(var e=s.settings.interactionEntropy,n=1,i=s.getTop(t);e&&0!=e&&i;)i.causeEntropy(e),e--,i=s.getTop(t,n),n++},this.setClickability=function(t){s.stacks[t].stack.forEach((function(e){e.canClick=!e.isHidden||s.canUncover(t,e)}))},this.add=function(t,e){return s.stacks[t].stack=s.stacks[t].stack.concat(e.map((function(e){return s.setCardProperties(e,t)}))),s.stackEntropy(t),s.setClickability(t),e},this.setCardProperties=function(t,e){return t.source=s.stacks[e].source,t},this.getTop=function(t,e){return s.stacks[t].stack[s.stacks[t].stack.length-1-(e||0)]},this.setEntropy=function(t){return s.stacks.forEach((function(e){return e.stack.forEach((function(e){return e.causeEntropy(Math.min(t,4))}))})),s},this.focus=n;this.stacks=[0,1,2,3,4,5,6].map((function(t){var e=new dt("tableau-"+t);return e.stack=[],e.blinkFor=0,e.id=t,e})),this.settings=e,this.onClick=function(){}};ht.copy=function(t){var e=new ht(t.settings,t.focus);return e.stacks=t.stacks.map((function(t,e){var n=new dt(t.source);return n.id=e,n.stack=Q.copyAll(t.stack),n})),e};var ft=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,"waste")).tryPutDown=function(t){return s.canAdd(t)&&(s.add(t)||!0)},s.add=function(t){return t&&s.stack.push(s.setCardProperties(t))},s.setClickability=function(t){return s.stack.forEach((function(t){t.canClick=!1})),s.getTop()&&(s.getTop().canClick=!0),t},s.addAll=function(t){return t&&t.length&&t.map(s.add)&&s.setClickability(1)},s.setCardProperties=function(t){return t.source=s.source,t.isHidden=!1,t.causeEntropy(Math.min(s.settings.interactionEntropy,1)),t.canClick=!1,t},s.wouldAccept=function(t){return t.isFromWaste()&&s.canAdd(t.currentCard())},s.canAdd=function(t){return t&&(!s.getTop()||!t.equals(s.getTop()))},s.popTop=function(t){return t&&t.equals(s.getTop())&&s.setClickability(s.stack.pop())},s.recycle=function(){return s.stack.splice(0,s.stack.length)},s.setEntropy=function(t){return s.stack.forEach((function(e){return e.causeEntropy(Math.min(t,1))})),Object(m.a)(s)},s.settings=t,s.onClick=function(t,e,n){},s.blinkFor=0,s.unblink=function(){},s}return n}(et);ft.copy=function(t){var e=new ft(t.settings);return e.stack=Q.copyAll(t.stack),e};var gt=function t(e){Object(c.a)(this,t),this.stock=void 0,this.waste=void 0,this.foundation=void 0,this.tableau=void 0,this.hand=void 0,this.game=void 0,this.settings=void 0,this.focus=void 0,this.stock=e.stock,this.waste=e.waste,this.foundation=e.foundation,this.tableau=e.tableau,this.hand=e.hand,this.game=e.game,this.settings=e.settings,this.focus=e.focus};gt.getInitialState=function(t){var e=(new $).shuffle(),n=new ut(t),s=new tt(n);return{stock:new lt(Object(J.a)(e.cards),n,s),waste:new ft(n),foundation:new nt(n),tableau:new ht(n,s),hand:new ct(s),game:new at(n),settings:n,focus:s}},gt.copy=function(t){return{stock:lt.copy(t.stock),waste:ft.copy(t.waste),foundation:nt.copy(t.foundation),tableau:ht.copy(t.tableau),hand:ct.copy(t.hand),game:at.copy(t.game),settings:ut.copy(t.settings),focus:t.focus}};var pt=function t(e){var n=this;Object(c.a)(this,t),this.model=void 0,this.currentIndex=void 0,this.rows=void 0,this.getZindex=function(t,e){for(var n=t.getClickable(),s=0;s<n.length;s++)if(Q.equals(e,n[s]))return s;return 0},this.update=function(t,e){for(var s=0;s<n.rows.length;s++)for(var i=n.rows[s],a=0;a<i.length;a++){var c=i[a];if(c&&c.source==t){var r=n.getZindex(c,e);return n.currentIndex={x:a,y:s,z:r},void n.finishNav()}}},this.valid=function(t){return t.x===n.currentIndex.x&&t.y===n.currentIndex.y&&t.z===n.currentIndex.z},this.moveLeft=function(t){return n.move(t,(function(){n.currentIndex.x--,-1==n.currentIndex.x&&(n.currentIndex.x=6)}))},this.moveRight=function(t){return n.move(t,(function(){n.currentIndex.x++,7==n.currentIndex.x&&(n.currentIndex.x=0)}))},this.move=function(t,e){n.valid(t)&&(e(),void 0==n.current()?n.move(n.currentIndex,e):(n.currentIndex.z=n.current().getClickable().length-1,n.finishNav()))},this.moveUp=function(t){n.valid(t)&&(n.current().getClickable().length&&n.currentIndex.z>0?(n.currentIndex.z--,n.finishNav()):n.toggleRow(!0))},this.moveDown=function(t){if(n.valid(t)){var e=n.current().getClickable();e.length&&n.currentIndex.z<e.length-1?(n.currentIndex.z++,n.finishNav()):n.toggleRow(!1)}},this.toggleRow=function(t){0==n.currentIndex.y?n.currentIndex.y=1:n.currentIndex.y=0;var e=n.current()?n.current().getClickable().length-1:0;n.currentIndex.z=t?e:0,void 0==n.current()?n.moveLeft(n.currentIndex):n.finishNav()},this.finishNav=function(){var t=n.current().getClickable();t&&t[n.currentIndex.z]?n.model.focus.setCard(t[n.currentIndex.z]):n.model.focus.setStack(n.current().source)},this.current=function(){return n.rows[n.currentIndex.y][n.currentIndex.x]},this.model=e,this.currentIndex={x:0,y:0,z:0},this.rows=[[this.model.stock,this.model.waste,void 0].concat(Object(J.a)(this.model.foundation.stacks)),Object(J.a)(this.model.tableau.stacks)]},bt=function t(){var e=this;Object(c.a)(this,t),this.blink=function(t){return(new X).startBlink((function(t){return t.stock}),t)},this.dispatchPutDown=function(t,n,s){return e.blink(s,0)},this.dispatchPickup=function(t,n,s){return null!=t?e.moveToWaste(t,s):e.recycleWaste(t,s)},this.moveToWaste=function(t,e){return e.stock.isOnTop(t)&&e.waste.addAll(e.stock.popTop())&&e.game.registerMove("waste","stock")},this.recycleWaste=function(t,n){if(!n.stock.getTop())return!!n.waste.getTop()&&n.stock.canRecycle()&&n.stock.recycle(n.waste.recycle())&&n.game.registerRecycle()||e.blink(n,0)}},vt=function t(){var e=this;Object(c.a)(this,t),this.blink=function(t,e){return(new X).startBlink((function(t){return t.tableau.stacks[e]}),t)},this.dispatchPutDown=function(t,n,s,i){if(s.tableau.wouldAccept(i,s.hand)){var a=s.hand.source;s.tableau.add(i,s.hand.putDown())&&s.game.registerMove("tableau-"+i,a)}else e.blink(s,i)},this.dispatchPickup=function(t,n,s,i){!t||e.tryUncover(t,i,s)||t.isHidden?t||e.blink(s,i):s.hand.pickUp(s.tableau.popWithFollowing(t,i),t.source,n)&&s.game.registerPickup()},this.tryUncover=function(t,e,n){return!n.hand.isHoldingCard()&&t.isHidden&&n.tableau.uncover(e,t)&&n.game.registerUncover()}},kt=function t(){var e=this;Object(c.a)(this,t),this.blink=function(t){return(new X).startBlink((function(t){return t.waste}),t)},this.dispatchPutDown=function(t,n,s){return s.waste.wouldAccept(s.hand)&&s.waste.tryPutDown(s.hand.currentCard())&&s.hand.putDown()&&s.game.registerMove("waste","waste")||e.blink(s,0)},this.dispatchPickup=function(t,n,s){return t&&s.hand.pickUp([s.waste.popTop(t)],"waste",n)&&s.game.registerPickup()||e.blink(s,0)}},jt=function t(){var e=this;Object(c.a)(this,t),this.tableau=void 0,this.waste=void 0,this.evaluateOptions=function(t){e.disableAllSuggestions(t),t.settings.suggestionMode.key===ot.NONE||e.getUncoverOptions(t)||e.getPutdownSuggestions(t)||t.hand.isHoldingCard()||e.getPickupOptions(t)&&t.settings.suggestionMode.key!=ot.FULL||!t.stock.getTop()&&!t.stock.canRecycle()||t.settings.suggestionMode.key===ot.SCORED||(t.stock.suggestion=!0)},this.getPutdownSuggestions=function(t,e){if(!t.hand.isHoldingCard()||t.settings.suggestionMode.key==ot.NONE)return 0;var n=[];if(t.waste.wouldAccept(t.hand)&&(t.settings.suggestionMode.key===ot.FULL||!t.hand.isFromWaste())){var s={target:"waste",source:t.hand.source};(t.settings.suggestionMode.key!==ot.SCORED||t.game.rating.rateMove(s)>0)&&(n.push(s),t.waste.suggestion=!0)}return t.foundation.stacks.forEach((function(e,s){if(t.foundation.wouldAccept(s,t.hand)&&(t.settings.suggestionMode.key===ot.FULL||!t.hand.isFromFoundation(s))){var i={target:e.source,source:t.hand.source};(t.settings.suggestionMode.key!==ot.SCORED||t.game.rating.rateMove(i)>0)&&(n.push(i),e.suggestion=!0)}})),t.tableau.stacks.forEach((function(s,i){if(t.tableau.wouldAccept(i,t.hand)&&(t.settings.suggestionMode.key===ot.FULL||!t.hand.isFromTableau(i))){var a=t.hand.isHoldingKing()&&0==s.stack.length&&t.hand.isFromAnyTableau()&&0==t.tableau.stacks[t.hand.getTableauIndex()].stack.length,c=s.stack.length>0&&t.hand.isFromAnyTableau()&&t.tableau.stacks[t.hand.getTableauIndex()].stack.length>0&&s.stack[s.stack.length-1].face==t.tableau.stacks[t.hand.getTableauIndex()].stack[t.tableau.stacks[t.hand.getTableauIndex()].stack.length-1].face&&!t.tableau.getTop(t.hand.getTableauIndex()).isHidden,r=!a&&!c;if(!e||t.settings.suggestionMode.key===ot.FULL||r){var o={target:s.source,source:t.hand.source};(t.settings.suggestionMode.key!==ot.SCORED||t.game.rating.rateMove(o)>0)&&(n.push(o),s.suggestion=!0)}}})),n.length},this.getPickupOptions=function(t){var n=!1,s=mt.copy(t);return e.waste.dispatchPickup(s.waste.getTop(),null,s),s.game.timemachine.modified&&e.getPutdownSuggestions(s,!0)>(t.settings.suggestionMode.key==ot.FULL?1:0)&&(t.waste.suggestion=!0,n=!0),t.tableau.stacks.forEach((function(s,i){return s.stack.map((function(t,e){return{cardIndex:e,card:t}})).filter((function(t){return!t.card.isHidden})).forEach((function(a){var c=a.card,r=a.cardIndex,o=mt.copy(t);e.tableau.dispatchPickup(c,null,o,i),o.game.timemachine.modified&&e.getPutdownSuggestions(o,!0)>(t.settings.suggestionMode.key==ot.FULL?1:0)&&(s.stack[r].suggestion=!0,n=!0)}))})),n},this.getUncoverOptions=function(t){if(!t.hand.isHoldingCard()){var e=t.tableau.stacks.map((function(t,e){return e})).filter((function(e){return t.tableau.getTop(e)&&t.tableau.getTop(e).isHidden}));return e.forEach((function(e){t.tableau.getTop(e).suggestion=!0})),e.length}return 0},this.disableAllSuggestions=function(t){var e=function t(e){e.suggestion=!1,e.stack&&e.stack.forEach(t),e.stacks&&e.stacks.forEach(t)};e(t.waste),e(t.stock),e(t.tableau),e(t.foundation)},this.tableau=new vt,this.waste=new kt},mt=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var s;return Object(c.a)(this,n),(s=e.call(this,t)).suggestor=void 0,s.dealer=void 0,s.navigator=void 0,s.withSuggestions=function(){return s.suggestor.evaluateOptions(Object(m.a)(s)),Object(m.a)(s)},s.setEntropy=function(t){s.settings.baseEntropy=t,s.stock.setEntropy(t),s.waste.setEntropy(t),s.foundation.setEntropy(t),s.tableau.setEntropy(t)},s.withHandlers=function(){var t=function(t){return new Y(t).getHandler(s.hand)};return s.stock.onClick=t(new bt),s.waste.onClick=t(new kt),s.foundation.onClick=t(new V),s.tableau.onClick=t(new vt),Object(m.a)(s)},s.suggestor=new jt,s.dealer=new W,s.navigator=new pt(Object(m.a)(s)),s}return n}(gt);mt.getInitialState=function(t){return new mt(gt.getInitialState(t))},mt.copy=function(t){return new mt(gt.copy(t))};var Ot=function(t){Object(r.a)(n,t);var e=Object(o.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).replaceContext=function(t){return i.setState(t)},i.updateContext=function(t){return i.replaceContext((function(e){return t(e),e}))},i.updateGameContext=function(t){return i.replaceContext((function(e){e.game.timemachine.modified=!1;var n=mt.copy(e);return t(e),e.game.timemachine.modified?(e.game.timemachine.pushPreviousState(n),e):null}))},i.render=function(){var t={state:i.state.withHandlers().withSuggestions(),replaceContext:i.replaceContext,updateContext:i.updateContext,updateGameContext:i.updateGameContext,restart:i.props.restart};return Object(s.jsx)(f,{value:t,children:Object(s.jsx)(G,{})})},i.state=mt.getInitialState(t.settings),i}return n}(l.a.Component),xt=[{id:0,settings:{drawMode:"single",recyclingMode:"infinite"},icon:"\ud83d\udc2d",lines:["Turn 1 card at once.","No limit on passes","through the deck."]},{id:1,settings:{drawMode:"single",recyclingMode:"3-pass"},icon:"\ud83d\udc39",lines:["Turn 1 card at once.","Three passes","through the deck."]},{id:2,settings:{drawMode:"single",recyclingMode:"1-pass"},icon:"\ud83d\udc30",lines:["Turn 1 card at once.","Only a single pass","through the deck."]},{id:3,settings:{drawMode:"triple",recyclingMode:"infinite"},icon:"\ud83d\udc28",lines:["Turn 3 cards at once","No limit on passes","through the deck"]},{id:4,settings:{drawMode:"triple",recyclingMode:"3-pass"},icon:"\ud83d\udc3c",lines:["Turn 3 cards at once.","Three passes","through the deck."]},{id:5,settings:{drawMode:"triple",recyclingMode:"1-pass"},icon:"\ud83d\udc3b",lines:["Turn 3 cards at once.","Only a single pass","through the deck."]}],yt=l.a.createContext({state:{difficultySettings:0,ratingPreset:0,ratingSettings:{},isTouch:!1},setState:function(){}}),wt=yt.Provider,Ct=yt,Mt=function(){var t=l.a.useContext(Ct),e=t.state,n=t.setState,a=function(t){return n(Object(i.a)(Object(i.a)({},e),{},{difficultySettings:t}))},c=function(t){return e.difficultySettings==t?"active active-".concat(t):"inactive-".concat(t)};return Object(s.jsxs)("div",{className:"ui center quickstart",children:[Object(s.jsx)("div",{className:"title",children:"Difficulty"}),Object(s.jsxs)("div",{className:"content",children:[Object(s.jsx)("div",{className:"left",children:xt.slice(0,3).map((function(t){return Object(s.jsxs)("button",{className:c(t.id),onClick:function(){return a(t.id)},children:[t.icon,t.lines.map((function(t,e){return Object(s.jsx)("div",{children:t},e)}))]},t.id)}))}),Object(s.jsx)("div",{className:"right",children:xt.slice(3).map((function(t){return Object(s.jsxs)("button",{className:c(t.id),onClick:function(){return a(t.id)},children:[t.icon,t.lines.map((function(t,e){return Object(s.jsx)("div",{children:t},e)}))]},t.id)}))})]})]})},St=function(t){var e=l.a.useContext(Ct),n=e.state,a=e.setState;return Object(s.jsxs)("div",{className:"ui right quickstart",children:[Object(s.jsx)("div",{className:"title",children:"Quickstart"}),Object(s.jsx)("div",{className:"content center",children:Object(s.jsxs)("div",{children:[Object(s.jsxs)("button",{disabled:!n.isTouch,className:n.isTouch?"inactive-0":"active active-0",onClick:function(){return a(Object(i.a)(Object(i.a)({},n),{},{isTouch:!1}))},children:["\ud83d\udda5\ufe0f",Object(s.jsxs)("div",{children:[n.isTouch?"Optimize":"Optimized"," for Desktop"]}),Object(s.jsx)("div",{children:"with Mouse Support"})]}),Object(s.jsxs)("button",{disabled:n.isTouch,className:n.isTouch?"active active-0":"inactive-0",onClick:function(){return a(Object(i.a)(Object(i.a)({},n),{},{isTouch:!0}))},children:["\ud83d\udcf1",Object(s.jsxs)("div",{children:[n.isTouch?"Optimized":"Optimize"," for Mobile"]}),Object(s.jsx)("div",{children:"with Touch Support"})]}),Object(s.jsxs)("button",{className:"blinking",onClick:t.start,children:["\ud83c\udfb2",Object(s.jsx)("div",{children:"Start"})]})]})})]})},Tt=function t(){Object(c.a)(this,t)};Tt.all=[{id:0,icon:"\ud83c\udf34",label:"Chill",settings:{timedMode:!1,missPenalty:!1,undoPenalty:!1,hintPenalty:!1}},{id:1,icon:"\u2696\ufe0f",label:"Regular",settings:{timedMode:!0,missPenalty:!1,undoPenalty:!0,hintPenalty:!1}},{id:2,icon:"\ud83c\udfc6",label:"Competitive",settings:{timedMode:!0,missPenalty:!0,undoPenalty:!0,hintPenalty:!0}}],Tt.matchPreset=function(t){var e=Tt.all.filter((function(e){return Tt.equals(e.settings,t)}));return e.length>0?e[0].id:-1},Tt.equals=function(t,e){return t.timedMode===e.timedMode&&t.missPenalty===e.missPenalty&&t.undoPenalty===e.undoPenalty&&t.hintPenalty===e.hintPenalty};var Et=function(){var t=l.a.useContext(Ct),e=t.state,n=t.setState,c=l.a.useState(!1),r=Object(a.a)(c,2),o=r[0],u=r[1],d=function(t){var s=Object(i.a)({},e);t(s.ratingSettings),s.ratingPreset=Tt.matchPreset(s.ratingSettings),n(s)};return Object(s.jsxs)("div",{className:"ui left quickstart",children:[Object(s.jsx)("div",{className:"closer",children:Object(s.jsx)("button",{onClick:function(){return u(!o)},children:o?"\ud83d\uddd9":"\u2630"})}),Object(s.jsx)("div",{className:"title",children:o?"Customize Rating":"Rating"}),o?Object(s.jsxs)("div",{className:"content",children:[Object(s.jsxs)("div",{className:"section",children:[Object(s.jsx)("div",{className:"title",children:"Undo Penalty"}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"label",children:"Should there be a penalty for the UNDO operation? This penalty increases exponentially."}),Object(s.jsxs)("select",{onChange:function(t){return e=t.target.value,d((function(t){return t.undoPenalty="true"==e}));var e},value:String(!!e.ratingSettings.undoPenalty),children:[Object(s.jsx)("option",{value:"true",children:"yes"}),Object(s.jsx)("option",{value:"false",children:"no"})]})]})]}),Object(s.jsxs)("div",{className:"section",children:[Object(s.jsx)("div",{className:"title",children:"Time Rating"}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsxs)("div",{className:"label",children:["Should the performance be part of the final rating, according to the rules described"," ",Object(s.jsx)("a",{href:"https://en.wikipedia.org/wiki/Klondike_(solitaire)#Scoring",rel:"noreferrer",target:"_blank",children:"here"}),"?"]}),Object(s.jsxs)("select",{onChange:function(t){return e=t.target.value,d((function(t){return t.timedMode="true"==e}));var e},value:String(!!e.ratingSettings.timedMode),children:[Object(s.jsx)("option",{value:"true",children:"yes"}),Object(s.jsx)("option",{value:"false",children:"no"})]})]})]}),Object(s.jsxs)("div",{className:"section",children:[Object(s.jsx)("div",{className:"title",children:"Hint Penalty"}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"label",children:"Should there be a penalty for the HINT operation? This penalty does not increase."}),Object(s.jsxs)("select",{onChange:function(t){return e=t.target.value,d((function(t){return t.hintPenalty="true"==e}));var e},value:String(!!e.ratingSettings.hintPenalty),children:[Object(s.jsx)("option",{value:"true",children:"yes"}),Object(s.jsx)("option",{value:"false",children:"no"})]})]})]}),Object(s.jsxs)("div",{className:"section",children:[Object(s.jsx)("div",{className:"title",children:"Miss Penalty"}),Object(s.jsxs)("div",{className:"row",children:[Object(s.jsx)("div",{className:"label",children:"Should there be a penalty for attempting to perform invalid actions?"}),Object(s.jsxs)("select",{onChange:function(t){return e=t.target.value,d((function(t){return t.missPenalty="true"==e}));var e},value:String(!!e.ratingSettings.missPenalty),children:[Object(s.jsx)("option",{value:"true",children:"yes"}),Object(s.jsx)("option",{value:"false",children:"no"})]})]})]})]}):Object(s.jsx)("div",{className:"content center",children:Object(s.jsx)("div",{children:Tt.all.map((function(t){return Object(s.jsxs)("button",{className:(a=t.id,e.ratingPreset==a?"active active-".concat(a):"inactive-".concat(a)),onClick:function(){return s=t.id,n(Object(i.a)(Object(i.a)({},e),{},{ratingSettings:Object(i.a)({},Tt.all[s].settings),ratingPreset:s}));var s},children:[t.icon,Object(s.jsx)("div",{children:t.label})]},t.id);var a}))})})]})},Nt=function(){try{var t=" -webkit- -moz- -o- -ms- ".split(" ");return"ontouchstart"in window||"undefined"!==typeof window.DocumentTouch&&document instanceof window.DocumentTouch||(e=["(",t.join("touch-enabled),("),"heartz",")"].join(""),window.matchMedia(e).matches)}catch(n){return console.error("(Touch detect failed)",n),!1}var e},Pt=function(t){var e=l.a.useState({ratingSettings:Object(i.a)({},Tt.all[1].settings),difficultySettings:1,ratingPreset:1,isTouch:Nt()}),n=Object(a.a)(e,2),c=n[0],r=n[1];return t&&t.start?Object(s.jsx)(wt,{value:{state:c,setState:r},children:Object(s.jsxs)("div",{children:[Object(s.jsx)(Et,{}),Object(s.jsx)(Mt,{}),Object(s.jsx)(St,{start:function(){var e=Object(i.a)(Object(i.a)(Object(i.a)({},xt[c.difficultySettings].settings),c.ratingSettings),{},{isTouch:c.isTouch});t.start(e)}})]})}):null},Dt=function(){var t=l.a.useState({}),e=Object(a.a)(t,2),n=e[0],c=e[1];return n.initialized?Object(s.jsx)(Ot,{settings:n,restart:function(){return c({})}}):Object(s.jsx)(Pt,{start:function(t){return c(Object(i.a)(Object(i.a)({},t),{},{initialized:!0}))}})},It=n(17);n.n(It).a.render(Object(s.jsx)(l.a.StrictMode,{children:Object(s.jsx)(Dt,{})}),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.4f606d1d.chunk.js.map