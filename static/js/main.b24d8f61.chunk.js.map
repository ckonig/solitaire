{"version":3,"sources":["View/Clock.js","View/Undo.js","View/Footer.js","View/BlinkingComponent.js","View/Card.js","View/TouchAwareComponent.js","View/MouseHand.js","View/StackBase.js","View/TouchHand.js","View/Foundation.js","View/Stock.js","View/Tableau.js","View/Waste.js","View/Board.js","Model/Deck/Card.js","Model/Deck/DeckSize.js","Model/Deck/Suits.js","Model/Deck/Deck.js","Model/Game/Foundation.js","Model/Game/Game.js","Model/Game/Hand.js","Model/Game/Stock.js","Model/Game/Tableau.js","Model/Game/Waste.js","Model/Facade.js","Service/BaseService.js","Service/Foundation.js","Service/Stock.js","Service/Tableau.js","Service/Waste.js","Service/Facade.js","App.js","index.js"],"names":["Clock","props","state","timeElapsed","setInterval","setState","msec","end","Date","now","started","hh","Math","floor","mm","ss","className","this","Component","Undo","document","addEventListener","e","evtobj","window","event","keyCode","ctrlKey","undo","onClick","undoLabel","Footer","model","points","isEnded","reset","beat","trip","href","BlinkingComponent","blinkFor","unblink","Card","type","icon","isSelected","blink","style","zIndex","offsetTop","top","entropyStyle","shadowOffsetX","offsetY","shadowOffsetY","isHidden","face","TouchAwareComponent","isTouch","is_touch_device","prefixes","split","DocumentTouch","query","join","matchMedia","matches","console","error","source","hand","isHoldingCard","MouseHand","myRef","React","createRef","onMouseMove","bind","onKeyDown","putBack","removeEventListener","parent","node","current","x","clientX","y","clientY","left","position","ref","stack","map","card","index","StackBase","classname","children","TouchHand","offset","c","Foundation","entropy","length","Stock","Tableau","getOffset","i","Waste","Board","stock","handlers","clickStock","waste","clickWaste","foundation","stacks","clickFoundation","tableau","clickTableau","game","causeEntropy","lvl","level","random","randomInt","min","max","equals","other","otherCard","copy","orig","copyAll","cards","DeckSize","Suits","heart","color","club","diamond","spade","Deck","keys","Object","deckSize","key","flat","shuffleArray","array","j","getCurrentAccepted","currentFoundation","acceptedCards","accepts","currentAccepted","add","push","usedCards","pop","remove","getTop","getPreviousUsed","countCards","f","parseInt","reduce","a","b","randomStack","randomElement","suit","slice","reverse","origStack","Game","popPreviousState","id","isRequested","previousStates","popPrevious","previous","memorable","modelEquals","pow","multiplicator","modified","trippy","target","currentMove","rateMove","every","stackEquals","stacksEqual","debug","move","sourceIsTableau","substr","targetIsTableau","sourceIsFoundation","targetIsFoundation","Hand","currentCard","hasMoreThanOneCard","isFromCurrentSource","log","splice","isOnTop","element","getStack","range","indexOf","popWithFollowing","uncover","concat","setCardProperties","TableauGenerator","generateStacks","deck","pointer","oldpointer","ids","template","forEach","generateStack","tryPutDown","canAdd","popTop","recycle","Facade","getInitialState","Service","stateholder","dispatchPutDown","_setState","_dispatchPutDown","dispatchPickup","_dispatchPickup","_blink","selector","startBlink","registerBlink","setTimeout","toggleBlink","Model","pushPreviousState","_card","src","putDown","registerMove","tryDetectEnd","pickUp","registerPickup","s","moveToWaste","recycleWaste","registerRecycle","canPutDown","tryUncover","registerUncover","currentState","shuffle","handler","App","getHandlers","subscribe","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.b24d8f61.chunk.js","sourcesContent":["import { Component } from \"react\";\r\nimport React from \"react\";\r\n\r\nexport default class Clock extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            timeElapsed: null,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        setInterval(() => {\r\n            this.setState((state) => {\r\n                //@todo padleft or string format : 00:01\r\n                let msec = (this.props.end || Date.now()) - this.props.started;\r\n                const hh = Math.floor(msec / 1000 / 60 / 60);\r\n                msec -= hh * 1000 * 60 * 60;\r\n                const mm = Math.floor(msec / 1000 / 60);\r\n                msec -= mm * 1000 * 60;\r\n                const ss = Math.floor(msec / 1000);\r\n                msec -= ss * 1000;\r\n                state.timeElapsed = hh ? hh + \":\" + mm + \":\" + ss : mm + \":\" + ss;\r\n                return { ...state };\r\n            });\r\n        }, 1000);\r\n    }\r\n\r\n    render() {\r\n        return <span className={this.props.className}>Time Elapsed: {this.state.timeElapsed}</span>;\r\n    }\r\n}\r\n","import React, { Component } from \"react\";\r\n\r\nexport default class Undo extends Component {\r\n    componentDidMount() {\r\n        document.addEventListener(\"keydown\", (e) => {\r\n            const evtobj = window.event ? event : e;\r\n            if (evtobj.keyCode == 90 && evtobj.ctrlKey) this.props.undo();\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <button onClick={this.props.undo}>undo (penalty:-{this.props.undoLabel()})</button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import Clock from \"./Clock\";\r\nimport React from \"react\";\r\nimport Undo from \"./Undo\";\r\n\r\nconst Footer = (props) => {\r\n    return (\r\n        <div className=\"footer\">\r\n            <div className=\"footer-grid-container\">\r\n                <span>Points: {props.model.points}</span>\r\n                <Clock className=\"clock\" started={props.model.started} end={props.model.end} />\r\n                <span>Is Ended: {props.model.isEnded ? \"Y\" : \"N\"}</span>\r\n                <div><button onClick={props.reset}>reset</button></div>\r\n                <Undo undo={props.undo} undoLabel={props.undoLabel} />\r\n                <div><button onClick={props.beat}>beat on table</button></div>\r\n                <div><button onClick={props.trip}>trip</button></div>\r\n                <span className=\"report\">\r\n                    Report Issues <a href=\"https://github.com/ckonig/solitaire/issues\">here</a>.\r\n                </span>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\nexport default Footer;\r\n","import { Component } from \"react\";\r\n\r\nexport default class BlinkingComponent extends Component {\r\n    componentDidUpdate() {\r\n        if (this.props.model.blinkFor) {\r\n            this.props.model.unblink();\r\n        }\r\n    }\r\n}","import React from \"react\";\r\n\r\nconst Card = (props) => {\r\n    //@todo 3d flip https://3dtransforms.desandro.com/card-flip\r\n    //run css animation first like this:\r\n    //https://medium.com/hackernoon/5-ways-to-animate-a-reactjs-app-in-2019-56eb9af6e3bf\r\n    //then trigger re-render through state change in parent\r\n    const model = props.model;\r\n    let className = props.className + \" card card-base suit-\" + model.type.icon;\r\n    className += props.isSelected ? \" card-selected\" : \"\";\r\n    className += props.blink ? \" blink\" : \"\";\r\n    const style = {\r\n        zIndex: props.zIndex ? props.zIndex : !!props.offsetTop + 2,\r\n        top: props.offsetTop ? props.offsetTop / 10 + \"vw\" : 0,\r\n        ...props.model.entropyStyle,\r\n    };\r\n    if (props.shadowOffsetX || (!props.shadowOffsetX && props.shadowOffsetX === 0)) {\r\n        const offsetY = props.shadowOffsetY || \"-1\";\r\n        style[\"boxShadow\"] = props.shadowOffsetX + \"px \" + offsetY + \"px 4px 4px rgba(0, 0, 0, 0.75)\";\r\n    }\r\n\r\n    return (\r\n        <div className=\"stack-base\">\r\n            <div style={style} className={className} onClick={() => props.onClick({ ...model })}>\r\n                {model.isHidden ? (\r\n                    <div className=\"card-back quarot\">&nbsp;</div>\r\n                ) : (\r\n                    <div className=\"card-grid-container\">\r\n                        <div>\r\n                            <div className=\"align-center\">{model.type.icon}</div>\r\n                        </div>\r\n                        <div>\r\n                            <div className=\"align-left\">{model.face}</div>\r\n                        </div>\r\n                        <div>&nbsp;</div>\r\n                        <div>\r\n                            <div className=\"align-center\">{model.type.icon}</div>\r\n                        </div>\r\n                        <div className=\"mainface\">\r\n                            <div className=\"align-center\">{model.face}</div>\r\n                        </div>\r\n                        <div>\r\n                            <div className=\"align-center\">{model.type.icon}</div>\r\n                        </div>\r\n                        <div>&nbsp;</div>\r\n                        <div>\r\n                            <div className=\"align-right\">{model.face}</div>\r\n                        </div>\r\n                        <div>\r\n                            <div className=\"align-center\">{model.type.icon}</div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\nexport default Card;\r\n","import { Component } from \"react\";\r\n\r\nexport default class TouchAwareComponent extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.isTouch = this.is_touch_device();\r\n    }\r\n\r\n    is_touch_device() {\r\n        try {\r\n            const prefixes = \" -webkit- -moz- -o- -ms- \".split(\" \");\r\n\r\n            const mq = (query) => window.matchMedia(query).matches;\r\n\r\n            if (\"ontouchstart\" in window || (typeof window.DocumentTouch !== \"undefined\" && document instanceof window.DocumentTouch)) {\r\n                return true;\r\n            }\r\n\r\n            return mq([\"(\", prefixes.join(\"touch-enabled),(\"), \"heartz\", \")\"].join(\"\"));\r\n        } catch (e) {\r\n            console.error(\"(Touch detect failed)\", e);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    shouldShowHand(source) {\r\n        return this.isTouch && this.props.hand.isHoldingCard() && this.props.hand.source === source;\r\n    }\r\n}\r\n","import Card from \"./Card\";\r\nimport React from \"react\";\r\nimport TouchAwareComponent from \"./TouchAwareComponent\";\r\n\r\nexport default class MouseHand extends TouchAwareComponent {\r\n    constructor(props) {\r\n        super(props);\r\n        this.myRef = React.createRef();\r\n        this.onMouseMove = this.onMouseMove.bind(this);\r\n        this.onKeyDown = this.onKeyDown.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (!this.isTouch) {\r\n            document.addEventListener(\"mousemove\", this.onMouseMove, false);\r\n\r\n            if (this.props.putBack) {\r\n                document.addEventListener(\"keydown\", this.onKeyDown, false);\r\n            }\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (!this.isTouch) {\r\n            document.removeEventListener(\"mousemove\", this.onMouseMove, false);\r\n            document.addEventListener(\"keydown\", this.onKeyDown, false);\r\n        }\r\n    }\r\n\r\n    onMouseMove(e) {\r\n        if (!this.isTouch && this.props.hand && this.props.parent == this.props.hand.source) {\r\n            const node = this.myRef.current;\r\n            const x = e.clientX,\r\n                y = e.clientY;\r\n            node.style.top = y + 25 + \"px\";\r\n            node.style.left = x + 25 + \"px\";\r\n            node.style.position = \"absolute\";\r\n        }\r\n    }\r\n\r\n    onKeyDown(e) {\r\n        const evtobj = window.event ? event : e;\r\n        if (evtobj.keyCode == 27 && !this.isTouch && this.props.hand && this.props.parent == this.props.hand.source) this.props.putBack();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div ref={this.myRef}>\r\n                {!this.isTouch &&\r\n                    this.props.hand &&\r\n                    this.props.parent == this.props.hand.source &&\r\n                    this.props.stack &&\r\n                    this.props.stack.map((card, index) => (\r\n                        <Card\r\n                            model={card}\r\n                            key={index}\r\n                            onClick={() => {\r\n                                console.error(\"clicked card in mouse hand\");\r\n                            }}\r\n                            offsetTop={index * 20}\r\n                            zIndex={1000 + index * 20}\r\n                            isSelected={true}\r\n                        />\r\n                    ))}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React from \"react\";\r\n\r\nconst StackBase = (props) => {\r\n    let classname = \"card-base socket-empty\";\r\n    if (props.blink) {\r\n        classname += \" blink\";\r\n    }\r\n    return (\r\n        <div className={classname} onClick={() => props.onClick()}>\r\n            {props.children}\r\n        </div>\r\n    );\r\n};\r\nexport default StackBase;\r\n","import Card from \"./Card\";\r\nimport React from \"react\";\r\nimport TouchAwareComponent from \"./TouchAwareComponent\";\r\n\r\nexport default class TouchHand extends TouchAwareComponent {\r\n    render() {\r\n        if (!this.isTouch || !this.props.hand || this.props.parent !== this.props.hand.source) {\r\n            return null;\r\n        }\r\n        return (\r\n            <div>\r\n                {this.props.hand &&\r\n                    this.props.hand.stack &&\r\n                    this.props.hand.stack.map((card, index) => (\r\n                        <Card\r\n                            model={card}\r\n                            key={index}\r\n                            offsetTop={this.props.offset + index * 20}\r\n                            zIndex={1000 + index * 20}\r\n                            isSelected={true}\r\n                            onClick={(c) => this.props.onClick(c)}\r\n                        />\r\n                    ))}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import BlinkingComponent from \"./BlinkingComponent\";\r\nimport Card from \"./Card\";\r\nimport MouseHand from \"./MouseHand\";\r\nimport React from \"react\";\r\nimport StackBase from \"./StackBase\";\r\nimport TouchHand from \"./TouchHand\";\r\n\r\nexport default class Foundation extends BlinkingComponent {\r\n    render() {\r\n        const props = this.props;\r\n        return (\r\n            <div>\r\n                <StackBase blink={props.model.blinkFor} onClick={() => props.onClick()}>\r\n                    <div className={\"align-center foundation-base suit-\" + props.model.icon}>{props.model.icon}</div>\r\n                </StackBase>\r\n                {props.model.stack.map((card, index) => (\r\n                    <Card model={card} key={index} shadowOffsetX={(props.index)*2} shadowOffsetY={-3} blink={props.model.blinkFor} entropy={6} onClick={props.onClick} />\r\n                ))}\r\n                <TouchHand\r\n                    parent={\"foundation-\" + props.index}\r\n                    hand={props.hand}\r\n                    onClick={() => props.onClick(props.model.stack[props.model.stack.length - 1])}\r\n                />\r\n                <MouseHand\r\n                    parent={\"foundation-\" + props.index}\r\n                    hand={props.hand}\r\n                    stack={props.hand.stack}\r\n                    putBack={() => props.onClick(props.model.stack[props.model.stack.length - 1], props.model.stack.length - 1)}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import BlinkingComponent from \"./BlinkingComponent\";\r\nimport Card from \"./Card\";\r\nimport React from \"react\";\r\nimport StackBase from \"./StackBase\";\r\n\r\nexport default class Stock extends BlinkingComponent {\r\n    render() {\r\n        const props = this.props;\r\n        return (\r\n            <div>\r\n                <StackBase blink={props.model.blinkFor} onClick={props.onClick} />\r\n                {props.model.stack.map((card, index) => (\r\n                    <Card\r\n                        model={card}\r\n                        key={index}\r\n                        blink={props.model.blinkFor}\r\n                        shadowOffsetX={-6}\r\n                        shadowOffsetY={-3}\r\n                        source=\"main\"\r\n                        entropy={6}\r\n                        onClick={props.onClick}\r\n                    />\r\n                ))}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import BlinkingComponent from \"./BlinkingComponent\";\r\nimport Card from \"./Card\";\r\nimport MouseHand from \"./MouseHand\";\r\nimport React from \"react\";\r\nimport StackBase from \"./StackBase\";\r\nimport TouchHand from \"./TouchHand\";\r\n\r\nexport default class Tableau extends BlinkingComponent {\r\n    render() {\r\n        const props = this.props;\r\n        let offset = 0;\r\n        const getOffset = (index) => {\r\n            for (let i = 0; i <= index; i++) {\r\n                if (props.model.stack[i] && !props.model.stack[i].isHidden) {\r\n                    offset = i * 12 + (index - i) * 24;\r\n                    return offset;\r\n                }\r\n            }\r\n            offset = index * 12;\r\n            return offset;\r\n        };\r\n\r\n        return (\r\n            <div>\r\n                <StackBase blink={props.model.blinkFor} onClick={() => props.onClick(null, \"tableau-\" + props.index)} />\r\n                {props.model.stack.map((card, index) => (\r\n                    <Card\r\n                        model={card}\r\n                        key={index}\r\n                        blink={props.model.blinkFor}\r\n                        entropy={4}\r\n                        shadowOffsetX={(4 - 7 + props.index)*2}\r\n                        offsetTop={getOffset(index)}\r\n                        onClick={props.onClick}\r\n                    />\r\n                ))}\r\n                <TouchHand\r\n                    parent={\"tableau-\" + props.index}\r\n                    hand={props.hand}\r\n                    offset={getOffset(props.model.stack.length)}\r\n                    onClick={() => props.onClick(props.model.stack[props.model.stack.length - 1])}\r\n                />\r\n                <MouseHand\r\n                    parent={\"tableau-\" + props.index}\r\n                    hand={props.hand}\r\n                    stack={props.hand.stack}\r\n                    putBack={() => props.onClick(props.model.stack[props.model.stack.length - 1], props.model.stack.length - 1)}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import BlinkingComponent from \"./BlinkingComponent\";\r\nimport Card from \"./Card\";\r\nimport MouseHand from \"./MouseHand\";\r\nimport React from \"react\";\r\nimport StackBase from \"./StackBase\";\r\nimport TouchHand from \"./TouchHand\";\r\n\r\nexport default class Waste extends BlinkingComponent {\r\n    render() {\r\n        const props = this.props;\r\n        return (\r\n            <div>\r\n                <StackBase blink={props.model.blinkFor} onClick={props.onClick} />\r\n                {props.model.stack.map((card, index) => (\r\n                    <Card\r\n                        model={card}\r\n                        shadowOffsetX={-4}\r\n                        shadowOffsetY={-3}\r\n                        key={index}\r\n                        blink={props.model.blinkFor}\r\n                        onClick={(c) => props.onClick(c)}\r\n                        entropy={6}\r\n                    />\r\n                ))}\r\n                <TouchHand parent=\"waste\" hand={props.hand} onClick={(c) => props.onClick(c, \"waste\")} />\r\n                <MouseHand\r\n                    parent={\"waste\"}\r\n                    hand={props.hand}\r\n                    stack={props.hand.stack}\r\n                    putBack={() => props.onClick(props.model.stack[props.model.stack.length - 1], props.model.stack.length - 1)}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import Footer from \"./Footer\";\r\nimport Foundation from \"./Foundation\";\r\nimport React from \"react\";\r\nimport Stock from \"./Stock\";\r\nimport Tableau from \"./Tableau\";\r\nimport Waste from \"./Waste\";\r\n\r\nconst Board = (props) => {\r\n    return (\r\n        <div>\r\n            <div className=\"layout-grid-container\">\r\n                <div className=\"game-view\">\r\n                    <div className=\"board-grid-container\">\r\n                        <Stock model={props.model.stock} onClick={props.handlers.clickStock} />\r\n                        <Waste model={props.model.waste} hand={props.model.hand} onClick={props.handlers.clickWaste} />\r\n                        <div className=\"spacer\">&nbsp;</div>\r\n                        {props.model.foundation.stacks.map((foundation, index) => (\r\n                            <Foundation\r\n                                key={index}\r\n                                index={index}\r\n                                model={foundation}\r\n                                hand={props.model.hand}\r\n                                onClick={(c) => props.handlers.clickFoundation(c, index)}\r\n                            />\r\n                        ))}\r\n                        {props.model.tableau.stacks.map((stack, index) => (\r\n                            <Tableau\r\n                                key={index}\r\n                                index={index}\r\n                                model={stack}\r\n                                hand={props.model.hand}\r\n                                onClick={(card) => props.handlers.clickTableau(card, index)}\r\n                            />\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n                <Footer\r\n                    reset={props.handlers.reset}\r\n                    undoLabel={props.handlers.undoLabel}\r\n                    undo={props.handlers.undo}\r\n                    beat={props.handlers.beat}\r\n                    trip={props.handlers.trip}\r\n                    model={props.model.game}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Board;\r\n","export default class Card {\r\n    constructor(face, type, isHidden) {\r\n        this.face = face;\r\n        this.type = type;\r\n        this.isHidden = isHidden;\r\n        this.entropyStyle = {};\r\n        this.causeEntropy(3);\r\n    }\r\n\r\n    causeEntropy = (lvl) => {\r\n        const level = lvl * 2;\r\n        //@todo this is awesome but move it to model\r\n        const random = () => Math.random() < 0.5;\r\n        const randomInt = (min, max) => Math.random() * (max - min) + min;\r\n        //shift\r\n        if (random()) {\r\n            if (random()) {\r\n                this.entropyStyle[\"left\"] = randomInt(0, level / 2);\r\n            } else {\r\n                this.entropyStyle[\"right\"] = randomInt(0, level / 2);\r\n            }\r\n        }\r\n        //rotate\r\n        this.entropyStyle[\"transform\"] = \"rotate(\" + randomInt(level * -1, level) + \"deg)\";\r\n    };\r\n\r\n    equals = (other) => {\r\n        return Card.equals(this, other);\r\n    };\r\n\r\n    static equals(card, otherCard) {\r\n        return (!card && !otherCard) || (card && otherCard && otherCard.face == card.face && otherCard.type.icon == card.type.icon);\r\n    }\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Card(orig.face, orig.type, orig.isHidden);\r\n        copy.source = orig.source;\r\n        return copy;\r\n    };\r\n\r\n    static copyAll = (cards) => cards.map((card) => Card.copy(card));\r\n}\r\n","export const DeckSize = [\"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"J\", \"Q\", \"K\", \"A\"];\r\n\r\nexport const getFoundationOrder = () => {\r\n    return [\"A\", ...DeckSize.slice(0, DeckSize.length - 1)].reverse();\r\n};\r\n\r\nexport const getTableauOrder = () => {\r\n    return [...DeckSize];\r\n};\r\n","const Suits = {\r\n    heart: {\r\n        icon: \"♥\",\r\n        color: \"red\",\r\n    },\r\n    club: {\r\n        icon: \"♣\",\r\n        color: \"black\",\r\n    },\r\n    diamond: {\r\n        icon: \"♦\",\r\n        color: \"red\",\r\n    },\r\n    spade: {\r\n        icon: \"♠\",\r\n        color: \"black\",\r\n    },\r\n};\r\n\r\nexport default Suits;\r\n","import Card from \"./Card\";\r\nimport { DeckSize } from \"./DeckSize\";\r\nimport Suits from \"./Suits\";\r\n\r\nexport default class Deck {\r\n    constructor() {\r\n        const keys = Object.keys(Suits);\r\n        this.cards = DeckSize.map((deckSize) => [...keys.map((key) => new Card(deckSize, Suits[key], true))]).flat();\r\n    }\r\n\r\n    shuffle() {\r\n        this.shuffleArray(this.cards);\r\n        return this;\r\n    }\r\n\r\n    // credits: https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array\r\n    shuffleArray(array) {\r\n        for (let i = array.length - 1; i > 0; i--) {\r\n            const j = Math.floor(Math.random() * (i + 1));\r\n            [array[i], array[j]] = [array[j], array[i]];\r\n        }\r\n    }\r\n}\r\n","import Card from \"../Deck/Card\";\r\nimport Suits from \"../Deck/Suits\";\r\nimport { getFoundationOrder } from \"../Deck/DeckSize\";\r\n\r\nexport default class Foundation {\r\n    constructor() {\r\n        const template = () => ({\r\n            stack: [],\r\n            acceptedCards: [...getFoundationOrder()],\r\n            usedCards: [],\r\n            icon: null,\r\n            color: null,\r\n        });\r\n        const stacks = Object.keys(Suits)\r\n            .map((key) => Suits[key])\r\n            .map((suit) => ({ ...template(), ...suit }));\r\n        this.stacks = [...stacks];\r\n    }\r\n\r\n    getCurrentAccepted = (index) => {\r\n        const currentFoundation = this.stacks[index].acceptedCards;\r\n        return currentFoundation[currentFoundation.length - 1];\r\n    };\r\n\r\n    //@todo same (similar) in tableau\r\n    accepts = (index, card) => {\r\n        const currentAccepted = this.getCurrentAccepted(index);\r\n        return this.stacks[index].icon == card.type.icon && currentAccepted == card.face;\r\n    };\r\n\r\n    add = (index, cards) => {\r\n        const card = cards[0]\r\n        card.causeEntropy(3);\r\n        card.source = \"foundation-\" + index;\r\n        this.stacks[index].stack.push(card);\r\n        return this.stacks[index].usedCards.push(this.stacks[index].acceptedCards.pop());\r\n    };\r\n\r\n    remove = (index, card) => {\r\n        this.stacks[index].acceptedCards.push(this.stacks[index].usedCards.pop());\r\n        return card && card.equals(this.getTop(index)) && this.stacks[index].stack.pop();\r\n    };\r\n\r\n    getPreviousUsed = (index) => {\r\n        return [...this.stacks[index].usedCards].pop();\r\n    };\r\n\r\n    countCards = () => {\r\n        this.stacks.map((f) => parseInt(f.stack.length)).reduce((a, b) => a + b, 0);\r\n    };\r\n\r\n    getTop(index) {\r\n        return this.stacks[index].stack[this.stacks[index].stack.length - 1];\r\n    }\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Foundation();\r\n        copy.stacks = orig.stacks.map((origStack) => ({\r\n            stack: Card.copyAll(origStack.stack),\r\n            acceptedCards: [...origStack.acceptedCards],\r\n            usedCards: [...origStack.usedCards],\r\n            icon: origStack.icon,\r\n            color: origStack.color,\r\n        }));\r\n        return copy;\r\n    };\r\n\r\n    trip = () => {\r\n        const randomStack = this.stacks[Math.floor(Math.random() * this.stacks.length)];\r\n        const randomElement = randomStack.stack[Math.floor(Math.random() * randomStack.stack.length)];\r\n        randomElement && randomElement.causeEntropy(4);        \r\n        return this;\r\n    }\r\n}\r\n","import Card from \"../Deck/Card\";\r\n\r\nexport default class Game {\r\n    constructor() {\r\n        this.points = 0;\r\n        this.started = Date.now();\r\n        this.previousStates = [];\r\n        this.memorable = true;\r\n        this.modified = false;\r\n        this.multiplicator = 1;\r\n        this.trippy = false;\r\n    }\r\n\r\n    registerMove(target, source) {\r\n        this.memorable = true;\r\n        this.modified = true;\r\n        const currentMove = {\r\n            source: source,\r\n            target: target,\r\n        };\r\n        if (source == target) {\r\n            this.memorable = false;\r\n        }\r\n\r\n        this.points += this.rateMove(currentMove);\r\n        return true;\r\n    }\r\n\r\n    stackEquals(a, b) {\r\n        return a.stack.every((card, i) => Card.equals(card, b.stack[i]) && card.isHidden == b.stack[i].isHidden);\r\n    }\r\n\r\n    stacksEqual(a, b) {\r\n        return a.stacks.every((stack, i) => this.stackEquals(stack, b.stacks[i]));\r\n    }\r\n\r\n    modelEquals(a, b) {\r\n        return (\r\n            this.stackEquals(a.stock, b.stock) &&\r\n            this.stackEquals(a.waste, b.waste) &&\r\n            this.stacksEqual(a.tableau, b.tableau) &&\r\n            this.stacksEqual(a.foundation, b.foundation)\r\n        );\r\n    }\r\n\r\n    pushPreviousState(state) {\r\n        const previous = this.previousStates[this.previousStates.length - 1];\r\n        if (!previous || !this.modelEquals(state, previous)) {\r\n            this.previousStates.push(state);\r\n        }\r\n    }\r\n\r\n    registerPickup() {\r\n        this.modified = true;\r\n        this.memorable = false;\r\n        return true;\r\n    }\r\n\r\n    popPreviousState = (id, current) => {\r\n        const isRequested = this.previousStates.length - 1 == id;\r\n        const popPrevious = () => isRequested && this.previousStates && this.previousStates.pop();\r\n        let previous = popPrevious();\r\n        while (previous && (!previous.game.memorable || this.modelEquals(previous, current)) && this.previousStates.length) {\r\n            previous = popPrevious();\r\n        }\r\n        if (previous && previous.game) {\r\n            previous.game.points = Math.min(previous.game.points, this.points) - Math.pow(2, this.multiplicator);\r\n            previous.game.multiplicator = this.multiplicator + 1;\r\n        }\r\n        return previous;\r\n    };\r\n\r\n    registerRecycle() {\r\n        this.memorable = true;\r\n        this.modified = true;\r\n        if (this.points > 0) {\r\n            if (this.points < 100) {\r\n                this.points = 0;\r\n            } else {\r\n                this.points -= 100;\r\n            }\r\n        }\r\n        console.debug(\"RATING: subtract (max) 100 points for RECYCLE\");\r\n    }\r\n\r\n    registerUncover() {\r\n        this.memorable = true;\r\n        this.modified = true;\r\n        this.points += 5;\r\n        console.debug(\"RATING: add 5 points for UNCOVER\");\r\n        return true;\r\n    }\r\n\r\n    registerBlink() {\r\n        this.modified = true;\r\n        this.memorable = false;\r\n        return true;\r\n    }\r\n\r\n    rateMove(move) {\r\n        const sourceIsTableau = move.source.substr(0, 7) == \"tableau\";\r\n        const targetIsTableau = move.target.substr(0, 7) == \"tableau\";\r\n        const sourceIsFoundation = move.source.substr(0, 10) == \"foundation\";\r\n        const targetIsFoundation = move.target.substr(0, 10) == \"foundation\";\r\n        if (sourceIsTableau) {\r\n            if (targetIsFoundation) {\r\n                console.debug(\"RATING: add 10 points for MOVE tableau -> foundation\");\r\n                return 10;\r\n            }\r\n        } else if (move.source == \"waste\") {\r\n            if (targetIsFoundation) {\r\n                console.debug(\"RATING: add 10 points for MOVE waste -> foundation\");\r\n                return 10;\r\n            }\r\n            if (targetIsTableau) {\r\n                console.debug(\"RATING: add 5 points for MOVE waste -> tableau\");\r\n                return 5;\r\n            }\r\n        } else if (sourceIsFoundation) {\r\n            if (targetIsTableau) {\r\n                console.debug(\"RATING: subtract 15 points for MOVE foundation -> tableau\");\r\n                return -15;\r\n            }\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Game();\r\n        copy.points = orig.points;\r\n        copy.started = orig.started;\r\n        copy.modified = orig.modified;\r\n        copy.multiplicator = orig.multiplicator;\r\n        copy.memorable = orig.memorable;\r\n        copy.previousStates = [...orig.previousStates];\r\n        return copy;\r\n    };\r\n}\r\n","import Card from \"../Deck/Card\";\r\n\r\nexport default class Hand {\r\n    constructor() {\r\n        this.stack = [];\r\n        this.source = null;\r\n    }\r\n\r\n    pickUp(stack, source) {\r\n        if (stack && stack[0]) {\r\n            this.stack = stack;\r\n            this.source = source;\r\n            console.log('picked up', this.stack)\r\n        }\r\n\r\n        return stack;\r\n    }\r\n\r\n    putDown() {\r\n        this.source = null;\r\n        return this.stack.splice(0, this.stack.length);\r\n    }\r\n\r\n    isHoldingCard = () => !!this.stack.length;\r\n\r\n    currentCard = () => this.isHoldingCard() && this.stack[0];\r\n\r\n    hasMoreThanOneCard = () => this.stack.length > 1;\r\n\r\n    isFromCurrentSource = (card) => this.source && card.source == this.source;\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Hand();\r\n        copy.stack = Card.copyAll(orig.stack)\r\n        copy.source = orig.source;\r\n        return copy;\r\n    }\r\n}\r\n","import Card from \"../Deck/Card\";\r\n\r\nexport default class Stock {\r\n    constructor(stack) {\r\n        this.stack = [...stack];\r\n    }\r\n\r\n    recycle(waste) {\r\n        if (waste.length) {\r\n            this.stack = waste.reverse().map((element) => {\r\n                element.causeEntropy(3);\r\n                element.isHidden = true;\r\n                return element;\r\n            });\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    isOnTop = (card) => card && card.equals(this.getTop());\r\n\r\n    getTop = () => this.stack[this.stack.length - 1];\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Stock([]);\r\n        copy.stack = Card.copyAll(orig.stack);\r\n        return copy;\r\n    }\r\n\r\n    trip = () => {\r\n        const randomElement = this.stack[Math.floor(Math.random() * this.stack.length)];\r\n        randomElement && randomElement.causeEntropy(4);      \r\n        return this;\r\n    }\r\n}\r\n","import Card from \"../Deck/Card\";\r\nimport { getTableauOrder } from \"../Deck/DeckSize\";\r\n\r\nexport default class Tableau {\r\n    constructor(cards) {\r\n        this.stacks = !cards ? [] : new TableauGenerator().generateStacks(cards);\r\n    }\r\n\r\n    getStack = (index) => {\r\n        return this.stacks[index];\r\n    };\r\n\r\n    accepts = (index, current) => {\r\n        const top = this.getTop(index);\r\n        if (!top) {\r\n            return current && current.face == \"K\";\r\n        }\r\n        if (top.isHidden) {\r\n            return false;\r\n        }\r\n        const range = [...getTableauOrder()];\r\n        const currentIndex = range.indexOf(current.face);\r\n        const topIndex = range.indexOf(top.face);\r\n        return currentIndex + 1 == topIndex && current.type.color != top.type.color;\r\n    };\r\n\r\n    popWithFollowing = (card, i) => {\r\n        for (let j = 0; j < this.stacks[i].stack.length; j++) {\r\n            if (card && card.equals(this.stacks[i].stack[j])) {\r\n                return this.stacks[i].stack.splice(j, this.stacks[i].stack.length);\r\n            }\r\n        }\r\n\r\n        return [];\r\n    };\r\n\r\n    uncover = (index, card) => {\r\n        const top = this.getTop(index);\r\n        if (top.isHidden && card && card.equals(this.getTop(index))) {\r\n            top.isHidden = false;\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    add = (index, cards) => {\r\n        this.getTop(index) && this.getTop(index).causeEntropy(3);\r\n        this.stacks[index].stack = this.stacks[index].stack.concat(cards.map((c) => this.setCardProperties(c, index)));\r\n\r\n        //this.stacks[index].stack.push(cards.map((c) => this.setCardProperties(c, index))); //@todo investigate why this doesn't work\r\n        return cards;\r\n    };\r\n\r\n    setCardProperties = (card, index) => {\r\n        card.source = \"tableau-\" + index;\r\n        card.causeEntropy(4);\r\n        return card;\r\n    };\r\n\r\n    getTop(index) {\r\n        return this.stacks[index].stack[this.stacks[index].stack.length - 1];\r\n    }\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Tableau([]);\r\n        copy.stacks = orig.stacks.map(stack => ({stack: Card.copyAll(stack.stack)}));\r\n        return copy;\r\n    }\r\n\r\n    trip = () => {\r\n        const randomStack = this.stacks[Math.floor(Math.random() * this.stacks.length)];\r\n        const randomElement = randomStack && randomStack.stack[Math.floor(Math.random() * randomStack.stack.length)];\r\n        randomElement && randomElement.causeEntropy(4);        \r\n        return this;\r\n    }\r\n}\r\n\r\nclass TableauGenerator {\r\n    generateStacks = (deck) => {\r\n        this.deck = deck;\r\n        this.pointer = 0;\r\n        this.oldpointer = this.pointer;\r\n        const ids = [0, 1, 2, 3, 4, 5, 6];\r\n        this.stacks = ids.map((id) => this.template(id));\r\n        ids.reverse().forEach((id) => {\r\n            this.generateStack(id);\r\n        });\r\n        return this.stacks;\r\n    };\r\n\r\n    template = (id) => ({\r\n        stack: [],\r\n        id,\r\n    });\r\n\r\n    generateStack = (id) => {\r\n        this.pointer += 6 - id + 1;\r\n        this.stacks[id].stack = this.deck\r\n            .slice(this.oldpointer, this.pointer)\r\n            .map((c) => ({\r\n                ...c,\r\n                isHidden: true,\r\n                source: \"tableau-\" + id,\r\n            }))\r\n            .reverse();\r\n        if (this.stacks[id].stack[this.stacks[id].stack.length - 1]) {\r\n            this.stacks[id].stack[this.stacks[id].stack.length - 1].isHidden = false;\r\n        }\r\n        this.oldpointer = this.pointer;\r\n    };\r\n}\r\n","import Card from \"../Deck/Card\";\r\n\r\nexport default class Waste {\r\n    constructor() {\r\n        this.stack = [];\r\n    }\r\n\r\n    tryPutDown = (card) => this.canAdd(card) && (this.add(card) || true);\r\n\r\n    add = (card) => card && this.stack.push(this.setCardProperties(card));\r\n\r\n    setCardProperties = (card) => {\r\n        card.source = \"waste\";\r\n        card.isHidden = false;\r\n        card.causeEntropy(3);\r\n        return card;\r\n    };\r\n\r\n    canAdd = (card) => card && (!this.getTop() || !card.equals(this.getTop()));\r\n\r\n    popTop = (card) => card && card.equals(this.getTop()) && this.stack.pop();\r\n\r\n    recycle = () => this.stack.splice(0, this.stack.length);\r\n\r\n    getTop = () => this.stack[this.stack.length - 1];\r\n\r\n    static copy = (orig) => {\r\n        const copy = new Waste();\r\n        copy.stack = Card.copyAll(orig.stack);\r\n        return copy;\r\n    }\r\n\r\n    trip = () => {\r\n        const randomElement = this.stack[Math.floor(Math.random() * this.stack.length)];\r\n        randomElement && randomElement.causeEntropy(4);     \r\n        return this;\r\n    }\r\n}\r\n","import Foundation from \"./Game/Foundation\";\r\nimport Game from \"./Game/Game\";\r\nimport Hand from \"./Game/Hand\";\r\nimport Stock from \"./Game/Stock\";\r\nimport Tableau from \"./Game/Tableau\";\r\nimport Waste from \"./Game/Waste\";\r\n\r\nexport default class Facade {\r\n    static getInitialState = (deck) => {\r\n        const state = {\r\n            stock: new Stock([...deck.cards.slice(28)]),\r\n            waste: new Waste(),\r\n            foundation: new Foundation(),\r\n            tableau: new Tableau([...deck.cards.slice(0, 28)]),\r\n            hand: new Hand(),\r\n            game: new Game(),\r\n        };\r\n        return state;\r\n    };\r\n\r\n    static copy = (state) => {\r\n        return {\r\n            stock: Stock.copy(state.stock),\r\n            waste: Waste.copy(state.waste),\r\n            foundation: Foundation.copy(state.foundation),\r\n            tableau: Tableau.copy(state.tableau),\r\n            hand: Hand.copy(state.hand),\r\n            game: Game.copy(state.game),\r\n        };\r\n    };\r\n\r\n    static trip = (state) => {\r\n        return {\r\n            stock: state.stock.trip(),\r\n            waste: state.waste.trip(),\r\n            foundation: state.foundation.trip(),\r\n            tableau: state.tableau.trip(),\r\n            hand: state.hand,\r\n            game: state.game,\r\n        };\r\n    };\r\n}\r\n","import Model from \"../Model/Facade\";\r\n\r\nexport default class Service {\r\n    constructor(stateholder) {\r\n        this._setState = (a, b) =>\r\n            stateholder.setState((state) => {\r\n                state.game.modified = false;\r\n                const previous = Model.copy(state);\r\n                a(state);\r\n                if (state.game.modified) {\r\n                    state.game.pushPreviousState(previous);\r\n                    return { ...state };\r\n                }\r\n\r\n                // @todo enable undoing via browser back gesture/button\r\n                return null;\r\n            }, b);\r\n    }\r\n\r\n    dispatchPutDown = (card, index) => {\r\n        this._setState(\r\n            (state) => {\r\n                if (state.hand.isHoldingCard()) {\r\n                    this._dispatchPutDown(card, state, index);\r\n                }\r\n            },\r\n            null,\r\n            true\r\n        );\r\n    };\r\n\r\n    dispatchPickup = (card, index) => {\r\n        this._setState((state) => {\r\n            if (!state.hand.isHoldingCard()) {\r\n                this._dispatchPickup(card, state, index);\r\n            }\r\n        });\r\n    };\r\n\r\n    _blink = (selector, state) => this.startBlink(selector, 10, state);\r\n\r\n    startBlink = (selector, blinkFor, state) => {\r\n        selector(state).blinkFor = blinkFor;\r\n        state.game.registerBlink();\r\n        selector(state).unblink = () => setTimeout(() => this.toggleBlink(selector, 0), 100);\r\n    };\r\n\r\n    toggleBlink = (selector, blinkFor) =>\r\n        this._setState((state) => {\r\n            selector(state).blinkFor = blinkFor;\r\n            state.game.registerBlink();\r\n        });\r\n}\r\n","import Service from \"./BaseService\";\r\n\r\nexport default class Foundation extends Service {\r\n    _dispatchPutDown = (_card, state, index) => {\r\n        if (!state.hand.hasMoreThanOneCard() && state.foundation.accepts(index, state.hand.currentCard())) {\r\n            const src = state.hand.source;\r\n            state.foundation.add(index, state.hand.putDown()) && state.game.registerMove(\"foundation-\" + index, src);\r\n            this.tryDetectEnd(state);\r\n        } else {\r\n            this.blink(index, state);\r\n        }\r\n    };\r\n\r\n    _dispatchPickup = (_card, state, index) => {\r\n        const card = state.foundation.getTop(index);\r\n        if (card && state.foundation.getPreviousUsed(index) === card.face) {\r\n            state.hand.pickUp([state.foundation.remove(index, card)], card.source) && state.game.registerPickup();\r\n        } else {\r\n            this.blink(index, state);\r\n        }\r\n    };\r\n\r\n    tryDetectEnd(state) {\r\n        const nrofCards = state.foundation.countCards();\r\n        if (nrofCards === 52) {\r\n            state.game.isEnded = true;\r\n            state.game.end = Date.now();\r\n        }\r\n    }\r\n\r\n    blink = (index, state) => this._blink((s) => s.foundation.stacks[index], state);\r\n}\r\n","import Service from \"./BaseService\";\r\n\r\nexport default class Stock extends Service {\r\n    _dispatchPutDown = (card, state) => this.blink(card, state);\r\n\r\n    _dispatchPickup = (card, state) => (card ? this.moveToWaste(card, state) : this.recycleWaste(card, state));\r\n\r\n    moveToWaste = (card, state) =>\r\n        state.stock.isOnTop(card) && state.waste.add(state.stock.stack.pop()) && state.game.registerMove(\"waste\", \"stock\");\r\n\r\n    recycleWaste = (_card, state) =>\r\n        !state.stock.getTop() && !!state.waste.getTop() && state.stock.recycle(state.waste.recycle()) && state.game.registerRecycle(state);\r\n\r\n    blink = (_card, state) => this._blink((s) => s.stock, state);\r\n}\r\n","import Service from \"./BaseService\";\r\n\r\nexport default class Tableau extends Service {\r\n    _dispatchPutDown = (card, state, index) => {\r\n        if (this.canPutDown(card, state, index)) {\r\n            const src = state.hand.source;\r\n            state.tableau.add(index, state.hand.putDown()) && state.game.registerMove(\"tableau-\" + index, src);\r\n        } else {\r\n            this.blink(index, state);\r\n        }\r\n    };\r\n\r\n    canPutDown = (card, state, index) =>\r\n        (card && card.isHidden && state.hand.isFromCurrentSource(card)) ||\r\n        state.tableau.accepts(index, state.hand.currentCard()) ||\r\n        (!card && state.hand.source == \"tableau-\" + index);\r\n\r\n    _dispatchPickup = (card, state, index) => {\r\n        if (card && !this.tryUncover(card, index, state) && !card.isHidden) {\r\n            state.hand.pickUp(state.tableau.popWithFollowing(card, index), card.source) && state.game.registerPickup();\r\n        } else if (!card) {\r\n            this.blink(index, state);\r\n        }\r\n    };\r\n\r\n    tryUncover = (card, index, state) =>\r\n        !state.hand.isHoldingCard() && card.isHidden && state.tableau.uncover(index, card) && state.game.registerUncover(card, state);\r\n\r\n    blink = (index, state) => this._blink((s) => s.tableau.stacks[index], state);\r\n}\r\n","import Service from \"./BaseService\";\r\n\r\nexport default class Waste extends Service {\r\n    _dispatchPutDown = (card, state) =>\r\n        (state.hand.source == \"waste\" &&\r\n            state.waste.tryPutDown(state.hand.currentCard()) &&\r\n            state.hand.putDown() &&\r\n            state.game.registerMove(\"waste\", \"waste\")) ||\r\n        this.blink(card, state);\r\n\r\n    _dispatchPickup = (card, state) =>\r\n        (card && state.hand.pickUp([state.waste.popTop(card)], \"waste\") && state.game.registerPickup()) || this.blink(card, state);\r\n\r\n    blink = (card, state) => this._blink((s) => s.waste, state);\r\n}\r\n","import Deck from \"../Model/Deck/Deck\";\r\nimport Foundation from \"./Foundation\";\r\nimport Model from \"../Model/Facade\";\r\nimport Stock from \"./Stock\";\r\nimport Tableau from \"./Tableau\";\r\nimport Waste from \"./Waste\";\r\n\r\nexport default class Facade {\r\n    constructor() {\r\n        this.deck = new Deck();\r\n        this.deck.shuffle();\r\n    }\r\n\r\n    getInitialState = () => Model.getInitialState(this.deck);\r\n\r\n    getHandlers(stateholder, state) {\r\n        let handler = \"dispatchPickup\";\r\n        if (state && state.hand && state.hand.isHoldingCard()) {\r\n            handler = \"dispatchPutDown\";\r\n        }\r\n\r\n        return {\r\n            clickTableau: new Tableau(stateholder)[handler],\r\n            clickFoundation: new Foundation(stateholder)[handler],\r\n            clickStock: new Stock(stateholder)[handler],\r\n            clickWaste: new Waste(stateholder)[handler],\r\n            undo: () => this.undo(state.game.previousStates.length - 1, stateholder, state),\r\n            reset: () => this.reset(stateholder),\r\n            beat: () => this.beat(stateholder),\r\n            trip: () => this.trip(stateholder),\r\n            undoLabel: () => Math.pow(2, stateholder.state.game.multiplicator),\r\n        };\r\n    }\r\n\r\n    beat = (stateholder) => {\r\n        stateholder.setState((state) => Model.copy(state));\r\n    }\r\n\r\n    reset = (stateholder) =>\r\n        stateholder.setState((state) => (state.game.previousStates ? state.game.previousStates[0] : { ...this.getInitialState() }));\r\n\r\n    undo = (id, stateholder, currentState) => stateholder.setState((state) => state.game.popPreviousState(id, currentState) || null);\r\n\r\n    trip = (stateholder) => {\r\n        console.log('start tripping')\r\n        setInterval(() =>{\r\n            stateholder.setState((state) => Model.copy(state));\r\n        }, 250);\r\n    }\r\n}\r\n","import \"./App.css\";\r\n\r\nimport Board from \"./View/Board\";\r\nimport { Component } from \"react\";\r\nimport Game from \"./Service/Facade\";\r\nimport React from \"react\";\r\n\r\nexport default class App extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.game = new Game();\r\n        this.state = this.game.getInitialState(this);\r\n    }\r\n\r\n    render() {\r\n        const handlers = this.game.getHandlers(this, this.state);\r\n        return <Board subscribe={this.subscribe} model={this.state} game={this.game} handlers={handlers} />;\r\n    }\r\n}\r\n","import \"./App.css\";\r\n\r\nimport App from \"./App\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <App />\r\n    </React.StrictMode>,\r\n    document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}